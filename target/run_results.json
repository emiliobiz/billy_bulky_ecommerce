{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.1", "generated_at": "2023-11-20T15:55:05.394419Z", "invocation_id": "986bb2ad-dea4-4e03-b41b-60bf454f4544", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2023-11-20T15:54:59.998532Z", "completed_at": "2023-11-20T15:55:00.003446Z"}, {"name": "execute", "started_at": "2023-11-20T15:55:00.039880Z", "completed_at": "2023-11-20T15:55:01.486180Z"}], "thread_id": "Thread-3", "execution_time": 1.8708579540252686, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b0755a-0001-834e-0004-d8be0001121a"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.billy_bulky.staging_shopify__products", "compiled": true, "compiled_code": "WITH products AS (\n    SELECT * FROM SHOPIFY.PUBLIC.products\n)\n\nSELECT\n    PRODUCT_ID\n    , NAME\n    , CATEGORY\n    , PRICE\n    , STOCK_LEVEL\nFROM products", "relation_name": "E_COMMERCE.staging.staging_shopify__products"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-11-20T15:54:59.984164Z", "completed_at": "2023-11-20T15:55:00.002930Z"}, {"name": "execute", "started_at": "2023-11-20T15:55:00.015365Z", "completed_at": "2023-11-20T15:55:01.505039Z"}], "thread_id": "Thread-1", "execution_time": 1.9153919219970703, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b0755a-0001-815a-0000-0004d8bed281"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.billy_bulky.staging_shopify__customers", "compiled": true, "compiled_code": "WITH customers AS (\n    SELECT * FROM SHOPIFY.PUBLIC.customers\n)\n\nSELECT\n    CUSTOMER_ID\n    , FIRST_NAME\n    , LAST_NAME\n    , EMAIL\n    , JOIN_DATE\n    , COUNTRY\nFROM customers", "relation_name": "E_COMMERCE.staging.staging_shopify__customers"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-11-20T15:54:59.994972Z", "completed_at": "2023-11-20T15:55:00.002324Z"}, {"name": "execute", "started_at": "2023-11-20T15:55:00.005194Z", "completed_at": "2023-11-20T15:55:01.500336Z"}], "thread_id": "Thread-2", "execution_time": 1.917375087738037, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b0755a-0001-834e-0004-d8be0001121e"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.billy_bulky.staging_shopify__orders", "compiled": true, "compiled_code": "WITH orders AS (\n    SELECT * FROM SHOPIFY.PUBLIC.orders\n)\n\nSELECT\n    ORDER_ID\n    , CUSTOMER_ID\n    , PRODUCT_ID\n    , QUANTITY\n    , ORDER_DATE\n    , STATUS\nFROM orders", "relation_name": "E_COMMERCE.staging.staging_shopify__orders"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-11-20T15:55:01.901561Z", "completed_at": "2023-11-20T15:55:01.907376Z"}, {"name": "execute", "started_at": "2023-11-20T15:55:01.908237Z", "completed_at": "2023-11-20T15:55:04.981610Z"}], "thread_id": "Thread-5", "execution_time": 3.4849979877471924, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b0755a-0001-824a-0000-0004d8beb1f1"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.billy_bulky.int_customers_segmentation", "compiled": true, "compiled_code": "WITH customers AS (\n    SELECT * FROM E_COMMERCE.staging.staging_shopify__customers\n)\n\n, orders AS (\n    SELECT * FROM E_COMMERCE.staging.staging_shopify__orders\n)\n\n, products AS (\n    SELECT * FROM E_COMMERCE.staging.staging_shopify__products\n)\n\n, order_aggregates AS (\n    SELECT\n        o.CUSTOMER_ID\n        , COUNT(DISTINCT o.ORDER_ID) AS frequency\n        , SUM(o.QUANTITY * p.PRICE) AS monetary\n        , AVG(o.QUANTITY * p.PRICE) AS average_order_value\n        , MAX(o.ORDER_DATE) AS last_purchase_date\n        , COUNT(CASE WHEN o.STATUS = 'cancelled' THEN 1 END) AS cancelled_orders\n        , COUNT(*) AS total_orders\n    FROM orders o\n    JOIN products p ON o.PRODUCT_ID = p.PRODUCT_ID\n    GROUP BY o.CUSTOMER_ID\n)\n\n, customer_tenure AS (\n    SELECT\n        CUSTOMER_ID\n        , JOIN_DATE\n        , CURRENT_DATE - JOIN_DATE AS tenure\n    FROM customers\n)\n\n, customer_recency AS (\n    SELECT\n        CUSTOMER_ID\n        , CURRENT_DATE - last_purchase_date AS recency\n    FROM order_aggregates\n)\n\n, final AS (\n    SELECT\n        c.CUSTOMER_ID\n        , c.FIRST_NAME\n        , c.LAST_NAME\n        , c.EMAIL\n        , c.JOIN_DATE\n        , c.COUNTRY\n        , o.frequency\n        , o.monetary\n        , o.average_order_value\n        , o.cancelled_orders\n        , o.total_orders\n        , CASE \n            WHEN o.total_orders > 0 THEN ROUND((o.cancelled_orders::FLOAT / o.total_orders) * 100, 2) \n            ELSE 0 \n          END AS cancellation_rate\n        , r.recency\n        , t.tenure\n    FROM customer_tenure t\n    JOIN customers c ON t.CUSTOMER_ID = c.CUSTOMER_ID\n    JOIN order_aggregates o ON c.CUSTOMER_ID = o.CUSTOMER_ID\n    JOIN customer_recency r ON c.CUSTOMER_ID = r.CUSTOMER_ID\n)\n\nSELECT * FROM final", "relation_name": "E_COMMERCE.intermediate.int_customers_segmentation"}], "elapsed_time": 9.072035074234009, "args": {"cache_selected_only": false, "log_format_file": "debug", "invocation_command": "dbt run", "indirect_selection": "eager", "log_level_file": "debug", "partial_parse": true, "log_level": "info", "log_format": "default", "enable_legacy_logger": false, "quiet": false, "which": "run", "use_colors_file": true, "project_dir": "/Users/bitlevi/Desktop/dbt_project/billy_bulky", "use_colors": true, "introspect": true, "strict_mode": false, "profiles_dir": "/Users/bitlevi/.dbt", "favor_state": false, "vars": {}, "warn_error_options": {"include": [], "exclude": []}, "exclude": [], "print": true, "log_file_max_bytes": 10485760, "defer": false, "populate_cache": true, "send_anonymous_usage_stats": true, "select": [], "static_parser": true, "printer_width": 80, "partial_parse_file_diff": true, "macro_debugging": false, "write_json": true, "version_check": true, "log_path": "/Users/bitlevi/Desktop/dbt_project/billy_bulky/logs", "show_resource_report": false}}