[0m14:51:30.425561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102ea3310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105719e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105719820>]}


============================== 14:51:30.427785 | 17086bbb-7d58-4577-8eec-17668794b58d ==============================
[0m14:51:30.427785 [info ] [MainThread]: Running with dbt=1.7.1
[0m14:51:30.428102 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/bitlevi/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/bitlevi/Desktop/dbt_project/billy_bulky/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:51:30.428449 [info ] [MainThread]: dbt version: 1.7.1
[0m14:51:30.428616 [info ] [MainThread]: python version: 3.9.6
[0m14:51:30.428778 [info ] [MainThread]: python path: /Library/Developer/CommandLineTools/usr/bin/python3
[0m14:51:30.428931 [info ] [MainThread]: os info: macOS-14.1-arm64-arm-64bit
[0m14:51:30.901966 [info ] [MainThread]: Using profiles dir at /Users/bitlevi/.dbt
[0m14:51:30.902240 [info ] [MainThread]: Using profiles.yml file at /Users/bitlevi/.dbt/profiles.yml
[0m14:51:30.902415 [info ] [MainThread]: Using dbt_project.yml file at /Users/bitlevi/Desktop/dbt_project/billy_bulky/dbt_project.yml
[0m14:51:30.903422 [info ] [MainThread]: adapter type: snowflake
[0m14:51:30.903615 [info ] [MainThread]: adapter version: 1.7.0
[0m14:51:30.944632 [info ] [MainThread]: Configuration:
[0m14:51:30.944910 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m14:51:30.945078 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m14:51:30.945237 [info ] [MainThread]: Required dependencies:
[0m14:51:30.945439 [debug] [MainThread]: Executing "git --help"
[0m14:51:30.966812 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:51:30.967363 [debug] [MainThread]: STDERR: "b''"
[0m14:51:30.967580 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m14:51:30.967767 [info ] [MainThread]: Connection:
[0m14:51:30.967992 [info ] [MainThread]:   account: cgjaofv-wz65611
[0m14:51:30.968151 [info ] [MainThread]:   user: BILLYBULKY
[0m14:51:30.968304 [info ] [MainThread]:   database: E_COMMERCE
[0m14:51:30.968454 [info ] [MainThread]:   warehouse: COMPUTE_WH
[0m14:51:30.968603 [info ] [MainThread]:   role: ACCOUNTADMIN
[0m14:51:30.968750 [info ] [MainThread]:   schema: PUBLIC
[0m14:51:30.968901 [info ] [MainThread]:   authenticator: None
[0m14:51:30.969050 [info ] [MainThread]:   private_key_path: None
[0m14:51:30.969196 [info ] [MainThread]:   token: None
[0m14:51:30.969344 [info ] [MainThread]:   oauth_client_id: None
[0m14:51:30.969491 [info ] [MainThread]:   query_tag: None
[0m14:51:30.969639 [info ] [MainThread]:   client_session_keep_alive: False
[0m14:51:30.969788 [info ] [MainThread]:   host: None
[0m14:51:30.969935 [info ] [MainThread]:   port: None
[0m14:51:30.970082 [info ] [MainThread]:   proxy_host: None
[0m14:51:30.970229 [info ] [MainThread]:   proxy_port: None
[0m14:51:30.970375 [info ] [MainThread]:   protocol: None
[0m14:51:30.970522 [info ] [MainThread]:   connect_retries: 1
[0m14:51:30.970668 [info ] [MainThread]:   connect_timeout: None
[0m14:51:30.970815 [info ] [MainThread]:   retry_on_database_errors: False
[0m14:51:30.970963 [info ] [MainThread]:   retry_all: False
[0m14:51:30.971108 [info ] [MainThread]:   insecure_mode: False
[0m14:51:30.971255 [info ] [MainThread]:   reuse_connections: None
[0m14:51:30.971539 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m14:51:30.976031 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m14:51:30.976924 [debug] [MainThread]: Using snowflake connection "debug"
[0m14:51:30.977116 [debug] [MainThread]: On debug: select 1 as id
[0m14:51:30.977277 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:51:32.183826 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:51:32.188441 [debug] [MainThread]: On debug: Close
[0m14:51:32.521510 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m14:51:32.522749 [info ] [MainThread]: [32mAll checks passed![0m
[0m14:51:32.528014 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 2.1336784, "process_user_time": 3.425385, "process_kernel_time": 0.631802, "process_mem_max_rss": "204521472", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:51:32.529253 [debug] [MainThread]: Command `dbt debug` succeeded at 14:51:32.529017 after 2.14 seconds
[0m14:51:32.529863 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m14:51:32.530455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102ea3310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1300614c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127fd00a0>]}
[0m14:51:32.531145 [debug] [MainThread]: Flushing usage events
[0m15:02:50.924617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10270dca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f76b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f76a90>]}


============================== 15:02:50.929025 | 8cd5d0ee-289e-4dfa-b1f0-16f0b3debd21 ==============================
[0m15:02:50.929025 [info ] [MainThread]: Running with dbt=1.7.1
[0m15:02:50.929484 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/bitlevi/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/bitlevi/Desktop/dbt_project/billy_bulky/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m15:02:50.930036 [info ] [MainThread]: dbt version: 1.7.1
[0m15:02:50.930252 [info ] [MainThread]: python version: 3.9.6
[0m15:02:50.930442 [info ] [MainThread]: python path: /Library/Developer/CommandLineTools/usr/bin/python3
[0m15:02:50.930627 [info ] [MainThread]: os info: macOS-14.1-arm64-arm-64bit
[0m15:02:51.688697 [info ] [MainThread]: Using profiles dir at /Users/bitlevi/.dbt
[0m15:02:51.688997 [info ] [MainThread]: Using profiles.yml file at /Users/bitlevi/.dbt/profiles.yml
[0m15:02:51.689197 [info ] [MainThread]: Using dbt_project.yml file at /Users/bitlevi/Desktop/dbt_project/billy_bulky/dbt_project.yml
[0m15:02:51.689546 [info ] [MainThread]: adapter type: snowflake
[0m15:02:51.689729 [info ] [MainThread]: adapter version: 1.7.0
[0m15:02:51.731033 [info ] [MainThread]: Configuration:
[0m15:02:51.731348 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m15:02:51.731544 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m15:02:51.731836 [info ] [MainThread]: Required dependencies:
[0m15:02:51.732112 [debug] [MainThread]: Executing "git --help"
[0m15:02:51.759374 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m15:02:51.759980 [debug] [MainThread]: STDERR: "b''"
[0m15:02:51.760245 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m15:02:51.760461 [info ] [MainThread]: Connection:
[0m15:02:51.760740 [info ] [MainThread]:   account: cgjaofv-wz65611
[0m15:02:51.760923 [info ] [MainThread]:   user: BILLYBULKY
[0m15:02:51.761098 [info ] [MainThread]:   database: E_COMMERCE
[0m15:02:51.761271 [info ] [MainThread]:   warehouse: COMPUTE_WH
[0m15:02:51.761443 [info ] [MainThread]:   role: ACCOUNTADMIN
[0m15:02:51.761611 [info ] [MainThread]:   schema: PUBLIC
[0m15:02:51.761780 [info ] [MainThread]:   authenticator: None
[0m15:02:51.761952 [info ] [MainThread]:   private_key_path: None
[0m15:02:51.762123 [info ] [MainThread]:   token: None
[0m15:02:51.762291 [info ] [MainThread]:   oauth_client_id: None
[0m15:02:51.762464 [info ] [MainThread]:   query_tag: None
[0m15:02:51.762635 [info ] [MainThread]:   client_session_keep_alive: False
[0m15:02:51.762808 [info ] [MainThread]:   host: None
[0m15:02:51.762979 [info ] [MainThread]:   port: None
[0m15:02:51.763150 [info ] [MainThread]:   proxy_host: None
[0m15:02:51.763320 [info ] [MainThread]:   proxy_port: None
[0m15:02:51.763491 [info ] [MainThread]:   protocol: None
[0m15:02:51.763663 [info ] [MainThread]:   connect_retries: 1
[0m15:02:51.763836 [info ] [MainThread]:   connect_timeout: None
[0m15:02:51.764010 [info ] [MainThread]:   retry_on_database_errors: False
[0m15:02:51.764181 [info ] [MainThread]:   retry_all: False
[0m15:02:51.764351 [info ] [MainThread]:   insecure_mode: False
[0m15:02:51.764523 [info ] [MainThread]:   reuse_connections: None
[0m15:02:51.764882 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m15:02:51.770750 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m15:02:51.771704 [debug] [MainThread]: Using snowflake connection "debug"
[0m15:02:51.771941 [debug] [MainThread]: On debug: select 1 as id
[0m15:02:51.772133 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:02:53.073589 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:02:53.075009 [debug] [MainThread]: On debug: Close
[0m15:02:53.525318 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m15:02:53.526748 [info ] [MainThread]: [32mAll checks passed![0m
[0m15:02:53.532534 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 2.6485167, "process_user_time": 3.770276, "process_kernel_time": 0.356093, "process_mem_max_rss": "201670656", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:02:53.533779 [debug] [MainThread]: Command `dbt debug` succeeded at 15:02:53.533520 after 2.65 seconds
[0m15:02:53.534491 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m15:02:53.535132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10270dca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f5cfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137cbb820>]}
[0m15:02:53.535855 [debug] [MainThread]: Flushing usage events
[0m15:03:29.069571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107339eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b887f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b88a90>]}


============================== 15:03:29.072835 | 7bfb35f7-7753-459c-b958-791aa40c3648 ==============================
[0m15:03:29.072835 [info ] [MainThread]: Running with dbt=1.7.1
[0m15:03:29.073203 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/bitlevi/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/bitlevi/Desktop/dbt_project/billy_bulky/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:03:29.889665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7bfb35f7-7753-459c-b958-791aa40c3648', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e2b940>]}
[0m15:03:29.937285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7bfb35f7-7753-459c-b958-791aa40c3648', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1346e3100>]}
[0m15:03:29.937881 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m15:03:29.951582 [debug] [MainThread]: checksum: ad428e6dc3b353dcb23d0c4ebea8b20b180e94b873271ac2a054a8e446dac0e2, vars: {}, profile: , target: , version: 1.7.1
[0m15:03:29.952146 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:03:29.952403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7bfb35f7-7753-459c-b958-791aa40c3648', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x134965bb0>]}
[0m15:03:30.582405 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.billy_bulky.example
[0m15:03:30.585777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7bfb35f7-7753-459c-b958-791aa40c3648', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135074340>]}
[0m15:03:30.591815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7bfb35f7-7753-459c-b958-791aa40c3648', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135074fa0>]}
[0m15:03:30.592152 [info ] [MainThread]: Found 5 models, 3 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m15:03:30.592366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7bfb35f7-7753-459c-b958-791aa40c3648', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1347faee0>]}
[0m15:03:30.593177 [info ] [MainThread]: 
[0m15:03:30.593665 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:03:30.594294 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE'
[0m15:03:30.602896 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE"
[0m15:03:30.603172 [debug] [ThreadPool]: On list_E_COMMERCE: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE"} */
show terse schemas in database E_COMMERCE
    limit 10000
[0m15:03:30.603357 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:03:31.904499 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m15:03:31.908667 [debug] [ThreadPool]: On list_E_COMMERCE: Close
[0m15:03:32.244580 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_E_COMMERCE, now list_E_COMMERCE_PUBLIC)
[0m15:03:32.260198 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PUBLIC"
[0m15:03:32.260844 [debug] [ThreadPool]: On list_E_COMMERCE_PUBLIC: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE_PUBLIC"} */
show terse objects in E_COMMERCE.PUBLIC limit 10000
[0m15:03:32.261339 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:03:33.282304 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m15:03:33.288856 [debug] [ThreadPool]: On list_E_COMMERCE_PUBLIC: Close
[0m15:03:33.620160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7bfb35f7-7753-459c-b958-791aa40c3648', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135505640>]}
[0m15:03:33.621733 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m15:03:33.622388 [info ] [MainThread]: 
[0m15:03:33.628467 [debug] [Thread-1  ]: Began running node model.billy_bulky.staging_shopify__customers
[0m15:03:33.629365 [info ] [Thread-1  ]: 1 of 1 START sql view model PUBLIC.staging_shopify__customers .................. [RUN]
[0m15:03:33.630510 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_E_COMMERCE_PUBLIC, now model.billy_bulky.staging_shopify__customers)
[0m15:03:33.631178 [debug] [Thread-1  ]: Began compiling node model.billy_bulky.staging_shopify__customers
[0m15:03:33.641888 [debug] [Thread-1  ]: Writing injected SQL for node "model.billy_bulky.staging_shopify__customers"
[0m15:03:33.643380 [debug] [Thread-1  ]: Timing info for model.billy_bulky.staging_shopify__customers (compile): 15:03:33.631512 => 15:03:33.643089
[0m15:03:33.643858 [debug] [Thread-1  ]: Began executing node model.billy_bulky.staging_shopify__customers
[0m15:03:33.671673 [debug] [Thread-1  ]: Writing runtime sql for node "model.billy_bulky.staging_shopify__customers"
[0m15:03:33.672913 [debug] [Thread-1  ]: Using snowflake connection "model.billy_bulky.staging_shopify__customers"
[0m15:03:33.673237 [debug] [Thread-1  ]: On model.billy_bulky.staging_shopify__customers: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.staging_shopify__customers"} */
create or replace   view E_COMMERCE.PUBLIC.staging_shopify__customers
  
   as (
    WITH customers AS (
    SELECT * FROM E_COMMERCE.shopify.customers
)

SELECT * FROM customers
  );
[0m15:03:33.673530 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:03:34.737737 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01b074eb-0001-82f5-0004-d8be0001206e
[0m15:03:34.738173 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Schema 'E_COMMERCE.SHOPIFY' does not exist or not authorized.
[0m15:03:34.738634 [debug] [Thread-1  ]: Timing info for model.billy_bulky.staging_shopify__customers (execute): 15:03:33.644134 => 15:03:34.738443
[0m15:03:34.738970 [debug] [Thread-1  ]: On model.billy_bulky.staging_shopify__customers: Close
[0m15:03:35.106440 [debug] [Thread-1  ]: Database Error in model staging_shopify__customers (models/staging/shopify/staging_shopify__customers.sql)
  002003 (02000): SQL compilation error:
  Schema 'E_COMMERCE.SHOPIFY' does not exist or not authorized.
  compiled Code at target/run/billy_bulky/models/staging/shopify/staging_shopify__customers.sql
[0m15:03:35.107288 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7bfb35f7-7753-459c-b958-791aa40c3648', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135074ee0>]}
[0m15:03:35.108191 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model PUBLIC.staging_shopify__customers ......... [[31mERROR[0m in 1.48s]
[0m15:03:35.108986 [debug] [Thread-1  ]: Finished running node model.billy_bulky.staging_shopify__customers
[0m15:03:35.111007 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:03:35.111411 [debug] [MainThread]: Connection 'model.billy_bulky.staging_shopify__customers' was properly closed.
[0m15:03:35.111830 [info ] [MainThread]: 
[0m15:03:35.112240 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.52 seconds (4.52s).
[0m15:03:35.112997 [debug] [MainThread]: Command end result
[0m15:03:35.122290 [info ] [MainThread]: 
[0m15:03:35.122754 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:03:35.123092 [info ] [MainThread]: 
[0m15:03:35.123448 [error] [MainThread]:   Database Error in model staging_shopify__customers (models/staging/shopify/staging_shopify__customers.sql)
  002003 (02000): SQL compilation error:
  Schema 'E_COMMERCE.SHOPIFY' does not exist or not authorized.
  compiled Code at target/run/billy_bulky/models/staging/shopify/staging_shopify__customers.sql
[0m15:03:35.123788 [info ] [MainThread]: 
[0m15:03:35.124133 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:03:35.126552 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.089375, "process_user_time": 4.818965, "process_kernel_time": 0.386547, "process_mem_max_rss": "215302144", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:03:35.127100 [debug] [MainThread]: Command `dbt run` failed at 15:03:35.126973 after 6.09 seconds
[0m15:03:35.127516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107339eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e2b940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x134df9940>]}
[0m15:03:35.127920 [debug] [MainThread]: Flushing usage events
[0m15:04:23.772869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072e56d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dd69d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b33400>]}


============================== 15:04:23.775582 | 3eb723e4-6ed3-4868-9474-69035b88b561 ==============================
[0m15:04:23.775582 [info ] [MainThread]: Running with dbt=1.7.1
[0m15:04:23.775925 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/bitlevi/.dbt', 'log_path': '/Users/bitlevi/Desktop/dbt_project/billy_bulky/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:04:24.608848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3eb723e4-6ed3-4868-9474-69035b88b561', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dd69d0>]}
[0m15:04:24.656788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3eb723e4-6ed3-4868-9474-69035b88b561', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13d9e5340>]}
[0m15:04:24.657425 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m15:04:24.671561 [debug] [MainThread]: checksum: ad428e6dc3b353dcb23d0c4ebea8b20b180e94b873271ac2a054a8e446dac0e2, vars: {}, profile: , target: , version: 1.7.1
[0m15:04:24.701312 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:04:24.701803 [debug] [MainThread]: Partial parsing: updated file: billy_bulky://models/staging/shopify/_shopify__models.yml
[0m15:04:24.820399 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.billy_bulky.example
[0m15:04:24.823724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3eb723e4-6ed3-4868-9474-69035b88b561', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13e7ec0d0>]}
[0m15:04:24.831325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3eb723e4-6ed3-4868-9474-69035b88b561', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13dfe5e80>]}
[0m15:04:24.831667 [info ] [MainThread]: Found 5 models, 3 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m15:04:24.831899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3eb723e4-6ed3-4868-9474-69035b88b561', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13dfe5eb0>]}
[0m15:04:24.832863 [info ] [MainThread]: 
[0m15:04:24.833371 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:04:24.833982 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE'
[0m15:04:24.841869 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE"
[0m15:04:24.842083 [debug] [ThreadPool]: On list_E_COMMERCE: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE"} */
show terse schemas in database E_COMMERCE
    limit 10000
[0m15:04:24.842273 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:04:26.186257 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m15:04:26.190831 [debug] [ThreadPool]: On list_E_COMMERCE: Close
[0m15:04:26.525652 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_E_COMMERCE, now list_E_COMMERCE_PUBLIC)
[0m15:04:26.538642 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PUBLIC"
[0m15:04:26.539117 [debug] [ThreadPool]: On list_E_COMMERCE_PUBLIC: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE_PUBLIC"} */
show terse objects in E_COMMERCE.PUBLIC limit 10000
[0m15:04:26.539515 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:04:27.669925 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m15:04:27.675084 [debug] [ThreadPool]: On list_E_COMMERCE_PUBLIC: Close
[0m15:04:28.075458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3eb723e4-6ed3-4868-9474-69035b88b561', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13f3b74f0>]}
[0m15:04:28.077004 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m15:04:28.077583 [info ] [MainThread]: 
[0m15:04:28.082071 [debug] [Thread-1  ]: Began running node model.billy_bulky.staging_shopify__customers
[0m15:04:28.082916 [info ] [Thread-1  ]: 1 of 1 START sql view model PUBLIC.staging_shopify__customers .................. [RUN]
[0m15:04:28.084014 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_E_COMMERCE_PUBLIC, now model.billy_bulky.staging_shopify__customers)
[0m15:04:28.084628 [debug] [Thread-1  ]: Began compiling node model.billy_bulky.staging_shopify__customers
[0m15:04:28.095143 [debug] [Thread-1  ]: Writing injected SQL for node "model.billy_bulky.staging_shopify__customers"
[0m15:04:28.096215 [debug] [Thread-1  ]: Timing info for model.billy_bulky.staging_shopify__customers (compile): 15:04:28.084975 => 15:04:28.095922
[0m15:04:28.096801 [debug] [Thread-1  ]: Began executing node model.billy_bulky.staging_shopify__customers
[0m15:04:28.124993 [debug] [Thread-1  ]: Writing runtime sql for node "model.billy_bulky.staging_shopify__customers"
[0m15:04:28.125968 [debug] [Thread-1  ]: Using snowflake connection "model.billy_bulky.staging_shopify__customers"
[0m15:04:28.126323 [debug] [Thread-1  ]: On model.billy_bulky.staging_shopify__customers: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.staging_shopify__customers"} */
create or replace   view E_COMMERCE.PUBLIC.staging_shopify__customers
  
   as (
    WITH customers AS (
    SELECT * FROM E_COMMERCE.PUBLIC.customers
)

SELECT * FROM customers
  );
[0m15:04:28.126644 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:04:29.402673 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:04:29.436728 [debug] [Thread-1  ]: Timing info for model.billy_bulky.staging_shopify__customers (execute): 15:04:28.097085 => 15:04:29.436409
[0m15:04:29.437359 [debug] [Thread-1  ]: On model.billy_bulky.staging_shopify__customers: Close
[0m15:04:29.814397 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3eb723e4-6ed3-4868-9474-69035b88b561', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13db07ee0>]}
[0m15:04:29.816567 [info ] [Thread-1  ]: 1 of 1 OK created sql view model PUBLIC.staging_shopify__customers ............. [[32mSUCCESS 1[0m in 1.73s]
[0m15:04:29.818181 [debug] [Thread-1  ]: Finished running node model.billy_bulky.staging_shopify__customers
[0m15:04:29.821146 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:04:29.821689 [debug] [MainThread]: Connection 'model.billy_bulky.staging_shopify__customers' was properly closed.
[0m15:04:29.822185 [info ] [MainThread]: 
[0m15:04:29.822681 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.99 seconds (4.99s).
[0m15:04:29.823565 [debug] [MainThread]: Command end result
[0m15:04:29.835910 [info ] [MainThread]: 
[0m15:04:29.836472 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:04:29.836876 [info ] [MainThread]: 
[0m15:04:29.837286 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:04:29.840615 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.1021814, "process_user_time": 4.386934, "process_kernel_time": 0.403836, "process_mem_max_rss": "211681280", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:04:29.841266 [debug] [MainThread]: Command `dbt run` succeeded at 15:04:29.841113 after 6.10 seconds
[0m15:04:29.841743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072e56d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13daedcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13e79b0d0>]}
[0m15:04:29.842230 [debug] [MainThread]: Flushing usage events
[0m15:10:12.387069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103431250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106915460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106915850>]}


============================== 15:10:12.390056 | 8765895a-ede6-4594-9672-30aa23432f8e ==============================
[0m15:10:12.390056 [info ] [MainThread]: Running with dbt=1.7.1
[0m15:10:12.390443 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/bitlevi/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/bitlevi/Desktop/dbt_project/billy_bulky/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m15:10:13.276276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8765895a-ede6-4594-9672-30aa23432f8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068f7fa0>]}
[0m15:10:13.326948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8765895a-ede6-4594-9672-30aa23432f8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x150f02550>]}
[0m15:10:13.330063 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m15:10:13.343363 [debug] [MainThread]: checksum: ad428e6dc3b353dcb23d0c4ebea8b20b180e94b873271ac2a054a8e446dac0e2, vars: {}, profile: , target: , version: 1.7.1
[0m15:10:13.374581 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m15:10:13.375081 [debug] [MainThread]: Partial parsing: updated file: billy_bulky://models/staging/shopify/_shopify__models.yml
[0m15:10:13.375318 [debug] [MainThread]: Partial parsing: updated file: billy_bulky://models/staging/shopify/staging_shopify__customers.sql
[0m15:10:13.375559 [debug] [MainThread]: Partial parsing: updated file: billy_bulky://models/staging/shopify/staging_shopify__orders.sql
[0m15:10:13.375806 [debug] [MainThread]: Partial parsing: updated file: billy_bulky://models/staging/shopify/staging_shopify__products.sql
[0m15:10:13.503357 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.billy_bulky.example
[0m15:10:13.506676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8765895a-ede6-4594-9672-30aa23432f8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x151d170d0>]}
[0m15:10:13.513510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8765895a-ede6-4594-9672-30aa23432f8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15164fe50>]}
[0m15:10:13.513852 [info ] [MainThread]: Found 5 models, 3 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m15:10:13.514094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8765895a-ede6-4594-9672-30aa23432f8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15164fe80>]}
[0m15:10:13.515106 [info ] [MainThread]: 
[0m15:10:13.515649 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:10:13.516360 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE'
[0m15:10:13.524864 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE"
[0m15:10:13.525157 [debug] [ThreadPool]: On list_E_COMMERCE: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE"} */
show terse schemas in database E_COMMERCE
    limit 10000
[0m15:10:13.525352 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:10:14.870354 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m15:10:14.877164 [debug] [ThreadPool]: On list_E_COMMERCE: Close
[0m15:10:15.243546 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_E_COMMERCE, now list_E_COMMERCE_PUBLIC)
[0m15:10:15.259278 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PUBLIC"
[0m15:10:15.259873 [debug] [ThreadPool]: On list_E_COMMERCE_PUBLIC: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE_PUBLIC"} */
show terse objects in E_COMMERCE.PUBLIC limit 10000
[0m15:10:15.260366 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:10:16.448595 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:10:16.455338 [debug] [ThreadPool]: On list_E_COMMERCE_PUBLIC: Close
[0m15:10:16.860020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8765895a-ede6-4594-9672-30aa23432f8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x151ac5040>]}
[0m15:10:16.861139 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m15:10:16.861611 [info ] [MainThread]: 
[0m15:10:16.865625 [debug] [Thread-2  ]: Began running node model.billy_bulky.staging_shopify__orders
[0m15:10:16.866212 [debug] [Thread-3  ]: Began running node model.billy_bulky.staging_shopify__products
[0m15:10:16.866881 [debug] [Thread-1  ]: Began running node model.billy_bulky.staging_shopify__customers
[0m15:10:16.867598 [info ] [Thread-2  ]: 2 of 3 START sql view model PUBLIC.staging_shopify__orders ..................... [RUN]
[0m15:10:16.868450 [info ] [Thread-3  ]: 3 of 3 START sql view model PUBLIC.staging_shopify__products ................... [RUN]
[0m15:10:16.869177 [info ] [Thread-1  ]: 1 of 3 START sql view model PUBLIC.staging_shopify__customers .................. [RUN]
[0m15:10:16.870290 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.billy_bulky.staging_shopify__orders'
[0m15:10:16.871165 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.billy_bulky.staging_shopify__products'
[0m15:10:16.871874 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_E_COMMERCE_PUBLIC, now model.billy_bulky.staging_shopify__customers)
[0m15:10:16.872305 [debug] [Thread-2  ]: Began compiling node model.billy_bulky.staging_shopify__orders
[0m15:10:16.872706 [debug] [Thread-3  ]: Began compiling node model.billy_bulky.staging_shopify__products
[0m15:10:16.873090 [debug] [Thread-1  ]: Began compiling node model.billy_bulky.staging_shopify__customers
[0m15:10:16.881741 [debug] [Thread-3  ]: Writing injected SQL for node "model.billy_bulky.staging_shopify__products"
[0m15:10:16.884810 [debug] [Thread-2  ]: Writing injected SQL for node "model.billy_bulky.staging_shopify__orders"
[0m15:10:16.887938 [debug] [Thread-1  ]: Writing injected SQL for node "model.billy_bulky.staging_shopify__customers"
[0m15:10:16.889108 [debug] [Thread-3  ]: Timing info for model.billy_bulky.staging_shopify__products (compile): 15:10:16.878461 => 15:10:16.888834
[0m15:10:16.889512 [debug] [Thread-3  ]: Began executing node model.billy_bulky.staging_shopify__products
[0m15:10:16.889950 [debug] [Thread-2  ]: Timing info for model.billy_bulky.staging_shopify__orders (compile): 15:10:16.873330 => 15:10:16.889728
[0m15:10:16.890344 [debug] [Thread-1  ]: Timing info for model.billy_bulky.staging_shopify__customers (compile): 15:10:16.885156 => 15:10:16.890156
[0m15:10:16.896963 [debug] [Thread-2  ]: Began executing node model.billy_bulky.staging_shopify__orders
[0m15:10:16.912672 [debug] [Thread-3  ]: Writing runtime sql for node "model.billy_bulky.staging_shopify__products"
[0m15:10:16.913006 [debug] [Thread-1  ]: Began executing node model.billy_bulky.staging_shopify__customers
[0m15:10:16.916285 [debug] [Thread-2  ]: Writing runtime sql for node "model.billy_bulky.staging_shopify__orders"
[0m15:10:16.918878 [debug] [Thread-1  ]: Writing runtime sql for node "model.billy_bulky.staging_shopify__customers"
[0m15:10:16.919658 [debug] [Thread-2  ]: Using snowflake connection "model.billy_bulky.staging_shopify__orders"
[0m15:10:16.920147 [debug] [Thread-3  ]: Using snowflake connection "model.billy_bulky.staging_shopify__products"
[0m15:10:16.920414 [debug] [Thread-2  ]: On model.billy_bulky.staging_shopify__orders: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.staging_shopify__orders"} */
create or replace   view E_COMMERCE.PUBLIC.staging_shopify__orders
  
   as (
    WITH orders AS (
    SELECT * FROM SHOPIFY.PUBLIC.orders
)

SELECT
    ORDER_ID
    , CUSTOMER_ID
    , PRODUCT_ID
    , QUANTITY
    , ORDER_DATE
    , STATUS
FROM orders
  );
[0m15:10:16.920899 [debug] [Thread-1  ]: Using snowflake connection "model.billy_bulky.staging_shopify__customers"
[0m15:10:16.921164 [debug] [Thread-3  ]: On model.billy_bulky.staging_shopify__products: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.staging_shopify__products"} */
create or replace   view E_COMMERCE.PUBLIC.staging_shopify__products
  
   as (
    WITH products AS (
    SELECT * FROM SHOPIFY.PUBLIC.products
)

SELECT
    PRODUCT_ID
    , NAME
    , CATEGORY
    , PRICE
    , STOCK_LEVEL
FROM products
  );
[0m15:10:16.921421 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m15:10:16.921674 [debug] [Thread-1  ]: On model.billy_bulky.staging_shopify__customers: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.staging_shopify__customers"} */
create or replace   view E_COMMERCE.PUBLIC.staging_shopify__customers
  
   as (
    WITH customers AS (
    SELECT * FROM SHOPIFY.PUBLIC.customers
)

SELECT
    CUSTOMER_ID
    , FIRST_NAME
    , LAST_NAME
    , EMAIL
    , JOIN_DATE
    , COUNTRY
FROM customers
  );
[0m15:10:16.921923 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m15:10:16.922340 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:10:18.181092 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:10:18.209546 [debug] [Thread-2  ]: Timing info for model.billy_bulky.staging_shopify__orders (execute): 15:10:16.913190 => 15:10:18.209264
[0m15:10:18.210090 [debug] [Thread-2  ]: On model.billy_bulky.staging_shopify__orders: Close
[0m15:10:18.212267 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:10:18.217556 [debug] [Thread-1  ]: Timing info for model.billy_bulky.staging_shopify__customers (execute): 15:10:16.916609 => 15:10:18.217351
[0m15:10:18.218289 [debug] [Thread-1  ]: On model.billy_bulky.staging_shopify__customers: Close
[0m15:10:18.598265 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8765895a-ede6-4594-9672-30aa23432f8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1553d0f40>]}
[0m15:10:18.599471 [info ] [Thread-1  ]: 1 of 3 OK created sql view model PUBLIC.staging_shopify__customers ............. [[32mSUCCESS 1[0m in 1.73s]
[0m15:10:18.600541 [debug] [Thread-1  ]: Finished running node model.billy_bulky.staging_shopify__customers
[0m15:10:20.337923 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8765895a-ede6-4594-9672-30aa23432f8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x151d17f70>]}
[0m15:10:20.339352 [info ] [Thread-2  ]: 2 of 3 OK created sql view model PUBLIC.staging_shopify__orders ................ [[32mSUCCESS 1[0m in 3.47s]
[0m15:10:20.340240 [debug] [Thread-2  ]: Finished running node model.billy_bulky.staging_shopify__orders
[0m15:10:20.538140 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 4.0 seconds
[0m15:10:20.545922 [debug] [Thread-3  ]: Timing info for model.billy_bulky.staging_shopify__products (execute): 15:10:16.890524 => 15:10:20.545447
[0m15:10:20.546773 [debug] [Thread-3  ]: On model.billy_bulky.staging_shopify__products: Close
[0m15:10:20.886933 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8765895a-ede6-4594-9672-30aa23432f8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1554027f0>]}
[0m15:10:20.888370 [info ] [Thread-3  ]: 3 of 3 OK created sql view model PUBLIC.staging_shopify__products .............. [[32mSUCCESS 1[0m in 4.02s]
[0m15:10:20.889424 [debug] [Thread-3  ]: Finished running node model.billy_bulky.staging_shopify__products
[0m15:10:20.892348 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:10:20.893000 [debug] [MainThread]: Connection 'model.billy_bulky.staging_shopify__customers' was properly closed.
[0m15:10:20.893577 [debug] [MainThread]: Connection 'model.billy_bulky.staging_shopify__orders' was properly closed.
[0m15:10:20.894077 [debug] [MainThread]: Connection 'model.billy_bulky.staging_shopify__products' was properly closed.
[0m15:10:20.894653 [info ] [MainThread]: 
[0m15:10:20.895238 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 7.38 seconds (7.38s).
[0m15:10:20.896756 [debug] [MainThread]: Command end result
[0m15:10:20.909397 [info ] [MainThread]: 
[0m15:10:20.909942 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:10:20.910350 [info ] [MainThread]: 
[0m15:10:20.910768 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m15:10:20.914093 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.562431, "process_user_time": 4.600991, "process_kernel_time": 0.417732, "process_mem_max_rss": "215711744", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:10:20.914732 [debug] [MainThread]: Command `dbt run` succeeded at 15:10:20.914578 after 8.56 seconds
[0m15:10:20.915228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103431250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x150d3a130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x151a90070>]}
[0m15:10:20.915708 [debug] [MainThread]: Flushing usage events
[0m15:16:20.618614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ee50d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109734a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109751ee0>]}


============================== 15:16:20.621341 | d5c00783-cd72-4b8c-843d-469e49275e5d ==============================
[0m15:16:20.621341 [info ] [MainThread]: Running with dbt=1.7.1
[0m15:16:20.621719 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/bitlevi/Desktop/dbt_project/billy_bulky/logs', 'debug': 'False', 'profiles_dir': '/Users/bitlevi/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:16:21.563497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd5c00783-cd72-4b8c-843d-469e49275e5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x134589250>]}
[0m15:16:21.611331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd5c00783-cd72-4b8c-843d-469e49275e5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13464ec40>]}
[0m15:16:21.611923 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m15:16:21.624906 [debug] [MainThread]: checksum: ad428e6dc3b353dcb23d0c4ebea8b20b180e94b873271ac2a054a8e446dac0e2, vars: {}, profile: , target: , version: 1.7.1
[0m15:16:21.635248 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading billy_bulky: staging/shopify/_shopify__schema.yml - Runtime Error
    Syntax error near line 86
    ------------------------------
    83 | 
    84 |       - name: category
    85 |         description: "The category to which the product belongs."
    86 |         - accepted_values:
    87 |               values: ['books', 'electronics', 'home', 'toys', 'garden', 'clothing']
    88 | 
    89 |       - name: price
    
    Raw Error:
    ------------------------------
    while parsing a block mapping
      in "<unicode string>", line 84, column 9
    did not find expected key
      in "<unicode string>", line 86, column 9
[0m15:16:21.637479 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 1.0533248, "process_user_time": 3.009658, "process_kernel_time": 0.995629, "process_mem_max_rss": "191004672", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:16:21.637939 [debug] [MainThread]: Command `dbt test` failed at 15:16:21.637843 after 1.05 seconds
[0m15:16:21.638210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ee50d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137d253d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137d251f0>]}
[0m15:16:21.638487 [debug] [MainThread]: Flushing usage events
[0m15:16:37.189572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048e1eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071307f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107130a90>]}


============================== 15:16:37.192236 | f0987162-d2a5-4d42-a720-852c8409fefb ==============================
[0m15:16:37.192236 [info ] [MainThread]: Running with dbt=1.7.1
[0m15:16:37.192599 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/bitlevi/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/bitlevi/Desktop/dbt_project/billy_bulky/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:16:37.772476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f0987162-d2a5-4d42-a720-852c8409fefb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043d3940>]}
[0m15:16:37.820463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f0987162-d2a5-4d42-a720-852c8409fefb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128ae4100>]}
[0m15:16:37.821285 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m15:16:37.833136 [debug] [MainThread]: checksum: ad428e6dc3b353dcb23d0c4ebea8b20b180e94b873271ac2a054a8e446dac0e2, vars: {}, profile: , target: , version: 1.7.1
[0m15:16:37.843352 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading billy_bulky: staging/shopify/_shopify__schema.yml - Runtime Error
    Syntax error near line 86
    ------------------------------
    83 | 
    84 |       - name: category
    85 |         description: "The category to which the product belongs."
    86 |         - accepted_values:
    87 |               values: ['books', 'electronics', 'home', 'toys', 'garden', 'clothing']
    88 | 
    89 |       - name: price
    
    Raw Error:
    ------------------------------
    while parsing a block mapping
      in "<unicode string>", line 84, column 9
    did not find expected key
      in "<unicode string>", line 86, column 9
[0m15:16:37.844947 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.68792707, "process_user_time": 3.350811, "process_kernel_time": 0.364405, "process_mem_max_rss": "192364544", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:16:37.845358 [debug] [MainThread]: Command `dbt run` failed at 15:16:37.845272 after 0.69 seconds
[0m15:16:37.845644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048e1eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1293793a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1293791c0>]}
[0m15:16:37.845914 [debug] [MainThread]: Flushing usage events
[0m15:17:54.850765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e95250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109701460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109701850>]}


============================== 15:17:54.853453 | 4b0b926d-0d09-431e-95b3-705337362199 ==============================
[0m15:17:54.853453 [info ] [MainThread]: Running with dbt=1.7.1
[0m15:17:54.853820 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/bitlevi/Desktop/dbt_project/billy_bulky/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/bitlevi/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m15:17:55.660331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4b0b926d-0d09-431e-95b3-705337362199', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096e3fa0>]}
[0m15:17:55.708646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4b0b926d-0d09-431e-95b3-705337362199', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ad2a550>]}
[0m15:17:55.709517 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m15:17:55.722448 [debug] [MainThread]: checksum: ad428e6dc3b353dcb23d0c4ebea8b20b180e94b873271ac2a054a8e446dac0e2, vars: {}, profile: , target: , version: 1.7.1
[0m15:17:55.732365 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading billy_bulky: staging/shopify/_shopify__schema.yml - Runtime Error
    Syntax error near line 90
    ------------------------------
    87 | 
    88 |       - name: category
    89 |         description: "The category to which the product belongs."
    90 |         - accepted_values:
    91 |               values: 
    92 |                 - books
    93 |                 - electronics
    
    Raw Error:
    ------------------------------
    while parsing a block mapping
      in "<unicode string>", line 88, column 9
    did not find expected key
      in "<unicode string>", line 90, column 9
[0m15:17:55.734263 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.9167301, "process_user_time": 3.648686, "process_kernel_time": 0.325326, "process_mem_max_rss": "191610880", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:17:55.734844 [debug] [MainThread]: Command `dbt run` failed at 15:17:55.734733 after 0.92 seconds
[0m15:17:55.735149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e95250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b43c400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b43c1c0>]}
[0m15:17:55.735511 [debug] [MainThread]: Flushing usage events
[0m15:18:53.807096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d71eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1138f87f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1138f8a90>]}


============================== 15:18:53.809965 | 84ff95ef-d60c-4605-9670-793adbda3b44 ==============================
[0m15:18:53.809965 [info ] [MainThread]: Running with dbt=1.7.1
[0m15:18:53.810341 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/bitlevi/Desktop/dbt_project/billy_bulky/logs', 'profiles_dir': '/Users/bitlevi/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:18:54.760689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '84ff95ef-d60c-4605-9670-793adbda3b44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107736940>]}
[0m15:18:54.808472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '84ff95ef-d60c-4605-9670-793adbda3b44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145664100>]}
[0m15:18:54.809090 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m15:18:54.822990 [debug] [MainThread]: checksum: ad428e6dc3b353dcb23d0c4ebea8b20b180e94b873271ac2a054a8e446dac0e2, vars: {}, profile: , target: , version: 1.7.1
[0m15:18:54.853315 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:18:54.853826 [debug] [MainThread]: Partial parsing: updated file: billy_bulky://models/staging/shopify/_shopify__schema.yml
[0m15:18:54.885410 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'products' in the 'models' section of file 'models/staging/shopify/_shopify__schema.yml'
[0m15:18:54.974280 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.unique_products_product_id.68edffb83d' (models/staging/shopify/_shopify__schema.yml) depends on a node named 'products' in package '' which was not found
[0m15:18:54.974625 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_products_product_id.33741cf88e' (models/staging/shopify/_shopify__schema.yml) depends on a node named 'products' in package '' which was not found
[0m15:18:54.974862 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_products_name.d755fc2381' (models/staging/shopify/_shopify__schema.yml) depends on a node named 'products' in package '' which was not found
[0m15:18:54.975098 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.accepted_values_products_category__books__electronics__home__toys__garden__clothing.e85e5b5f7b' (models/staging/shopify/_shopify__schema.yml) depends on a node named 'products' in package '' which was not found
[0m15:18:54.975322 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_products_price.3b5b0a69be' (models/staging/shopify/_shopify__schema.yml) depends on a node named 'products' in package '' which was not found
[0m15:18:54.975534 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_products_stock_level.ee79d71f38' (models/staging/shopify/_shopify__schema.yml) depends on a node named 'products' in package '' which was not found
[0m15:18:54.980844 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.billy_bulky.example
[0m15:18:54.984702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '84ff95ef-d60c-4605-9670-793adbda3b44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146551df0>]}
[0m15:18:54.993827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '84ff95ef-d60c-4605-9670-793adbda3b44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146543d30>]}
[0m15:18:54.994156 [info ] [MainThread]: Found 5 models, 14 tests, 3 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m15:18:54.994381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '84ff95ef-d60c-4605-9670-793adbda3b44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146543d60>]}
[0m15:18:54.995459 [info ] [MainThread]: 
[0m15:18:54.995937 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:18:54.996603 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE'
[0m15:18:55.005158 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE"
[0m15:18:55.005448 [debug] [ThreadPool]: On list_E_COMMERCE: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE"} */
show terse schemas in database E_COMMERCE
    limit 10000
[0m15:18:55.005638 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:18:56.556858 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 2.0 seconds
[0m15:18:56.561116 [debug] [ThreadPool]: On list_E_COMMERCE: Close
[0m15:18:56.896839 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_E_COMMERCE, now list_E_COMMERCE_PUBLIC)
[0m15:18:56.914348 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PUBLIC"
[0m15:18:56.915003 [debug] [ThreadPool]: On list_E_COMMERCE_PUBLIC: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE_PUBLIC"} */
show terse objects in E_COMMERCE.PUBLIC limit 10000
[0m15:18:56.915483 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:18:58.058076 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m15:18:58.063926 [debug] [ThreadPool]: On list_E_COMMERCE_PUBLIC: Close
[0m15:18:58.492689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '84ff95ef-d60c-4605-9670-793adbda3b44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1464c9b80>]}
[0m15:18:58.494142 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m15:18:58.494712 [info ] [MainThread]: 
[0m15:18:58.498232 [debug] [Thread-2  ]: Began running node model.billy_bulky.staging_shopify__orders
[0m15:18:58.498717 [debug] [Thread-3  ]: Began running node model.billy_bulky.staging_shopify__products
[0m15:18:58.499108 [debug] [Thread-1  ]: Began running node model.billy_bulky.staging_shopify__customers
[0m15:18:58.499512 [info ] [Thread-2  ]: 2 of 3 START sql view model PUBLIC.staging_shopify__orders ..................... [RUN]
[0m15:18:58.499913 [info ] [Thread-3  ]: 3 of 3 START sql view model PUBLIC.staging_shopify__products ................... [RUN]
[0m15:18:58.500708 [info ] [Thread-1  ]: 1 of 3 START sql view model PUBLIC.staging_shopify__customers .................. [RUN]
[0m15:18:58.501586 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.billy_bulky.staging_shopify__orders'
[0m15:18:58.502242 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.billy_bulky.staging_shopify__products'
[0m15:18:58.502965 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_E_COMMERCE_PUBLIC, now model.billy_bulky.staging_shopify__customers)
[0m15:18:58.503315 [debug] [Thread-2  ]: Began compiling node model.billy_bulky.staging_shopify__orders
[0m15:18:58.503591 [debug] [Thread-3  ]: Began compiling node model.billy_bulky.staging_shopify__products
[0m15:18:58.503854 [debug] [Thread-1  ]: Began compiling node model.billy_bulky.staging_shopify__customers
[0m15:18:58.511771 [debug] [Thread-2  ]: Writing injected SQL for node "model.billy_bulky.staging_shopify__orders"
[0m15:18:58.515798 [debug] [Thread-3  ]: Writing injected SQL for node "model.billy_bulky.staging_shopify__products"
[0m15:18:58.519890 [debug] [Thread-1  ]: Writing injected SQL for node "model.billy_bulky.staging_shopify__customers"
[0m15:18:58.521266 [debug] [Thread-2  ]: Timing info for model.billy_bulky.staging_shopify__orders (compile): 15:18:58.504018 => 15:18:58.520915
[0m15:18:58.521944 [debug] [Thread-1  ]: Timing info for model.billy_bulky.staging_shopify__customers (compile): 15:18:58.516193 => 15:18:58.521636
[0m15:18:58.522424 [debug] [Thread-2  ]: Began executing node model.billy_bulky.staging_shopify__orders
[0m15:18:58.522945 [debug] [Thread-3  ]: Timing info for model.billy_bulky.staging_shopify__products (compile): 15:18:58.512151 => 15:18:58.522688
[0m15:18:58.523412 [debug] [Thread-1  ]: Began executing node model.billy_bulky.staging_shopify__customers
[0m15:18:58.542710 [debug] [Thread-3  ]: Began executing node model.billy_bulky.staging_shopify__products
[0m15:18:58.554420 [debug] [Thread-2  ]: Writing runtime sql for node "model.billy_bulky.staging_shopify__orders"
[0m15:18:58.557514 [debug] [Thread-1  ]: Writing runtime sql for node "model.billy_bulky.staging_shopify__customers"
[0m15:18:58.560128 [debug] [Thread-3  ]: Writing runtime sql for node "model.billy_bulky.staging_shopify__products"
[0m15:18:58.561075 [debug] [Thread-2  ]: Using snowflake connection "model.billy_bulky.staging_shopify__orders"
[0m15:18:58.561437 [debug] [Thread-2  ]: On model.billy_bulky.staging_shopify__orders: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.staging_shopify__orders"} */
create or replace   view E_COMMERCE.PUBLIC.staging_shopify__orders
  
   as (
    WITH orders AS (
    SELECT * FROM SHOPIFY.PUBLIC.orders
)

SELECT
    ORDER_ID
    , CUSTOMER_ID
    , PRODUCT_ID
    , QUANTITY
    , ORDER_DATE
    , STATUS
FROM orders
  );
[0m15:18:58.561780 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m15:18:58.562377 [debug] [Thread-1  ]: Using snowflake connection "model.billy_bulky.staging_shopify__customers"
[0m15:18:58.562905 [debug] [Thread-3  ]: Using snowflake connection "model.billy_bulky.staging_shopify__products"
[0m15:18:58.563398 [debug] [Thread-1  ]: On model.billy_bulky.staging_shopify__customers: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.staging_shopify__customers"} */
create or replace   view E_COMMERCE.PUBLIC.staging_shopify__customers
  
   as (
    WITH customers AS (
    SELECT * FROM SHOPIFY.PUBLIC.customers
)

SELECT
    CUSTOMER_ID
    , FIRST_NAME
    , LAST_NAME
    , EMAIL
    , JOIN_DATE
    , COUNTRY
FROM customers
  );
[0m15:18:58.563947 [debug] [Thread-3  ]: On model.billy_bulky.staging_shopify__products: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.staging_shopify__products"} */
create or replace   view E_COMMERCE.PUBLIC.staging_shopify__products
  
   as (
    WITH products AS (
    SELECT * FROM SHOPIFY.PUBLIC.products
)

SELECT
    PRODUCT_ID
    , NAME
    , CATEGORY
    , PRICE
    , STOCK_LEVEL
FROM products
  );
[0m15:18:58.564291 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:18:58.564562 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m15:18:59.903375 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:18:59.940461 [debug] [Thread-2  ]: Timing info for model.billy_bulky.staging_shopify__orders (execute): 15:18:58.523698 => 15:18:59.940113
[0m15:18:59.941603 [debug] [Thread-2  ]: On model.billy_bulky.staging_shopify__orders: Close
[0m15:18:59.942426 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:18:59.946573 [debug] [Thread-1  ]: Timing info for model.billy_bulky.staging_shopify__customers (execute): 15:18:58.554734 => 15:18:59.946346
[0m15:18:59.947006 [debug] [Thread-1  ]: On model.billy_bulky.staging_shopify__customers: Close
[0m15:18:59.949506 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:18:59.952441 [debug] [Thread-3  ]: Timing info for model.billy_bulky.staging_shopify__products (execute): 15:18:58.557727 => 15:18:59.952212
[0m15:18:59.953374 [debug] [Thread-3  ]: On model.billy_bulky.staging_shopify__products: Close
[0m15:19:00.341475 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84ff95ef-d60c-4605-9670-793adbda3b44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146543d60>]}
[0m15:19:00.343148 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84ff95ef-d60c-4605-9670-793adbda3b44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146041d60>]}
[0m15:19:00.344397 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84ff95ef-d60c-4605-9670-793adbda3b44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146bcfee0>]}
[0m15:19:00.345496 [info ] [Thread-2  ]: 2 of 3 OK created sql view model PUBLIC.staging_shopify__orders ................ [[32mSUCCESS 1[0m in 1.84s]
[0m15:19:00.346467 [info ] [Thread-1  ]: 1 of 3 OK created sql view model PUBLIC.staging_shopify__customers ............. [[32mSUCCESS 1[0m in 1.84s]
[0m15:19:00.347420 [info ] [Thread-3  ]: 3 of 3 OK created sql view model PUBLIC.staging_shopify__products .............. [[32mSUCCESS 1[0m in 1.84s]
[0m15:19:00.348430 [debug] [Thread-2  ]: Finished running node model.billy_bulky.staging_shopify__orders
[0m15:19:00.349320 [debug] [Thread-1  ]: Finished running node model.billy_bulky.staging_shopify__customers
[0m15:19:00.350175 [debug] [Thread-3  ]: Finished running node model.billy_bulky.staging_shopify__products
[0m15:19:00.352919 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:19:00.353488 [debug] [MainThread]: Connection 'model.billy_bulky.staging_shopify__customers' was properly closed.
[0m15:19:00.353940 [debug] [MainThread]: Connection 'model.billy_bulky.staging_shopify__orders' was properly closed.
[0m15:19:00.354385 [debug] [MainThread]: Connection 'model.billy_bulky.staging_shopify__products' was properly closed.
[0m15:19:00.354941 [info ] [MainThread]: 
[0m15:19:00.355467 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 5.36 seconds (5.36s).
[0m15:19:00.356745 [debug] [MainThread]: Command end result
[0m15:19:00.370138 [info ] [MainThread]: 
[0m15:19:00.370778 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:19:00.371207 [info ] [MainThread]: 
[0m15:19:00.371642 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m15:19:00.374739 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.6008806, "process_user_time": 4.666032, "process_kernel_time": 0.519217, "process_mem_max_rss": "216121344", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:19:00.375344 [debug] [MainThread]: Command `dbt run` succeeded at 15:19:00.375213 after 6.60 seconds
[0m15:19:00.375747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d71eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145fd7040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146522130>]}
[0m15:19:00.376169 [debug] [MainThread]: Flushing usage events
[0m15:29:18.419701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10324d6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102d3f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a9c400>]}


============================== 15:29:18.422669 | aac66cd4-addd-4444-a26c-2bce76527da6 ==============================
[0m15:29:18.422669 [info ] [MainThread]: Running with dbt=1.7.1
[0m15:29:18.423072 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/bitlevi/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/bitlevi/Desktop/dbt_project/billy_bulky/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:29:19.266582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aac66cd4-addd-4444-a26c-2bce76527da6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102d3f9d0>]}
[0m15:29:19.314514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aac66cd4-addd-4444-a26c-2bce76527da6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040af790>]}
[0m15:29:19.315155 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m15:29:19.328437 [debug] [MainThread]: checksum: ad428e6dc3b353dcb23d0c4ebea8b20b180e94b873271ac2a054a8e446dac0e2, vars: {}, profile: , target: , version: 1.7.1
[0m15:29:19.336531 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m15:29:19.336925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'aac66cd4-addd-4444-a26c-2bce76527da6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c4264c0>]}
[0m15:29:19.935383 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'products' in the 'models' section of file 'models/staging/shopify/_shopify__schema.yml'
[0m15:29:20.050999 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.unique_products_product_id.68edffb83d' (models/staging/shopify/_shopify__schema.yml) depends on a node named 'products' in package '' which was not found
[0m15:29:20.051340 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_products_product_id.33741cf88e' (models/staging/shopify/_shopify__schema.yml) depends on a node named 'products' in package '' which was not found
[0m15:29:20.051578 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_products_name.d755fc2381' (models/staging/shopify/_shopify__schema.yml) depends on a node named 'products' in package '' which was not found
[0m15:29:20.051854 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.accepted_values_products_category__books__electronics__home__toys__garden__clothing.e85e5b5f7b' (models/staging/shopify/_shopify__schema.yml) depends on a node named 'products' in package '' which was not found
[0m15:29:20.052147 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_products_price.3b5b0a69be' (models/staging/shopify/_shopify__schema.yml) depends on a node named 'products' in package '' which was not found
[0m15:29:20.052388 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_products_stock_level.ee79d71f38' (models/staging/shopify/_shopify__schema.yml) depends on a node named 'products' in package '' which was not found
[0m15:29:20.078896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aac66cd4-addd-4444-a26c-2bce76527da6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d37ce80>]}
[0m15:29:20.088376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aac66cd4-addd-4444-a26c-2bce76527da6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c5171c0>]}
[0m15:29:20.088711 [info ] [MainThread]: Found 6 models, 14 tests, 6 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m15:29:20.088928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aac66cd4-addd-4444-a26c-2bce76527da6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c3fefa0>]}
[0m15:29:20.089982 [info ] [MainThread]: 
[0m15:29:20.090466 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:29:20.091158 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE'
[0m15:29:20.099023 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE"
[0m15:29:20.099240 [debug] [ThreadPool]: On list_E_COMMERCE: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE"} */
show terse schemas in database E_COMMERCE
    limit 10000
[0m15:29:20.099652 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE'
[0m15:29:20.099864 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:29:20.101305 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE"
[0m15:29:20.102278 [debug] [ThreadPool]: On list_E_COMMERCE: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE"} */
show terse schemas in database E_COMMERCE
    limit 10000
[0m15:29:20.102635 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:29:21.451391 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m15:29:21.453928 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m15:29:21.456798 [debug] [ThreadPool]: On list_E_COMMERCE: Close
[0m15:29:21.458940 [debug] [ThreadPool]: On list_E_COMMERCE: Close
[0m15:29:21.924020 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_E_COMMERCE, now create_E_COMMERCE_PUBLIC_staging)
[0m15:29:21.925414 [debug] [ThreadPool]: Creating schema "database: "E_COMMERCE"
schema: "PUBLIC_staging"
"
[0m15:29:21.934680 [debug] [ThreadPool]: Using snowflake connection "create_E_COMMERCE_PUBLIC_staging"
[0m15:29:21.935224 [debug] [ThreadPool]: On create_E_COMMERCE_PUBLIC_staging: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "create_E_COMMERCE_PUBLIC_staging"} */
create schema if not exists E_COMMERCE.PUBLIC_staging
[0m15:29:21.935702 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:29:23.128466 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:29:23.131789 [debug] [ThreadPool]: On create_E_COMMERCE_PUBLIC_staging: Close
[0m15:29:23.592665 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_E_COMMERCE, now list_E_COMMERCE_PUBLIC_staging)
[0m15:29:23.595268 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_E_COMMERCE_PUBLIC_staging, now list_E_COMMERCE_PUBLIC)
[0m15:29:23.616136 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PUBLIC_staging"
[0m15:29:23.619388 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PUBLIC"
[0m15:29:23.619853 [debug] [ThreadPool]: On list_E_COMMERCE_PUBLIC_staging: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE_PUBLIC_staging"} */
show terse objects in E_COMMERCE.PUBLIC_staging limit 10000
[0m15:29:23.620310 [debug] [ThreadPool]: On list_E_COMMERCE_PUBLIC: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE_PUBLIC"} */
show terse objects in E_COMMERCE.PUBLIC limit 10000
[0m15:29:23.620726 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:29:23.621099 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:29:24.647427 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m15:29:24.653097 [debug] [ThreadPool]: On list_E_COMMERCE_PUBLIC: Close
[0m15:29:24.700113 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.0 seconds
[0m15:29:24.706512 [debug] [ThreadPool]: On list_E_COMMERCE_PUBLIC_staging: Close
[0m15:29:25.030585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aac66cd4-addd-4444-a26c-2bce76527da6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d37c940>]}
[0m15:29:25.032278 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m15:29:25.032954 [info ] [MainThread]: 
[0m15:29:25.037759 [debug] [Thread-1  ]: Began running node model.billy_bulky.staging_shopify__customers
[0m15:29:25.038568 [debug] [Thread-2  ]: Began running node model.billy_bulky.staging_shopify__orders
[0m15:29:25.039929 [info ] [Thread-1  ]: 1 of 4 START sql view model PUBLIC_staging.staging_shopify__customers .......... [RUN]
[0m15:29:25.040658 [info ] [Thread-2  ]: 2 of 4 START sql view model PUBLIC_staging.staging_shopify__orders ............. [RUN]
[0m15:29:25.042158 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_E_COMMERCE_PUBLIC_staging, now model.billy_bulky.staging_shopify__customers)
[0m15:29:25.042945 [debug] [Thread-3  ]: Began running node model.billy_bulky.staging_shopify__products
[0m15:29:25.043974 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_E_COMMERCE_PUBLIC, now model.billy_bulky.staging_shopify__orders)
[0m15:29:25.044599 [debug] [Thread-1  ]: Began compiling node model.billy_bulky.staging_shopify__customers
[0m15:29:25.045314 [info ] [Thread-3  ]: 3 of 4 START sql view model PUBLIC_staging.staging_shopify__products ........... [RUN]
[0m15:29:25.045921 [debug] [Thread-2  ]: Began compiling node model.billy_bulky.staging_shopify__orders
[0m15:29:25.057076 [debug] [Thread-1  ]: Writing injected SQL for node "model.billy_bulky.staging_shopify__customers"
[0m15:29:25.058194 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.billy_bulky.staging_shopify__products'
[0m15:29:25.061987 [debug] [Thread-2  ]: Writing injected SQL for node "model.billy_bulky.staging_shopify__orders"
[0m15:29:25.062613 [debug] [Thread-3  ]: Began compiling node model.billy_bulky.staging_shopify__products
[0m15:29:25.066152 [debug] [Thread-3  ]: Writing injected SQL for node "model.billy_bulky.staging_shopify__products"
[0m15:29:25.066722 [debug] [Thread-1  ]: Timing info for model.billy_bulky.staging_shopify__customers (compile): 15:29:25.046261 => 15:29:25.066432
[0m15:29:25.067252 [debug] [Thread-1  ]: Began executing node model.billy_bulky.staging_shopify__customers
[0m15:29:25.067766 [debug] [Thread-2  ]: Timing info for model.billy_bulky.staging_shopify__orders (compile): 15:29:25.058590 => 15:29:25.067516
[0m15:29:25.080228 [debug] [Thread-3  ]: Timing info for model.billy_bulky.staging_shopify__products (compile): 15:29:25.063290 => 15:29:25.079948
[0m15:29:25.087189 [debug] [Thread-2  ]: Began executing node model.billy_bulky.staging_shopify__orders
[0m15:29:25.095464 [debug] [Thread-1  ]: Writing runtime sql for node "model.billy_bulky.staging_shopify__customers"
[0m15:29:25.095835 [debug] [Thread-3  ]: Began executing node model.billy_bulky.staging_shopify__products
[0m15:29:25.098484 [debug] [Thread-2  ]: Writing runtime sql for node "model.billy_bulky.staging_shopify__orders"
[0m15:29:25.100982 [debug] [Thread-3  ]: Writing runtime sql for node "model.billy_bulky.staging_shopify__products"
[0m15:29:25.101789 [debug] [Thread-2  ]: Using snowflake connection "model.billy_bulky.staging_shopify__orders"
[0m15:29:25.102344 [debug] [Thread-1  ]: Using snowflake connection "model.billy_bulky.staging_shopify__customers"
[0m15:29:25.102652 [debug] [Thread-2  ]: On model.billy_bulky.staging_shopify__orders: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.staging_shopify__orders"} */
create or replace   view E_COMMERCE.PUBLIC_staging.staging_shopify__orders
  
   as (
    WITH orders AS (
    SELECT * FROM SHOPIFY.PUBLIC.orders
)

SELECT
    ORDER_ID
    , CUSTOMER_ID
    , PRODUCT_ID
    , QUANTITY
    , ORDER_DATE
    , STATUS
FROM orders
  );
[0m15:29:25.102963 [debug] [Thread-1  ]: On model.billy_bulky.staging_shopify__customers: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.staging_shopify__customers"} */
create or replace   view E_COMMERCE.PUBLIC_staging.staging_shopify__customers
  
   as (
    WITH customers AS (
    SELECT * FROM SHOPIFY.PUBLIC.customers
)

SELECT
    CUSTOMER_ID
    , FIRST_NAME
    , LAST_NAME
    , EMAIL
    , JOIN_DATE
    , COUNTRY
FROM customers
  );
[0m15:29:25.103493 [debug] [Thread-3  ]: Using snowflake connection "model.billy_bulky.staging_shopify__products"
[0m15:29:25.103774 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m15:29:25.104038 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:29:25.104308 [debug] [Thread-3  ]: On model.billy_bulky.staging_shopify__products: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.staging_shopify__products"} */
create or replace   view E_COMMERCE.PUBLIC_staging.staging_shopify__products
  
   as (
    WITH products AS (
    SELECT * FROM SHOPIFY.PUBLIC.products
)

SELECT
    PRODUCT_ID
    , NAME
    , CATEGORY
    , PRICE
    , STOCK_LEVEL
FROM products
  );
[0m15:29:25.105611 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m15:29:26.291692 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:29:26.325309 [debug] [Thread-3  ]: Timing info for model.billy_bulky.staging_shopify__products (execute): 15:29:25.098743 => 15:29:26.324969
[0m15:29:26.325966 [debug] [Thread-3  ]: On model.billy_bulky.staging_shopify__products: Close
[0m15:29:26.368455 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:29:26.372258 [debug] [Thread-1  ]: Timing info for model.billy_bulky.staging_shopify__customers (execute): 15:29:25.068047 => 15:29:26.371945
[0m15:29:26.372853 [debug] [Thread-1  ]: On model.billy_bulky.staging_shopify__customers: Close
[0m15:29:26.384504 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:29:26.387995 [debug] [Thread-2  ]: Timing info for model.billy_bulky.staging_shopify__orders (execute): 15:29:25.096028 => 15:29:26.387693
[0m15:29:26.388561 [debug] [Thread-2  ]: On model.billy_bulky.staging_shopify__orders: Close
[0m15:29:26.659125 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aac66cd4-addd-4444-a26c-2bce76527da6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d37cca0>]}
[0m15:29:26.660150 [info ] [Thread-3  ]: 3 of 4 OK created sql view model PUBLIC_staging.staging_shopify__products ...... [[32mSUCCESS 1[0m in 1.60s]
[0m15:29:26.661027 [debug] [Thread-3  ]: Finished running node model.billy_bulky.staging_shopify__products
[0m15:29:26.699220 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aac66cd4-addd-4444-a26c-2bce76527da6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bc989d0>]}
[0m15:29:26.700063 [info ] [Thread-1  ]: 1 of 4 OK created sql view model PUBLIC_staging.staging_shopify__customers ..... [[32mSUCCESS 1[0m in 1.66s]
[0m15:29:26.700791 [debug] [Thread-1  ]: Finished running node model.billy_bulky.staging_shopify__customers
[0m15:29:26.709697 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aac66cd4-addd-4444-a26c-2bce76527da6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d4c2310>]}
[0m15:29:26.710455 [info ] [Thread-2  ]: 2 of 4 OK created sql view model PUBLIC_staging.staging_shopify__orders ........ [[32mSUCCESS 1[0m in 1.67s]
[0m15:29:26.711160 [debug] [Thread-2  ]: Finished running node model.billy_bulky.staging_shopify__orders
[0m15:29:26.711967 [debug] [Thread-5  ]: Began running node model.billy_bulky.int_customers_and_orders
[0m15:29:26.712689 [info ] [Thread-5  ]: 4 of 4 START sql view model PUBLIC.int_customers_and_orders .................... [RUN]
[0m15:29:26.713730 [debug] [Thread-5  ]: Acquiring new snowflake connection 'model.billy_bulky.int_customers_and_orders'
[0m15:29:26.714268 [debug] [Thread-5  ]: Began compiling node model.billy_bulky.int_customers_and_orders
[0m15:29:26.719279 [debug] [Thread-5  ]: Writing injected SQL for node "model.billy_bulky.int_customers_and_orders"
[0m15:29:26.720313 [debug] [Thread-5  ]: Timing info for model.billy_bulky.int_customers_and_orders (compile): 15:29:26.714568 => 15:29:26.720059
[0m15:29:26.720727 [debug] [Thread-5  ]: Began executing node model.billy_bulky.int_customers_and_orders
[0m15:29:26.724965 [debug] [Thread-5  ]: Writing runtime sql for node "model.billy_bulky.int_customers_and_orders"
[0m15:29:26.726607 [debug] [Thread-5  ]: Using snowflake connection "model.billy_bulky.int_customers_and_orders"
[0m15:29:26.727019 [debug] [Thread-5  ]: On model.billy_bulky.int_customers_and_orders: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.int_customers_and_orders"} */
create or replace   view E_COMMERCE.PUBLIC.int_customers_and_orders
  
   as (
    WITH customers AS (
    SELECT * FROM E_COMMERCE.PUBLIC_staging.staging_shopify__customers
)

, orders AS (
    SELECT * FROM E_COMMERCE.PUBLIC_staging.staging_shopify__orders
)


SELECT 
    o.ORDER_ID
    , o.CUSTOMER_ID
    , c.FIRST_NAME
    , c.LAST_NAME
    , c.EMAIL
    , o.PRODUCT_ID
    , o.QUANTITY
    , o.ORDER_DATE
    , o.STATUS
    , c.COUNTRY  
FROM orders AS o 
INNER JOIN customers AS c ON c.customer_id = o.order_id
  );
[0m15:29:26.727409 [debug] [Thread-5  ]: Opening a new connection, currently in state init
[0m15:29:27.992884 [debug] [Thread-5  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:29:28.001296 [debug] [Thread-5  ]: Timing info for model.billy_bulky.int_customers_and_orders (execute): 15:29:26.720971 => 15:29:28.000864
[0m15:29:28.002169 [debug] [Thread-5  ]: On model.billy_bulky.int_customers_and_orders: Close
[0m15:29:28.329303 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aac66cd4-addd-4444-a26c-2bce76527da6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11db23d60>]}
[0m15:29:28.331041 [info ] [Thread-5  ]: 4 of 4 OK created sql view model PUBLIC.int_customers_and_orders ............... [[32mSUCCESS 1[0m in 1.62s]
[0m15:29:28.332240 [debug] [Thread-5  ]: Finished running node model.billy_bulky.int_customers_and_orders
[0m15:29:28.335214 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:29:28.335846 [debug] [MainThread]: Connection 'model.billy_bulky.staging_shopify__customers' was properly closed.
[0m15:29:28.336385 [debug] [MainThread]: Connection 'model.billy_bulky.staging_shopify__orders' was properly closed.
[0m15:29:28.336885 [debug] [MainThread]: Connection 'model.billy_bulky.staging_shopify__products' was properly closed.
[0m15:29:28.337368 [debug] [MainThread]: Connection 'model.billy_bulky.int_customers_and_orders' was properly closed.
[0m15:29:28.338015 [info ] [MainThread]: 
[0m15:29:28.338609 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 8.25 seconds (8.25s).
[0m15:29:28.340331 [debug] [MainThread]: Command end result
[0m15:29:28.354132 [info ] [MainThread]: 
[0m15:29:28.354684 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:29:28.355088 [info ] [MainThread]: 
[0m15:29:28.355509 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m15:29:28.359586 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.975688, "process_user_time": 5.604296, "process_kernel_time": 0.487747, "process_mem_max_rss": "218054656", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:29:28.360353 [debug] [MainThread]: Command `dbt run` succeeded at 15:29:28.360195 after 9.98 seconds
[0m15:29:28.360839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10324d6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11dc3f370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c517370>]}
[0m15:29:28.361335 [debug] [MainThread]: Flushing usage events
[0m15:30:12.803935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102bac250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e54460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e54850>]}


============================== 15:30:12.806707 | f0249e44-34a4-4c69-ab35-fe9dce7aa808 ==============================
[0m15:30:12.806707 [info ] [MainThread]: Running with dbt=1.7.1
[0m15:30:12.807099 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/bitlevi/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/bitlevi/Desktop/dbt_project/billy_bulky/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m15:30:13.646458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f0249e44-34a4-4c69-ab35-fe9dce7aa808', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e37fa0>]}
[0m15:30:13.693976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f0249e44-34a4-4c69-ab35-fe9dce7aa808', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1510e4640>]}
[0m15:30:13.694607 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m15:30:13.708059 [debug] [MainThread]: checksum: ad428e6dc3b353dcb23d0c4ebea8b20b180e94b873271ac2a054a8e446dac0e2, vars: {}, profile: , target: , version: 1.7.1
[0m15:30:13.738373 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m15:30:13.738880 [debug] [MainThread]: Partial parsing: added file: billy_bulky://macros/generate_schema_name.sql
[0m15:30:13.740350 [info ] [MainThread]: Unable to do partial parsing because change detected to override macro. Starting full parse.
[0m15:30:14.318113 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'products' in the 'models' section of file 'models/staging/shopify/_shopify__schema.yml'
[0m15:30:14.428828 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.unique_products_product_id.68edffb83d' (models/staging/shopify/_shopify__schema.yml) depends on a node named 'products' in package '' which was not found
[0m15:30:14.429193 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_products_product_id.33741cf88e' (models/staging/shopify/_shopify__schema.yml) depends on a node named 'products' in package '' which was not found
[0m15:30:14.429480 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_products_name.d755fc2381' (models/staging/shopify/_shopify__schema.yml) depends on a node named 'products' in package '' which was not found
[0m15:30:14.429743 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.accepted_values_products_category__books__electronics__home__toys__garden__clothing.e85e5b5f7b' (models/staging/shopify/_shopify__schema.yml) depends on a node named 'products' in package '' which was not found
[0m15:30:14.429981 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_products_price.3b5b0a69be' (models/staging/shopify/_shopify__schema.yml) depends on a node named 'products' in package '' which was not found
[0m15:30:14.430202 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_products_stock_level.ee79d71f38' (models/staging/shopify/_shopify__schema.yml) depends on a node named 'products' in package '' which was not found
[0m15:30:14.454852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f0249e44-34a4-4c69-ab35-fe9dce7aa808', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x155515eb0>]}
[0m15:30:14.462707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f0249e44-34a4-4c69-ab35-fe9dce7aa808', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x151a87730>]}
[0m15:30:14.463008 [info ] [MainThread]: Found 6 models, 14 tests, 6 sources, 0 exposures, 0 metrics, 431 macros, 0 groups, 0 semantic models
[0m15:30:14.463224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f0249e44-34a4-4c69-ab35-fe9dce7aa808', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x151a87610>]}
[0m15:30:14.464287 [info ] [MainThread]: 
[0m15:30:14.464760 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:30:14.465455 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE'
[0m15:30:14.473991 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE"
[0m15:30:14.474524 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE'
[0m15:30:14.474752 [debug] [ThreadPool]: On list_E_COMMERCE: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE"} */
show terse schemas in database E_COMMERCE
    limit 10000
[0m15:30:14.476265 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE"
[0m15:30:14.476476 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:30:14.476668 [debug] [ThreadPool]: On list_E_COMMERCE: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE"} */
show terse schemas in database E_COMMERCE
    limit 10000
[0m15:30:14.477425 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:30:15.692662 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m15:30:15.695779 [debug] [ThreadPool]: On list_E_COMMERCE: Close
[0m15:30:15.699792 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m15:30:15.702670 [debug] [ThreadPool]: On list_E_COMMERCE: Close
[0m15:30:16.195664 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_E_COMMERCE, now create_E_COMMERCE_staging)
[0m15:30:16.197409 [debug] [ThreadPool]: Creating schema "database: "E_COMMERCE"
schema: "staging"
"
[0m15:30:16.210582 [debug] [ThreadPool]: Using snowflake connection "create_E_COMMERCE_staging"
[0m15:30:16.210944 [debug] [ThreadPool]: On create_E_COMMERCE_staging: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "create_E_COMMERCE_staging"} */
create schema if not exists E_COMMERCE.staging
[0m15:30:16.211158 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:30:17.619305 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:30:17.621848 [debug] [ThreadPool]: On create_E_COMMERCE_staging: Close
[0m15:30:18.042197 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_E_COMMERCE_staging, now list_E_COMMERCE_PUBLIC)
[0m15:30:18.044996 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_E_COMMERCE, now list_E_COMMERCE_staging)
[0m15:30:18.057476 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PUBLIC"
[0m15:30:18.060301 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_staging"
[0m15:30:18.060791 [debug] [ThreadPool]: On list_E_COMMERCE_PUBLIC: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE_PUBLIC"} */
show terse objects in E_COMMERCE.PUBLIC limit 10000
[0m15:30:18.061223 [debug] [ThreadPool]: On list_E_COMMERCE_staging: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE_staging"} */
show terse objects in E_COMMERCE.staging limit 10000
[0m15:30:18.061630 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:30:18.061994 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:30:19.162761 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m15:30:19.166831 [debug] [ThreadPool]: On list_E_COMMERCE_PUBLIC: Close
[0m15:30:19.363298 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.0 seconds
[0m15:30:19.366472 [debug] [ThreadPool]: On list_E_COMMERCE_staging: Close
[0m15:30:19.777699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f0249e44-34a4-4c69-ab35-fe9dce7aa808', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x151a91100>]}
[0m15:30:19.779144 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m15:30:19.779789 [info ] [MainThread]: 
[0m15:30:19.784568 [debug] [Thread-1  ]: Began running node model.billy_bulky.staging_shopify__customers
[0m15:30:19.785441 [debug] [Thread-2  ]: Began running node model.billy_bulky.staging_shopify__orders
[0m15:30:19.787227 [info ] [Thread-1  ]: 1 of 4 START sql view model staging.staging_shopify__customers ................. [RUN]
[0m15:30:19.786136 [debug] [Thread-3  ]: Began running node model.billy_bulky.staging_shopify__products
[0m15:30:19.789304 [info ] [Thread-2  ]: 2 of 4 START sql view model staging.staging_shopify__orders .................... [RUN]
[0m15:30:19.790575 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_E_COMMERCE_PUBLIC, now model.billy_bulky.staging_shopify__customers)
[0m15:30:19.791428 [info ] [Thread-3  ]: 3 of 4 START sql view model staging.staging_shopify__products .................. [RUN]
[0m15:30:19.792526 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_E_COMMERCE_staging, now model.billy_bulky.staging_shopify__orders)
[0m15:30:19.793145 [debug] [Thread-1  ]: Began compiling node model.billy_bulky.staging_shopify__customers
[0m15:30:19.794211 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.billy_bulky.staging_shopify__products'
[0m15:30:19.794767 [debug] [Thread-2  ]: Began compiling node model.billy_bulky.staging_shopify__orders
[0m15:30:19.805655 [debug] [Thread-1  ]: Writing injected SQL for node "model.billy_bulky.staging_shopify__customers"
[0m15:30:19.806238 [debug] [Thread-3  ]: Began compiling node model.billy_bulky.staging_shopify__products
[0m15:30:19.810259 [debug] [Thread-2  ]: Writing injected SQL for node "model.billy_bulky.staging_shopify__orders"
[0m15:30:19.813614 [debug] [Thread-3  ]: Writing injected SQL for node "model.billy_bulky.staging_shopify__products"
[0m15:30:19.814600 [debug] [Thread-1  ]: Timing info for model.billy_bulky.staging_shopify__customers (compile): 15:30:19.795112 => 15:30:19.814335
[0m15:30:19.815116 [debug] [Thread-1  ]: Began executing node model.billy_bulky.staging_shopify__customers
[0m15:30:19.821302 [debug] [Thread-2  ]: Timing info for model.billy_bulky.staging_shopify__orders (compile): 15:30:19.806598 => 15:30:19.820939
[0m15:30:19.821852 [debug] [Thread-3  ]: Timing info for model.billy_bulky.staging_shopify__products (compile): 15:30:19.810675 => 15:30:19.821606
[0m15:30:19.840583 [debug] [Thread-2  ]: Began executing node model.billy_bulky.staging_shopify__orders
[0m15:30:19.842654 [debug] [Thread-1  ]: Writing runtime sql for node "model.billy_bulky.staging_shopify__customers"
[0m15:30:19.843022 [debug] [Thread-3  ]: Began executing node model.billy_bulky.staging_shopify__products
[0m15:30:19.845528 [debug] [Thread-2  ]: Writing runtime sql for node "model.billy_bulky.staging_shopify__orders"
[0m15:30:19.847787 [debug] [Thread-3  ]: Writing runtime sql for node "model.billy_bulky.staging_shopify__products"
[0m15:30:19.848685 [debug] [Thread-2  ]: Using snowflake connection "model.billy_bulky.staging_shopify__orders"
[0m15:30:19.849237 [debug] [Thread-1  ]: Using snowflake connection "model.billy_bulky.staging_shopify__customers"
[0m15:30:19.849533 [debug] [Thread-2  ]: On model.billy_bulky.staging_shopify__orders: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.staging_shopify__orders"} */
create or replace   view E_COMMERCE.staging.staging_shopify__orders
  
   as (
    WITH orders AS (
    SELECT * FROM SHOPIFY.PUBLIC.orders
)

SELECT
    ORDER_ID
    , CUSTOMER_ID
    , PRODUCT_ID
    , QUANTITY
    , ORDER_DATE
    , STATUS
FROM orders
  );
[0m15:30:19.850067 [debug] [Thread-3  ]: Using snowflake connection "model.billy_bulky.staging_shopify__products"
[0m15:30:19.850343 [debug] [Thread-1  ]: On model.billy_bulky.staging_shopify__customers: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.staging_shopify__customers"} */
create or replace   view E_COMMERCE.staging.staging_shopify__customers
  
   as (
    WITH customers AS (
    SELECT * FROM SHOPIFY.PUBLIC.customers
)

SELECT
    CUSTOMER_ID
    , FIRST_NAME
    , LAST_NAME
    , EMAIL
    , JOIN_DATE
    , COUNTRY
FROM customers
  );
[0m15:30:19.850626 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m15:30:19.850915 [debug] [Thread-3  ]: On model.billy_bulky.staging_shopify__products: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.staging_shopify__products"} */
create or replace   view E_COMMERCE.staging.staging_shopify__products
  
   as (
    WITH products AS (
    SELECT * FROM SHOPIFY.PUBLIC.products
)

SELECT
    PRODUCT_ID
    , NAME
    , CATEGORY
    , PRICE
    , STOCK_LEVEL
FROM products
  );
[0m15:30:19.851186 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:30:19.851635 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m15:30:21.102300 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:30:21.136094 [debug] [Thread-1  ]: Timing info for model.billy_bulky.staging_shopify__customers (execute): 15:30:19.815404 => 15:30:21.135795
[0m15:30:21.136685 [debug] [Thread-1  ]: On model.billy_bulky.staging_shopify__customers: Close
[0m15:30:21.152272 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:30:21.154982 [debug] [Thread-2  ]: Timing info for model.billy_bulky.staging_shopify__orders (execute): 15:30:19.843215 => 15:30:21.154716
[0m15:30:21.155473 [debug] [Thread-2  ]: On model.billy_bulky.staging_shopify__orders: Close
[0m15:30:21.518811 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0249e44-34a4-4c69-ab35-fe9dce7aa808', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x155bd0d60>]}
[0m15:30:21.521077 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0249e44-34a4-4c69-ab35-fe9dce7aa808', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1519bfbb0>]}
[0m15:30:21.522327 [info ] [Thread-1  ]: 1 of 4 OK created sql view model staging.staging_shopify__customers ............ [[32mSUCCESS 1[0m in 1.73s]
[0m15:30:21.523389 [info ] [Thread-2  ]: 2 of 4 OK created sql view model staging.staging_shopify__orders ............... [[32mSUCCESS 1[0m in 1.73s]
[0m15:30:21.524548 [debug] [Thread-1  ]: Finished running node model.billy_bulky.staging_shopify__customers
[0m15:30:21.525517 [debug] [Thread-2  ]: Finished running node model.billy_bulky.staging_shopify__orders
[0m15:30:21.526665 [debug] [Thread-5  ]: Began running node model.billy_bulky.int_customers_and_orders
[0m15:30:21.527492 [info ] [Thread-5  ]: 4 of 4 START sql view model PUBLIC.int_customers_and_orders .................... [RUN]
[0m15:30:21.528856 [debug] [Thread-5  ]: Acquiring new snowflake connection 'model.billy_bulky.int_customers_and_orders'
[0m15:30:21.529505 [debug] [Thread-5  ]: Began compiling node model.billy_bulky.int_customers_and_orders
[0m15:30:21.535200 [debug] [Thread-5  ]: Writing injected SQL for node "model.billy_bulky.int_customers_and_orders"
[0m15:30:21.536427 [debug] [Thread-5  ]: Timing info for model.billy_bulky.int_customers_and_orders (compile): 15:30:21.529907 => 15:30:21.536086
[0m15:30:21.536988 [debug] [Thread-5  ]: Began executing node model.billy_bulky.int_customers_and_orders
[0m15:30:21.543244 [debug] [Thread-5  ]: Writing runtime sql for node "model.billy_bulky.int_customers_and_orders"
[0m15:30:21.544894 [debug] [Thread-5  ]: Using snowflake connection "model.billy_bulky.int_customers_and_orders"
[0m15:30:21.545414 [debug] [Thread-5  ]: On model.billy_bulky.int_customers_and_orders: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.int_customers_and_orders"} */
create or replace   view E_COMMERCE.PUBLIC.int_customers_and_orders
  
   as (
    WITH customers AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__customers
)

, orders AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__orders
)


SELECT 
    o.ORDER_ID
    , o.CUSTOMER_ID
    , c.FIRST_NAME
    , c.LAST_NAME
    , c.EMAIL
    , o.PRODUCT_ID
    , o.QUANTITY
    , o.ORDER_DATE
    , o.STATUS
    , c.COUNTRY  
FROM orders AS o 
INNER JOIN customers AS c ON c.customer_id = o.order_id
  );
[0m15:30:21.545903 [debug] [Thread-5  ]: Opening a new connection, currently in state init
[0m15:30:22.945709 [debug] [Thread-5  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:30:22.958307 [debug] [Thread-5  ]: Timing info for model.billy_bulky.int_customers_and_orders (execute): 15:30:21.537307 => 15:30:22.957931
[0m15:30:22.959048 [debug] [Thread-5  ]: On model.billy_bulky.int_customers_and_orders: Close
[0m15:30:23.872045 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0249e44-34a4-4c69-ab35-fe9dce7aa808', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x155b96d30>]}
[0m15:30:23.873574 [info ] [Thread-5  ]: 4 of 4 OK created sql view model PUBLIC.int_customers_and_orders ............... [[32mSUCCESS 1[0m in 2.34s]
[0m15:30:23.874901 [debug] [Thread-5  ]: Finished running node model.billy_bulky.int_customers_and_orders
[0m15:30:24.074264 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 4.0 seconds
[0m15:30:24.081997 [debug] [Thread-3  ]: Timing info for model.billy_bulky.staging_shopify__products (execute): 15:30:19.845783 => 15:30:24.081613
[0m15:30:24.082749 [debug] [Thread-3  ]: On model.billy_bulky.staging_shopify__products: Close
[0m15:30:24.488077 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0249e44-34a4-4c69-ab35-fe9dce7aa808', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x151a870d0>]}
[0m15:30:24.490103 [info ] [Thread-3  ]: 3 of 4 OK created sql view model staging.staging_shopify__products ............. [[32mSUCCESS 1[0m in 4.69s]
[0m15:30:24.491316 [debug] [Thread-3  ]: Finished running node model.billy_bulky.staging_shopify__products
[0m15:30:24.494277 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:30:24.494873 [debug] [MainThread]: Connection 'model.billy_bulky.staging_shopify__customers' was properly closed.
[0m15:30:24.495337 [debug] [MainThread]: Connection 'model.billy_bulky.staging_shopify__orders' was properly closed.
[0m15:30:24.495760 [debug] [MainThread]: Connection 'model.billy_bulky.staging_shopify__products' was properly closed.
[0m15:30:24.496163 [debug] [MainThread]: Connection 'model.billy_bulky.int_customers_and_orders' was properly closed.
[0m15:30:24.496727 [info ] [MainThread]: 
[0m15:30:24.497233 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 10.03 seconds (10.03s).
[0m15:30:24.498682 [debug] [MainThread]: Command end result
[0m15:30:24.513016 [info ] [MainThread]: 
[0m15:30:24.513586 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:30:24.514007 [info ] [MainThread]: 
[0m15:30:24.514418 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m15:30:24.517341 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.747548, "process_user_time": 5.555326, "process_kernel_time": 0.428406, "process_mem_max_rss": "213696512", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:30:24.517899 [debug] [MainThread]: Command `dbt run` succeeded at 15:30:24.517773 after 11.75 seconds
[0m15:30:24.518315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102bac250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x155c19040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1511fa7c0>]}
[0m15:30:24.518724 [debug] [MainThread]: Flushing usage events
[0m15:33:13.930835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065a5eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108df47f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108df4a90>]}


============================== 15:33:13.933951 | 2dea3acb-767f-497c-b8b4-7e7758c60e46 ==============================
[0m15:33:13.933951 [info ] [MainThread]: Running with dbt=1.7.1
[0m15:33:13.934350 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/bitlevi/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/bitlevi/Desktop/dbt_project/billy_bulky/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:33:14.931364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2dea3acb-767f-497c-b8b4-7e7758c60e46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106096940>]}
[0m15:33:14.980521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2dea3acb-767f-497c-b8b4-7e7758c60e46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15432aac0>]}
[0m15:33:14.981153 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m15:33:14.994808 [debug] [MainThread]: checksum: ad428e6dc3b353dcb23d0c4ebea8b20b180e94b873271ac2a054a8e446dac0e2, vars: {}, profile: , target: , version: 1.7.1
[0m15:33:15.003253 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m15:33:15.003686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2dea3acb-767f-497c-b8b4-7e7758c60e46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x154ad33d0>]}
[0m15:33:15.602470 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'products' in the 'models' section of file 'models/staging/shopify/_shopify__schema.yml'
[0m15:33:15.715065 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.unique_products_product_id.68edffb83d' (models/staging/shopify/_shopify__schema.yml) depends on a node named 'products' in package '' which was not found
[0m15:33:15.715415 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_products_product_id.33741cf88e' (models/staging/shopify/_shopify__schema.yml) depends on a node named 'products' in package '' which was not found
[0m15:33:15.715665 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_products_name.d755fc2381' (models/staging/shopify/_shopify__schema.yml) depends on a node named 'products' in package '' which was not found
[0m15:33:15.715888 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.accepted_values_products_category__books__electronics__home__toys__garden__clothing.e85e5b5f7b' (models/staging/shopify/_shopify__schema.yml) depends on a node named 'products' in package '' which was not found
[0m15:33:15.716104 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_products_price.3b5b0a69be' (models/staging/shopify/_shopify__schema.yml) depends on a node named 'products' in package '' which was not found
[0m15:33:15.716324 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_products_stock_level.ee79d71f38' (models/staging/shopify/_shopify__schema.yml) depends on a node named 'products' in package '' which was not found
[0m15:33:15.739155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2dea3acb-767f-497c-b8b4-7e7758c60e46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15540a970>]}
[0m15:33:15.746457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2dea3acb-767f-497c-b8b4-7e7758c60e46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x154b0d2b0>]}
[0m15:33:15.746792 [info ] [MainThread]: Found 6 models, 14 tests, 6 sources, 0 exposures, 0 metrics, 431 macros, 0 groups, 0 semantic models
[0m15:33:15.747022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2dea3acb-767f-497c-b8b4-7e7758c60e46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1550c3520>]}
[0m15:33:15.748123 [info ] [MainThread]: 
[0m15:33:15.748634 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:33:15.749341 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE'
[0m15:33:15.757991 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE"
[0m15:33:15.758493 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE'
[0m15:33:15.758746 [debug] [ThreadPool]: On list_E_COMMERCE: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE"} */
show terse schemas in database E_COMMERCE
    limit 10000
[0m15:33:15.760242 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE"
[0m15:33:15.760460 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:33:15.760666 [debug] [ThreadPool]: On list_E_COMMERCE: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE"} */
show terse schemas in database E_COMMERCE
    limit 10000
[0m15:33:15.761149 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:33:17.058481 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m15:33:17.059976 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m15:33:17.062509 [debug] [ThreadPool]: On list_E_COMMERCE: Close
[0m15:33:17.064604 [debug] [ThreadPool]: On list_E_COMMERCE: Close
[0m15:33:17.549236 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_E_COMMERCE, now create_E_COMMERCE_intermediate)
[0m15:33:17.550624 [debug] [ThreadPool]: Creating schema "database: "E_COMMERCE"
schema: "intermediate"
"
[0m15:33:17.559712 [debug] [ThreadPool]: Using snowflake connection "create_E_COMMERCE_intermediate"
[0m15:33:17.560272 [debug] [ThreadPool]: On create_E_COMMERCE_intermediate: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "create_E_COMMERCE_intermediate"} */
create schema if not exists E_COMMERCE.intermediate
[0m15:33:17.560744 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:33:18.781862 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:33:18.785974 [debug] [ThreadPool]: On create_E_COMMERCE_intermediate: Close
[0m15:33:19.182154 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_E_COMMERCE_intermediate, now list_E_COMMERCE_intermediate)
[0m15:33:19.183814 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_E_COMMERCE, now list_E_COMMERCE_staging)
[0m15:33:19.186504 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PUBLIC'
[0m15:33:19.198373 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_intermediate"
[0m15:33:19.202442 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_staging"
[0m15:33:19.205419 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PUBLIC"
[0m15:33:19.205954 [debug] [ThreadPool]: On list_E_COMMERCE_intermediate: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE_intermediate"} */
show terse objects in E_COMMERCE.intermediate limit 10000
[0m15:33:19.206448 [debug] [ThreadPool]: On list_E_COMMERCE_staging: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE_staging"} */
show terse objects in E_COMMERCE.staging limit 10000
[0m15:33:19.206839 [debug] [ThreadPool]: On list_E_COMMERCE_PUBLIC: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE_PUBLIC"} */
show terse objects in E_COMMERCE.PUBLIC limit 10000
[0m15:33:19.207187 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:33:19.207567 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:33:19.207935 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:33:20.402274 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.0 seconds
[0m15:33:20.408902 [debug] [ThreadPool]: On list_E_COMMERCE_intermediate: Close
[0m15:33:20.449854 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m15:33:20.453625 [debug] [ThreadPool]: On list_E_COMMERCE_staging: Close
[0m15:33:20.512892 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b07509-0001-831c-0004-d8be0001317a
[0m15:33:20.513279 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m15:33:20.513650 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m15:33:20.513927 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m15:33:20.514251 [debug] [ThreadPool]: On list_E_COMMERCE_PUBLIC: Close
[0m15:33:20.846169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2dea3acb-767f-497c-b8b4-7e7758c60e46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x155446670>]}
[0m15:33:20.847820 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m15:33:20.848523 [info ] [MainThread]: 
[0m15:33:20.852594 [debug] [Thread-1  ]: Began running node model.billy_bulky.staging_shopify__customers
[0m15:33:20.853423 [debug] [Thread-2  ]: Began running node model.billy_bulky.staging_shopify__orders
[0m15:33:20.854117 [debug] [Thread-3  ]: Began running node model.billy_bulky.staging_shopify__products
[0m15:33:20.854967 [info ] [Thread-1  ]: 1 of 4 START sql view model staging.staging_shopify__customers ................. [RUN]
[0m15:33:20.855848 [info ] [Thread-2  ]: 2 of 4 START sql view model staging.staging_shopify__orders .................... [RUN]
[0m15:33:20.857869 [info ] [Thread-3  ]: 3 of 4 START sql view model staging.staging_shopify__products .................. [RUN]
[0m15:33:20.859128 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_E_COMMERCE_intermediate, now model.billy_bulky.staging_shopify__customers)
[0m15:33:20.860199 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_E_COMMERCE_staging, now model.billy_bulky.staging_shopify__orders)
[0m15:33:20.861345 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.billy_bulky.staging_shopify__products'
[0m15:33:20.861928 [debug] [Thread-1  ]: Began compiling node model.billy_bulky.staging_shopify__customers
[0m15:33:20.862478 [debug] [Thread-2  ]: Began compiling node model.billy_bulky.staging_shopify__orders
[0m15:33:20.863000 [debug] [Thread-3  ]: Began compiling node model.billy_bulky.staging_shopify__products
[0m15:33:20.873589 [debug] [Thread-1  ]: Writing injected SQL for node "model.billy_bulky.staging_shopify__customers"
[0m15:33:20.878593 [debug] [Thread-2  ]: Writing injected SQL for node "model.billy_bulky.staging_shopify__orders"
[0m15:33:20.881645 [debug] [Thread-3  ]: Writing injected SQL for node "model.billy_bulky.staging_shopify__products"
[0m15:33:20.883039 [debug] [Thread-3  ]: Timing info for model.billy_bulky.staging_shopify__products (compile): 15:33:20.878897 => 15:33:20.882732
[0m15:33:20.883567 [debug] [Thread-2  ]: Timing info for model.billy_bulky.staging_shopify__orders (compile): 15:33:20.873982 => 15:33:20.883324
[0m15:33:20.884008 [debug] [Thread-1  ]: Timing info for model.billy_bulky.staging_shopify__customers (compile): 15:33:20.863335 => 15:33:20.883799
[0m15:33:20.884401 [debug] [Thread-3  ]: Began executing node model.billy_bulky.staging_shopify__products
[0m15:33:20.884812 [debug] [Thread-2  ]: Began executing node model.billy_bulky.staging_shopify__orders
[0m15:33:20.885243 [debug] [Thread-1  ]: Began executing node model.billy_bulky.staging_shopify__customers
[0m15:33:20.912410 [debug] [Thread-2  ]: Writing runtime sql for node "model.billy_bulky.staging_shopify__orders"
[0m15:33:20.913517 [debug] [Thread-3  ]: Writing runtime sql for node "model.billy_bulky.staging_shopify__products"
[0m15:33:20.915739 [debug] [Thread-1  ]: Writing runtime sql for node "model.billy_bulky.staging_shopify__customers"
[0m15:33:20.916610 [debug] [Thread-3  ]: Using snowflake connection "model.billy_bulky.staging_shopify__products"
[0m15:33:20.917170 [debug] [Thread-2  ]: Using snowflake connection "model.billy_bulky.staging_shopify__orders"
[0m15:33:20.917702 [debug] [Thread-1  ]: Using snowflake connection "model.billy_bulky.staging_shopify__customers"
[0m15:33:20.917978 [debug] [Thread-3  ]: On model.billy_bulky.staging_shopify__products: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.staging_shopify__products"} */
create or replace   view E_COMMERCE.staging.staging_shopify__products
  
   as (
    WITH products AS (
    SELECT * FROM SHOPIFY.PUBLIC.products
)

SELECT
    PRODUCT_ID
    , NAME
    , CATEGORY
    , PRICE
    , STOCK_LEVEL
FROM products
  );
[0m15:33:20.918280 [debug] [Thread-2  ]: On model.billy_bulky.staging_shopify__orders: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.staging_shopify__orders"} */
create or replace   view E_COMMERCE.staging.staging_shopify__orders
  
   as (
    WITH orders AS (
    SELECT * FROM SHOPIFY.PUBLIC.orders
)

SELECT
    ORDER_ID
    , CUSTOMER_ID
    , PRODUCT_ID
    , QUANTITY
    , ORDER_DATE
    , STATUS
FROM orders
  );
[0m15:33:20.918587 [debug] [Thread-1  ]: On model.billy_bulky.staging_shopify__customers: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.staging_shopify__customers"} */
create or replace   view E_COMMERCE.staging.staging_shopify__customers
  
   as (
    WITH customers AS (
    SELECT * FROM SHOPIFY.PUBLIC.customers
)

SELECT
    CUSTOMER_ID
    , FIRST_NAME
    , LAST_NAME
    , EMAIL
    , JOIN_DATE
    , COUNTRY
FROM customers
  );
[0m15:33:20.918989 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m15:33:20.919225 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m15:33:20.919469 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:33:22.096934 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:33:22.132364 [debug] [Thread-1  ]: Timing info for model.billy_bulky.staging_shopify__customers (execute): 15:33:20.913705 => 15:33:22.132049
[0m15:33:22.132999 [debug] [Thread-1  ]: On model.billy_bulky.staging_shopify__customers: Close
[0m15:33:22.146773 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:33:22.149772 [debug] [Thread-3  ]: Timing info for model.billy_bulky.staging_shopify__products (execute): 15:33:20.885530 => 15:33:22.149508
[0m15:33:22.150259 [debug] [Thread-3  ]: On model.billy_bulky.staging_shopify__products: Close
[0m15:33:22.226543 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:33:22.232413 [debug] [Thread-2  ]: Timing info for model.billy_bulky.staging_shopify__orders (execute): 15:33:20.905180 => 15:33:22.231981
[0m15:33:22.233193 [debug] [Thread-2  ]: On model.billy_bulky.staging_shopify__orders: Close
[0m15:33:22.463000 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2dea3acb-767f-497c-b8b4-7e7758c60e46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1583e3130>]}
[0m15:33:22.464547 [info ] [Thread-1  ]: 1 of 4 OK created sql view model staging.staging_shopify__customers ............ [[32mSUCCESS 1[0m in 1.60s]
[0m15:33:22.466064 [debug] [Thread-1  ]: Finished running node model.billy_bulky.staging_shopify__customers
[0m15:33:22.470731 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2dea3acb-767f-497c-b8b4-7e7758c60e46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x158364490>]}
[0m15:33:22.471852 [info ] [Thread-3  ]: 3 of 4 OK created sql view model staging.staging_shopify__products ............. [[32mSUCCESS 1[0m in 1.61s]
[0m15:33:22.472902 [debug] [Thread-3  ]: Finished running node model.billy_bulky.staging_shopify__products
[0m15:33:22.593509 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2dea3acb-767f-497c-b8b4-7e7758c60e46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1553da970>]}
[0m15:33:22.594571 [info ] [Thread-2  ]: 2 of 4 OK created sql view model staging.staging_shopify__orders ............... [[32mSUCCESS 1[0m in 1.73s]
[0m15:33:22.595462 [debug] [Thread-2  ]: Finished running node model.billy_bulky.staging_shopify__orders
[0m15:33:22.596528 [debug] [Thread-5  ]: Began running node model.billy_bulky.int_customers_and_orders
[0m15:33:22.597300 [info ] [Thread-5  ]: 4 of 4 START sql table model intermediate.int_customers_and_orders ............. [RUN]
[0m15:33:22.598422 [debug] [Thread-5  ]: Acquiring new snowflake connection 'model.billy_bulky.int_customers_and_orders'
[0m15:33:22.598965 [debug] [Thread-5  ]: Began compiling node model.billy_bulky.int_customers_and_orders
[0m15:33:22.604569 [debug] [Thread-5  ]: Writing injected SQL for node "model.billy_bulky.int_customers_and_orders"
[0m15:33:22.605632 [debug] [Thread-5  ]: Timing info for model.billy_bulky.int_customers_and_orders (compile): 15:33:22.599284 => 15:33:22.605347
[0m15:33:22.606101 [debug] [Thread-5  ]: Began executing node model.billy_bulky.int_customers_and_orders
[0m15:33:22.630416 [debug] [Thread-5  ]: Writing runtime sql for node "model.billy_bulky.int_customers_and_orders"
[0m15:33:22.631845 [debug] [Thread-5  ]: Using snowflake connection "model.billy_bulky.int_customers_and_orders"
[0m15:33:22.632209 [debug] [Thread-5  ]: On model.billy_bulky.int_customers_and_orders: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.int_customers_and_orders"} */
create or replace transient table E_COMMERCE.intermediate.int_customers_and_orders
         as
        (WITH customers AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__customers
)

, orders AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__orders
)


SELECT 
    o.ORDER_ID
    , o.CUSTOMER_ID
    , c.FIRST_NAME
    , c.LAST_NAME
    , c.EMAIL
    , o.PRODUCT_ID
    , o.QUANTITY
    , o.ORDER_DATE
    , o.STATUS
    , c.COUNTRY  
FROM orders AS o 
INNER JOIN customers AS c ON c.customer_id = o.order_id
        );
[0m15:33:22.632546 [debug] [Thread-5  ]: Opening a new connection, currently in state init
[0m15:33:24.913785 [debug] [Thread-5  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m15:33:24.918781 [debug] [Thread-5  ]: Timing info for model.billy_bulky.int_customers_and_orders (execute): 15:33:22.606378 => 15:33:24.918356
[0m15:33:24.919536 [debug] [Thread-5  ]: On model.billy_bulky.int_customers_and_orders: Close
[0m15:33:25.330085 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2dea3acb-767f-497c-b8b4-7e7758c60e46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x159035d00>]}
[0m15:33:25.332286 [info ] [Thread-5  ]: 4 of 4 OK created sql table model intermediate.int_customers_and_orders ........ [[32mSUCCESS 1[0m in 2.73s]
[0m15:33:25.333715 [debug] [Thread-5  ]: Finished running node model.billy_bulky.int_customers_and_orders
[0m15:33:25.336935 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:33:25.337562 [debug] [MainThread]: Connection 'model.billy_bulky.staging_shopify__customers' was properly closed.
[0m15:33:25.338075 [debug] [MainThread]: Connection 'model.billy_bulky.staging_shopify__orders' was properly closed.
[0m15:33:25.338556 [debug] [MainThread]: Connection 'list_E_COMMERCE_PUBLIC' was properly closed.
[0m15:33:25.339028 [debug] [MainThread]: Connection 'model.billy_bulky.staging_shopify__products' was properly closed.
[0m15:33:25.339499 [debug] [MainThread]: Connection 'model.billy_bulky.int_customers_and_orders' was properly closed.
[0m15:33:25.340131 [info ] [MainThread]: 
[0m15:33:25.340724 [info ] [MainThread]: Finished running 3 view models, 1 table model in 0 hours 0 minutes and 9.59 seconds (9.59s).
[0m15:33:25.342562 [debug] [MainThread]: Command end result
[0m15:33:25.358839 [info ] [MainThread]: 
[0m15:33:25.359513 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:33:25.359965 [info ] [MainThread]: 
[0m15:33:25.360423 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m15:33:25.364284 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.471581, "process_user_time": 5.999427, "process_kernel_time": 0.569507, "process_mem_max_rss": "220364800", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:33:25.364994 [debug] [MainThread]: Command `dbt run` succeeded at 15:33:25.364850 after 11.47 seconds
[0m15:33:25.365440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065a5eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1554464c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x154b0d2b0>]}
[0m15:33:25.365881 [debug] [MainThread]: Flushing usage events
[0m15:37:33.777531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105571eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089d5850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089d5a60>]}


============================== 15:37:33.780324 | 04f29fbe-a7fb-4a22-86d5-f56a61a9a3c6 ==============================
[0m15:37:33.780324 [info ] [MainThread]: Running with dbt=1.7.1
[0m15:37:33.780722 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/bitlevi/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/bitlevi/Desktop/dbt_project/billy_bulky/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:37:34.615269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '04f29fbe-a7fb-4a22-86d5-f56a61a9a3c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x133936eb0>]}
[0m15:37:34.662922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '04f29fbe-a7fb-4a22-86d5-f56a61a9a3c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13382adc0>]}
[0m15:37:34.663567 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m15:37:34.677364 [debug] [MainThread]: checksum: ad428e6dc3b353dcb23d0c4ebea8b20b180e94b873271ac2a054a8e446dac0e2, vars: {}, profile: , target: , version: 1.7.1
[0m15:37:34.685471 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m15:37:34.685802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '04f29fbe-a7fb-4a22-86d5-f56a61a9a3c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1339365b0>]}
[0m15:37:35.278965 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'products' in the 'models' section of file 'models/staging/shopify/_shopify__schema.yml'
[0m15:37:35.390213 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.unique_products_product_id.68edffb83d' (models/staging/shopify/_shopify__schema.yml) depends on a node named 'products' in package '' which was not found
[0m15:37:35.390570 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_products_product_id.33741cf88e' (models/staging/shopify/_shopify__schema.yml) depends on a node named 'products' in package '' which was not found
[0m15:37:35.390806 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_products_name.d755fc2381' (models/staging/shopify/_shopify__schema.yml) depends on a node named 'products' in package '' which was not found
[0m15:37:35.391058 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.accepted_values_products_category__books__electronics__home__toys__garden__clothing.e85e5b5f7b' (models/staging/shopify/_shopify__schema.yml) depends on a node named 'products' in package '' which was not found
[0m15:37:35.391332 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_products_price.3b5b0a69be' (models/staging/shopify/_shopify__schema.yml) depends on a node named 'products' in package '' which was not found
[0m15:37:35.391570 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_products_stock_level.ee79d71f38' (models/staging/shopify/_shopify__schema.yml) depends on a node named 'products' in package '' which was not found
[0m15:37:35.415542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '04f29fbe-a7fb-4a22-86d5-f56a61a9a3c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1379dbeb0>]}
[0m15:37:35.424005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '04f29fbe-a7fb-4a22-86d5-f56a61a9a3c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x133a618b0>]}
[0m15:37:35.424348 [info ] [MainThread]: Found 6 models, 14 tests, 4 sources, 0 exposures, 0 metrics, 431 macros, 0 groups, 0 semantic models
[0m15:37:35.424566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '04f29fbe-a7fb-4a22-86d5-f56a61a9a3c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x133a83a90>]}
[0m15:37:35.425586 [info ] [MainThread]: 
[0m15:37:35.426066 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:37:35.426746 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE'
[0m15:37:35.434553 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE"
[0m15:37:35.434996 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE'
[0m15:37:35.435205 [debug] [ThreadPool]: On list_E_COMMERCE: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE"} */
show terse schemas in database E_COMMERCE
    limit 10000
[0m15:37:35.436618 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE"
[0m15:37:35.436837 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:37:35.437051 [debug] [ThreadPool]: On list_E_COMMERCE: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE"} */
show terse schemas in database E_COMMERCE
    limit 10000
[0m15:37:35.437852 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:37:36.740813 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m15:37:36.745763 [debug] [ThreadPool]: On list_E_COMMERCE: Close
[0m15:37:36.750160 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m15:37:36.752487 [debug] [ThreadPool]: On list_E_COMMERCE: Close
[0m15:37:37.848471 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_E_COMMERCE, now list_E_COMMERCE_staging)
[0m15:37:37.850219 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_E_COMMERCE, now list_E_COMMERCE_PUBLIC)
[0m15:37:37.863447 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_intermediate'
[0m15:37:37.865202 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PUBLIC"
[0m15:37:37.862892 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_staging"
[0m15:37:37.867175 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_intermediate"
[0m15:37:37.867494 [debug] [ThreadPool]: On list_E_COMMERCE_PUBLIC: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE_PUBLIC"} */
show terse objects in E_COMMERCE.PUBLIC limit 10000
[0m15:37:37.867782 [debug] [ThreadPool]: On list_E_COMMERCE_staging: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE_staging"} */
show terse objects in E_COMMERCE.staging limit 10000
[0m15:37:37.868060 [debug] [ThreadPool]: On list_E_COMMERCE_intermediate: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE_intermediate"} */
show terse objects in E_COMMERCE.intermediate limit 10000
[0m15:37:37.868322 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:37:37.868569 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:37:37.868814 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:37:39.179102 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m15:37:39.189327 [debug] [ThreadPool]: On list_E_COMMERCE_staging: Close
[0m15:37:39.244409 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b0750d-0001-824a-0000-0004d8beb165
[0m15:37:39.244770 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m15:37:39.245127 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m15:37:39.245384 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m15:37:39.245658 [debug] [ThreadPool]: On list_E_COMMERCE_PUBLIC: Close
[0m15:37:39.450682 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 2.0 seconds
[0m15:37:39.455408 [debug] [ThreadPool]: On list_E_COMMERCE_intermediate: Close
[0m15:37:39.788347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '04f29fbe-a7fb-4a22-86d5-f56a61a9a3c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137b51040>]}
[0m15:37:39.790127 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m15:37:39.790836 [info ] [MainThread]: 
[0m15:37:39.795453 [debug] [Thread-1  ]: Began running node model.billy_bulky.staging_shopify__customers
[0m15:37:39.796283 [debug] [Thread-2  ]: Began running node model.billy_bulky.staging_shopify__orders
[0m15:37:39.796951 [debug] [Thread-3  ]: Began running node model.billy_bulky.staging_shopify__products
[0m15:37:39.797826 [info ] [Thread-1  ]: 1 of 4 START sql view model staging.staging_shopify__customers ................. [RUN]
[0m15:37:39.799696 [info ] [Thread-2  ]: 2 of 4 START sql view model staging.staging_shopify__orders .................... [RUN]
[0m15:37:39.800608 [info ] [Thread-3  ]: 3 of 4 START sql view model staging.staging_shopify__products .................. [RUN]
[0m15:37:39.801795 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_E_COMMERCE_staging, now model.billy_bulky.staging_shopify__customers)
[0m15:37:39.802828 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_E_COMMERCE_PUBLIC, now model.billy_bulky.staging_shopify__orders)
[0m15:37:39.803788 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly list_E_COMMERCE_intermediate, now model.billy_bulky.staging_shopify__products)
[0m15:37:39.804404 [debug] [Thread-1  ]: Began compiling node model.billy_bulky.staging_shopify__customers
[0m15:37:39.804942 [debug] [Thread-2  ]: Began compiling node model.billy_bulky.staging_shopify__orders
[0m15:37:39.805462 [debug] [Thread-3  ]: Began compiling node model.billy_bulky.staging_shopify__products
[0m15:37:39.816416 [debug] [Thread-1  ]: Writing injected SQL for node "model.billy_bulky.staging_shopify__customers"
[0m15:37:39.820009 [debug] [Thread-2  ]: Writing injected SQL for node "model.billy_bulky.staging_shopify__orders"
[0m15:37:39.823504 [debug] [Thread-3  ]: Writing injected SQL for node "model.billy_bulky.staging_shopify__products"
[0m15:37:39.824836 [debug] [Thread-1  ]: Timing info for model.billy_bulky.staging_shopify__customers (compile): 15:37:39.805791 => 15:37:39.824584
[0m15:37:39.825372 [debug] [Thread-3  ]: Timing info for model.billy_bulky.staging_shopify__products (compile): 15:37:39.820358 => 15:37:39.825089
[0m15:37:39.825812 [debug] [Thread-1  ]: Began executing node model.billy_bulky.staging_shopify__customers
[0m15:37:39.826328 [debug] [Thread-2  ]: Timing info for model.billy_bulky.staging_shopify__orders (compile): 15:37:39.816774 => 15:37:39.826057
[0m15:37:39.826786 [debug] [Thread-3  ]: Began executing node model.billy_bulky.staging_shopify__products
[0m15:37:39.837340 [debug] [Thread-2  ]: Began executing node model.billy_bulky.staging_shopify__orders
[0m15:37:39.861173 [debug] [Thread-3  ]: Writing runtime sql for node "model.billy_bulky.staging_shopify__products"
[0m15:37:39.863518 [debug] [Thread-2  ]: Writing runtime sql for node "model.billy_bulky.staging_shopify__orders"
[0m15:37:39.865846 [debug] [Thread-1  ]: Writing runtime sql for node "model.billy_bulky.staging_shopify__customers"
[0m15:37:39.866659 [debug] [Thread-2  ]: Using snowflake connection "model.billy_bulky.staging_shopify__orders"
[0m15:37:39.867168 [debug] [Thread-1  ]: Using snowflake connection "model.billy_bulky.staging_shopify__customers"
[0m15:37:39.867428 [debug] [Thread-2  ]: On model.billy_bulky.staging_shopify__orders: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.staging_shopify__orders"} */
create or replace   view E_COMMERCE.staging.staging_shopify__orders
  
   as (
    WITH orders AS (
    SELECT * FROM SHOPIFY.PUBLIC.orders
)

SELECT
    ORDER_ID
    , CUSTOMER_ID
    , PRODUCT_ID
    , QUANTITY
    , ORDER_DATE
    , STATUS
FROM orders
  );
[0m15:37:39.867897 [debug] [Thread-3  ]: Using snowflake connection "model.billy_bulky.staging_shopify__products"
[0m15:37:39.868161 [debug] [Thread-1  ]: On model.billy_bulky.staging_shopify__customers: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.staging_shopify__customers"} */
create or replace   view E_COMMERCE.staging.staging_shopify__customers
  
   as (
    WITH customers AS (
    SELECT * FROM SHOPIFY.PUBLIC.customers
)

SELECT
    CUSTOMER_ID
    , FIRST_NAME
    , LAST_NAME
    , EMAIL
    , JOIN_DATE
    , COUNTRY
FROM customers
  );
[0m15:37:39.868418 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m15:37:39.868673 [debug] [Thread-3  ]: On model.billy_bulky.staging_shopify__products: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.staging_shopify__products"} */
create or replace   view E_COMMERCE.staging.staging_shopify__products
  
   as (
    WITH products AS (
    SELECT * FROM SHOPIFY.PUBLIC.products
)

SELECT
    PRODUCT_ID
    , NAME
    , CATEGORY
    , PRICE
    , STOCK_LEVEL
FROM products
  );
[0m15:37:39.868923 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:37:39.869582 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m15:37:41.126779 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:37:41.128636 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:37:41.130238 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:37:41.171560 [debug] [Thread-2  ]: Timing info for model.billy_bulky.staging_shopify__orders (execute): 15:37:39.861400 => 15:37:41.171292
[0m15:37:41.173924 [debug] [Thread-1  ]: Timing info for model.billy_bulky.staging_shopify__customers (execute): 15:37:39.827044 => 15:37:41.173702
[0m15:37:41.178093 [debug] [Thread-3  ]: Timing info for model.billy_bulky.staging_shopify__products (execute): 15:37:39.843992 => 15:37:41.177885
[0m15:37:41.178479 [debug] [Thread-2  ]: On model.billy_bulky.staging_shopify__orders: Close
[0m15:37:41.178846 [debug] [Thread-1  ]: On model.billy_bulky.staging_shopify__customers: Close
[0m15:37:41.179195 [debug] [Thread-3  ]: On model.billy_bulky.staging_shopify__products: Close
[0m15:37:41.645681 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04f29fbe-a7fb-4a22-86d5-f56a61a9a3c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1379eecd0>]}
[0m15:37:41.647531 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04f29fbe-a7fb-4a22-86d5-f56a61a9a3c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x158097ca0>]}
[0m15:37:41.648852 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04f29fbe-a7fb-4a22-86d5-f56a61a9a3c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1580880a0>]}
[0m15:37:41.649966 [info ] [Thread-2  ]: 2 of 4 OK created sql view model staging.staging_shopify__orders ............... [[32mSUCCESS 1[0m in 1.84s]
[0m15:37:41.651032 [info ] [Thread-1  ]: 1 of 4 OK created sql view model staging.staging_shopify__customers ............ [[32mSUCCESS 1[0m in 1.85s]
[0m15:37:41.652146 [info ] [Thread-3  ]: 3 of 4 OK created sql view model staging.staging_shopify__products ............. [[32mSUCCESS 1[0m in 1.85s]
[0m15:37:41.653213 [debug] [Thread-2  ]: Finished running node model.billy_bulky.staging_shopify__orders
[0m15:37:41.654127 [debug] [Thread-1  ]: Finished running node model.billy_bulky.staging_shopify__customers
[0m15:37:41.655019 [debug] [Thread-3  ]: Finished running node model.billy_bulky.staging_shopify__products
[0m15:37:41.656280 [debug] [Thread-5  ]: Began running node model.billy_bulky.int_customers_and_orders
[0m15:37:41.657146 [info ] [Thread-5  ]: 4 of 4 START sql ephemerally model intermediate.int_customers_and_orders ....... [RUN]
[0m15:37:41.658416 [debug] [Thread-5  ]: Acquiring new snowflake connection 'model.billy_bulky.int_customers_and_orders'
[0m15:37:41.659021 [debug] [Thread-5  ]: Began compiling node model.billy_bulky.int_customers_and_orders
[0m15:37:41.664144 [debug] [Thread-5  ]: Writing injected SQL for node "model.billy_bulky.int_customers_and_orders"
[0m15:37:41.665818 [debug] [Thread-5  ]: Timing info for model.billy_bulky.int_customers_and_orders (compile): 15:37:41.659363 => 15:37:41.665485
[0m15:37:41.666371 [debug] [Thread-5  ]: Began executing node model.billy_bulky.int_customers_and_orders
[0m15:37:41.669141 [debug] [Thread-5  ]: Timing info for model.billy_bulky.int_customers_and_orders (execute): 15:37:41.666696 => 15:37:41.668866
[0m15:37:41.677238 [debug] [Thread-5  ]: Compilation Error in model int_customers_and_orders (models/intermediate/int_customers_and_orders.sql)
  No materialization 'ephemerally' was found for adapter snowflake! (searched types 'default' and 'snowflake')
[0m15:37:41.677842 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04f29fbe-a7fb-4a22-86d5-f56a61a9a3c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1580f5ac0>]}
[0m15:37:41.678567 [error] [Thread-5  ]: 4 of 4 ERROR creating sql ephemerally model intermediate.int_customers_and_orders  [[31mERROR[0m in 0.02s]
[0m15:37:41.679274 [debug] [Thread-5  ]: Finished running node model.billy_bulky.int_customers_and_orders
[0m15:37:41.681036 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:37:41.681378 [debug] [MainThread]: Connection 'model.billy_bulky.staging_shopify__customers' was properly closed.
[0m15:37:41.681695 [debug] [MainThread]: Connection 'model.billy_bulky.staging_shopify__orders' was properly closed.
[0m15:37:41.681990 [debug] [MainThread]: Connection 'model.billy_bulky.staging_shopify__products' was properly closed.
[0m15:37:41.682283 [debug] [MainThread]: Connection 'model.billy_bulky.int_customers_and_orders' was properly closed.
[0m15:37:41.682627 [info ] [MainThread]: 
[0m15:37:41.683007 [info ] [MainThread]: Finished running 3 view models, 1 ephemerally model in 0 hours 0 minutes and 6.26 seconds (6.26s).
[0m15:37:41.684046 [debug] [MainThread]: Command end result
[0m15:37:41.694566 [info ] [MainThread]: 
[0m15:37:41.695019 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:37:41.695334 [info ] [MainThread]: 
[0m15:37:41.695637 [error] [MainThread]:   Compilation Error in model int_customers_and_orders (models/intermediate/int_customers_and_orders.sql)
  No materialization 'ephemerally' was found for adapter snowflake! (searched types 'default' and 'snowflake')
[0m15:37:41.695961 [info ] [MainThread]: 
[0m15:37:41.696272 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m15:37:41.699094 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 7.9559784, "process_user_time": 5.457456, "process_kernel_time": 0.411893, "process_mem_max_rss": "221790208", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:37:41.699566 [debug] [MainThread]: Command `dbt run` failed at 15:37:41.699461 after 7.96 seconds
[0m15:37:41.699902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105571eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1580b07f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x133a61cd0>]}
[0m15:37:41.700228 [debug] [MainThread]: Flushing usage events
[0m15:37:58.911460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106815250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109081460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109081850>]}


============================== 15:37:58.914438 | 20428909-120f-4a0e-b34e-048d0c1f94a6 ==============================
[0m15:37:58.914438 [info ] [MainThread]: Running with dbt=1.7.1
[0m15:37:58.914806 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/bitlevi/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/bitlevi/Desktop/dbt_project/billy_bulky/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:37:59.700555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '20428909-120f-4a0e-b34e-048d0c1f94a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109064fa0>]}
[0m15:37:59.748077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '20428909-120f-4a0e-b34e-048d0c1f94a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a5fb220>]}
[0m15:37:59.748893 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m15:37:59.761420 [debug] [MainThread]: checksum: ad428e6dc3b353dcb23d0c4ebea8b20b180e94b873271ac2a054a8e446dac0e2, vars: {}, profile: , target: , version: 1.7.1
[0m15:37:59.789655 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
[0m15:37:59.798370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '20428909-120f-4a0e-b34e-048d0c1f94a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b2930d0>]}
[0m15:37:59.805577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '20428909-120f-4a0e-b34e-048d0c1f94a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ada25b0>]}
[0m15:37:59.805933 [info ] [MainThread]: Found 6 models, 14 tests, 3 sources, 0 exposures, 0 metrics, 431 macros, 0 groups, 0 semantic models
[0m15:37:59.806178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '20428909-120f-4a0e-b34e-048d0c1f94a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ada26a0>]}
[0m15:37:59.807351 [info ] [MainThread]: 
[0m15:37:59.807864 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:37:59.808686 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE'
[0m15:37:59.817537 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE"
[0m15:37:59.818153 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE'
[0m15:37:59.818373 [debug] [ThreadPool]: On list_E_COMMERCE: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE"} */
show terse schemas in database E_COMMERCE
    limit 10000
[0m15:37:59.819888 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE"
[0m15:37:59.820104 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:37:59.820299 [debug] [ThreadPool]: On list_E_COMMERCE: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE"} */
show terse schemas in database E_COMMERCE
    limit 10000
[0m15:37:59.821884 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:38:01.068466 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m15:38:01.072606 [debug] [ThreadPool]: On list_E_COMMERCE: Close
[0m15:38:01.145803 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m15:38:01.150125 [debug] [ThreadPool]: On list_E_COMMERCE: Close
[0m15:38:01.512936 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_E_COMMERCE, now list_E_COMMERCE_intermediate)
[0m15:38:01.516965 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_E_COMMERCE, now list_E_COMMERCE_staging)
[0m15:38:01.530708 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PUBLIC'
[0m15:38:01.534308 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_intermediate"
[0m15:38:01.540194 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_staging"
[0m15:38:01.543142 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PUBLIC"
[0m15:38:01.543739 [debug] [ThreadPool]: On list_E_COMMERCE_intermediate: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE_intermediate"} */
show terse objects in E_COMMERCE.intermediate limit 10000
[0m15:38:01.544199 [debug] [ThreadPool]: On list_E_COMMERCE_staging: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE_staging"} */
show terse objects in E_COMMERCE.staging limit 10000
[0m15:38:01.544613 [debug] [ThreadPool]: On list_E_COMMERCE_PUBLIC: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE_PUBLIC"} */
show terse objects in E_COMMERCE.PUBLIC limit 10000
[0m15:38:01.545004 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:38:01.545354 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:38:01.545671 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:38:02.645300 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:38:02.650144 [debug] [ThreadPool]: On list_E_COMMERCE_intermediate: Close
[0m15:38:02.691572 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m15:38:02.694396 [debug] [ThreadPool]: On list_E_COMMERCE_staging: Close
[0m15:38:02.743964 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b0750d-0001-834b-0004-d8be00017196
[0m15:38:02.744271 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m15:38:02.744595 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m15:38:02.744839 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m15:38:02.745113 [debug] [ThreadPool]: On list_E_COMMERCE_PUBLIC: Close
[0m15:38:03.063412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '20428909-120f-4a0e-b34e-048d0c1f94a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a718eb0>]}
[0m15:38:03.064580 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m15:38:03.065001 [info ] [MainThread]: 
[0m15:38:03.068099 [debug] [Thread-1  ]: Began running node model.billy_bulky.staging_shopify__customers
[0m15:38:03.068605 [debug] [Thread-2  ]: Began running node model.billy_bulky.staging_shopify__orders
[0m15:38:03.069045 [debug] [Thread-3  ]: Began running node model.billy_bulky.staging_shopify__products
[0m15:38:03.070153 [info ] [Thread-1  ]: 1 of 4 START sql view model staging.staging_shopify__customers ................. [RUN]
[0m15:38:03.070745 [info ] [Thread-2  ]: 2 of 4 START sql view model staging.staging_shopify__orders .................... [RUN]
[0m15:38:03.071365 [info ] [Thread-3  ]: 3 of 4 START sql view model staging.staging_shopify__products .................. [RUN]
[0m15:38:03.072203 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_E_COMMERCE_intermediate, now model.billy_bulky.staging_shopify__customers)
[0m15:38:03.072906 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_E_COMMERCE_staging, now model.billy_bulky.staging_shopify__orders)
[0m15:38:03.073562 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly list_E_COMMERCE_PUBLIC, now model.billy_bulky.staging_shopify__products)
[0m15:38:03.073986 [debug] [Thread-1  ]: Began compiling node model.billy_bulky.staging_shopify__customers
[0m15:38:03.074411 [debug] [Thread-2  ]: Began compiling node model.billy_bulky.staging_shopify__orders
[0m15:38:03.074768 [debug] [Thread-3  ]: Began compiling node model.billy_bulky.staging_shopify__products
[0m15:38:03.082868 [debug] [Thread-1  ]: Writing injected SQL for node "model.billy_bulky.staging_shopify__customers"
[0m15:38:03.086260 [debug] [Thread-3  ]: Writing injected SQL for node "model.billy_bulky.staging_shopify__products"
[0m15:38:03.089191 [debug] [Thread-2  ]: Writing injected SQL for node "model.billy_bulky.staging_shopify__orders"
[0m15:38:03.090307 [debug] [Thread-3  ]: Timing info for model.billy_bulky.staging_shopify__products (compile): 15:38:03.083978 => 15:38:03.090037
[0m15:38:03.090760 [debug] [Thread-2  ]: Timing info for model.billy_bulky.staging_shopify__orders (compile): 15:38:03.083205 => 15:38:03.090555
[0m15:38:03.091120 [debug] [Thread-3  ]: Began executing node model.billy_bulky.staging_shopify__products
[0m15:38:03.091530 [debug] [Thread-2  ]: Began executing node model.billy_bulky.staging_shopify__orders
[0m15:38:03.091954 [debug] [Thread-1  ]: Timing info for model.billy_bulky.staging_shopify__customers (compile): 15:38:03.075054 => 15:38:03.091753
[0m15:38:03.116601 [debug] [Thread-2  ]: Writing runtime sql for node "model.billy_bulky.staging_shopify__orders"
[0m15:38:03.118151 [debug] [Thread-3  ]: Writing runtime sql for node "model.billy_bulky.staging_shopify__products"
[0m15:38:03.118471 [debug] [Thread-1  ]: Began executing node model.billy_bulky.staging_shopify__customers
[0m15:38:03.120552 [debug] [Thread-1  ]: Writing runtime sql for node "model.billy_bulky.staging_shopify__customers"
[0m15:38:03.121266 [debug] [Thread-2  ]: Using snowflake connection "model.billy_bulky.staging_shopify__orders"
[0m15:38:03.121567 [debug] [Thread-2  ]: On model.billy_bulky.staging_shopify__orders: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.staging_shopify__orders"} */
create or replace   view E_COMMERCE.staging.staging_shopify__orders
  
   as (
    WITH orders AS (
    SELECT * FROM SHOPIFY.PUBLIC.orders
)

SELECT
    ORDER_ID
    , CUSTOMER_ID
    , PRODUCT_ID
    , QUANTITY
    , ORDER_DATE
    , STATUS
FROM orders
  );
[0m15:38:03.122086 [debug] [Thread-1  ]: Using snowflake connection "model.billy_bulky.staging_shopify__customers"
[0m15:38:03.122562 [debug] [Thread-3  ]: Using snowflake connection "model.billy_bulky.staging_shopify__products"
[0m15:38:03.122802 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m15:38:03.123084 [debug] [Thread-1  ]: On model.billy_bulky.staging_shopify__customers: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.staging_shopify__customers"} */
create or replace   view E_COMMERCE.staging.staging_shopify__customers
  
   as (
    WITH customers AS (
    SELECT * FROM SHOPIFY.PUBLIC.customers
)

SELECT
    CUSTOMER_ID
    , FIRST_NAME
    , LAST_NAME
    , EMAIL
    , JOIN_DATE
    , COUNTRY
FROM customers
  );
[0m15:38:03.123375 [debug] [Thread-3  ]: On model.billy_bulky.staging_shopify__products: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.staging_shopify__products"} */
create or replace   view E_COMMERCE.staging.staging_shopify__products
  
   as (
    WITH products AS (
    SELECT * FROM SHOPIFY.PUBLIC.products
)

SELECT
    PRODUCT_ID
    , NAME
    , CATEGORY
    , PRICE
    , STOCK_LEVEL
FROM products
  );
[0m15:38:03.123918 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:38:03.124386 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m15:38:04.281435 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:38:04.317538 [debug] [Thread-1  ]: Timing info for model.billy_bulky.staging_shopify__customers (execute): 15:38:03.118754 => 15:38:04.317221
[0m15:38:04.318187 [debug] [Thread-1  ]: On model.billy_bulky.staging_shopify__customers: Close
[0m15:38:04.320715 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:38:04.323654 [debug] [Thread-2  ]: Timing info for model.billy_bulky.staging_shopify__orders (execute): 15:38:03.111185 => 15:38:04.323425
[0m15:38:04.324146 [debug] [Thread-2  ]: On model.billy_bulky.staging_shopify__orders: Close
[0m15:38:04.350603 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:38:04.353670 [debug] [Thread-3  ]: Timing info for model.billy_bulky.staging_shopify__products (execute): 15:38:03.092185 => 15:38:04.353406
[0m15:38:04.354198 [debug] [Thread-3  ]: On model.billy_bulky.staging_shopify__products: Close
[0m15:38:04.646818 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20428909-120f-4a0e-b34e-048d0c1f94a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12bc6cd30>]}
[0m15:38:04.648316 [info ] [Thread-2  ]: 2 of 4 OK created sql view model staging.staging_shopify__orders ............... [[32mSUCCESS 1[0m in 1.57s]
[0m15:38:04.650598 [debug] [Thread-2  ]: Finished running node model.billy_bulky.staging_shopify__orders
[0m15:38:04.654120 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20428909-120f-4a0e-b34e-048d0c1f94a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b22d250>]}
[0m15:38:04.655189 [info ] [Thread-1  ]: 1 of 4 OK created sql view model staging.staging_shopify__customers ............ [[32mSUCCESS 1[0m in 1.58s]
[0m15:38:04.656221 [debug] [Thread-1  ]: Finished running node model.billy_bulky.staging_shopify__customers
[0m15:38:04.657237 [debug] [Thread-5  ]: Began running node model.billy_bulky.int_customers_and_orders
[0m15:38:04.658143 [info ] [Thread-5  ]: 4 of 4 START sql ephemerally model intermediate.int_customers_and_orders ....... [RUN]
[0m15:38:04.659573 [debug] [Thread-5  ]: Acquiring new snowflake connection 'model.billy_bulky.int_customers_and_orders'
[0m15:38:04.660275 [debug] [Thread-5  ]: Began compiling node model.billy_bulky.int_customers_and_orders
[0m15:38:04.665609 [debug] [Thread-5  ]: Writing injected SQL for node "model.billy_bulky.int_customers_and_orders"
[0m15:38:04.667356 [debug] [Thread-5  ]: Timing info for model.billy_bulky.int_customers_and_orders (compile): 15:38:04.660613 => 15:38:04.667010
[0m15:38:04.667923 [debug] [Thread-5  ]: Began executing node model.billy_bulky.int_customers_and_orders
[0m15:38:04.670935 [debug] [Thread-5  ]: Timing info for model.billy_bulky.int_customers_and_orders (execute): 15:38:04.668251 => 15:38:04.670652
[0m15:38:04.671928 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20428909-120f-4a0e-b34e-048d0c1f94a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12bc79cd0>]}
[0m15:38:04.676828 [info ] [Thread-3  ]: 3 of 4 OK created sql view model staging.staging_shopify__products ............. [[32mSUCCESS 1[0m in 1.60s]
[0m15:38:04.680931 [debug] [Thread-3  ]: Finished running node model.billy_bulky.staging_shopify__products
[0m15:38:04.682193 [debug] [Thread-5  ]: Compilation Error in model int_customers_and_orders (models/intermediate/int_customers_and_orders.sql)
  No materialization 'ephemerally' was found for adapter snowflake! (searched types 'default' and 'snowflake')
[0m15:38:04.682741 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20428909-120f-4a0e-b34e-048d0c1f94a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a59eb80>]}
[0m15:38:04.683398 [error] [Thread-5  ]: 4 of 4 ERROR creating sql ephemerally model intermediate.int_customers_and_orders  [[31mERROR[0m in 0.02s]
[0m15:38:04.684048 [debug] [Thread-5  ]: Finished running node model.billy_bulky.int_customers_and_orders
[0m15:38:04.685884 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:38:04.686229 [debug] [MainThread]: Connection 'model.billy_bulky.staging_shopify__customers' was properly closed.
[0m15:38:04.686537 [debug] [MainThread]: Connection 'model.billy_bulky.staging_shopify__orders' was properly closed.
[0m15:38:04.686836 [debug] [MainThread]: Connection 'model.billy_bulky.staging_shopify__products' was properly closed.
[0m15:38:04.687129 [debug] [MainThread]: Connection 'model.billy_bulky.int_customers_and_orders' was properly closed.
[0m15:38:04.687489 [info ] [MainThread]: 
[0m15:38:04.687848 [info ] [MainThread]: Finished running 3 view models, 1 ephemerally model in 0 hours 0 minutes and 4.88 seconds (4.88s).
[0m15:38:04.688890 [debug] [MainThread]: Command end result
[0m15:38:04.698208 [info ] [MainThread]: 
[0m15:38:04.698661 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:38:04.698985 [info ] [MainThread]: 
[0m15:38:04.699299 [error] [MainThread]:   Compilation Error in model int_customers_and_orders (models/intermediate/int_customers_and_orders.sql)
  No materialization 'ephemerally' was found for adapter snowflake! (searched types 'default' and 'snowflake')
[0m15:38:04.699613 [info ] [MainThread]: 
[0m15:38:04.699935 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m15:38:04.702140 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 5.8231297, "process_user_time": 4.760777, "process_kernel_time": 0.326508, "process_mem_max_rss": "214450176", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:38:04.702591 [debug] [MainThread]: Command `dbt run` failed at 15:38:04.702490 after 5.82 seconds
[0m15:38:04.702932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106815250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a673f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12bd7bdc0>]}
[0m15:38:04.703269 [debug] [MainThread]: Flushing usage events
[0m15:38:30.216259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102d30eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c787f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c78a90>]}


============================== 15:38:30.218942 | f6c1fe4f-fa61-41f5-9e01-ce2603aa68e5 ==============================
[0m15:38:30.218942 [info ] [MainThread]: Running with dbt=1.7.1
[0m15:38:30.219288 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/bitlevi/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/bitlevi/Desktop/dbt_project/billy_bulky/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:38:31.088127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f6c1fe4f-fa61-41f5-9e01-ce2603aa68e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1026e6940>]}
[0m15:38:31.137052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f6c1fe4f-fa61-41f5-9e01-ce2603aa68e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1591aaac0>]}
[0m15:38:31.137783 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m15:38:31.149594 [debug] [MainThread]: checksum: ad428e6dc3b353dcb23d0c4ebea8b20b180e94b873271ac2a054a8e446dac0e2, vars: {}, profile: , target: , version: 1.7.1
[0m15:38:31.158233 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m15:38:31.158713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f6c1fe4f-fa61-41f5-9e01-ce2603aa68e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1594273d0>]}
[0m15:38:31.763443 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'products' in the 'models' section of file 'models/staging/shopify/_shopify__schema.yml'
[0m15:38:31.877579 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.unique_products_product_id.68edffb83d' (models/staging/shopify/_shopify__schema.yml) depends on a node named 'products' in package '' which was not found
[0m15:38:31.877952 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_products_product_id.33741cf88e' (models/staging/shopify/_shopify__schema.yml) depends on a node named 'products' in package '' which was not found
[0m15:38:31.878191 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_products_name.d755fc2381' (models/staging/shopify/_shopify__schema.yml) depends on a node named 'products' in package '' which was not found
[0m15:38:31.878425 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.accepted_values_products_category__books__electronics__home__toys__garden__clothing.e85e5b5f7b' (models/staging/shopify/_shopify__schema.yml) depends on a node named 'products' in package '' which was not found
[0m15:38:31.878642 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_products_price.3b5b0a69be' (models/staging/shopify/_shopify__schema.yml) depends on a node named 'products' in package '' which was not found
[0m15:38:31.878858 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_products_stock_level.ee79d71f38' (models/staging/shopify/_shopify__schema.yml) depends on a node named 'products' in package '' which was not found
[0m15:38:31.903532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f6c1fe4f-fa61-41f5-9e01-ce2603aa68e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15a1460d0>]}
[0m15:38:31.911990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f6c1fe4f-fa61-41f5-9e01-ce2603aa68e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1594622b0>]}
[0m15:38:31.912327 [info ] [MainThread]: Found 6 models, 14 tests, 3 sources, 0 exposures, 0 metrics, 431 macros, 0 groups, 0 semantic models
[0m15:38:31.912553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f6c1fe4f-fa61-41f5-9e01-ce2603aa68e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x159b24580>]}
[0m15:38:31.913592 [info ] [MainThread]: 
[0m15:38:31.914069 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:38:31.914764 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE'
[0m15:38:31.923260 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE"
[0m15:38:31.923615 [debug] [ThreadPool]: On list_E_COMMERCE: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE"} */
show terse schemas in database E_COMMERCE
    limit 10000
[0m15:38:31.923818 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:38:33.107132 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m15:38:33.110535 [debug] [ThreadPool]: On list_E_COMMERCE: Close
[0m15:38:33.440411 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_E_COMMERCE, now list_E_COMMERCE_staging)
[0m15:38:33.443042 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PUBLIC'
[0m15:38:33.459306 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PUBLIC"
[0m15:38:33.460206 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_staging"
[0m15:38:33.460781 [debug] [ThreadPool]: On list_E_COMMERCE_PUBLIC: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE_PUBLIC"} */
show terse objects in E_COMMERCE.PUBLIC limit 10000
[0m15:38:33.461312 [debug] [ThreadPool]: On list_E_COMMERCE_staging: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE_staging"} */
show terse objects in E_COMMERCE.staging limit 10000
[0m15:38:33.461812 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:38:33.462261 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:38:34.500516 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m15:38:34.503308 [debug] [ThreadPool]: On list_E_COMMERCE_staging: Close
[0m15:38:34.550922 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b0750e-0001-824a-0000-0004d8beb16d
[0m15:38:34.551301 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m15:38:34.551665 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m15:38:34.551937 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m15:38:34.552252 [debug] [ThreadPool]: On list_E_COMMERCE_PUBLIC: Close
[0m15:38:34.864844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f6c1fe4f-fa61-41f5-9e01-ce2603aa68e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15a146490>]}
[0m15:38:34.866331 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m15:38:34.866659 [info ] [MainThread]: 
[0m15:38:34.870265 [debug] [Thread-1  ]: Began running node model.billy_bulky.staging_shopify__customers
[0m15:38:34.870722 [info ] [Thread-1  ]: 1 of 3 START sql view model staging.staging_shopify__customers ................. [RUN]
[0m15:38:34.871614 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_E_COMMERCE_staging, now model.billy_bulky.staging_shopify__customers)
[0m15:38:34.871912 [debug] [Thread-1  ]: Began compiling node model.billy_bulky.staging_shopify__customers
[0m15:38:34.878027 [debug] [Thread-1  ]: Writing injected SQL for node "model.billy_bulky.staging_shopify__customers"
[0m15:38:34.878481 [debug] [Thread-2  ]: Began running node model.billy_bulky.staging_shopify__orders
[0m15:38:34.879144 [info ] [Thread-2  ]: 2 of 3 START sql view model staging.staging_shopify__orders .................... [RUN]
[0m15:38:34.879712 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_E_COMMERCE_PUBLIC, now model.billy_bulky.staging_shopify__orders)
[0m15:38:34.879977 [debug] [Thread-2  ]: Began compiling node model.billy_bulky.staging_shopify__orders
[0m15:38:34.881576 [debug] [Thread-1  ]: Timing info for model.billy_bulky.staging_shopify__customers (compile): 15:38:34.872069 => 15:38:34.881303
[0m15:38:34.881953 [debug] [Thread-3  ]: Began running node model.billy_bulky.staging_shopify__products
[0m15:38:34.884392 [debug] [Thread-2  ]: Writing injected SQL for node "model.billy_bulky.staging_shopify__orders"
[0m15:38:34.884855 [debug] [Thread-1  ]: Began executing node model.billy_bulky.staging_shopify__customers
[0m15:38:34.885378 [info ] [Thread-3  ]: 3 of 3 START sql view model staging.staging_shopify__products .................. [RUN]
[0m15:38:34.906193 [debug] [Thread-1  ]: Writing runtime sql for node "model.billy_bulky.staging_shopify__customers"
[0m15:38:34.906797 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.billy_bulky.staging_shopify__products'
[0m15:38:34.907205 [debug] [Thread-3  ]: Began compiling node model.billy_bulky.staging_shopify__products
[0m15:38:34.907543 [debug] [Thread-2  ]: Timing info for model.billy_bulky.staging_shopify__orders (compile): 15:38:34.880134 => 15:38:34.907367
[0m15:38:34.909901 [debug] [Thread-3  ]: Writing injected SQL for node "model.billy_bulky.staging_shopify__products"
[0m15:38:34.910607 [debug] [Thread-2  ]: Began executing node model.billy_bulky.staging_shopify__orders
[0m15:38:34.911907 [debug] [Thread-1  ]: Using snowflake connection "model.billy_bulky.staging_shopify__customers"
[0m15:38:34.912896 [debug] [Thread-3  ]: Timing info for model.billy_bulky.staging_shopify__products (compile): 15:38:34.907703 => 15:38:34.912703
[0m15:38:34.915833 [debug] [Thread-2  ]: Writing runtime sql for node "model.billy_bulky.staging_shopify__orders"
[0m15:38:34.916620 [debug] [Thread-1  ]: On model.billy_bulky.staging_shopify__customers: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.staging_shopify__customers"} */
create or replace   view E_COMMERCE.staging.staging_shopify__customers
  
   as (
    WITH customers AS (
    SELECT * FROM SHOPIFY.PUBLIC.customers
)

SELECT
    CUSTOMER_ID
    , FIRST_NAME
    , LAST_NAME
    , EMAIL
    , JOIN_DATE
    , COUNTRY
FROM customers
  );
[0m15:38:34.917361 [debug] [Thread-3  ]: Began executing node model.billy_bulky.staging_shopify__products
[0m15:38:34.918010 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:38:34.920601 [debug] [Thread-3  ]: Writing runtime sql for node "model.billy_bulky.staging_shopify__products"
[0m15:38:34.922074 [debug] [Thread-2  ]: Using snowflake connection "model.billy_bulky.staging_shopify__orders"
[0m15:38:34.924352 [debug] [Thread-3  ]: Using snowflake connection "model.billy_bulky.staging_shopify__products"
[0m15:38:34.925289 [debug] [Thread-2  ]: On model.billy_bulky.staging_shopify__orders: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.staging_shopify__orders"} */
create or replace   view E_COMMERCE.staging.staging_shopify__orders
  
   as (
    WITH orders AS (
    SELECT * FROM SHOPIFY.PUBLIC.orders
)

SELECT
    ORDER_ID
    , CUSTOMER_ID
    , PRODUCT_ID
    , QUANTITY
    , ORDER_DATE
    , STATUS
FROM orders
  );
[0m15:38:34.925868 [debug] [Thread-3  ]: On model.billy_bulky.staging_shopify__products: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.staging_shopify__products"} */
create or replace   view E_COMMERCE.staging.staging_shopify__products
  
   as (
    WITH products AS (
    SELECT * FROM SHOPIFY.PUBLIC.products
)

SELECT
    PRODUCT_ID
    , NAME
    , CATEGORY
    , PRICE
    , STOCK_LEVEL
FROM products
  );
[0m15:38:34.926164 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m15:38:34.926645 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m15:38:36.149708 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:38:36.190727 [debug] [Thread-2  ]: Timing info for model.billy_bulky.staging_shopify__orders (execute): 15:38:34.913447 => 15:38:36.190410
[0m15:38:36.191382 [debug] [Thread-2  ]: On model.billy_bulky.staging_shopify__orders: Close
[0m15:38:36.248457 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:38:36.252789 [debug] [Thread-1  ]: Timing info for model.billy_bulky.staging_shopify__customers (execute): 15:38:34.885675 => 15:38:36.252454
[0m15:38:36.253401 [debug] [Thread-1  ]: On model.billy_bulky.staging_shopify__customers: Close
[0m15:38:36.259779 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:38:36.263289 [debug] [Thread-3  ]: Timing info for model.billy_bulky.staging_shopify__products (execute): 15:38:34.918355 => 15:38:36.262986
[0m15:38:36.263863 [debug] [Thread-3  ]: On model.billy_bulky.staging_shopify__products: Close
[0m15:38:36.536291 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6c1fe4f-fa61-41f5-9e01-ce2603aa68e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15d60afd0>]}
[0m15:38:36.537778 [info ] [Thread-2  ]: 2 of 3 OK created sql view model staging.staging_shopify__orders ............... [[32mSUCCESS 1[0m in 1.66s]
[0m15:38:36.538972 [debug] [Thread-2  ]: Finished running node model.billy_bulky.staging_shopify__orders
[0m15:38:36.583548 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6c1fe4f-fa61-41f5-9e01-ce2603aa68e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15a7aaf40>]}
[0m15:38:36.584800 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6c1fe4f-fa61-41f5-9e01-ce2603aa68e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15d2a5460>]}
[0m15:38:36.585759 [info ] [Thread-1  ]: 1 of 3 OK created sql view model staging.staging_shopify__customers ............ [[32mSUCCESS 1[0m in 1.71s]
[0m15:38:36.587532 [debug] [Thread-1  ]: Finished running node model.billy_bulky.staging_shopify__customers
[0m15:38:36.586496 [info ] [Thread-3  ]: 3 of 3 OK created sql view model staging.staging_shopify__products ............. [[32mSUCCESS 1[0m in 1.68s]
[0m15:38:36.588627 [debug] [Thread-5  ]: Began running node model.billy_bulky.int_customers_and_orders
[0m15:38:36.589428 [debug] [Thread-3  ]: Finished running node model.billy_bulky.staging_shopify__products
[0m15:38:36.590555 [debug] [Thread-5  ]: Acquiring new snowflake connection 'model.billy_bulky.int_customers_and_orders'
[0m15:38:36.591281 [debug] [Thread-5  ]: Began compiling node model.billy_bulky.int_customers_and_orders
[0m15:38:36.596121 [debug] [Thread-5  ]: Writing injected SQL for node "model.billy_bulky.int_customers_and_orders"
[0m15:38:36.597813 [debug] [Thread-5  ]: Timing info for model.billy_bulky.int_customers_and_orders (compile): 15:38:36.591632 => 15:38:36.597519
[0m15:38:36.598847 [debug] [Thread-5  ]: Finished running node model.billy_bulky.int_customers_and_orders
[0m15:38:36.600629 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:38:36.600998 [debug] [MainThread]: Connection 'model.billy_bulky.staging_shopify__customers' was properly closed.
[0m15:38:36.601321 [debug] [MainThread]: Connection 'model.billy_bulky.staging_shopify__orders' was properly closed.
[0m15:38:36.601629 [debug] [MainThread]: Connection 'model.billy_bulky.staging_shopify__products' was properly closed.
[0m15:38:36.601928 [debug] [MainThread]: Connection 'model.billy_bulky.int_customers_and_orders' was properly closed.
[0m15:38:36.602277 [info ] [MainThread]: 
[0m15:38:36.602662 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 4.69 seconds (4.69s).
[0m15:38:36.603597 [debug] [MainThread]: Command end result
[0m15:38:36.615115 [info ] [MainThread]: 
[0m15:38:36.615744 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:38:36.616108 [info ] [MainThread]: 
[0m15:38:36.616463 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m15:38:36.618654 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.4357533, "process_user_time": 5.03687, "process_kernel_time": 0.38971, "process_mem_max_rss": "217399296", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:38:36.619145 [debug] [MainThread]: Command `dbt run` succeeded at 15:38:36.619039 after 6.44 seconds
[0m15:38:36.619467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102d30eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15d1a74f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1594622b0>]}
[0m15:38:36.619802 [debug] [MainThread]: Flushing usage events
[0m16:34:44.672210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10479deb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10428e910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fec130>]}


============================== 16:34:44.675406 | 01950e73-9d33-4240-9717-68d6374b6523 ==============================
[0m16:34:44.675406 [info ] [MainThread]: Running with dbt=1.7.1
[0m16:34:44.675806 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/bitlevi/.dbt', 'log_path': '/Users/bitlevi/Desktop/dbt_project/billy_bulky/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m16:34:45.625070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '01950e73-9d33-4240-9717-68d6374b6523', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10428e910>]}
[0m16:34:45.673223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '01950e73-9d33-4240-9717-68d6374b6523', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102554910>]}
[0m16:34:45.674101 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m16:34:45.689086 [debug] [MainThread]: checksum: ad428e6dc3b353dcb23d0c4ebea8b20b180e94b873271ac2a054a8e446dac0e2, vars: {}, profile: , target: , version: 1.7.1
[0m16:34:45.722517 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 4 files added, 0 files changed.
[0m16:34:45.723016 [debug] [MainThread]: Partial parsing: added file: billy_bulky://models/intermediate/customers/_int_customers__models.yml
[0m16:34:45.723282 [debug] [MainThread]: Partial parsing: added file: billy_bulky://models/intermediate/products/int_product_performance.sql
[0m16:34:45.723513 [debug] [MainThread]: Partial parsing: added file: billy_bulky://models/intermediate/products/_int_products__models.yml
[0m16:34:45.723728 [debug] [MainThread]: Partial parsing: added file: billy_bulky://models/intermediate/customers/int_customers_and_orders.sql
[0m16:34:45.723915 [debug] [MainThread]: Partial parsing: deleted file: billy_bulky://models/intermediate/int_customers_and_orders.sql
[0m16:34:45.816946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '01950e73-9d33-4240-9717-68d6374b6523', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x143c420d0>]}
[0m16:34:45.827225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '01950e73-9d33-4240-9717-68d6374b6523', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14362c550>]}
[0m16:34:45.827582 [info ] [MainThread]: Found 7 models, 14 tests, 3 sources, 0 exposures, 0 metrics, 431 macros, 0 groups, 0 semantic models
[0m16:34:45.827834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '01950e73-9d33-4240-9717-68d6374b6523', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x143c1df70>]}
[0m16:34:45.829010 [info ] [MainThread]: 
[0m16:34:45.829527 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:34:45.830318 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE'
[0m16:34:45.839198 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE"
[0m16:34:45.839522 [debug] [ThreadPool]: On list_E_COMMERCE: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE"} */
show terse schemas in database E_COMMERCE
    limit 10000
[0m16:34:45.839740 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:34:47.433431 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.0 seconds
[0m16:34:47.437709 [debug] [ThreadPool]: On list_E_COMMERCE: Close
[0m16:34:47.864292 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_E_COMMERCE, now list_E_COMMERCE_staging)
[0m16:34:47.865898 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PUBLIC'
[0m16:34:47.888201 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PUBLIC"
[0m16:34:47.885635 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_staging"
[0m16:34:47.888624 [debug] [ThreadPool]: On list_E_COMMERCE_PUBLIC: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE_PUBLIC"} */
show terse objects in E_COMMERCE.PUBLIC limit 10000
[0m16:34:47.889006 [debug] [ThreadPool]: On list_E_COMMERCE_staging: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE_staging"} */
show terse objects in E_COMMERCE.staging limit 10000
[0m16:34:47.889350 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:34:47.889703 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:34:49.459758 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b07546-0001-8184-0004-d8be000101ae
[0m16:34:49.460095 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m16:34:49.460377 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m16:34:49.460578 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m16:34:49.460824 [debug] [ThreadPool]: On list_E_COMMERCE_PUBLIC: Close
[0m16:34:49.770756 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.0 seconds
[0m16:34:49.775360 [debug] [ThreadPool]: On list_E_COMMERCE_staging: Close
[0m16:34:50.463909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '01950e73-9d33-4240-9717-68d6374b6523', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x142e95880>]}
[0m16:34:50.465331 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m16:34:50.465963 [info ] [MainThread]: 
[0m16:34:50.468847 [debug] [Thread-1  ]: Began running node model.billy_bulky.staging_shopify__customers
[0m16:34:50.469592 [info ] [Thread-1  ]: 1 of 3 START sql view model staging.staging_shopify__customers ................. [RUN]
[0m16:34:50.469992 [debug] [Thread-2  ]: Began running node model.billy_bulky.staging_shopify__orders
[0m16:34:50.470478 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_E_COMMERCE_staging, now model.billy_bulky.staging_shopify__customers)
[0m16:34:50.470782 [debug] [Thread-3  ]: Began running node model.billy_bulky.staging_shopify__products
[0m16:34:50.471174 [info ] [Thread-2  ]: 2 of 3 START sql view model staging.staging_shopify__orders .................... [RUN]
[0m16:34:50.471499 [debug] [Thread-1  ]: Began compiling node model.billy_bulky.staging_shopify__customers
[0m16:34:50.471813 [info ] [Thread-3  ]: 3 of 3 START sql view model staging.staging_shopify__products .................. [RUN]
[0m16:34:50.472407 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_E_COMMERCE_PUBLIC, now model.billy_bulky.staging_shopify__orders)
[0m16:34:50.477851 [debug] [Thread-1  ]: Writing injected SQL for node "model.billy_bulky.staging_shopify__customers"
[0m16:34:50.478458 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.billy_bulky.staging_shopify__products'
[0m16:34:50.478725 [debug] [Thread-2  ]: Began compiling node model.billy_bulky.staging_shopify__orders
[0m16:34:50.479064 [debug] [Thread-3  ]: Began compiling node model.billy_bulky.staging_shopify__products
[0m16:34:50.480939 [debug] [Thread-2  ]: Writing injected SQL for node "model.billy_bulky.staging_shopify__orders"
[0m16:34:50.482927 [debug] [Thread-3  ]: Writing injected SQL for node "model.billy_bulky.staging_shopify__products"
[0m16:34:50.483430 [debug] [Thread-1  ]: Timing info for model.billy_bulky.staging_shopify__customers (compile): 16:34:50.472620 => 16:34:50.483246
[0m16:34:50.483946 [debug] [Thread-1  ]: Began executing node model.billy_bulky.staging_shopify__customers
[0m16:34:50.490979 [debug] [Thread-3  ]: Timing info for model.billy_bulky.staging_shopify__products (compile): 16:34:50.481156 => 16:34:50.490677
[0m16:34:50.491400 [debug] [Thread-2  ]: Timing info for model.billy_bulky.staging_shopify__orders (compile): 16:34:50.479260 => 16:34:50.491227
[0m16:34:50.503971 [debug] [Thread-3  ]: Began executing node model.billy_bulky.staging_shopify__products
[0m16:34:50.504486 [debug] [Thread-1  ]: Writing runtime sql for node "model.billy_bulky.staging_shopify__customers"
[0m16:34:50.504819 [debug] [Thread-2  ]: Began executing node model.billy_bulky.staging_shopify__orders
[0m16:34:50.507042 [debug] [Thread-3  ]: Writing runtime sql for node "model.billy_bulky.staging_shopify__products"
[0m16:34:50.509096 [debug] [Thread-2  ]: Writing runtime sql for node "model.billy_bulky.staging_shopify__orders"
[0m16:34:50.509825 [debug] [Thread-2  ]: Using snowflake connection "model.billy_bulky.staging_shopify__orders"
[0m16:34:50.510098 [debug] [Thread-2  ]: On model.billy_bulky.staging_shopify__orders: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.staging_shopify__orders"} */
create or replace   view E_COMMERCE.staging.staging_shopify__orders
  
   as (
    WITH orders AS (
    SELECT * FROM SHOPIFY.PUBLIC.orders
)

SELECT
    ORDER_ID
    , CUSTOMER_ID
    , PRODUCT_ID
    , QUANTITY
    , ORDER_DATE
    , STATUS
FROM orders
  );
[0m16:34:50.510343 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m16:34:50.511214 [debug] [Thread-1  ]: Using snowflake connection "model.billy_bulky.staging_shopify__customers"
[0m16:34:50.511484 [debug] [Thread-1  ]: On model.billy_bulky.staging_shopify__customers: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.staging_shopify__customers"} */
create or replace   view E_COMMERCE.staging.staging_shopify__customers
  
   as (
    WITH customers AS (
    SELECT * FROM SHOPIFY.PUBLIC.customers
)

SELECT
    CUSTOMER_ID
    , FIRST_NAME
    , LAST_NAME
    , EMAIL
    , JOIN_DATE
    , COUNTRY
FROM customers
  );
[0m16:34:50.511723 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:34:50.512745 [debug] [Thread-3  ]: Using snowflake connection "model.billy_bulky.staging_shopify__products"
[0m16:34:50.513007 [debug] [Thread-3  ]: On model.billy_bulky.staging_shopify__products: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.staging_shopify__products"} */
create or replace   view E_COMMERCE.staging.staging_shopify__products
  
   as (
    WITH products AS (
    SELECT * FROM SHOPIFY.PUBLIC.products
)

SELECT
    PRODUCT_ID
    , NAME
    , CATEGORY
    , PRICE
    , STOCK_LEVEL
FROM products
  );
[0m16:34:50.513239 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m16:34:51.811426 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:34:51.830293 [debug] [Thread-3  ]: Timing info for model.billy_bulky.staging_shopify__products (execute): 16:34:50.505007 => 16:34:51.830140
[0m16:34:51.830647 [debug] [Thread-3  ]: On model.billy_bulky.staging_shopify__products: Close
[0m16:34:51.835645 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:34:51.837366 [debug] [Thread-2  ]: Timing info for model.billy_bulky.staging_shopify__orders (execute): 16:34:50.507291 => 16:34:51.837230
[0m16:34:51.837757 [debug] [Thread-2  ]: On model.billy_bulky.staging_shopify__orders: Close
[0m16:34:52.205953 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01950e73-9d33-4240-9717-68d6374b6523', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14411c8e0>]}
[0m16:34:52.207236 [info ] [Thread-3  ]: 3 of 3 OK created sql view model staging.staging_shopify__products ............. [[32mSUCCESS 1[0m in 1.73s]
[0m16:34:52.208220 [debug] [Thread-3  ]: Finished running node model.billy_bulky.staging_shopify__products
[0m16:34:52.378929 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m16:34:52.385643 [debug] [Thread-1  ]: Timing info for model.billy_bulky.staging_shopify__customers (execute): 16:34:50.484187 => 16:34:52.385199
[0m16:34:52.386374 [debug] [Thread-1  ]: On model.billy_bulky.staging_shopify__customers: Close
[0m16:34:52.480536 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01950e73-9d33-4240-9717-68d6374b6523', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1440e3d30>]}
[0m16:34:52.481699 [info ] [Thread-2  ]: 2 of 3 OK created sql view model staging.staging_shopify__orders ............... [[32mSUCCESS 1[0m in 2.01s]
[0m16:34:52.482523 [debug] [Thread-2  ]: Finished running node model.billy_bulky.staging_shopify__orders
[0m16:34:53.035720 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01950e73-9d33-4240-9717-68d6374b6523', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1443e58b0>]}
[0m16:34:53.036266 [info ] [Thread-1  ]: 1 of 3 OK created sql view model staging.staging_shopify__customers ............ [[32mSUCCESS 1[0m in 2.57s]
[0m16:34:53.036655 [debug] [Thread-1  ]: Finished running node model.billy_bulky.staging_shopify__customers
[0m16:34:53.037186 [debug] [Thread-5  ]: Began running node model.billy_bulky.int_customers_and_orders
[0m16:34:53.037718 [debug] [Thread-5  ]: Acquiring new snowflake connection 'model.billy_bulky.int_customers_and_orders'
[0m16:34:53.037965 [debug] [Thread-5  ]: Began compiling node model.billy_bulky.int_customers_and_orders
[0m16:34:53.041489 [debug] [Thread-5  ]: Writing injected SQL for node "model.billy_bulky.int_customers_and_orders"
[0m16:34:53.042735 [debug] [Thread-5  ]: Timing info for model.billy_bulky.int_customers_and_orders (compile): 16:34:53.038173 => 16:34:53.042471
[0m16:34:53.043558 [debug] [Thread-5  ]: Finished running node model.billy_bulky.int_customers_and_orders
[0m16:34:53.044812 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:34:53.045041 [debug] [MainThread]: Connection 'model.billy_bulky.staging_shopify__customers' was properly closed.
[0m16:34:53.045227 [debug] [MainThread]: Connection 'model.billy_bulky.staging_shopify__orders' was properly closed.
[0m16:34:53.045405 [debug] [MainThread]: Connection 'model.billy_bulky.staging_shopify__products' was properly closed.
[0m16:34:53.045577 [debug] [MainThread]: Connection 'model.billy_bulky.int_customers_and_orders' was properly closed.
[0m16:34:53.045825 [info ] [MainThread]: 
[0m16:34:53.046051 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 7.22 seconds (7.22s).
[0m16:34:53.046611 [debug] [MainThread]: Command end result
[0m16:34:53.053652 [info ] [MainThread]: 
[0m16:34:53.054143 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:34:53.054368 [info ] [MainThread]: 
[0m16:34:53.054600 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m16:34:53.056907 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.422656, "process_user_time": 4.672234, "process_kernel_time": 0.408188, "process_mem_max_rss": "217448448", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:34:53.057339 [debug] [MainThread]: Command `dbt run` succeeded at 16:34:53.057257 after 8.42 seconds
[0m16:34:53.057593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10479deb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x142e69d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102554910>]}
[0m16:34:53.057848 [debug] [MainThread]: Flushing usage events
[0m16:35:43.267988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054710d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091b8af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091d5ee0>]}


============================== 16:35:43.270811 | 30ef2883-b42a-4d31-b57a-4733be48ad07 ==============================
[0m16:35:43.270811 [info ] [MainThread]: Running with dbt=1.7.1
[0m16:35:43.271208 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/bitlevi/.dbt', 'log_path': '/Users/bitlevi/Desktop/dbt_project/billy_bulky/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:35:44.135518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '30ef2883-b42a-4d31-b57a-4733be48ad07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109205490>]}
[0m16:35:44.184220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '30ef2883-b42a-4d31-b57a-4733be48ad07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15b8e5bb0>]}
[0m16:35:44.184986 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m16:35:44.196935 [debug] [MainThread]: checksum: ad428e6dc3b353dcb23d0c4ebea8b20b180e94b873271ac2a054a8e446dac0e2, vars: {}, profile: , target: , version: 1.7.1
[0m16:35:44.205920 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m16:35:44.206297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '30ef2883-b42a-4d31-b57a-4733be48ad07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15ba080d0>]}
[0m16:35:44.806844 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'products' in the 'models' section of file 'models/staging/shopify/_shopify__schema.yml'
[0m16:35:44.922646 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.unique_products_product_id.68edffb83d' (models/staging/shopify/_shopify__schema.yml) depends on a node named 'products' in package '' which was not found
[0m16:35:44.923022 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_products_product_id.33741cf88e' (models/staging/shopify/_shopify__schema.yml) depends on a node named 'products' in package '' which was not found
[0m16:35:44.923257 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_products_name.d755fc2381' (models/staging/shopify/_shopify__schema.yml) depends on a node named 'products' in package '' which was not found
[0m16:35:44.923490 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.accepted_values_products_category__books__electronics__home__toys__garden__clothing.e85e5b5f7b' (models/staging/shopify/_shopify__schema.yml) depends on a node named 'products' in package '' which was not found
[0m16:35:44.923729 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_products_price.3b5b0a69be' (models/staging/shopify/_shopify__schema.yml) depends on a node named 'products' in package '' which was not found
[0m16:35:44.923966 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_products_stock_level.ee79d71f38' (models/staging/shopify/_shopify__schema.yml) depends on a node named 'products' in package '' which was not found
[0m16:35:44.948279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '30ef2883-b42a-4d31-b57a-4733be48ad07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15c9130d0>]}
[0m16:35:44.957941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '30ef2883-b42a-4d31-b57a-4733be48ad07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15b8ea310>]}
[0m16:35:44.958279 [info ] [MainThread]: Found 7 models, 14 tests, 3 sources, 0 exposures, 0 metrics, 431 macros, 0 groups, 0 semantic models
[0m16:35:44.958494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '30ef2883-b42a-4d31-b57a-4733be48ad07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15ba088e0>]}
[0m16:35:44.959528 [info ] [MainThread]: 
[0m16:35:44.960010 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:35:44.960732 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE'
[0m16:35:44.968923 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE"
[0m16:35:44.969469 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE'
[0m16:35:44.969689 [debug] [ThreadPool]: On list_E_COMMERCE: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE"} */
show terse schemas in database E_COMMERCE
    limit 10000
[0m16:35:44.971783 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE"
[0m16:35:44.972113 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:35:44.972319 [debug] [ThreadPool]: On list_E_COMMERCE: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE"} */
show terse schemas in database E_COMMERCE
    limit 10000
[0m16:35:44.973731 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:35:46.338868 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m16:35:46.341564 [debug] [ThreadPool]: On list_E_COMMERCE: Close
[0m16:35:46.349260 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m16:35:46.351614 [debug] [ThreadPool]: On list_E_COMMERCE: Close
[0m16:35:46.722930 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_E_COMMERCE, now list_E_COMMERCE_PUBLIC)
[0m16:35:46.725655 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_E_COMMERCE, now list_E_COMMERCE_intermediate)
[0m16:35:46.726935 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_staging'
[0m16:35:46.740569 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_intermediate"
[0m16:35:46.743701 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PUBLIC"
[0m16:35:46.746733 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_staging"
[0m16:35:46.747204 [debug] [ThreadPool]: On list_E_COMMERCE_intermediate: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE_intermediate"} */
show terse objects in E_COMMERCE.intermediate limit 10000
[0m16:35:46.747625 [debug] [ThreadPool]: On list_E_COMMERCE_PUBLIC: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE_PUBLIC"} */
show terse objects in E_COMMERCE.PUBLIC limit 10000
[0m16:35:46.748055 [debug] [ThreadPool]: On list_E_COMMERCE_staging: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE_staging"} */
show terse objects in E_COMMERCE.staging limit 10000
[0m16:35:46.748469 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:35:46.748852 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:35:46.749216 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:35:48.052681 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:35:48.054250 [debug] [ThreadPool]: On list_E_COMMERCE_intermediate: Close
[0m16:35:48.063953 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m16:35:48.065383 [debug] [ThreadPool]: On list_E_COMMERCE_staging: Close
[0m16:35:48.092127 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b07547-0001-8184-0004-d8be000101c2
[0m16:35:48.092437 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m16:35:48.092709 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m16:35:48.092906 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m16:35:48.093138 [debug] [ThreadPool]: On list_E_COMMERCE_PUBLIC: Close
[0m16:35:48.560989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '30ef2883-b42a-4d31-b57a-4733be48ad07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15c9131f0>]}
[0m16:35:48.562537 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m16:35:48.563191 [info ] [MainThread]: 
[0m16:35:48.568302 [debug] [Thread-1  ]: Began running node model.billy_bulky.staging_shopify__customers
[0m16:35:48.569024 [debug] [Thread-2  ]: Began running node model.billy_bulky.staging_shopify__orders
[0m16:35:48.569617 [debug] [Thread-3  ]: Began running node model.billy_bulky.staging_shopify__products
[0m16:35:48.570317 [info ] [Thread-1  ]: 1 of 4 START sql view model staging.staging_shopify__customers ................. [RUN]
[0m16:35:48.571056 [info ] [Thread-2  ]: 2 of 4 START sql view model staging.staging_shopify__orders .................... [RUN]
[0m16:35:48.572706 [info ] [Thread-3  ]: 3 of 4 START sql view model staging.staging_shopify__products .................. [RUN]
[0m16:35:48.573952 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_E_COMMERCE_PUBLIC, now model.billy_bulky.staging_shopify__customers)
[0m16:35:48.574973 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_E_COMMERCE_intermediate, now model.billy_bulky.staging_shopify__orders)
[0m16:35:48.575872 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly list_E_COMMERCE_staging, now model.billy_bulky.staging_shopify__products)
[0m16:35:48.576438 [debug] [Thread-1  ]: Began compiling node model.billy_bulky.staging_shopify__customers
[0m16:35:48.576964 [debug] [Thread-2  ]: Began compiling node model.billy_bulky.staging_shopify__orders
[0m16:35:48.577474 [debug] [Thread-3  ]: Began compiling node model.billy_bulky.staging_shopify__products
[0m16:35:48.587855 [debug] [Thread-1  ]: Writing injected SQL for node "model.billy_bulky.staging_shopify__customers"
[0m16:35:48.591721 [debug] [Thread-2  ]: Writing injected SQL for node "model.billy_bulky.staging_shopify__orders"
[0m16:35:48.594926 [debug] [Thread-3  ]: Writing injected SQL for node "model.billy_bulky.staging_shopify__products"
[0m16:35:48.596555 [debug] [Thread-3  ]: Timing info for model.billy_bulky.staging_shopify__products (compile): 16:35:48.592110 => 16:35:48.596250
[0m16:35:48.597112 [debug] [Thread-2  ]: Timing info for model.billy_bulky.staging_shopify__orders (compile): 16:35:48.588233 => 16:35:48.596837
[0m16:35:48.597584 [debug] [Thread-1  ]: Timing info for model.billy_bulky.staging_shopify__customers (compile): 16:35:48.577799 => 16:35:48.597358
[0m16:35:48.597988 [debug] [Thread-3  ]: Began executing node model.billy_bulky.staging_shopify__products
[0m16:35:48.598424 [debug] [Thread-2  ]: Began executing node model.billy_bulky.staging_shopify__orders
[0m16:35:48.598857 [debug] [Thread-1  ]: Began executing node model.billy_bulky.staging_shopify__customers
[0m16:35:48.632070 [debug] [Thread-2  ]: Writing runtime sql for node "model.billy_bulky.staging_shopify__orders"
[0m16:35:48.633667 [debug] [Thread-3  ]: Writing runtime sql for node "model.billy_bulky.staging_shopify__products"
[0m16:35:48.636012 [debug] [Thread-1  ]: Writing runtime sql for node "model.billy_bulky.staging_shopify__customers"
[0m16:35:48.637012 [debug] [Thread-3  ]: Using snowflake connection "model.billy_bulky.staging_shopify__products"
[0m16:35:48.637302 [debug] [Thread-3  ]: On model.billy_bulky.staging_shopify__products: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.staging_shopify__products"} */
create or replace   view E_COMMERCE.staging.staging_shopify__products
  
   as (
    WITH products AS (
    SELECT * FROM SHOPIFY.PUBLIC.products
)

SELECT
    PRODUCT_ID
    , NAME
    , CATEGORY
    , PRICE
    , STOCK_LEVEL
FROM products
  );
[0m16:35:48.637560 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m16:35:48.638264 [debug] [Thread-1  ]: Using snowflake connection "model.billy_bulky.staging_shopify__customers"
[0m16:35:48.639165 [debug] [Thread-2  ]: Using snowflake connection "model.billy_bulky.staging_shopify__orders"
[0m16:35:48.639443 [debug] [Thread-1  ]: On model.billy_bulky.staging_shopify__customers: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.staging_shopify__customers"} */
create or replace   view E_COMMERCE.staging.staging_shopify__customers
  
   as (
    WITH customers AS (
    SELECT * FROM SHOPIFY.PUBLIC.customers
)

SELECT
    CUSTOMER_ID
    , FIRST_NAME
    , LAST_NAME
    , EMAIL
    , JOIN_DATE
    , COUNTRY
FROM customers
  );
[0m16:35:48.640019 [debug] [Thread-2  ]: On model.billy_bulky.staging_shopify__orders: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.staging_shopify__orders"} */
create or replace   view E_COMMERCE.staging.staging_shopify__orders
  
   as (
    WITH orders AS (
    SELECT * FROM SHOPIFY.PUBLIC.orders
)

SELECT
    ORDER_ID
    , CUSTOMER_ID
    , PRODUCT_ID
    , QUANTITY
    , ORDER_DATE
    , STATUS
FROM orders
  );
[0m16:35:48.640307 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:35:48.640560 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m16:35:49.944726 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:35:49.979543 [debug] [Thread-2  ]: Timing info for model.billy_bulky.staging_shopify__orders (execute): 16:35:48.615097 => 16:35:49.979237
[0m16:35:49.980331 [debug] [Thread-2  ]: On model.billy_bulky.staging_shopify__orders: Close
[0m16:35:49.993965 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:35:49.997043 [debug] [Thread-1  ]: Timing info for model.billy_bulky.staging_shopify__customers (execute): 16:35:48.633838 => 16:35:49.996766
[0m16:35:49.997563 [debug] [Thread-1  ]: On model.billy_bulky.staging_shopify__customers: Close
[0m16:35:50.351562 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30ef2883-b42a-4d31-b57a-4733be48ad07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15cfb9b20>]}
[0m16:35:50.353560 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30ef2883-b42a-4d31-b57a-4733be48ad07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15f927040>]}
[0m16:35:50.354771 [info ] [Thread-1  ]: 1 of 4 OK created sql view model staging.staging_shopify__customers ............ [[32mSUCCESS 1[0m in 1.78s]
[0m16:35:50.355665 [info ] [Thread-2  ]: 2 of 4 OK created sql view model staging.staging_shopify__orders ............... [[32mSUCCESS 1[0m in 1.78s]
[0m16:35:50.356917 [debug] [Thread-1  ]: Finished running node model.billy_bulky.staging_shopify__customers
[0m16:35:50.357844 [debug] [Thread-2  ]: Finished running node model.billy_bulky.staging_shopify__orders
[0m16:35:50.358993 [debug] [Thread-5  ]: Began running node model.billy_bulky.int_customers_and_orders
[0m16:35:50.359810 [info ] [Thread-5  ]: 4 of 4 START sql table model intermediate.int_customers_and_orders ............. [RUN]
[0m16:35:50.361117 [debug] [Thread-5  ]: Acquiring new snowflake connection 'model.billy_bulky.int_customers_and_orders'
[0m16:35:50.361758 [debug] [Thread-5  ]: Began compiling node model.billy_bulky.int_customers_and_orders
[0m16:35:50.368681 [debug] [Thread-5  ]: Writing injected SQL for node "model.billy_bulky.int_customers_and_orders"
[0m16:35:50.369921 [debug] [Thread-5  ]: Timing info for model.billy_bulky.int_customers_and_orders (compile): 16:35:50.362177 => 16:35:50.369579
[0m16:35:50.370472 [debug] [Thread-5  ]: Began executing node model.billy_bulky.int_customers_and_orders
[0m16:35:50.397305 [debug] [Thread-5  ]: Writing runtime sql for node "model.billy_bulky.int_customers_and_orders"
[0m16:35:50.398931 [debug] [Thread-5  ]: Using snowflake connection "model.billy_bulky.int_customers_and_orders"
[0m16:35:50.399353 [debug] [Thread-5  ]: On model.billy_bulky.int_customers_and_orders: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.int_customers_and_orders"} */
create or replace transient table E_COMMERCE.intermediate.int_customers_and_orders
         as
        (WITH customers AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__customers
)

, orders AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__orders
)


SELECT 
    o.ORDER_ID
    , o.CUSTOMER_ID
    , c.FIRST_NAME
    , c.LAST_NAME
    , c.EMAIL
    , o.PRODUCT_ID
    , o.QUANTITY
    , o.ORDER_DATE
    , o.STATUS
    , c.COUNTRY  
FROM orders AS o 
INNER JOIN customers AS c ON c.customer_id = o.order_id
        );
[0m16:35:50.399748 [debug] [Thread-5  ]: Opening a new connection, currently in state init
[0m16:35:51.104261 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m16:35:51.106873 [debug] [Thread-3  ]: Timing info for model.billy_bulky.staging_shopify__products (execute): 16:35:48.599096 => 16:35:51.106659
[0m16:35:51.107272 [debug] [Thread-3  ]: On model.billy_bulky.staging_shopify__products: Close
[0m16:35:51.808213 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30ef2883-b42a-4d31-b57a-4733be48ad07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15ca571f0>]}
[0m16:35:51.808999 [info ] [Thread-3  ]: 3 of 4 OK created sql view model staging.staging_shopify__products ............. [[32mSUCCESS 1[0m in 3.23s]
[0m16:35:51.809642 [debug] [Thread-3  ]: Finished running node model.billy_bulky.staging_shopify__products
[0m16:35:54.384442 [debug] [Thread-5  ]: SQL status: SUCCESS 1 in 4.0 seconds
[0m16:35:54.393753 [debug] [Thread-5  ]: Timing info for model.billy_bulky.int_customers_and_orders (execute): 16:35:50.370791 => 16:35:54.393084
[0m16:35:54.395070 [debug] [Thread-5  ]: On model.billy_bulky.int_customers_and_orders: Close
[0m16:35:55.208678 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30ef2883-b42a-4d31-b57a-4733be48ad07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15fc15f40>]}
[0m16:35:55.210610 [info ] [Thread-5  ]: 4 of 4 OK created sql table model intermediate.int_customers_and_orders ........ [[32mSUCCESS 1[0m in 4.85s]
[0m16:35:55.211717 [debug] [Thread-5  ]: Finished running node model.billy_bulky.int_customers_and_orders
[0m16:35:55.215957 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:35:55.217029 [debug] [MainThread]: Connection 'model.billy_bulky.staging_shopify__customers' was properly closed.
[0m16:35:55.217847 [debug] [MainThread]: Connection 'model.billy_bulky.staging_shopify__orders' was properly closed.
[0m16:35:55.218614 [debug] [MainThread]: Connection 'model.billy_bulky.staging_shopify__products' was properly closed.
[0m16:35:55.219367 [debug] [MainThread]: Connection 'model.billy_bulky.int_customers_and_orders' was properly closed.
[0m16:35:55.220303 [info ] [MainThread]: 
[0m16:35:55.221035 [info ] [MainThread]: Finished running 3 view models, 1 table model in 0 hours 0 minutes and 10.26 seconds (10.26s).
[0m16:35:55.222993 [debug] [MainThread]: Command end result
[0m16:35:55.235122 [info ] [MainThread]: 
[0m16:35:55.235497 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:35:55.235776 [info ] [MainThread]: 
[0m16:35:55.236240 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m16:35:55.238657 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.004562, "process_user_time": 5.513439, "process_kernel_time": 0.406769, "process_mem_max_rss": "222150656", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:35:55.239191 [debug] [MainThread]: Command `dbt run` succeeded at 16:35:55.239085 after 12.01 seconds
[0m16:35:55.239537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054710d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15c94d580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15b8ea310>]}
[0m16:35:55.239919 [debug] [MainThread]: Flushing usage events
[0m16:36:27.501861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050e8eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103387f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110338a90>]}


============================== 16:36:27.504737 | c3131a98-40b1-4248-b054-62518c41b2cd ==============================
[0m16:36:27.504737 [info ] [MainThread]: Running with dbt=1.7.1
[0m16:36:27.505114 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/bitlevi/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/bitlevi/Desktop/dbt_project/billy_bulky/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:36:28.356195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c3131a98-40b1-4248-b054-62518c41b2cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bda940>]}
[0m16:36:28.404045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c3131a98-40b1-4248-b054-62518c41b2cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1250aaac0>]}
[0m16:36:28.404578 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m16:36:28.416126 [debug] [MainThread]: checksum: ad428e6dc3b353dcb23d0c4ebea8b20b180e94b873271ac2a054a8e446dac0e2, vars: {}, profile: , target: , version: 1.7.1
[0m16:36:28.445505 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:36:28.445965 [debug] [MainThread]: Partial parsing: updated file: billy_bulky://models/intermediate/customers/int_customers_and_orders.sql
[0m16:36:28.526611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c3131a98-40b1-4248-b054-62518c41b2cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125b950d0>]}
[0m16:36:28.534756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c3131a98-40b1-4248-b054-62518c41b2cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125879b80>]}
[0m16:36:28.535133 [info ] [MainThread]: Found 7 models, 14 tests, 3 sources, 0 exposures, 0 metrics, 431 macros, 0 groups, 0 semantic models
[0m16:36:28.535373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c3131a98-40b1-4248-b054-62518c41b2cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125879ac0>]}
[0m16:36:28.536581 [info ] [MainThread]: 
[0m16:36:28.537153 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:36:28.537905 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE'
[0m16:36:28.544840 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE'
[0m16:36:28.546811 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE"
[0m16:36:28.548345 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE"
[0m16:36:28.548594 [debug] [ThreadPool]: On list_E_COMMERCE: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE"} */
show terse schemas in database E_COMMERCE
    limit 10000
[0m16:36:28.548798 [debug] [ThreadPool]: On list_E_COMMERCE: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE"} */
show terse schemas in database E_COMMERCE
    limit 10000
[0m16:36:28.548992 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:36:28.549163 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:36:29.971636 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m16:36:29.977766 [debug] [ThreadPool]: On list_E_COMMERCE: Close
[0m16:36:30.294129 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.0 seconds
[0m16:36:30.299398 [debug] [ThreadPool]: On list_E_COMMERCE: Close
[0m16:36:31.053962 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_E_COMMERCE, now list_E_COMMERCE_PUBLIC)
[0m16:36:31.056493 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_E_COMMERCE, now list_E_COMMERCE_intermediate)
[0m16:36:31.058270 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_staging'
[0m16:36:31.077828 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PUBLIC"
[0m16:36:31.081552 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_intermediate"
[0m16:36:31.084974 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_staging"
[0m16:36:31.085507 [debug] [ThreadPool]: On list_E_COMMERCE_PUBLIC: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE_PUBLIC"} */
show terse objects in E_COMMERCE.PUBLIC limit 10000
[0m16:36:31.085968 [debug] [ThreadPool]: On list_E_COMMERCE_intermediate: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE_intermediate"} */
show terse objects in E_COMMERCE.intermediate limit 10000
[0m16:36:31.086409 [debug] [ThreadPool]: On list_E_COMMERCE_staging: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE_staging"} */
show terse objects in E_COMMERCE.staging limit 10000
[0m16:36:31.086830 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:36:31.087216 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:36:31.087594 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:36:32.456845 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m16:36:32.464267 [debug] [ThreadPool]: On list_E_COMMERCE_staging: Close
[0m16:36:32.535904 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b07548-0001-8184-0004-d8be000101ce
[0m16:36:32.536263 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m16:36:32.536600 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m16:36:32.536853 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m16:36:32.537150 [debug] [ThreadPool]: On list_E_COMMERCE_PUBLIC: Close
[0m16:36:32.911038 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 2.0 seconds
[0m16:36:32.917338 [debug] [ThreadPool]: On list_E_COMMERCE_intermediate: Close
[0m16:36:33.505431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c3131a98-40b1-4248-b054-62518c41b2cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125275430>]}
[0m16:36:33.508581 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m16:36:33.509539 [info ] [MainThread]: 
[0m16:36:33.515263 [debug] [Thread-1  ]: Began running node model.billy_bulky.staging_shopify__customers
[0m16:36:33.516147 [debug] [Thread-2  ]: Began running node model.billy_bulky.staging_shopify__orders
[0m16:36:33.517012 [debug] [Thread-3  ]: Began running node model.billy_bulky.staging_shopify__products
[0m16:36:33.519106 [info ] [Thread-1  ]: 1 of 4 START sql view model staging.staging_shopify__customers ................. [RUN]
[0m16:36:33.520476 [info ] [Thread-2  ]: 2 of 4 START sql view model staging.staging_shopify__orders .................... [RUN]
[0m16:36:33.521723 [info ] [Thread-3  ]: 3 of 4 START sql view model staging.staging_shopify__products .................. [RUN]
[0m16:36:33.523561 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_E_COMMERCE_PUBLIC, now model.billy_bulky.staging_shopify__customers)
[0m16:36:33.525693 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_E_COMMERCE_intermediate, now model.billy_bulky.staging_shopify__orders)
[0m16:36:33.527280 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly list_E_COMMERCE_staging, now model.billy_bulky.staging_shopify__products)
[0m16:36:33.527826 [debug] [Thread-1  ]: Began compiling node model.billy_bulky.staging_shopify__customers
[0m16:36:33.528322 [debug] [Thread-2  ]: Began compiling node model.billy_bulky.staging_shopify__orders
[0m16:36:33.528793 [debug] [Thread-3  ]: Began compiling node model.billy_bulky.staging_shopify__products
[0m16:36:33.539080 [debug] [Thread-1  ]: Writing injected SQL for node "model.billy_bulky.staging_shopify__customers"
[0m16:36:33.543088 [debug] [Thread-2  ]: Writing injected SQL for node "model.billy_bulky.staging_shopify__orders"
[0m16:36:33.546952 [debug] [Thread-3  ]: Writing injected SQL for node "model.billy_bulky.staging_shopify__products"
[0m16:36:33.548202 [debug] [Thread-3  ]: Timing info for model.billy_bulky.staging_shopify__products (compile): 16:36:33.543520 => 16:36:33.547876
[0m16:36:33.548788 [debug] [Thread-2  ]: Timing info for model.billy_bulky.staging_shopify__orders (compile): 16:36:33.539473 => 16:36:33.548506
[0m16:36:33.549297 [debug] [Thread-1  ]: Timing info for model.billy_bulky.staging_shopify__customers (compile): 16:36:33.529098 => 16:36:33.549054
[0m16:36:33.549760 [debug] [Thread-3  ]: Began executing node model.billy_bulky.staging_shopify__products
[0m16:36:33.550237 [debug] [Thread-2  ]: Began executing node model.billy_bulky.staging_shopify__orders
[0m16:36:33.550683 [debug] [Thread-1  ]: Began executing node model.billy_bulky.staging_shopify__customers
[0m16:36:33.593155 [debug] [Thread-3  ]: Writing runtime sql for node "model.billy_bulky.staging_shopify__products"
[0m16:36:33.593804 [debug] [Thread-2  ]: Writing runtime sql for node "model.billy_bulky.staging_shopify__orders"
[0m16:36:33.595343 [debug] [Thread-1  ]: Writing runtime sql for node "model.billy_bulky.staging_shopify__customers"
[0m16:36:33.596205 [debug] [Thread-1  ]: Using snowflake connection "model.billy_bulky.staging_shopify__customers"
[0m16:36:33.596480 [debug] [Thread-1  ]: On model.billy_bulky.staging_shopify__customers: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.staging_shopify__customers"} */
create or replace   view E_COMMERCE.staging.staging_shopify__customers
  
   as (
    WITH customers AS (
    SELECT * FROM SHOPIFY.PUBLIC.customers
)

SELECT
    CUSTOMER_ID
    , FIRST_NAME
    , LAST_NAME
    , EMAIL
    , JOIN_DATE
    , COUNTRY
FROM customers
  );
[0m16:36:33.596726 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:36:33.597208 [debug] [Thread-2  ]: Using snowflake connection "model.billy_bulky.staging_shopify__orders"
[0m16:36:33.597664 [debug] [Thread-3  ]: Using snowflake connection "model.billy_bulky.staging_shopify__products"
[0m16:36:33.598110 [debug] [Thread-2  ]: On model.billy_bulky.staging_shopify__orders: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.staging_shopify__orders"} */
create or replace   view E_COMMERCE.staging.staging_shopify__orders
  
   as (
    WITH orders AS (
    SELECT * FROM SHOPIFY.PUBLIC.orders
)

SELECT
    ORDER_ID
    , CUSTOMER_ID
    , PRODUCT_ID
    , QUANTITY
    , ORDER_DATE
    , STATUS
FROM orders
  );
[0m16:36:33.598609 [debug] [Thread-3  ]: On model.billy_bulky.staging_shopify__products: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.staging_shopify__products"} */
create or replace   view E_COMMERCE.staging.staging_shopify__products
  
   as (
    WITH products AS (
    SELECT * FROM SHOPIFY.PUBLIC.products
)

SELECT
    PRODUCT_ID
    , NAME
    , CATEGORY
    , PRICE
    , STOCK_LEVEL
FROM products
  );
[0m16:36:33.599085 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m16:36:33.599346 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m16:36:34.831835 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:36:34.866228 [debug] [Thread-3  ]: Timing info for model.billy_bulky.staging_shopify__products (execute): 16:36:33.550964 => 16:36:34.866063
[0m16:36:34.866548 [debug] [Thread-3  ]: On model.billy_bulky.staging_shopify__products: Close
[0m16:36:34.882241 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:36:34.883797 [debug] [Thread-1  ]: Timing info for model.billy_bulky.staging_shopify__customers (execute): 16:36:33.582540 => 16:36:34.883662
[0m16:36:34.884044 [debug] [Thread-1  ]: On model.billy_bulky.staging_shopify__customers: Close
[0m16:36:35.260926 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3131a98-40b1-4248-b054-62518c41b2cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125bfef70>]}
[0m16:36:35.265534 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3131a98-40b1-4248-b054-62518c41b2cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125a2afd0>]}
[0m16:36:35.264016 [info ] [Thread-3  ]: 3 of 4 OK created sql view model staging.staging_shopify__products ............. [[32mSUCCESS 1[0m in 1.73s]
[0m16:36:35.268235 [debug] [Thread-3  ]: Finished running node model.billy_bulky.staging_shopify__products
[0m16:36:35.267137 [info ] [Thread-1  ]: 1 of 4 OK created sql view model staging.staging_shopify__customers ............ [[32mSUCCESS 1[0m in 1.74s]
[0m16:36:35.269960 [debug] [Thread-1  ]: Finished running node model.billy_bulky.staging_shopify__customers
[0m16:36:35.449566 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m16:36:35.459710 [debug] [Thread-2  ]: Timing info for model.billy_bulky.staging_shopify__orders (execute): 16:36:33.563661 => 16:36:35.459010
[0m16:36:35.461105 [debug] [Thread-2  ]: On model.billy_bulky.staging_shopify__orders: Close
[0m16:36:36.080239 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3131a98-40b1-4248-b054-62518c41b2cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125352e20>]}
[0m16:36:36.082105 [info ] [Thread-2  ]: 2 of 4 OK created sql view model staging.staging_shopify__orders ............... [[32mSUCCESS 1[0m in 2.56s]
[0m16:36:36.083366 [debug] [Thread-2  ]: Finished running node model.billy_bulky.staging_shopify__orders
[0m16:36:36.084621 [debug] [Thread-5  ]: Began running node model.billy_bulky.int_customers_and_orders
[0m16:36:36.085714 [info ] [Thread-5  ]: 4 of 4 START sql table model intermediate.int_customers_and_orders ............. [RUN]
[0m16:36:36.087607 [debug] [Thread-5  ]: Acquiring new snowflake connection 'model.billy_bulky.int_customers_and_orders'
[0m16:36:36.088676 [debug] [Thread-5  ]: Began compiling node model.billy_bulky.int_customers_and_orders
[0m16:36:36.096073 [debug] [Thread-5  ]: Writing injected SQL for node "model.billy_bulky.int_customers_and_orders"
[0m16:36:36.097124 [debug] [Thread-5  ]: Timing info for model.billy_bulky.int_customers_and_orders (compile): 16:36:36.089186 => 16:36:36.096857
[0m16:36:36.097537 [debug] [Thread-5  ]: Began executing node model.billy_bulky.int_customers_and_orders
[0m16:36:36.122746 [debug] [Thread-5  ]: Writing runtime sql for node "model.billy_bulky.int_customers_and_orders"
[0m16:36:36.124332 [debug] [Thread-5  ]: Using snowflake connection "model.billy_bulky.int_customers_and_orders"
[0m16:36:36.124807 [debug] [Thread-5  ]: On model.billy_bulky.int_customers_and_orders: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.int_customers_and_orders"} */
create or replace transient table E_COMMERCE.intermediate.int_customers_and_orders
         as
        (WITH customers AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__customers
)

, orders AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__orders
)


SELECT 
    o.ORDER_ID
    , o.CUSTOMER_ID
    , c.FIRST_NAME
    , c.LAST_NAME
    , c.EMAIL
    , o.PRODUCT_ID
    , o.QUANTITY
    , o.ORDER_DATE
    , o.STATUS
    , c.COUNTRY  
FROM orders AS o 
INNER JOIN customers AS c ON c.customer_id = o.customer_id
        );
[0m16:36:36.125250 [debug] [Thread-5  ]: Opening a new connection, currently in state init
[0m16:36:38.519626 [debug] [Thread-5  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m16:36:38.528095 [debug] [Thread-5  ]: Timing info for model.billy_bulky.int_customers_and_orders (execute): 16:36:36.097770 => 16:36:38.527453
[0m16:36:38.529327 [debug] [Thread-5  ]: On model.billy_bulky.int_customers_and_orders: Close
[0m16:36:39.137395 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3131a98-40b1-4248-b054-62518c41b2cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125275430>]}
[0m16:36:39.140395 [info ] [Thread-5  ]: 4 of 4 OK created sql table model intermediate.int_customers_and_orders ........ [[32mSUCCESS 1[0m in 3.05s]
[0m16:36:39.143295 [debug] [Thread-5  ]: Finished running node model.billy_bulky.int_customers_and_orders
[0m16:36:39.147122 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:36:39.148174 [debug] [MainThread]: Connection 'model.billy_bulky.staging_shopify__customers' was properly closed.
[0m16:36:39.148685 [debug] [MainThread]: Connection 'model.billy_bulky.staging_shopify__orders' was properly closed.
[0m16:36:39.149198 [debug] [MainThread]: Connection 'model.billy_bulky.staging_shopify__products' was properly closed.
[0m16:36:39.149688 [debug] [MainThread]: Connection 'model.billy_bulky.int_customers_and_orders' was properly closed.
[0m16:36:39.150478 [info ] [MainThread]: 
[0m16:36:39.151183 [info ] [MainThread]: Finished running 3 view models, 1 table model in 0 hours 0 minutes and 10.61 seconds (10.61s).
[0m16:36:39.154016 [debug] [MainThread]: Command end result
[0m16:36:39.173449 [info ] [MainThread]: 
[0m16:36:39.174154 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:36:39.174655 [info ] [MainThread]: 
[0m16:36:39.175154 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m16:36:39.178464 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.710207, "process_user_time": 5.158418, "process_kernel_time": 0.389001, "process_mem_max_rss": "215924736", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:36:39.179266 [debug] [MainThread]: Command `dbt run` succeeded at 16:36:39.179088 after 11.71 seconds
[0m16:36:39.179818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050e8eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127b9ec10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12517b0d0>]}
[0m16:36:39.180395 [debug] [MainThread]: Flushing usage events
[0m16:37:36.154019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102c800d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054d0af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054edee0>]}


============================== 16:37:36.156787 | 11338d04-718b-41bc-8ae5-510ad131fc9b ==============================
[0m16:37:36.156787 [info ] [MainThread]: Running with dbt=1.7.1
[0m16:37:36.157168 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/bitlevi/Desktop/dbt_project/billy_bulky/logs', 'profiles_dir': '/Users/bitlevi/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:37:36.986249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '11338d04-718b-41bc-8ae5-510ad131fc9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10551d490>]}
[0m16:37:37.034246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '11338d04-718b-41bc-8ae5-510ad131fc9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1360bebb0>]}
[0m16:37:37.034895 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m16:37:37.047867 [debug] [MainThread]: checksum: ad428e6dc3b353dcb23d0c4ebea8b20b180e94b873271ac2a054a8e446dac0e2, vars: {}, profile: , target: , version: 1.7.1
[0m16:37:37.079194 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 1 files changed.
[0m16:37:37.079629 [debug] [MainThread]: Partial parsing: added file: billy_bulky://models/intermediate/customers/int_customer_segmentation.sql
[0m16:37:37.079912 [debug] [MainThread]: Partial parsing: updated file: billy_bulky://models/intermediate/customers/_int_customers__models.yml
[0m16:37:37.080102 [debug] [MainThread]: Partial parsing: deleted file: billy_bulky://models/intermediate/customers/int_customers_and_orders.sql
[0m16:37:37.235027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '11338d04-718b-41bc-8ae5-510ad131fc9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137e260d0>]}
[0m16:37:37.244899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '11338d04-718b-41bc-8ae5-510ad131fc9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137a1bc10>]}
[0m16:37:37.245226 [info ] [MainThread]: Found 7 models, 15 tests, 3 sources, 0 exposures, 0 metrics, 431 macros, 0 groups, 0 semantic models
[0m16:37:37.245466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '11338d04-718b-41bc-8ae5-510ad131fc9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137a1bb50>]}
[0m16:37:37.246606 [info ] [MainThread]: 
[0m16:37:37.247115 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:37:37.248008 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE'
[0m16:37:37.297214 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE'
[0m16:37:37.304687 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE"
[0m16:37:37.306151 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE"
[0m16:37:37.306389 [debug] [ThreadPool]: On list_E_COMMERCE: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE"} */
show terse schemas in database E_COMMERCE
    limit 10000
[0m16:37:37.306591 [debug] [ThreadPool]: On list_E_COMMERCE: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE"} */
show terse schemas in database E_COMMERCE
    limit 10000
[0m16:37:37.306775 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:37:37.306945 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:37:39.356401 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.0 seconds
[0m16:37:39.359615 [debug] [ThreadPool]: On list_E_COMMERCE: Close
[0m16:37:39.573122 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.0 seconds
[0m16:37:39.575237 [debug] [ThreadPool]: On list_E_COMMERCE: Close
[0m16:37:39.969887 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_E_COMMERCE, now list_E_COMMERCE_intermediate)
[0m16:37:39.971173 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_E_COMMERCE, now list_E_COMMERCE_staging)
[0m16:37:39.974391 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PUBLIC'
[0m16:37:39.991635 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_intermediate"
[0m16:37:39.992429 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_staging"
[0m16:37:39.994782 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PUBLIC"
[0m16:37:39.995123 [debug] [ThreadPool]: On list_E_COMMERCE_intermediate: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE_intermediate"} */
show terse objects in E_COMMERCE.intermediate limit 10000
[0m16:37:39.995490 [debug] [ThreadPool]: On list_E_COMMERCE_staging: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE_staging"} */
show terse objects in E_COMMERCE.staging limit 10000
[0m16:37:39.995814 [debug] [ThreadPool]: On list_E_COMMERCE_PUBLIC: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE_PUBLIC"} */
show terse objects in E_COMMERCE.PUBLIC limit 10000
[0m16:37:39.996117 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:37:39.996413 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:37:39.996677 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:37:41.116469 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:37:41.117852 [debug] [ThreadPool]: On list_E_COMMERCE_intermediate: Close
[0m16:37:41.201568 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b07549-0001-834e-0004-d8be000111e2
[0m16:37:41.201914 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m16:37:41.202222 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m16:37:41.202445 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m16:37:41.202866 [debug] [ThreadPool]: On list_E_COMMERCE_PUBLIC: Close
[0m16:37:41.537344 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.0 seconds
[0m16:37:41.542046 [debug] [ThreadPool]: On list_E_COMMERCE_staging: Close
[0m16:37:42.293899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '11338d04-718b-41bc-8ae5-510ad131fc9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137b25430>]}
[0m16:37:42.295895 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m16:37:42.296788 [info ] [MainThread]: 
[0m16:37:42.301389 [debug] [Thread-1  ]: Began running node model.billy_bulky.staging_shopify__customers
[0m16:37:42.302508 [debug] [Thread-2  ]: Began running node model.billy_bulky.staging_shopify__orders
[0m16:37:42.304739 [debug] [Thread-3  ]: Began running node model.billy_bulky.staging_shopify__products
[0m16:37:42.303859 [info ] [Thread-1  ]: 1 of 4 START sql view model staging.staging_shopify__customers ................. [RUN]
[0m16:37:42.306347 [info ] [Thread-2  ]: 2 of 4 START sql view model staging.staging_shopify__orders .................... [RUN]
[0m16:37:42.307314 [info ] [Thread-3  ]: 3 of 4 START sql view model staging.staging_shopify__products .................. [RUN]
[0m16:37:42.309725 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_E_COMMERCE_intermediate, now model.billy_bulky.staging_shopify__customers)
[0m16:37:42.310831 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_E_COMMERCE_staging, now model.billy_bulky.staging_shopify__orders)
[0m16:37:42.311937 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly list_E_COMMERCE_PUBLIC, now model.billy_bulky.staging_shopify__products)
[0m16:37:42.312612 [debug] [Thread-1  ]: Began compiling node model.billy_bulky.staging_shopify__customers
[0m16:37:42.313328 [debug] [Thread-2  ]: Began compiling node model.billy_bulky.staging_shopify__orders
[0m16:37:42.313745 [debug] [Thread-3  ]: Began compiling node model.billy_bulky.staging_shopify__products
[0m16:37:42.321620 [debug] [Thread-1  ]: Writing injected SQL for node "model.billy_bulky.staging_shopify__customers"
[0m16:37:42.324365 [debug] [Thread-2  ]: Writing injected SQL for node "model.billy_bulky.staging_shopify__orders"
[0m16:37:42.327049 [debug] [Thread-3  ]: Writing injected SQL for node "model.billy_bulky.staging_shopify__products"
[0m16:37:42.328527 [debug] [Thread-2  ]: Timing info for model.billy_bulky.staging_shopify__orders (compile): 16:37:42.321885 => 16:37:42.328251
[0m16:37:42.328990 [debug] [Thread-1  ]: Timing info for model.billy_bulky.staging_shopify__customers (compile): 16:37:42.313959 => 16:37:42.328772
[0m16:37:42.329406 [debug] [Thread-3  ]: Timing info for model.billy_bulky.staging_shopify__products (compile): 16:37:42.324624 => 16:37:42.329197
[0m16:37:42.329768 [debug] [Thread-2  ]: Began executing node model.billy_bulky.staging_shopify__orders
[0m16:37:42.330141 [debug] [Thread-1  ]: Began executing node model.billy_bulky.staging_shopify__customers
[0m16:37:42.330490 [debug] [Thread-3  ]: Began executing node model.billy_bulky.staging_shopify__products
[0m16:37:42.368130 [debug] [Thread-1  ]: Writing runtime sql for node "model.billy_bulky.staging_shopify__customers"
[0m16:37:42.372101 [debug] [Thread-2  ]: Writing runtime sql for node "model.billy_bulky.staging_shopify__orders"
[0m16:37:42.372474 [debug] [Thread-3  ]: Writing runtime sql for node "model.billy_bulky.staging_shopify__products"
[0m16:37:42.373543 [debug] [Thread-3  ]: Using snowflake connection "model.billy_bulky.staging_shopify__products"
[0m16:37:42.373858 [debug] [Thread-3  ]: On model.billy_bulky.staging_shopify__products: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.staging_shopify__products"} */
create or replace   view E_COMMERCE.staging.staging_shopify__products
  
   as (
    WITH products AS (
    SELECT * FROM SHOPIFY.PUBLIC.products
)

SELECT
    PRODUCT_ID
    , NAME
    , CATEGORY
    , PRICE
    , STOCK_LEVEL
FROM products
  );
[0m16:37:42.374161 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m16:37:42.374706 [debug] [Thread-1  ]: Using snowflake connection "model.billy_bulky.staging_shopify__customers"
[0m16:37:42.375449 [debug] [Thread-2  ]: Using snowflake connection "model.billy_bulky.staging_shopify__orders"
[0m16:37:42.376324 [debug] [Thread-1  ]: On model.billy_bulky.staging_shopify__customers: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.staging_shopify__customers"} */
create or replace   view E_COMMERCE.staging.staging_shopify__customers
  
   as (
    WITH customers AS (
    SELECT * FROM SHOPIFY.PUBLIC.customers
)

SELECT
    CUSTOMER_ID
    , FIRST_NAME
    , LAST_NAME
    , EMAIL
    , JOIN_DATE
    , COUNTRY
FROM customers
  );
[0m16:37:42.376664 [debug] [Thread-2  ]: On model.billy_bulky.staging_shopify__orders: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.staging_shopify__orders"} */
create or replace   view E_COMMERCE.staging.staging_shopify__orders
  
   as (
    WITH orders AS (
    SELECT * FROM SHOPIFY.PUBLIC.orders
)

SELECT
    ORDER_ID
    , CUSTOMER_ID
    , PRODUCT_ID
    , QUANTITY
    , ORDER_DATE
    , STATUS
FROM orders
  );
[0m16:37:42.376950 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:37:42.377214 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m16:37:43.553772 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:37:43.598972 [debug] [Thread-3  ]: Timing info for model.billy_bulky.staging_shopify__products (execute): 16:37:42.360853 => 16:37:43.598661
[0m16:37:43.599591 [debug] [Thread-3  ]: On model.billy_bulky.staging_shopify__products: Close
[0m16:37:43.908054 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m16:37:43.915672 [debug] [Thread-2  ]: Timing info for model.billy_bulky.staging_shopify__orders (execute): 16:37:42.330715 => 16:37:43.915144
[0m16:37:43.916763 [debug] [Thread-2  ]: On model.billy_bulky.staging_shopify__orders: Close
[0m16:37:43.981185 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11338d04-718b-41bc-8ae5-510ad131fc9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137b25430>]}
[0m16:37:43.983083 [info ] [Thread-3  ]: 3 of 4 OK created sql view model staging.staging_shopify__products ............. [[32mSUCCESS 1[0m in 1.67s]
[0m16:37:43.984613 [debug] [Thread-3  ]: Finished running node model.billy_bulky.staging_shopify__products
[0m16:37:44.265608 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m16:37:44.273649 [debug] [Thread-1  ]: Timing info for model.billy_bulky.staging_shopify__customers (execute): 16:37:42.343289 => 16:37:44.272732
[0m16:37:44.275491 [debug] [Thread-1  ]: On model.billy_bulky.staging_shopify__customers: Close
[0m16:37:44.285055 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11338d04-718b-41bc-8ae5-510ad131fc9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137d77d00>]}
[0m16:37:44.286969 [info ] [Thread-2  ]: 2 of 4 OK created sql view model staging.staging_shopify__orders ............... [[32mSUCCESS 1[0m in 1.97s]
[0m16:37:44.288664 [debug] [Thread-2  ]: Finished running node model.billy_bulky.staging_shopify__orders
[0m16:37:44.980700 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11338d04-718b-41bc-8ae5-510ad131fc9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137d8e4f0>]}
[0m16:37:44.983279 [info ] [Thread-1  ]: 1 of 4 OK created sql view model staging.staging_shopify__customers ............ [[32mSUCCESS 1[0m in 2.67s]
[0m16:37:44.984809 [debug] [Thread-1  ]: Finished running node model.billy_bulky.staging_shopify__customers
[0m16:37:44.986512 [debug] [Thread-5  ]: Began running node model.billy_bulky.int_customer_segmentation
[0m16:37:44.988820 [info ] [Thread-5  ]: 4 of 4 START sql table model intermediate.int_customer_segmentation ............ [RUN]
[0m16:37:44.991344 [debug] [Thread-5  ]: Acquiring new snowflake connection 'model.billy_bulky.int_customer_segmentation'
[0m16:37:44.992133 [debug] [Thread-5  ]: Began compiling node model.billy_bulky.int_customer_segmentation
[0m16:37:45.000929 [debug] [Thread-5  ]: Writing injected SQL for node "model.billy_bulky.int_customer_segmentation"
[0m16:37:45.002653 [debug] [Thread-5  ]: Timing info for model.billy_bulky.int_customer_segmentation (compile): 16:37:44.992538 => 16:37:45.002146
[0m16:37:45.003513 [debug] [Thread-5  ]: Began executing node model.billy_bulky.int_customer_segmentation
[0m16:37:45.033059 [debug] [Thread-5  ]: Writing runtime sql for node "model.billy_bulky.int_customer_segmentation"
[0m16:37:45.035096 [debug] [Thread-5  ]: Using snowflake connection "model.billy_bulky.int_customer_segmentation"
[0m16:37:45.035659 [debug] [Thread-5  ]: On model.billy_bulky.int_customer_segmentation: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.int_customer_segmentation"} */
create or replace transient table E_COMMERCE.intermediate.int_customer_segmentation
         as
        (WITH customers AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__customers
)

, orders AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__orders
)


SELECT 
    o.ORDER_ID
    , o.CUSTOMER_ID
    , c.FIRST_NAME
    , c.LAST_NAME
    , c.EMAIL
    , o.PRODUCT_ID
    , o.QUANTITY
    , o.ORDER_DATE
    , o.STATUS
    , c.COUNTRY  
FROM orders AS o 
INNER JOIN customers AS c ON c.customer_id = o.customer_id
        );
[0m16:37:45.036169 [debug] [Thread-5  ]: Opening a new connection, currently in state init
[0m16:37:47.741798 [debug] [Thread-5  ]: SQL status: SUCCESS 1 in 3.0 seconds
[0m16:37:47.749920 [debug] [Thread-5  ]: Timing info for model.billy_bulky.int_customer_segmentation (execute): 16:37:45.004055 => 16:37:47.749448
[0m16:37:47.751726 [debug] [Thread-5  ]: On model.billy_bulky.int_customer_segmentation: Close
[0m16:37:48.161113 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11338d04-718b-41bc-8ae5-510ad131fc9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153272b80>]}
[0m16:37:48.164400 [info ] [Thread-5  ]: 4 of 4 OK created sql table model intermediate.int_customer_segmentation ....... [[32mSUCCESS 1[0m in 3.17s]
[0m16:37:48.166603 [debug] [Thread-5  ]: Finished running node model.billy_bulky.int_customer_segmentation
[0m16:37:48.171858 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:37:48.172867 [debug] [MainThread]: Connection 'model.billy_bulky.staging_shopify__customers' was properly closed.
[0m16:37:48.173611 [debug] [MainThread]: Connection 'model.billy_bulky.staging_shopify__orders' was properly closed.
[0m16:37:48.174213 [debug] [MainThread]: Connection 'model.billy_bulky.staging_shopify__products' was properly closed.
[0m16:37:48.174802 [debug] [MainThread]: Connection 'model.billy_bulky.int_customer_segmentation' was properly closed.
[0m16:37:48.175559 [info ] [MainThread]: 
[0m16:37:48.176287 [info ] [MainThread]: Finished running 3 view models, 1 table model in 0 hours 0 minutes and 10.93 seconds (10.93s).
[0m16:37:48.178674 [debug] [MainThread]: Command end result
[0m16:37:48.205474 [info ] [MainThread]: 
[0m16:37:48.206190 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:37:48.206609 [info ] [MainThread]: 
[0m16:37:48.207033 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m16:37:48.210571 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.089848, "process_user_time": 5.111006, "process_kernel_time": 0.401089, "process_mem_max_rss": "213270528", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:37:48.211261 [debug] [MainThread]: Command `dbt run` succeeded at 16:37:48.211109 after 12.09 seconds
[0m16:37:48.211759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102c800d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137cef0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136052640>]}
[0m16:37:48.212264 [debug] [MainThread]: Flushing usage events
[0m16:43:11.020672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106aa90d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10659a970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092f84f0>]}


============================== 16:43:11.023754 | 661a463b-31ce-43b4-aa19-b60945800ba9 ==============================
[0m16:43:11.023754 [info ] [MainThread]: Running with dbt=1.7.1
[0m16:43:11.024159 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/bitlevi/.dbt', 'log_path': '/Users/bitlevi/Desktop/dbt_project/billy_bulky/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:43:11.900970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '661a463b-31ce-43b4-aa19-b60945800ba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10659a970>]}
[0m16:43:11.948533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '661a463b-31ce-43b4-aa19-b60945800ba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12015dc10>]}
[0m16:43:11.949139 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m16:43:11.963062 [debug] [MainThread]: checksum: ad428e6dc3b353dcb23d0c4ebea8b20b180e94b873271ac2a054a8e446dac0e2, vars: {}, profile: , target: , version: 1.7.1
[0m16:43:11.995985 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m16:43:11.996428 [debug] [MainThread]: Partial parsing: added file: billy_bulky://models/intermediate/customers/int_customers_segmentation.sql
[0m16:43:11.996657 [debug] [MainThread]: Partial parsing: deleted file: billy_bulky://models/intermediate/customers/int_customer_segmentation.sql
[0m16:43:12.099406 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'int_customer_segmentation' in the 'models' section of file 'models/intermediate/customers/_int_customers__models.yml'
[0m16:43:12.148799 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_int_customer_segmentation_customer_id.b278231c99' (models/intermediate/customers/_int_customers__models.yml) depends on a node named 'int_customer_segmentation' in package '' which was not found
[0m16:43:12.158861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '661a463b-31ce-43b4-aa19-b60945800ba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123bc10d0>]}
[0m16:43:12.169448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '661a463b-31ce-43b4-aa19-b60945800ba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120902d00>]}
[0m16:43:12.169888 [info ] [MainThread]: Found 7 models, 14 tests, 3 sources, 0 exposures, 0 metrics, 431 macros, 0 groups, 0 semantic models
[0m16:43:12.170142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '661a463b-31ce-43b4-aa19-b60945800ba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120902ca0>]}
[0m16:43:12.171645 [info ] [MainThread]: 
[0m16:43:12.172427 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:43:12.173255 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE'
[0m16:43:12.228608 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE'
[0m16:43:12.230399 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE"
[0m16:43:12.232017 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE"
[0m16:43:12.232299 [debug] [ThreadPool]: On list_E_COMMERCE: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE"} */
show terse schemas in database E_COMMERCE
    limit 10000
[0m16:43:12.232514 [debug] [ThreadPool]: On list_E_COMMERCE: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE"} */
show terse schemas in database E_COMMERCE
    limit 10000
[0m16:43:12.232707 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:43:12.232889 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:43:13.586308 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m16:43:13.592004 [debug] [ThreadPool]: On list_E_COMMERCE: Close
[0m16:43:13.598869 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m16:43:13.600534 [debug] [ThreadPool]: On list_E_COMMERCE: Close
[0m16:43:13.963179 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_E_COMMERCE, now list_E_COMMERCE_PUBLIC)
[0m16:43:13.966733 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_E_COMMERCE, now list_E_COMMERCE_staging)
[0m16:43:13.980316 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_intermediate'
[0m16:43:13.985532 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_staging"
[0m16:43:13.988025 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PUBLIC"
[0m16:43:13.990511 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_intermediate"
[0m16:43:13.990932 [debug] [ThreadPool]: On list_E_COMMERCE_staging: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE_staging"} */
show terse objects in E_COMMERCE.staging limit 10000
[0m16:43:13.991307 [debug] [ThreadPool]: On list_E_COMMERCE_PUBLIC: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE_PUBLIC"} */
show terse objects in E_COMMERCE.PUBLIC limit 10000
[0m16:43:13.991660 [debug] [ThreadPool]: On list_E_COMMERCE_intermediate: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE_intermediate"} */
show terse objects in E_COMMERCE.intermediate limit 10000
[0m16:43:13.992021 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:43:13.992369 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:43:13.992678 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:43:15.074655 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m16:43:15.080878 [debug] [ThreadPool]: On list_E_COMMERCE_staging: Close
[0m16:43:15.138547 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m16:43:15.141682 [debug] [ThreadPool]: On list_E_COMMERCE_intermediate: Close
[0m16:43:15.289651 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b0754f-0001-8184-0004-d8be000101de
[0m16:43:15.290029 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m16:43:15.290382 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m16:43:15.290632 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m16:43:15.290934 [debug] [ThreadPool]: On list_E_COMMERCE_PUBLIC: Close
[0m16:43:15.642778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '661a463b-31ce-43b4-aa19-b60945800ba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120209730>]}
[0m16:43:15.644899 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m16:43:15.645779 [info ] [MainThread]: 
[0m16:43:15.650654 [debug] [Thread-1  ]: Began running node model.billy_bulky.staging_shopify__customers
[0m16:43:15.651529 [debug] [Thread-2  ]: Began running node model.billy_bulky.staging_shopify__orders
[0m16:43:15.652256 [debug] [Thread-3  ]: Began running node model.billy_bulky.staging_shopify__products
[0m16:43:15.653093 [info ] [Thread-1  ]: 1 of 4 START sql view model staging.staging_shopify__customers ................. [RUN]
[0m16:43:15.654023 [info ] [Thread-2  ]: 2 of 4 START sql view model staging.staging_shopify__orders .................... [RUN]
[0m16:43:15.656710 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_E_COMMERCE_PUBLIC, now model.billy_bulky.staging_shopify__customers)
[0m16:43:15.655097 [info ] [Thread-3  ]: 3 of 4 START sql view model staging.staging_shopify__products .................. [RUN]
[0m16:43:15.658461 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_E_COMMERCE_staging, now model.billy_bulky.staging_shopify__orders)
[0m16:43:15.659118 [debug] [Thread-1  ]: Began compiling node model.billy_bulky.staging_shopify__customers
[0m16:43:15.660115 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly list_E_COMMERCE_intermediate, now model.billy_bulky.staging_shopify__products)
[0m16:43:15.660682 [debug] [Thread-2  ]: Began compiling node model.billy_bulky.staging_shopify__orders
[0m16:43:15.671956 [debug] [Thread-1  ]: Writing injected SQL for node "model.billy_bulky.staging_shopify__customers"
[0m16:43:15.672491 [debug] [Thread-3  ]: Began compiling node model.billy_bulky.staging_shopify__products
[0m16:43:15.677987 [debug] [Thread-2  ]: Writing injected SQL for node "model.billy_bulky.staging_shopify__orders"
[0m16:43:15.681504 [debug] [Thread-3  ]: Writing injected SQL for node "model.billy_bulky.staging_shopify__products"
[0m16:43:15.682274 [debug] [Thread-1  ]: Timing info for model.billy_bulky.staging_shopify__customers (compile): 16:43:15.661054 => 16:43:15.682015
[0m16:43:15.682752 [debug] [Thread-1  ]: Began executing node model.billy_bulky.staging_shopify__customers
[0m16:43:15.689701 [debug] [Thread-2  ]: Timing info for model.billy_bulky.staging_shopify__orders (compile): 16:43:15.672829 => 16:43:15.689363
[0m16:43:15.696530 [debug] [Thread-3  ]: Timing info for model.billy_bulky.staging_shopify__products (compile): 16:43:15.678491 => 16:43:15.696280
[0m16:43:15.703347 [debug] [Thread-2  ]: Began executing node model.billy_bulky.staging_shopify__orders
[0m16:43:15.710466 [debug] [Thread-1  ]: Writing runtime sql for node "model.billy_bulky.staging_shopify__customers"
[0m16:43:15.710871 [debug] [Thread-3  ]: Began executing node model.billy_bulky.staging_shopify__products
[0m16:43:15.713348 [debug] [Thread-2  ]: Writing runtime sql for node "model.billy_bulky.staging_shopify__orders"
[0m16:43:15.715715 [debug] [Thread-3  ]: Writing runtime sql for node "model.billy_bulky.staging_shopify__products"
[0m16:43:15.716502 [debug] [Thread-2  ]: Using snowflake connection "model.billy_bulky.staging_shopify__orders"
[0m16:43:15.717054 [debug] [Thread-1  ]: Using snowflake connection "model.billy_bulky.staging_shopify__customers"
[0m16:43:15.717378 [debug] [Thread-2  ]: On model.billy_bulky.staging_shopify__orders: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.staging_shopify__orders"} */
create or replace   view E_COMMERCE.staging.staging_shopify__orders
  
   as (
    WITH orders AS (
    SELECT * FROM SHOPIFY.PUBLIC.orders
)

SELECT
    ORDER_ID
    , CUSTOMER_ID
    , PRODUCT_ID
    , QUANTITY
    , ORDER_DATE
    , STATUS
FROM orders
  );
[0m16:43:15.717711 [debug] [Thread-1  ]: On model.billy_bulky.staging_shopify__customers: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.staging_shopify__customers"} */
create or replace   view E_COMMERCE.staging.staging_shopify__customers
  
   as (
    WITH customers AS (
    SELECT * FROM SHOPIFY.PUBLIC.customers
)

SELECT
    CUSTOMER_ID
    , FIRST_NAME
    , LAST_NAME
    , EMAIL
    , JOIN_DATE
    , COUNTRY
FROM customers
  );
[0m16:43:15.718243 [debug] [Thread-3  ]: Using snowflake connection "model.billy_bulky.staging_shopify__products"
[0m16:43:15.718512 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m16:43:15.718776 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:43:15.719069 [debug] [Thread-3  ]: On model.billy_bulky.staging_shopify__products: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.staging_shopify__products"} */
create or replace   view E_COMMERCE.staging.staging_shopify__products
  
   as (
    WITH products AS (
    SELECT * FROM SHOPIFY.PUBLIC.products
)

SELECT
    PRODUCT_ID
    , NAME
    , CATEGORY
    , PRICE
    , STOCK_LEVEL
FROM products
  );
[0m16:43:15.720084 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m16:43:17.274604 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m16:43:17.306768 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m16:43:17.313885 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m16:43:17.319349 [debug] [Thread-1  ]: Timing info for model.billy_bulky.staging_shopify__customers (execute): 16:43:15.683069 => 16:43:17.319097
[0m16:43:17.320990 [debug] [Thread-3  ]: Timing info for model.billy_bulky.staging_shopify__products (execute): 16:43:15.713602 => 16:43:17.320762
[0m16:43:17.323395 [debug] [Thread-2  ]: Timing info for model.billy_bulky.staging_shopify__orders (execute): 16:43:15.711071 => 16:43:17.323177
[0m16:43:17.323864 [debug] [Thread-1  ]: On model.billy_bulky.staging_shopify__customers: Close
[0m16:43:17.324273 [debug] [Thread-3  ]: On model.billy_bulky.staging_shopify__products: Close
[0m16:43:17.324644 [debug] [Thread-2  ]: On model.billy_bulky.staging_shopify__orders: Close
[0m16:43:17.792126 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '661a463b-31ce-43b4-aa19-b60945800ba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1202a1dc0>]}
[0m16:43:17.794145 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '661a463b-31ce-43b4-aa19-b60945800ba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123ad4ca0>]}
[0m16:43:17.795414 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '661a463b-31ce-43b4-aa19-b60945800ba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1301c82b0>]}
[0m16:43:17.796457 [info ] [Thread-2  ]: 2 of 4 OK created sql view model staging.staging_shopify__orders ............... [[32mSUCCESS 1[0m in 2.13s]
[0m16:43:17.797695 [info ] [Thread-3  ]: 3 of 4 OK created sql view model staging.staging_shopify__products ............. [[32mSUCCESS 1[0m in 2.13s]
[0m16:43:17.798701 [info ] [Thread-1  ]: 1 of 4 OK created sql view model staging.staging_shopify__customers ............ [[32mSUCCESS 1[0m in 2.14s]
[0m16:43:17.799759 [debug] [Thread-2  ]: Finished running node model.billy_bulky.staging_shopify__orders
[0m16:43:17.800664 [debug] [Thread-3  ]: Finished running node model.billy_bulky.staging_shopify__products
[0m16:43:17.801536 [debug] [Thread-1  ]: Finished running node model.billy_bulky.staging_shopify__customers
[0m16:43:17.803141 [debug] [Thread-5  ]: Began running node model.billy_bulky.int_customers_segmentation
[0m16:43:17.804128 [info ] [Thread-5  ]: 4 of 4 START sql table model intermediate.int_customers_segmentation ........... [RUN]
[0m16:43:17.805635 [debug] [Thread-5  ]: Acquiring new snowflake connection 'model.billy_bulky.int_customers_segmentation'
[0m16:43:17.806275 [debug] [Thread-5  ]: Began compiling node model.billy_bulky.int_customers_segmentation
[0m16:43:17.811902 [debug] [Thread-5  ]: Writing injected SQL for node "model.billy_bulky.int_customers_segmentation"
[0m16:43:17.814026 [debug] [Thread-5  ]: Timing info for model.billy_bulky.int_customers_segmentation (compile): 16:43:17.806623 => 16:43:17.813626
[0m16:43:17.814631 [debug] [Thread-5  ]: Began executing node model.billy_bulky.int_customers_segmentation
[0m16:43:17.840290 [debug] [Thread-5  ]: Writing runtime sql for node "model.billy_bulky.int_customers_segmentation"
[0m16:43:17.843048 [debug] [Thread-5  ]: Using snowflake connection "model.billy_bulky.int_customers_segmentation"
[0m16:43:17.843532 [debug] [Thread-5  ]: On model.billy_bulky.int_customers_segmentation: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.int_customers_segmentation"} */
create or replace transient table E_COMMERCE.intermediate.int_customers_segmentation
         as
        (WITH customers AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__customers
)

, orders AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__orders
)

, products AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__products
)


, order_aggregates AS (
    SELECT
        CUSTOMER_ID,
        COUNT(DISTINCT ORDER_ID) AS frequency,
        SUM(QUANTITY * p.PRICE) AS monetary,
        AVG(QUANTITY * p.PRICE) AS average_order_value,
        MAX(ORDER_DATE) AS last_purchase_date
    FROM orders o
    JOIN products p ON o.PRODUCT_ID = p.PRODUCT_ID
    WHERE o.STATUS NOT IN ('cancelled') 
    GROUP BY CUSTOMER_ID
)

, customer_tenure AS (
    SELECT
        CUSTOMER_ID,
        JOIN_DATE,
        CURRENT_DATE - JOIN_DATE AS tenure
    FROM CUSTOMERS
)

, customer_recency AS (
    SELECT
        CUSTOMER_ID,
        CURRENT_DATE - last_purchase_date AS recency
    FROM order_aggregates
)

, final AS (
    SELECT
    c.CUSTOMER_ID,
    c.FIRST_NAME,
    c.LAST_NAME,
    c.EMAIL,
    c.JOIN_DATE,
    c.COUNTRY,
    o.frequency,
    o.monetary,
    o.average_order_value,
    r.recency,
    t.tenure
FROM customer_tenure t
JOIN CUSTOMERS c ON t.CUSTOMER_ID = c.CUSTOMER_ID
JOIN order_aggregates o ON c.CUSTOMER_ID = o.CUSTOMER_ID
JOIN customer_recency r ON c.CUSTOMER_ID = r.CUSTOMER_ID
)

SELECT * FROM final
        );
[0m16:43:17.843975 [debug] [Thread-5  ]: Opening a new connection, currently in state init
[0m16:43:23.108446 [debug] [Thread-5  ]: SQL status: SUCCESS 1 in 5.0 seconds
[0m16:43:23.112641 [debug] [Thread-5  ]: Timing info for model.billy_bulky.int_customers_segmentation (execute): 16:43:17.814969 => 16:43:23.112247
[0m16:43:23.113377 [debug] [Thread-5  ]: On model.billy_bulky.int_customers_segmentation: Close
[0m16:43:23.526300 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '661a463b-31ce-43b4-aa19-b60945800ba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130513880>]}
[0m16:43:23.527812 [info ] [Thread-5  ]: 4 of 4 OK created sql table model intermediate.int_customers_segmentation ...... [[32mSUCCESS 1[0m in 5.72s]
[0m16:43:23.528878 [debug] [Thread-5  ]: Finished running node model.billy_bulky.int_customers_segmentation
[0m16:43:23.531709 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:43:23.532269 [debug] [MainThread]: Connection 'model.billy_bulky.staging_shopify__customers' was properly closed.
[0m16:43:23.532769 [debug] [MainThread]: Connection 'model.billy_bulky.staging_shopify__orders' was properly closed.
[0m16:43:23.533252 [debug] [MainThread]: Connection 'model.billy_bulky.staging_shopify__products' was properly closed.
[0m16:43:23.533778 [debug] [MainThread]: Connection 'model.billy_bulky.int_customers_segmentation' was properly closed.
[0m16:43:23.534369 [info ] [MainThread]: 
[0m16:43:23.534940 [info ] [MainThread]: Finished running 3 view models, 1 table model in 0 hours 0 minutes and 11.36 seconds (11.36s).
[0m16:43:23.536658 [debug] [MainThread]: Command end result
[0m16:43:23.552791 [info ] [MainThread]: 
[0m16:43:23.553350 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:43:23.553770 [info ] [MainThread]: 
[0m16:43:23.554206 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m16:43:23.558185 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.574284, "process_user_time": 4.744121, "process_kernel_time": 0.787353, "process_mem_max_rss": "219103232", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:43:23.558860 [debug] [MainThread]: Command `dbt run` succeeded at 16:43:23.558723 after 12.58 seconds
[0m16:43:23.559369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106aa90d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123ae2640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1202c3040>]}
[0m16:43:23.559825 [debug] [MainThread]: Flushing usage events
[0m16:54:55.247877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102efe4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1029ef8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10574c4f0>]}


============================== 16:54:55.250784 | 986bb2ad-dea4-4e03-b41b-60bf454f4544 ==============================
[0m16:54:55.250784 [info ] [MainThread]: Running with dbt=1.7.1
[0m16:54:55.251187 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/bitlevi/Desktop/dbt_project/billy_bulky/logs', 'version_check': 'True', 'profiles_dir': '/Users/bitlevi/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:54:56.126453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '986bb2ad-dea4-4e03-b41b-60bf454f4544', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1029ef8e0>]}
[0m16:54:56.177334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '986bb2ad-dea4-4e03-b41b-60bf454f4544', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126c1cc10>]}
[0m16:54:56.180169 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m16:54:56.194032 [debug] [MainThread]: checksum: ad428e6dc3b353dcb23d0c4ebea8b20b180e94b873271ac2a054a8e446dac0e2, vars: {}, profile: , target: , version: 1.7.1
[0m16:54:56.229306 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:54:56.229834 [debug] [MainThread]: Partial parsing: updated file: billy_bulky://models/intermediate/customers/int_customers_segmentation.sql
[0m16:54:56.312317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '986bb2ad-dea4-4e03-b41b-60bf454f4544', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127b02f10>]}
[0m16:54:56.319649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '986bb2ad-dea4-4e03-b41b-60bf454f4544', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127416df0>]}
[0m16:54:56.319958 [info ] [MainThread]: Found 7 models, 14 tests, 3 sources, 0 exposures, 0 metrics, 431 macros, 0 groups, 0 semantic models
[0m16:54:56.320191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '986bb2ad-dea4-4e03-b41b-60bf454f4544', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127416cd0>]}
[0m16:54:56.321282 [info ] [MainThread]: 
[0m16:54:56.321797 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:54:56.322619 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE'
[0m16:54:56.331566 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE"
[0m16:54:56.332092 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE'
[0m16:54:56.332295 [debug] [ThreadPool]: On list_E_COMMERCE: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE"} */
show terse schemas in database E_COMMERCE
    limit 10000
[0m16:54:56.333752 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE"
[0m16:54:56.333961 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:54:56.334152 [debug] [ThreadPool]: On list_E_COMMERCE: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE"} */
show terse schemas in database E_COMMERCE
    limit 10000
[0m16:54:56.335109 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:54:57.843195 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.0 seconds
[0m16:54:57.846004 [debug] [ThreadPool]: On list_E_COMMERCE: Close
[0m16:54:57.856831 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.0 seconds
[0m16:54:57.859153 [debug] [ThreadPool]: On list_E_COMMERCE: Close
[0m16:54:58.233711 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_E_COMMERCE, now list_E_COMMERCE_staging)
[0m16:54:58.235254 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_E_COMMERCE, now list_E_COMMERCE_intermediate)
[0m16:54:58.237756 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PUBLIC'
[0m16:54:58.250142 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_staging"
[0m16:54:58.253382 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_intermediate"
[0m16:54:58.256191 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PUBLIC"
[0m16:54:58.256648 [debug] [ThreadPool]: On list_E_COMMERCE_staging: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE_staging"} */
show terse objects in E_COMMERCE.staging limit 10000
[0m16:54:58.257076 [debug] [ThreadPool]: On list_E_COMMERCE_intermediate: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE_intermediate"} */
show terse objects in E_COMMERCE.intermediate limit 10000
[0m16:54:58.257477 [debug] [ThreadPool]: On list_E_COMMERCE_PUBLIC: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE_PUBLIC"} */
show terse objects in E_COMMERCE.PUBLIC limit 10000
[0m16:54:58.257861 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:54:58.258220 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:54:58.258569 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:54:59.425986 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:54:59.427241 [debug] [ThreadPool]: On list_E_COMMERCE_intermediate: Close
[0m16:54:59.543955 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b0755a-0001-831c-0004-d8be00013212
[0m16:54:59.544401 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m16:54:59.544810 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m16:54:59.545120 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m16:54:59.545475 [debug] [ThreadPool]: On list_E_COMMERCE_PUBLIC: Close
[0m16:54:59.554626 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m16:54:59.556101 [debug] [ThreadPool]: On list_E_COMMERCE_staging: Close
[0m16:54:59.967413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '986bb2ad-dea4-4e03-b41b-60bf454f4544', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127b1d580>]}
[0m16:54:59.968816 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m16:54:59.969451 [info ] [MainThread]: 
[0m16:54:59.973468 [debug] [Thread-1  ]: Began running node model.billy_bulky.staging_shopify__customers
[0m16:54:59.974292 [debug] [Thread-2  ]: Began running node model.billy_bulky.staging_shopify__orders
[0m16:54:59.975789 [debug] [Thread-3  ]: Began running node model.billy_bulky.staging_shopify__products
[0m16:54:59.975175 [info ] [Thread-1  ]: 1 of 4 START sql view model staging.staging_shopify__customers ................. [RUN]
[0m16:54:59.977626 [info ] [Thread-2  ]: 2 of 4 START sql view model staging.staging_shopify__orders .................... [RUN]
[0m16:54:59.978766 [info ] [Thread-3  ]: 3 of 4 START sql view model staging.staging_shopify__products .................. [RUN]
[0m16:54:59.979987 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_E_COMMERCE_staging, now model.billy_bulky.staging_shopify__customers)
[0m16:54:59.980972 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_E_COMMERCE_intermediate, now model.billy_bulky.staging_shopify__orders)
[0m16:54:59.981929 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly list_E_COMMERCE_PUBLIC, now model.billy_bulky.staging_shopify__products)
[0m16:54:59.982606 [debug] [Thread-1  ]: Began compiling node model.billy_bulky.staging_shopify__customers
[0m16:54:59.983254 [debug] [Thread-2  ]: Began compiling node model.billy_bulky.staging_shopify__orders
[0m16:54:59.983813 [debug] [Thread-3  ]: Began compiling node model.billy_bulky.staging_shopify__products
[0m16:54:59.994593 [debug] [Thread-1  ]: Writing injected SQL for node "model.billy_bulky.staging_shopify__customers"
[0m16:54:59.998229 [debug] [Thread-2  ]: Writing injected SQL for node "model.billy_bulky.staging_shopify__orders"
[0m16:55:00.001270 [debug] [Thread-3  ]: Writing injected SQL for node "model.billy_bulky.staging_shopify__products"
[0m16:55:00.002645 [debug] [Thread-2  ]: Timing info for model.billy_bulky.staging_shopify__orders (compile): 16:54:59.994972 => 16:55:00.002324
[0m16:55:00.003200 [debug] [Thread-1  ]: Timing info for model.billy_bulky.staging_shopify__customers (compile): 16:54:59.984164 => 16:55:00.002930
[0m16:55:00.003670 [debug] [Thread-3  ]: Timing info for model.billy_bulky.staging_shopify__products (compile): 16:54:59.998532 => 16:55:00.003446
[0m16:55:00.004122 [debug] [Thread-2  ]: Began executing node model.billy_bulky.staging_shopify__orders
[0m16:55:00.004537 [debug] [Thread-1  ]: Began executing node model.billy_bulky.staging_shopify__customers
[0m16:55:00.004943 [debug] [Thread-3  ]: Began executing node model.billy_bulky.staging_shopify__products
[0m16:55:00.048448 [debug] [Thread-2  ]: Writing runtime sql for node "model.billy_bulky.staging_shopify__orders"
[0m16:55:00.048933 [debug] [Thread-1  ]: Writing runtime sql for node "model.billy_bulky.staging_shopify__customers"
[0m16:55:00.045624 [debug] [Thread-3  ]: Writing runtime sql for node "model.billy_bulky.staging_shopify__products"
[0m16:55:00.049846 [debug] [Thread-1  ]: Using snowflake connection "model.billy_bulky.staging_shopify__customers"
[0m16:55:00.050351 [debug] [Thread-3  ]: Using snowflake connection "model.billy_bulky.staging_shopify__products"
[0m16:55:00.050624 [debug] [Thread-1  ]: On model.billy_bulky.staging_shopify__customers: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.staging_shopify__customers"} */
create or replace   view E_COMMERCE.staging.staging_shopify__customers
  
   as (
    WITH customers AS (
    SELECT * FROM SHOPIFY.PUBLIC.customers
)

SELECT
    CUSTOMER_ID
    , FIRST_NAME
    , LAST_NAME
    , EMAIL
    , JOIN_DATE
    , COUNTRY
FROM customers
  );
[0m16:55:00.051108 [debug] [Thread-2  ]: Using snowflake connection "model.billy_bulky.staging_shopify__orders"
[0m16:55:00.051374 [debug] [Thread-3  ]: On model.billy_bulky.staging_shopify__products: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.staging_shopify__products"} */
create or replace   view E_COMMERCE.staging.staging_shopify__products
  
   as (
    WITH products AS (
    SELECT * FROM SHOPIFY.PUBLIC.products
)

SELECT
    PRODUCT_ID
    , NAME
    , CATEGORY
    , PRICE
    , STOCK_LEVEL
FROM products
  );
[0m16:55:00.051629 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:55:00.051881 [debug] [Thread-2  ]: On model.billy_bulky.staging_shopify__orders: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.staging_shopify__orders"} */
create or replace   view E_COMMERCE.staging.staging_shopify__orders
  
   as (
    WITH orders AS (
    SELECT * FROM SHOPIFY.PUBLIC.orders
)

SELECT
    ORDER_ID
    , CUSTOMER_ID
    , PRODUCT_ID
    , QUANTITY
    , ORDER_DATE
    , STATUS
FROM orders
  );
[0m16:55:00.052125 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m16:55:00.052771 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m16:55:01.453865 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:55:01.486448 [debug] [Thread-3  ]: Timing info for model.billy_bulky.staging_shopify__products (execute): 16:55:00.039880 => 16:55:01.486180
[0m16:55:01.486975 [debug] [Thread-3  ]: On model.billy_bulky.staging_shopify__products: Close
[0m16:55:01.497811 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:55:01.500574 [debug] [Thread-2  ]: Timing info for model.billy_bulky.staging_shopify__orders (execute): 16:55:00.005194 => 16:55:01.500336
[0m16:55:01.501025 [debug] [Thread-2  ]: On model.billy_bulky.staging_shopify__orders: Close
[0m16:55:01.502950 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:55:01.505254 [debug] [Thread-1  ]: Timing info for model.billy_bulky.staging_shopify__customers (execute): 16:55:00.015365 => 16:55:01.505039
[0m16:55:01.505684 [debug] [Thread-1  ]: On model.billy_bulky.staging_shopify__customers: Close
[0m16:55:01.852510 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '986bb2ad-dea4-4e03-b41b-60bf454f4544', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126bfa3d0>]}
[0m16:55:01.853563 [info ] [Thread-3  ]: 3 of 4 OK created sql view model staging.staging_shopify__products ............. [[32mSUCCESS 1[0m in 1.87s]
[0m16:55:01.854461 [debug] [Thread-3  ]: Finished running node model.billy_bulky.staging_shopify__products
[0m16:55:01.894867 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '986bb2ad-dea4-4e03-b41b-60bf454f4544', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127416cd0>]}
[0m16:55:01.895667 [info ] [Thread-1  ]: 1 of 4 OK created sql view model staging.staging_shopify__customers ............ [[32mSUCCESS 1[0m in 1.92s]
[0m16:55:01.896465 [debug] [Thread-1  ]: Finished running node model.billy_bulky.staging_shopify__customers
[0m16:55:01.897927 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '986bb2ad-dea4-4e03-b41b-60bf454f4544', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127af85e0>]}
[0m16:55:01.898556 [info ] [Thread-2  ]: 2 of 4 OK created sql view model staging.staging_shopify__orders ............... [[32mSUCCESS 1[0m in 1.92s]
[0m16:55:01.899112 [debug] [Thread-2  ]: Finished running node model.billy_bulky.staging_shopify__orders
[0m16:55:01.899764 [debug] [Thread-5  ]: Began running node model.billy_bulky.int_customers_segmentation
[0m16:55:01.900256 [info ] [Thread-5  ]: 4 of 4 START sql table model intermediate.int_customers_segmentation ........... [RUN]
[0m16:55:01.900980 [debug] [Thread-5  ]: Acquiring new snowflake connection 'model.billy_bulky.int_customers_segmentation'
[0m16:55:01.901340 [debug] [Thread-5  ]: Began compiling node model.billy_bulky.int_customers_segmentation
[0m16:55:01.905886 [debug] [Thread-5  ]: Writing injected SQL for node "model.billy_bulky.int_customers_segmentation"
[0m16:55:01.907624 [debug] [Thread-5  ]: Timing info for model.billy_bulky.int_customers_segmentation (compile): 16:55:01.901561 => 16:55:01.907376
[0m16:55:01.908018 [debug] [Thread-5  ]: Began executing node model.billy_bulky.int_customers_segmentation
[0m16:55:01.926609 [debug] [Thread-5  ]: Writing runtime sql for node "model.billy_bulky.int_customers_segmentation"
[0m16:55:01.928757 [debug] [Thread-5  ]: Using snowflake connection "model.billy_bulky.int_customers_segmentation"
[0m16:55:01.929132 [debug] [Thread-5  ]: On model.billy_bulky.int_customers_segmentation: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.int_customers_segmentation"} */
create or replace transient table E_COMMERCE.intermediate.int_customers_segmentation
         as
        (WITH customers AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__customers
)

, orders AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__orders
)

, products AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__products
)

, order_aggregates AS (
    SELECT
        o.CUSTOMER_ID
        , COUNT(DISTINCT o.ORDER_ID) AS frequency
        , SUM(o.QUANTITY * p.PRICE) AS monetary
        , AVG(o.QUANTITY * p.PRICE) AS average_order_value
        , MAX(o.ORDER_DATE) AS last_purchase_date
        , COUNT(CASE WHEN o.STATUS = 'cancelled' THEN 1 END) AS cancelled_orders
        , COUNT(*) AS total_orders
    FROM orders o
    JOIN products p ON o.PRODUCT_ID = p.PRODUCT_ID
    GROUP BY o.CUSTOMER_ID
)

, customer_tenure AS (
    SELECT
        CUSTOMER_ID
        , JOIN_DATE
        , CURRENT_DATE - JOIN_DATE AS tenure
    FROM customers
)

, customer_recency AS (
    SELECT
        CUSTOMER_ID
        , CURRENT_DATE - last_purchase_date AS recency
    FROM order_aggregates
)

, final AS (
    SELECT
        c.CUSTOMER_ID
        , c.FIRST_NAME
        , c.LAST_NAME
        , c.EMAIL
        , c.JOIN_DATE
        , c.COUNTRY
        , o.frequency
        , o.monetary
        , o.average_order_value
        , o.cancelled_orders
        , o.total_orders
        , CASE 
            WHEN o.total_orders > 0 THEN ROUND((o.cancelled_orders::FLOAT / o.total_orders) * 100, 2) 
            ELSE 0 
          END AS cancellation_rate
        , r.recency
        , t.tenure
    FROM customer_tenure t
    JOIN customers c ON t.CUSTOMER_ID = c.CUSTOMER_ID
    JOIN order_aggregates o ON c.CUSTOMER_ID = o.CUSTOMER_ID
    JOIN customer_recency r ON c.CUSTOMER_ID = r.CUSTOMER_ID
)

SELECT * FROM final
        );
[0m16:55:01.929479 [debug] [Thread-5  ]: Opening a new connection, currently in state init
[0m16:55:04.976448 [debug] [Thread-5  ]: SQL status: SUCCESS 1 in 3.0 seconds
[0m16:55:04.981971 [debug] [Thread-5  ]: Timing info for model.billy_bulky.int_customers_segmentation (execute): 16:55:01.908237 => 16:55:04.981610
[0m16:55:04.982704 [debug] [Thread-5  ]: On model.billy_bulky.int_customers_segmentation: Close
[0m16:55:05.385835 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '986bb2ad-dea4-4e03-b41b-60bf454f4544', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130be6910>]}
[0m16:55:05.386947 [info ] [Thread-5  ]: 4 of 4 OK created sql table model intermediate.int_customers_segmentation ...... [[32mSUCCESS 1[0m in 3.48s]
[0m16:55:05.388128 [debug] [Thread-5  ]: Finished running node model.billy_bulky.int_customers_segmentation
[0m16:55:05.391361 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:55:05.392083 [debug] [MainThread]: Connection 'model.billy_bulky.staging_shopify__customers' was properly closed.
[0m16:55:05.392470 [debug] [MainThread]: Connection 'model.billy_bulky.staging_shopify__orders' was properly closed.
[0m16:55:05.392832 [debug] [MainThread]: Connection 'model.billy_bulky.staging_shopify__products' was properly closed.
[0m16:55:05.393182 [debug] [MainThread]: Connection 'model.billy_bulky.int_customers_segmentation' was properly closed.
[0m16:55:05.393670 [info ] [MainThread]: 
[0m16:55:05.394107 [info ] [MainThread]: Finished running 3 view models, 1 table model in 0 hours 0 minutes and 9.07 seconds (9.07s).
[0m16:55:05.395363 [debug] [MainThread]: Command end result
[0m16:55:05.408474 [info ] [MainThread]: 
[0m16:55:05.408981 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:55:05.409210 [info ] [MainThread]: 
[0m16:55:05.410027 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m16:55:05.415097 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.203373, "process_user_time": 4.878198, "process_kernel_time": 0.465695, "process_mem_max_rss": "206618624", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:55:05.415822 [debug] [MainThread]: Command `dbt run` succeeded at 16:55:05.415629 after 10.20 seconds
[0m16:55:05.416276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102efe4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130c19bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1029ef8e0>]}
[0m16:55:05.416685 [debug] [MainThread]: Flushing usage events
[0m17:16:48.295901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054650d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1107f8fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108153a0>]}


============================== 17:16:48.300525 | 68357855-0400-498f-a8c1-dcca6ece4612 ==============================
[0m17:16:48.300525 [info ] [MainThread]: Running with dbt=1.7.1
[0m17:16:48.300882 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/bitlevi/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/bitlevi/Documents/billy_bulky_ecommerce/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:16:49.131039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '68357855-0400-498f-a8c1-dcca6ece4612', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12760a610>]}
[0m17:16:49.178960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '68357855-0400-498f-a8c1-dcca6ece4612', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12767a2b0>]}
[0m17:16:49.179563 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m17:16:49.192867 [debug] [MainThread]: checksum: ad428e6dc3b353dcb23d0c4ebea8b20b180e94b873271ac2a054a8e446dac0e2, vars: {}, profile: , target: , version: 1.7.1
[0m17:16:49.224755 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:16:49.225055 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:16:49.229854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '68357855-0400-498f-a8c1-dcca6ece4612', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127f1a0d0>]}
[0m17:16:49.239127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '68357855-0400-498f-a8c1-dcca6ece4612', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127e16f40>]}
[0m17:16:49.239486 [info ] [MainThread]: Found 7 models, 14 tests, 3 sources, 0 exposures, 0 metrics, 431 macros, 0 groups, 0 semantic models
[0m17:16:49.239718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '68357855-0400-498f-a8c1-dcca6ece4612', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127e16e80>]}
[0m17:16:49.240911 [info ] [MainThread]: 
[0m17:16:49.241425 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:16:49.242172 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE'
[0m17:16:49.242668 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE'
[0m17:16:49.251199 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE"
[0m17:16:49.252614 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE"
[0m17:16:49.252844 [debug] [ThreadPool]: On list_E_COMMERCE: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE"} */
show terse schemas in database E_COMMERCE
    limit 10000
[0m17:16:49.253059 [debug] [ThreadPool]: On list_E_COMMERCE: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE"} */
show terse schemas in database E_COMMERCE
    limit 10000
[0m17:16:49.253257 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:16:49.253429 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:16:50.726237 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m17:16:50.731206 [debug] [ThreadPool]: On list_E_COMMERCE: Close
[0m17:16:52.651829 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 3.0 seconds
[0m17:16:52.656366 [debug] [ThreadPool]: On list_E_COMMERCE: Close
[0m17:16:53.068600 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_E_COMMERCE, now list_E_COMMERCE_staging)
[0m17:16:53.071356 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_E_COMMERCE, now list_E_COMMERCE_intermediate)
[0m17:16:53.094262 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_staging"
[0m17:16:53.095263 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_intermediate"
[0m17:16:53.096137 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PUBLIC'
[0m17:16:53.096567 [debug] [ThreadPool]: On list_E_COMMERCE_staging: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE_staging"} */
show terse objects in E_COMMERCE.staging limit 10000
[0m17:16:53.097054 [debug] [ThreadPool]: On list_E_COMMERCE_intermediate: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE_intermediate"} */
show terse objects in E_COMMERCE.intermediate limit 10000
[0m17:16:53.100059 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PUBLIC"
[0m17:16:53.100485 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:16:53.100835 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:16:53.101179 [debug] [ThreadPool]: On list_E_COMMERCE_PUBLIC: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE_PUBLIC"} */
show terse objects in E_COMMERCE.PUBLIC limit 10000
[0m17:16:53.103602 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:16:54.313557 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m17:16:54.316333 [debug] [ThreadPool]: On list_E_COMMERCE_intermediate: Close
[0m17:16:54.360332 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m17:16:54.361633 [debug] [ThreadPool]: On list_E_COMMERCE_staging: Close
[0m17:16:54.367303 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b07570-0001-815a-0000-0004d8bed28d
[0m17:16:54.367599 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m17:16:54.367933 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m17:16:54.368198 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:16:54.368484 [debug] [ThreadPool]: On list_E_COMMERCE_PUBLIC: Close
[0m17:16:54.915060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '68357855-0400-498f-a8c1-dcca6ece4612', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127c9d190>]}
[0m17:16:54.916451 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m17:16:54.917064 [info ] [MainThread]: 
[0m17:16:54.921985 [debug] [Thread-1  ]: Began running node model.billy_bulky.staging_shopify__customers
[0m17:16:54.922785 [debug] [Thread-2  ]: Began running node model.billy_bulky.staging_shopify__orders
[0m17:16:54.923459 [debug] [Thread-3  ]: Began running node model.billy_bulky.staging_shopify__products
[0m17:16:54.925126 [info ] [Thread-1  ]: 1 of 4 START sql view model staging.staging_shopify__customers ................. [RUN]
[0m17:16:54.926033 [info ] [Thread-2  ]: 2 of 4 START sql view model staging.staging_shopify__orders .................... [RUN]
[0m17:16:54.926837 [info ] [Thread-3  ]: 3 of 4 START sql view model staging.staging_shopify__products .................. [RUN]
[0m17:16:54.928008 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_E_COMMERCE_staging, now model.billy_bulky.staging_shopify__customers)
[0m17:16:54.928991 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_E_COMMERCE_intermediate, now model.billy_bulky.staging_shopify__orders)
[0m17:16:54.929912 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly list_E_COMMERCE_PUBLIC, now model.billy_bulky.staging_shopify__products)
[0m17:16:54.930508 [debug] [Thread-1  ]: Began compiling node model.billy_bulky.staging_shopify__customers
[0m17:16:54.931041 [debug] [Thread-2  ]: Began compiling node model.billy_bulky.staging_shopify__orders
[0m17:16:54.931552 [debug] [Thread-3  ]: Began compiling node model.billy_bulky.staging_shopify__products
[0m17:16:54.942239 [debug] [Thread-1  ]: Writing injected SQL for node "model.billy_bulky.staging_shopify__customers"
[0m17:16:54.946040 [debug] [Thread-2  ]: Writing injected SQL for node "model.billy_bulky.staging_shopify__orders"
[0m17:16:54.950796 [debug] [Thread-3  ]: Writing injected SQL for node "model.billy_bulky.staging_shopify__products"
[0m17:16:54.952109 [debug] [Thread-2  ]: Timing info for model.billy_bulky.staging_shopify__orders (compile): 17:16:54.942623 => 17:16:54.951812
[0m17:16:54.952655 [debug] [Thread-3  ]: Timing info for model.billy_bulky.staging_shopify__products (compile): 17:16:54.946562 => 17:16:54.952384
[0m17:16:54.953098 [debug] [Thread-2  ]: Began executing node model.billy_bulky.staging_shopify__orders
[0m17:16:54.953616 [debug] [Thread-1  ]: Timing info for model.billy_bulky.staging_shopify__customers (compile): 17:16:54.931879 => 17:16:54.953372
[0m17:16:54.953987 [debug] [Thread-3  ]: Began executing node model.billy_bulky.staging_shopify__products
[0m17:16:54.978573 [debug] [Thread-2  ]: Writing runtime sql for node "model.billy_bulky.staging_shopify__orders"
[0m17:16:54.978951 [debug] [Thread-1  ]: Began executing node model.billy_bulky.staging_shopify__customers
[0m17:16:54.981318 [debug] [Thread-3  ]: Writing runtime sql for node "model.billy_bulky.staging_shopify__products"
[0m17:16:54.983702 [debug] [Thread-1  ]: Writing runtime sql for node "model.billy_bulky.staging_shopify__customers"
[0m17:16:54.984511 [debug] [Thread-2  ]: Using snowflake connection "model.billy_bulky.staging_shopify__orders"
[0m17:16:54.985057 [debug] [Thread-1  ]: Using snowflake connection "model.billy_bulky.staging_shopify__customers"
[0m17:16:54.985550 [debug] [Thread-3  ]: Using snowflake connection "model.billy_bulky.staging_shopify__products"
[0m17:16:54.985827 [debug] [Thread-2  ]: On model.billy_bulky.staging_shopify__orders: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.staging_shopify__orders"} */
create or replace   view E_COMMERCE.staging.staging_shopify__orders
  
   as (
    WITH orders AS (
    SELECT * FROM SHOPIFY.PUBLIC.orders
)

SELECT
    ORDER_ID
    , CUSTOMER_ID
    , PRODUCT_ID
    , QUANTITY
    , ORDER_DATE
    , STATUS
FROM orders
  );
[0m17:16:54.986124 [debug] [Thread-1  ]: On model.billy_bulky.staging_shopify__customers: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.staging_shopify__customers"} */
create or replace   view E_COMMERCE.staging.staging_shopify__customers
  
   as (
    WITH customers AS (
    SELECT * FROM SHOPIFY.PUBLIC.customers
)

SELECT
    CUSTOMER_ID
    , FIRST_NAME
    , LAST_NAME
    , EMAIL
    , JOIN_DATE
    , COUNTRY
FROM customers
  );
[0m17:16:54.986408 [debug] [Thread-3  ]: On model.billy_bulky.staging_shopify__products: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.staging_shopify__products"} */
create or replace   view E_COMMERCE.staging.staging_shopify__products
  
   as (
    WITH products AS (
    SELECT * FROM SHOPIFY.PUBLIC.products
)

SELECT
    PRODUCT_ID
    , NAME
    , CATEGORY
    , PRICE
    , STOCK_LEVEL
FROM products
  );
[0m17:16:54.986670 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m17:16:54.986910 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:16:54.987149 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m17:16:56.312580 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m17:16:56.343144 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m17:16:56.347175 [debug] [Thread-2  ]: Timing info for model.billy_bulky.staging_shopify__orders (execute): 17:16:54.954208 => 17:16:56.346921
[0m17:16:56.349697 [debug] [Thread-3  ]: Timing info for model.billy_bulky.staging_shopify__products (execute): 17:16:54.979168 => 17:16:56.349472
[0m17:16:56.350161 [debug] [Thread-2  ]: On model.billy_bulky.staging_shopify__orders: Close
[0m17:16:56.350564 [debug] [Thread-3  ]: On model.billy_bulky.staging_shopify__products: Close
[0m17:16:56.358739 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m17:16:56.361272 [debug] [Thread-1  ]: Timing info for model.billy_bulky.staging_shopify__customers (execute): 17:16:54.981580 => 17:16:56.361040
[0m17:16:56.361699 [debug] [Thread-1  ]: On model.billy_bulky.staging_shopify__customers: Close
[0m17:16:56.857395 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68357855-0400-498f-a8c1-dcca6ece4612', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x134a32700>]}
[0m17:16:56.858810 [info ] [Thread-2  ]: 2 of 4 OK created sql view model staging.staging_shopify__orders ............... [[32mSUCCESS 1[0m in 1.93s]
[0m17:16:56.860273 [debug] [Thread-2  ]: Finished running node model.billy_bulky.staging_shopify__orders
[0m17:16:56.867281 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68357855-0400-498f-a8c1-dcca6ece4612', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127c265b0>]}
[0m17:16:56.868698 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68357855-0400-498f-a8c1-dcca6ece4612', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x134909e50>]}
[0m17:16:56.869838 [info ] [Thread-3  ]: 3 of 4 OK created sql view model staging.staging_shopify__products ............. [[32mSUCCESS 1[0m in 1.94s]
[0m17:16:56.870918 [info ] [Thread-1  ]: 1 of 4 OK created sql view model staging.staging_shopify__customers ............ [[32mSUCCESS 1[0m in 1.94s]
[0m17:16:56.871802 [debug] [Thread-3  ]: Finished running node model.billy_bulky.staging_shopify__products
[0m17:16:56.872637 [debug] [Thread-1  ]: Finished running node model.billy_bulky.staging_shopify__customers
[0m17:16:56.874062 [debug] [Thread-5  ]: Began running node model.billy_bulky.int_customers_segmentation
[0m17:16:56.874980 [info ] [Thread-5  ]: 4 of 4 START sql table model intermediate.int_customers_segmentation ........... [RUN]
[0m17:16:56.876294 [debug] [Thread-5  ]: Acquiring new snowflake connection 'model.billy_bulky.int_customers_segmentation'
[0m17:16:56.876943 [debug] [Thread-5  ]: Began compiling node model.billy_bulky.int_customers_segmentation
[0m17:16:56.883116 [debug] [Thread-5  ]: Writing injected SQL for node "model.billy_bulky.int_customers_segmentation"
[0m17:16:56.884740 [debug] [Thread-5  ]: Timing info for model.billy_bulky.int_customers_segmentation (compile): 17:16:56.877294 => 17:16:56.884380
[0m17:16:56.885271 [debug] [Thread-5  ]: Began executing node model.billy_bulky.int_customers_segmentation
[0m17:16:56.909534 [debug] [Thread-5  ]: Writing runtime sql for node "model.billy_bulky.int_customers_segmentation"
[0m17:16:56.912292 [debug] [Thread-5  ]: Using snowflake connection "model.billy_bulky.int_customers_segmentation"
[0m17:16:56.912776 [debug] [Thread-5  ]: On model.billy_bulky.int_customers_segmentation: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.int_customers_segmentation"} */
create or replace transient table E_COMMERCE.intermediate.int_customers_segmentation
         as
        (WITH customers AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__customers
)

, orders AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__orders
)

, products AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__products
)

, order_aggregates AS (
    SELECT
        o.CUSTOMER_ID
        , COUNT(DISTINCT o.ORDER_ID) AS frequency
        , SUM(o.QUANTITY * p.PRICE) AS monetary
        , AVG(o.QUANTITY * p.PRICE) AS average_order_value
        , MAX(o.ORDER_DATE) AS last_purchase_date
        , COUNT(CASE WHEN o.STATUS = 'cancelled' THEN 1 END) AS cancelled_orders
        , COUNT(*) AS total_orders
    FROM orders o
    JOIN products p ON o.PRODUCT_ID = p.PRODUCT_ID
    GROUP BY o.CUSTOMER_ID
)

, customer_tenure AS (
    SELECT
        CUSTOMER_ID
        , JOIN_DATE
        , CURRENT_DATE - JOIN_DATE AS tenure
    FROM customers
)

, customer_recency AS (
    SELECT
        CUSTOMER_ID
        , CURRENT_DATE - last_purchase_date AS recency
    FROM order_aggregates
)

, final AS (
    SELECT
        c.CUSTOMER_ID
        , c.FIRST_NAME
        , c.LAST_NAME
        , c.EMAIL
        , c.JOIN_DATE
        , c.COUNTRY
        , o.frequency
        , o.monetary
        , o.average_order_value
        , o.cancelled_orders
        , o.total_orders
        , CASE 
            WHEN o.total_orders > 0 THEN ROUND((o.cancelled_orders::FLOAT / o.total_orders) * 100, 2) 
            ELSE 0 
          END AS cancellation_rate
        , r.recency
        , t.tenure
    FROM customer_tenure t
    JOIN customers c ON t.CUSTOMER_ID = c.CUSTOMER_ID
    JOIN order_aggregates o ON c.CUSTOMER_ID = o.CUSTOMER_ID
    JOIN customer_recency r ON c.CUSTOMER_ID = r.CUSTOMER_ID
)

SELECT * FROM final
        );
[0m17:16:56.913188 [debug] [Thread-5  ]: Opening a new connection, currently in state init
[0m17:16:59.786897 [debug] [Thread-5  ]: SQL status: SUCCESS 1 in 3.0 seconds
[0m17:16:59.791676 [debug] [Thread-5  ]: Timing info for model.billy_bulky.int_customers_segmentation (execute): 17:16:56.885570 => 17:16:59.791264
[0m17:16:59.792429 [debug] [Thread-5  ]: On model.billy_bulky.int_customers_segmentation: Close
[0m17:17:00.146814 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68357855-0400-498f-a8c1-dcca6ece4612', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x134c3c7c0>]}
[0m17:17:00.147652 [info ] [Thread-5  ]: 4 of 4 OK created sql table model intermediate.int_customers_segmentation ...... [[32mSUCCESS 1[0m in 3.27s]
[0m17:17:00.148300 [debug] [Thread-5  ]: Finished running node model.billy_bulky.int_customers_segmentation
[0m17:17:00.150037 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:17:00.150395 [debug] [MainThread]: Connection 'model.billy_bulky.staging_shopify__customers' was properly closed.
[0m17:17:00.150712 [debug] [MainThread]: Connection 'model.billy_bulky.staging_shopify__orders' was properly closed.
[0m17:17:00.151012 [debug] [MainThread]: Connection 'model.billy_bulky.staging_shopify__products' was properly closed.
[0m17:17:00.151311 [debug] [MainThread]: Connection 'model.billy_bulky.int_customers_segmentation' was properly closed.
[0m17:17:00.151660 [info ] [MainThread]: 
[0m17:17:00.152014 [info ] [MainThread]: Finished running 3 view models, 1 table model in 0 hours 0 minutes and 10.91 seconds (10.91s).
[0m17:17:00.153040 [debug] [MainThread]: Command end result
[0m17:17:00.164061 [info ] [MainThread]: 
[0m17:17:00.164454 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:17:00.164741 [info ] [MainThread]: 
[0m17:17:00.165031 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m17:17:00.167461 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.90586, "process_user_time": 4.894347, "process_kernel_time": 0.430356, "process_mem_max_rss": "214368256", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:17:00.167909 [debug] [MainThread]: Command `dbt run` succeeded at 17:17:00.167808 after 11.91 seconds
[0m17:17:00.168229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054650d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x134922490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127ee1b50>]}
[0m17:17:00.168556 [debug] [MainThread]: Flushing usage events
[0m17:22:34.632293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071480d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109998fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099b53a0>]}


============================== 17:22:34.635098 | 073e8c50-b8d4-4441-9a22-b9a3d8ef8ec1 ==============================
[0m17:22:34.635098 [info ] [MainThread]: Running with dbt=1.7.1
[0m17:22:34.635483 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/bitlevi/.dbt', 'log_path': '/Users/bitlevi/Documents/billy_bulky_ecommerce/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:22:35.500832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '073e8c50-b8d4-4441-9a22-b9a3d8ef8ec1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12008b610>]}
[0m17:22:35.549482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '073e8c50-b8d4-4441-9a22-b9a3d8ef8ec1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1200fa2b0>]}
[0m17:22:35.550315 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m17:22:35.562718 [debug] [MainThread]: checksum: ad428e6dc3b353dcb23d0c4ebea8b20b180e94b873271ac2a054a8e446dac0e2, vars: {}, profile: , target: , version: 1.7.1
[0m17:22:35.595490 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m17:22:35.596015 [debug] [MainThread]: Partial parsing: updated file: billy_bulky://models/intermediate/customers/_int_customers__models.yml
[0m17:22:35.596291 [debug] [MainThread]: Partial parsing: updated file: billy_bulky://models/intermediate/products/int_product_performance.sql
[0m17:22:35.698963 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'int_customer_segmentation' in the 'models' section of file 'models/intermediate/customers/_int_customers__models.yml'
[0m17:22:35.755954 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two tests with the name "unique_int_customer_segmentation_customer_id" defined on "models.int_customer_segmentation".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when running tests.
  
  To fix this, change the name of one of these resources:
  - test.billy_bulky.unique_int_customer_segmentation_customer_id.93378a6f29 (models/intermediate/customers/_int_customers__models.yml)
  - test.billy_bulky.unique_int_customer_segmentation_customer_id.93378a6f29 (models/intermediate/customers/_int_customers__models.yml)
[0m17:22:35.760494 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.1634513, "process_user_time": 3.847873, "process_kernel_time": 0.337755, "process_mem_max_rss": "198164480", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:22:35.761131 [debug] [MainThread]: Command `dbt run` failed at 17:22:35.761020 after 1.16 seconds
[0m17:22:35.761464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071480d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120f208b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120d57af0>]}
[0m17:22:35.761762 [debug] [MainThread]: Flushing usage events
[0m17:23:26.409904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1032a9eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105af8f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105af84f0>]}


============================== 17:23:26.412632 | acf9da72-945f-4e99-a1d5-d6dced20ef5d ==============================
[0m17:23:26.412632 [info ] [MainThread]: Running with dbt=1.7.1
[0m17:23:26.412990 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/bitlevi/.dbt', 'log_path': '/Users/bitlevi/Documents/billy_bulky_ecommerce/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m17:23:27.230818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'acf9da72-945f-4e99-a1d5-d6dced20ef5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105af8490>]}
[0m17:23:27.278188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'acf9da72-945f-4e99-a1d5-d6dced20ef5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fece190>]}
[0m17:23:27.278894 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m17:23:27.291831 [debug] [MainThread]: checksum: ad428e6dc3b353dcb23d0c4ebea8b20b180e94b873271ac2a054a8e446dac0e2, vars: {}, profile: , target: , version: 1.7.1
[0m17:23:27.321467 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m17:23:27.321984 [debug] [MainThread]: Partial parsing: updated file: billy_bulky://models/intermediate/customers/_int_customers__models.yml
[0m17:23:27.322254 [debug] [MainThread]: Partial parsing: updated file: billy_bulky://models/intermediate/products/int_product_performance.sql
[0m17:23:27.426141 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'int_customer_segmentation' in the 'models' section of file 'models/intermediate/customers/_int_customers__models.yml'
[0m17:23:27.488461 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.unique_int_customer_segmentation_customer_id.93378a6f29' (models/intermediate/customers/_int_customers__models.yml) depends on a node named 'int_customer_segmentation' in package '' which was not found
[0m17:23:27.488819 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_int_customer_segmentation_customer_id.b278231c99' (models/intermediate/customers/_int_customers__models.yml) depends on a node named 'int_customer_segmentation' in package '' which was not found
[0m17:23:27.489103 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_int_customer_segmentation_email.e4880b86d9' (models/intermediate/customers/_int_customers__models.yml) depends on a node named 'int_customer_segmentation' in package '' which was not found
[0m17:23:27.489346 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.unique_int_customer_segmentation_email.525579524b' (models/intermediate/customers/_int_customers__models.yml) depends on a node named 'int_customer_segmentation' in package '' which was not found
[0m17:23:27.489573 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_int_customer_segmentation_frequency.f45b5cc0b0' (models/intermediate/customers/_int_customers__models.yml) depends on a node named 'int_customer_segmentation' in package '' which was not found
[0m17:23:27.489796 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_int_customer_segmentation_monetary.97dee85c9d' (models/intermediate/customers/_int_customers__models.yml) depends on a node named 'int_customer_segmentation' in package '' which was not found
[0m17:23:27.490014 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_int_customer_segmentation_average_order_value.15c482d127' (models/intermediate/customers/_int_customers__models.yml) depends on a node named 'int_customer_segmentation' in package '' which was not found
[0m17:23:27.490236 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_int_customer_segmentation_cancellation_rate.49f1f06ae7' (models/intermediate/customers/_int_customers__models.yml) depends on a node named 'int_customer_segmentation' in package '' which was not found
[0m17:23:27.490452 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_int_customer_segmentation_recency.b3e8e1b730' (models/intermediate/customers/_int_customers__models.yml) depends on a node named 'int_customer_segmentation' in package '' which was not found
[0m17:23:27.490667 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_int_customer_segmentation_tenure.9a1e5d8cf9' (models/intermediate/customers/_int_customers__models.yml) depends on a node named 'int_customer_segmentation' in package '' which was not found
[0m17:23:27.490895 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.relationships_int_customer_segmentation_customer_id__ref_staging_shopify__customers_.03801bedb5' (models/intermediate/customers/_int_customers__models.yml) depends on a node named 'int_customer_segmentation' in package '' which was not found
[0m17:23:27.503040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'acf9da72-945f-4e99-a1d5-d6dced20ef5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128dbc0d0>]}
[0m17:23:27.559497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'acf9da72-945f-4e99-a1d5-d6dced20ef5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128d49b50>]}
[0m17:23:27.559878 [info ] [MainThread]: Found 7 models, 14 tests, 3 sources, 0 exposures, 0 metrics, 431 macros, 0 groups, 0 semantic models
[0m17:23:27.560108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'acf9da72-945f-4e99-a1d5-d6dced20ef5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128c4fd60>]}
[0m17:23:27.561184 [info ] [MainThread]: 
[0m17:23:27.561670 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:23:27.562380 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE'
[0m17:23:27.570322 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE"
[0m17:23:27.570552 [debug] [ThreadPool]: On list_E_COMMERCE: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE"} */
show terse schemas in database E_COMMERCE
    limit 10000
[0m17:23:27.570738 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:23:27.571580 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE'
[0m17:23:27.573015 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE"
[0m17:23:27.573232 [debug] [ThreadPool]: On list_E_COMMERCE: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE"} */
show terse schemas in database E_COMMERCE
    limit 10000
[0m17:23:27.573414 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:23:29.377333 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.0 seconds
[0m17:23:29.379091 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.0 seconds
[0m17:23:29.382268 [debug] [ThreadPool]: On list_E_COMMERCE: Close
[0m17:23:29.384607 [debug] [ThreadPool]: On list_E_COMMERCE: Close
[0m17:23:29.863862 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_E_COMMERCE, now list_E_COMMERCE_PUBLIC)
[0m17:23:29.865396 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_E_COMMERCE, now list_E_COMMERCE_intermediate)
[0m17:23:29.866813 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_staging'
[0m17:23:29.887045 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_intermediate"
[0m17:23:29.890104 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_staging"
[0m17:23:29.893159 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PUBLIC"
[0m17:23:29.893533 [debug] [ThreadPool]: On list_E_COMMERCE_intermediate: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE_intermediate"} */
show terse objects in E_COMMERCE.intermediate limit 10000
[0m17:23:29.893935 [debug] [ThreadPool]: On list_E_COMMERCE_staging: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE_staging"} */
show terse objects in E_COMMERCE.staging limit 10000
[0m17:23:29.894300 [debug] [ThreadPool]: On list_E_COMMERCE_PUBLIC: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE_PUBLIC"} */
show terse objects in E_COMMERCE.PUBLIC limit 10000
[0m17:23:29.894643 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:23:29.894957 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:23:29.895261 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:23:31.161402 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m17:23:31.163584 [debug] [ThreadPool]: On list_E_COMMERCE_staging: Close
[0m17:23:31.176465 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m17:23:31.177855 [debug] [ThreadPool]: On list_E_COMMERCE_intermediate: Close
[0m17:23:31.196555 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b07577-0001-824a-0000-0004d8beb201
[0m17:23:31.196860 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m17:23:31.197184 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m17:23:31.197427 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:23:31.197699 [debug] [ThreadPool]: On list_E_COMMERCE_PUBLIC: Close
[0m17:23:31.718302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'acf9da72-945f-4e99-a1d5-d6dced20ef5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128d23670>]}
[0m17:23:31.719775 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m17:23:31.720386 [info ] [MainThread]: 
[0m17:23:31.725066 [debug] [Thread-1  ]: Began running node model.billy_bulky.staging_shopify__customers
[0m17:23:31.725768 [debug] [Thread-2  ]: Began running node model.billy_bulky.staging_shopify__orders
[0m17:23:31.726318 [debug] [Thread-3  ]: Began running node model.billy_bulky.staging_shopify__products
[0m17:23:31.726973 [info ] [Thread-1  ]: 1 of 5 START sql view model staging.staging_shopify__customers ................. [RUN]
[0m17:23:31.727670 [info ] [Thread-2  ]: 2 of 5 START sql view model staging.staging_shopify__orders .................... [RUN]
[0m17:23:31.729660 [info ] [Thread-3  ]: 3 of 5 START sql view model staging.staging_shopify__products .................. [RUN]
[0m17:23:31.730870 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_E_COMMERCE_PUBLIC, now model.billy_bulky.staging_shopify__customers)
[0m17:23:31.731883 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_E_COMMERCE_intermediate, now model.billy_bulky.staging_shopify__orders)
[0m17:23:31.732887 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly list_E_COMMERCE_staging, now model.billy_bulky.staging_shopify__products)
[0m17:23:31.733489 [debug] [Thread-1  ]: Began compiling node model.billy_bulky.staging_shopify__customers
[0m17:23:31.734047 [debug] [Thread-2  ]: Began compiling node model.billy_bulky.staging_shopify__orders
[0m17:23:31.734500 [debug] [Thread-3  ]: Began compiling node model.billy_bulky.staging_shopify__products
[0m17:23:31.744637 [debug] [Thread-1  ]: Writing injected SQL for node "model.billy_bulky.staging_shopify__customers"
[0m17:23:31.748295 [debug] [Thread-2  ]: Writing injected SQL for node "model.billy_bulky.staging_shopify__orders"
[0m17:23:31.751585 [debug] [Thread-3  ]: Writing injected SQL for node "model.billy_bulky.staging_shopify__products"
[0m17:23:31.752808 [debug] [Thread-1  ]: Timing info for model.billy_bulky.staging_shopify__customers (compile): 17:23:31.734778 => 17:23:31.752508
[0m17:23:31.753367 [debug] [Thread-3  ]: Timing info for model.billy_bulky.staging_shopify__products (compile): 17:23:31.748702 => 17:23:31.753074
[0m17:23:31.753844 [debug] [Thread-2  ]: Timing info for model.billy_bulky.staging_shopify__orders (compile): 17:23:31.744997 => 17:23:31.753619
[0m17:23:31.754243 [debug] [Thread-1  ]: Began executing node model.billy_bulky.staging_shopify__customers
[0m17:23:31.754658 [debug] [Thread-3  ]: Began executing node model.billy_bulky.staging_shopify__products
[0m17:23:31.755042 [debug] [Thread-2  ]: Began executing node model.billy_bulky.staging_shopify__orders
[0m17:23:31.780480 [debug] [Thread-1  ]: Writing runtime sql for node "model.billy_bulky.staging_shopify__customers"
[0m17:23:31.783127 [debug] [Thread-3  ]: Writing runtime sql for node "model.billy_bulky.staging_shopify__products"
[0m17:23:31.785366 [debug] [Thread-2  ]: Writing runtime sql for node "model.billy_bulky.staging_shopify__orders"
[0m17:23:31.786237 [debug] [Thread-3  ]: Using snowflake connection "model.billy_bulky.staging_shopify__products"
[0m17:23:31.786764 [debug] [Thread-2  ]: Using snowflake connection "model.billy_bulky.staging_shopify__orders"
[0m17:23:31.787271 [debug] [Thread-1  ]: Using snowflake connection "model.billy_bulky.staging_shopify__customers"
[0m17:23:31.787532 [debug] [Thread-3  ]: On model.billy_bulky.staging_shopify__products: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.staging_shopify__products"} */
create or replace   view E_COMMERCE.staging.staging_shopify__products
  
   as (
    WITH products AS (
    SELECT * FROM SHOPIFY.PUBLIC.products
)

SELECT
    PRODUCT_ID
    , NAME
    , CATEGORY
    , PRICE
    , STOCK_LEVEL
FROM products
  );
[0m17:23:31.787807 [debug] [Thread-2  ]: On model.billy_bulky.staging_shopify__orders: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.staging_shopify__orders"} */
create or replace   view E_COMMERCE.staging.staging_shopify__orders
  
   as (
    WITH orders AS (
    SELECT * FROM SHOPIFY.PUBLIC.orders
)

SELECT
    ORDER_ID
    , CUSTOMER_ID
    , PRODUCT_ID
    , QUANTITY
    , ORDER_DATE
    , STATUS
FROM orders
  );
[0m17:23:31.788076 [debug] [Thread-1  ]: On model.billy_bulky.staging_shopify__customers: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.staging_shopify__customers"} */
create or replace   view E_COMMERCE.staging.staging_shopify__customers
  
   as (
    WITH customers AS (
    SELECT * FROM SHOPIFY.PUBLIC.customers
)

SELECT
    CUSTOMER_ID
    , FIRST_NAME
    , LAST_NAME
    , EMAIL
    , JOIN_DATE
    , COUNTRY
FROM customers
  );
[0m17:23:31.788326 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m17:23:31.788557 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m17:23:31.788782 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:23:33.251732 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m17:23:33.253745 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m17:23:33.262209 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m17:23:33.294301 [debug] [Thread-2  ]: Timing info for model.billy_bulky.staging_shopify__orders (execute): 17:23:31.783319 => 17:23:33.294039
[0m17:23:33.297045 [debug] [Thread-1  ]: Timing info for model.billy_bulky.staging_shopify__customers (execute): 17:23:31.755291 => 17:23:33.296812
[0m17:23:33.299271 [debug] [Thread-3  ]: Timing info for model.billy_bulky.staging_shopify__products (execute): 17:23:31.774852 => 17:23:33.299071
[0m17:23:33.299679 [debug] [Thread-2  ]: On model.billy_bulky.staging_shopify__orders: Close
[0m17:23:33.300042 [debug] [Thread-1  ]: On model.billy_bulky.staging_shopify__customers: Close
[0m17:23:33.300399 [debug] [Thread-3  ]: On model.billy_bulky.staging_shopify__products: Close
[0m17:23:33.872484 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'acf9da72-945f-4e99-a1d5-d6dced20ef5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128d23100>]}
[0m17:23:33.874136 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'acf9da72-945f-4e99-a1d5-d6dced20ef5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128bdbaf0>]}
[0m17:23:33.875199 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'acf9da72-945f-4e99-a1d5-d6dced20ef5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x129adb3d0>]}
[0m17:23:33.876110 [info ] [Thread-2  ]: 2 of 5 OK created sql view model staging.staging_shopify__orders ............... [[32mSUCCESS 1[0m in 2.14s]
[0m17:23:33.877113 [info ] [Thread-1  ]: 1 of 5 OK created sql view model staging.staging_shopify__customers ............ [[32mSUCCESS 1[0m in 2.14s]
[0m17:23:33.878005 [info ] [Thread-3  ]: 3 of 5 OK created sql view model staging.staging_shopify__products ............. [[32mSUCCESS 1[0m in 2.14s]
[0m17:23:33.878839 [debug] [Thread-2  ]: Finished running node model.billy_bulky.staging_shopify__orders
[0m17:23:33.879598 [debug] [Thread-1  ]: Finished running node model.billy_bulky.staging_shopify__customers
[0m17:23:33.880339 [debug] [Thread-3  ]: Finished running node model.billy_bulky.staging_shopify__products
[0m17:23:33.881715 [debug] [Thread-5  ]: Began running node model.billy_bulky.int_customers_segmentation
[0m17:23:33.882342 [debug] [Thread-6  ]: Began running node model.billy_bulky.int_product_performance
[0m17:23:33.883023 [info ] [Thread-5  ]: 4 of 5 START sql table model intermediate.int_customers_segmentation ........... [RUN]
[0m17:23:33.883740 [info ] [Thread-6  ]: 5 of 5 START sql table model intermediate.int_product_performance .............. [RUN]
[0m17:23:33.884877 [debug] [Thread-5  ]: Acquiring new snowflake connection 'model.billy_bulky.int_customers_segmentation'
[0m17:23:33.885892 [debug] [Thread-6  ]: Acquiring new snowflake connection 'model.billy_bulky.int_product_performance'
[0m17:23:33.886389 [debug] [Thread-5  ]: Began compiling node model.billy_bulky.int_customers_segmentation
[0m17:23:33.886842 [debug] [Thread-6  ]: Began compiling node model.billy_bulky.int_product_performance
[0m17:23:33.892018 [debug] [Thread-5  ]: Writing injected SQL for node "model.billy_bulky.int_customers_segmentation"
[0m17:23:33.897049 [debug] [Thread-6  ]: Writing injected SQL for node "model.billy_bulky.int_product_performance"
[0m17:23:33.898019 [debug] [Thread-5  ]: Timing info for model.billy_bulky.int_customers_segmentation (compile): 17:23:33.887121 => 17:23:33.897761
[0m17:23:33.898477 [debug] [Thread-5  ]: Began executing node model.billy_bulky.int_customers_segmentation
[0m17:23:33.905123 [debug] [Thread-6  ]: Timing info for model.billy_bulky.int_product_performance (compile): 17:23:33.892387 => 17:23:33.904813
[0m17:23:33.912116 [debug] [Thread-6  ]: Began executing node model.billy_bulky.int_product_performance
[0m17:23:33.927705 [debug] [Thread-5  ]: Writing runtime sql for node "model.billy_bulky.int_customers_segmentation"
[0m17:23:33.931799 [debug] [Thread-6  ]: Writing runtime sql for node "model.billy_bulky.int_product_performance"
[0m17:23:33.933767 [debug] [Thread-6  ]: Using snowflake connection "model.billy_bulky.int_product_performance"
[0m17:23:33.935468 [debug] [Thread-5  ]: Using snowflake connection "model.billy_bulky.int_customers_segmentation"
[0m17:23:33.935803 [debug] [Thread-6  ]: On model.billy_bulky.int_product_performance: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.int_product_performance"} */
create or replace transient table E_COMMERCE.intermediate.int_product_performance
         as
        (WITH orders AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__orders
)

, products AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__products
)

, product_sales AS (
    SELECT
        o.PRODUCT_ID
        , COUNT(DISTINCT o.ORDER_ID) AS total_sales
        , SUM(o.QUANTITY) AS total_units_sold
        , SUM(o.QUANTITY * p.PRICE) AS total_sales_value
    FROM orders o
    INNER JOIN products p ON o.PRODUCT_ID = p.PRODUCT_ID
    WHERE o.STATUS NOT IN ('cancelled') 
    GROUP BY o.PRODUCT_ID
)

, product_averages AS (
    SELECT
        PRODUCT_ID
        , (total_sales_value / NULLIF(total_units_sold, 0)) AS average_sale_price
    FROM product_sales
)

, product_stock_turnover AS (
    SELECT
        p.PRODUCT_ID
        , p.STOCK_LEVEL
        , (total_units_sold / NULLIF(p.STOCK_LEVEL, 0)) AS turnover_rate
    FROM product_sales ps
    INNER JOIN products p ON ps.PRODUCT_ID = p.PRODUCT_ID
)

SELECT
    p.PRODUCT_ID
    , p.NAME
    , p.CATEGORY
    , p.PRICE
    , pa.average_sale_price
    , ps.total_sales
    , ps.total_units_sold
    , ps.total_sales_value
    , pst.turnover_rate
    , p.STOCK_LEVEL
FROM products p
LEFT JOIN product_sales ps ON p.PRODUCT_ID = ps.PRODUCT_ID
LEFT JOIN product_averages pa ON p.PRODUCT_ID = pa.PRODUCT_ID
LEFT JOIN product_stock_turnover pst ON p.PRODUCT_ID = pst.PRODUCT_ID
        );
[0m17:23:33.936220 [debug] [Thread-5  ]: On model.billy_bulky.int_customers_segmentation: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.int_customers_segmentation"} */
create or replace transient table E_COMMERCE.intermediate.int_customers_segmentation
         as
        (WITH customers AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__customers
)

, orders AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__orders
)

, products AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__products
)

, order_aggregates AS (
    SELECT
        o.CUSTOMER_ID
        , COUNT(DISTINCT o.ORDER_ID) AS frequency
        , SUM(o.QUANTITY * p.PRICE) AS monetary
        , AVG(o.QUANTITY * p.PRICE) AS average_order_value
        , MAX(o.ORDER_DATE) AS last_purchase_date
        , COUNT(CASE WHEN o.STATUS = 'cancelled' THEN 1 END) AS cancelled_orders
        , COUNT(*) AS total_orders
    FROM orders o
    JOIN products p ON o.PRODUCT_ID = p.PRODUCT_ID
    GROUP BY o.CUSTOMER_ID
)

, customer_tenure AS (
    SELECT
        CUSTOMER_ID
        , JOIN_DATE
        , CURRENT_DATE - JOIN_DATE AS tenure
    FROM customers
)

, customer_recency AS (
    SELECT
        CUSTOMER_ID
        , CURRENT_DATE - last_purchase_date AS recency
    FROM order_aggregates
)

, final AS (
    SELECT
        c.CUSTOMER_ID
        , c.FIRST_NAME
        , c.LAST_NAME
        , c.EMAIL
        , c.JOIN_DATE
        , c.COUNTRY
        , o.frequency
        , o.monetary
        , o.average_order_value
        , o.cancelled_orders
        , o.total_orders
        , CASE 
            WHEN o.total_orders > 0 THEN ROUND((o.cancelled_orders::FLOAT / o.total_orders) * 100, 2) 
            ELSE 0 
          END AS cancellation_rate
        , r.recency
        , t.tenure
    FROM customer_tenure t
    JOIN customers c ON t.CUSTOMER_ID = c.CUSTOMER_ID
    JOIN order_aggregates o ON c.CUSTOMER_ID = o.CUSTOMER_ID
    JOIN customer_recency r ON c.CUSTOMER_ID = r.CUSTOMER_ID
)

SELECT * FROM final
        );
[0m17:23:33.936560 [debug] [Thread-6  ]: Opening a new connection, currently in state init
[0m17:23:33.936819 [debug] [Thread-5  ]: Opening a new connection, currently in state init
[0m17:23:36.322411 [debug] [Thread-5  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m17:23:36.329532 [debug] [Thread-5  ]: Timing info for model.billy_bulky.int_customers_segmentation (execute): 17:23:33.898725 => 17:23:36.329098
[0m17:23:36.330411 [debug] [Thread-5  ]: On model.billy_bulky.int_customers_segmentation: Close
[0m17:23:36.736223 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'acf9da72-945f-4e99-a1d5-d6dced20ef5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x129c7bb50>]}
[0m17:23:36.737632 [info ] [Thread-5  ]: 4 of 5 OK created sql table model intermediate.int_customers_segmentation ...... [[32mSUCCESS 1[0m in 2.85s]
[0m17:23:36.738715 [debug] [Thread-5  ]: Finished running node model.billy_bulky.int_customers_segmentation
[0m17:23:36.750867 [debug] [Thread-6  ]: SQL status: SUCCESS 1 in 3.0 seconds
[0m17:23:36.754546 [debug] [Thread-6  ]: Timing info for model.billy_bulky.int_product_performance (execute): 17:23:33.918718 => 17:23:36.754229
[0m17:23:36.755143 [debug] [Thread-6  ]: On model.billy_bulky.int_product_performance: Close
[0m17:23:37.160117 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'acf9da72-945f-4e99-a1d5-d6dced20ef5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128d233a0>]}
[0m17:23:37.161570 [info ] [Thread-6  ]: 5 of 5 OK created sql table model intermediate.int_product_performance ......... [[32mSUCCESS 1[0m in 3.27s]
[0m17:23:37.162627 [debug] [Thread-6  ]: Finished running node model.billy_bulky.int_product_performance
[0m17:23:37.165673 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:23:37.166335 [debug] [MainThread]: Connection 'model.billy_bulky.staging_shopify__customers' was properly closed.
[0m17:23:37.166863 [debug] [MainThread]: Connection 'model.billy_bulky.staging_shopify__orders' was properly closed.
[0m17:23:37.167368 [debug] [MainThread]: Connection 'model.billy_bulky.staging_shopify__products' was properly closed.
[0m17:23:37.167847 [debug] [MainThread]: Connection 'model.billy_bulky.int_customers_segmentation' was properly closed.
[0m17:23:37.168327 [debug] [MainThread]: Connection 'model.billy_bulky.int_product_performance' was properly closed.
[0m17:23:37.168982 [info ] [MainThread]: 
[0m17:23:37.169592 [info ] [MainThread]: Finished running 3 view models, 2 table models in 0 hours 0 minutes and 9.61 seconds (9.61s).
[0m17:23:37.171501 [debug] [MainThread]: Command end result
[0m17:23:37.187633 [info ] [MainThread]: 
[0m17:23:37.188218 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:23:37.188638 [info ] [MainThread]: 
[0m17:23:37.189057 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m17:23:37.191982 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.814328, "process_user_time": 5.198331, "process_kernel_time": 0.393665, "process_mem_max_rss": "218251264", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:23:37.192681 [debug] [MainThread]: Command `dbt run` succeeded at 17:23:37.192523 after 10.82 seconds
[0m17:23:37.193141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1032a9eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a0f6b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128d49430>]}
[0m17:23:37.193572 [debug] [MainThread]: Flushing usage events
[0m17:38:27.776673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102fb9ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105807970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105825280>]}


============================== 17:38:27.779323 | f5186d1e-2208-4d20-985d-9ca7a9edb09f ==============================
[0m17:38:27.779323 [info ] [MainThread]: Running with dbt=1.7.1
[0m17:38:27.779676 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/bitlevi/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/bitlevi/Documents/billy_bulky_ecommerce/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m17:38:28.619543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f5186d1e-2208-4d20-985d-9ca7a9edb09f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105807580>]}
[0m17:38:28.667402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f5186d1e-2208-4d20-985d-9ca7a9edb09f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12af2a430>]}
[0m17:38:28.668055 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m17:38:28.681631 [debug] [MainThread]: checksum: ad428e6dc3b353dcb23d0c4ebea8b20b180e94b873271ac2a054a8e446dac0e2, vars: {}, profile: , target: , version: 1.7.1
[0m17:38:28.715792 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 3 files added, 1 files changed.
[0m17:38:28.716232 [debug] [MainThread]: Partial parsing: added file: billy_bulky://models/intermediate/products/int_products_performance.sql
[0m17:38:28.716545 [debug] [MainThread]: Partial parsing: added file: billy_bulky://models/intermediate/sales/_int_sales__models.yml
[0m17:38:28.716754 [debug] [MainThread]: Partial parsing: added file: billy_bulky://models/intermediate/sales/int_sales_trends.sql
[0m17:38:28.717027 [debug] [MainThread]: Partial parsing: updated file: billy_bulky://models/intermediate/products/_int_products__models.yml
[0m17:38:28.717213 [debug] [MainThread]: Partial parsing: deleted file: billy_bulky://models/intermediate/products/int_product_performance.sql
[0m17:38:28.883604 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'int_product_performance' in the 'models' section of file 'models/intermediate/products/_int_products__models.yml'
[0m17:38:28.897215 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.unique_int_product_performance_product_id.b828b9a3bd' (models/intermediate/products/_int_products__models.yml) depends on a node named 'int_product_performance' in package '' which was not found
[0m17:38:28.897582 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_int_product_performance_product_id.df41eb8b00' (models/intermediate/products/_int_products__models.yml) depends on a node named 'int_product_performance' in package '' which was not found
[0m17:38:28.897824 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_int_product_performance_name.84605c9ebd' (models/intermediate/products/_int_products__models.yml) depends on a node named 'int_product_performance' in package '' which was not found
[0m17:38:28.898048 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_int_product_performance_category.ce9d757af8' (models/intermediate/products/_int_products__models.yml) depends on a node named 'int_product_performance' in package '' which was not found
[0m17:38:28.898269 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_int_product_performance_price.d8cfbbbb6f' (models/intermediate/products/_int_products__models.yml) depends on a node named 'int_product_performance' in package '' which was not found
[0m17:38:28.898487 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_int_product_performance_average_sale_price.88051bf719' (models/intermediate/products/_int_products__models.yml) depends on a node named 'int_product_performance' in package '' which was not found
[0m17:38:28.898702 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_int_product_performance_total_sales.471d2d6538' (models/intermediate/products/_int_products__models.yml) depends on a node named 'int_product_performance' in package '' which was not found
[0m17:38:28.898914 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_int_product_performance_total_units_sold.1d57ff67fe' (models/intermediate/products/_int_products__models.yml) depends on a node named 'int_product_performance' in package '' which was not found
[0m17:38:28.899128 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_int_product_performance_total_sales_value.e22015eef1' (models/intermediate/products/_int_products__models.yml) depends on a node named 'int_product_performance' in package '' which was not found
[0m17:38:28.899339 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_int_product_performance_turnover_rate.2ba1e9ec16' (models/intermediate/products/_int_products__models.yml) depends on a node named 'int_product_performance' in package '' which was not found
[0m17:38:28.899549 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_int_product_performance_stock_level.8fd9f36e5b' (models/intermediate/products/_int_products__models.yml) depends on a node named 'int_product_performance' in package '' which was not found
[0m17:38:28.959661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f5186d1e-2208-4d20-985d-9ca7a9edb09f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12bdb80d0>]}
[0m17:38:28.970849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f5186d1e-2208-4d20-985d-9ca7a9edb09f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b6969a0>]}
[0m17:38:28.971218 [info ] [MainThread]: Found 8 models, 28 tests, 3 sources, 0 exposures, 0 metrics, 431 macros, 0 groups, 0 semantic models
[0m17:38:28.971452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f5186d1e-2208-4d20-985d-9ca7a9edb09f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b7cf160>]}
[0m17:38:28.972737 [info ] [MainThread]: 
[0m17:38:28.973320 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:38:28.974183 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE'
[0m17:38:28.974720 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE'
[0m17:38:28.984111 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE"
[0m17:38:28.985779 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE"
[0m17:38:28.986043 [debug] [ThreadPool]: On list_E_COMMERCE: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE"} */
show terse schemas in database E_COMMERCE
    limit 10000
[0m17:38:28.986279 [debug] [ThreadPool]: On list_E_COMMERCE: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE"} */
show terse schemas in database E_COMMERCE
    limit 10000
[0m17:38:28.986485 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:38:28.986669 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:38:30.362552 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m17:38:30.366260 [debug] [ThreadPool]: On list_E_COMMERCE: Close
[0m17:38:30.543117 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.0 seconds
[0m17:38:30.548150 [debug] [ThreadPool]: On list_E_COMMERCE: Close
[0m17:38:30.928599 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_E_COMMERCE, now list_E_COMMERCE_PUBLIC)
[0m17:38:30.930014 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_E_COMMERCE, now list_E_COMMERCE_intermediate)
[0m17:38:30.932593 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_staging'
[0m17:38:30.948612 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PUBLIC"
[0m17:38:30.954169 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_intermediate"
[0m17:38:30.956953 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_staging"
[0m17:38:30.957370 [debug] [ThreadPool]: On list_E_COMMERCE_PUBLIC: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE_PUBLIC"} */
show terse objects in E_COMMERCE.PUBLIC limit 10000
[0m17:38:30.957761 [debug] [ThreadPool]: On list_E_COMMERCE_intermediate: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE_intermediate"} */
show terse objects in E_COMMERCE.intermediate limit 10000
[0m17:38:30.958109 [debug] [ThreadPool]: On list_E_COMMERCE_staging: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE_staging"} */
show terse objects in E_COMMERCE.staging limit 10000
[0m17:38:30.958441 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:38:30.958772 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:38:30.959085 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:38:32.125433 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m17:38:32.126644 [debug] [ThreadPool]: On list_E_COMMERCE_intermediate: Close
[0m17:38:32.128015 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m17:38:32.128935 [debug] [ThreadPool]: On list_E_COMMERCE_staging: Close
[0m17:38:32.181224 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b07586-0001-8349-0004-d8be0001524e
[0m17:38:32.181527 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m17:38:32.181796 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m17:38:32.181993 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:38:32.182237 [debug] [ThreadPool]: On list_E_COMMERCE_PUBLIC: Close
[0m17:38:32.574573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f5186d1e-2208-4d20-985d-9ca7a9edb09f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12affb070>]}
[0m17:38:32.576282 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m17:38:32.576955 [info ] [MainThread]: 
[0m17:38:32.581793 [debug] [Thread-1  ]: Began running node model.billy_bulky.staging_shopify__customers
[0m17:38:32.582633 [debug] [Thread-2  ]: Began running node model.billy_bulky.staging_shopify__orders
[0m17:38:32.583353 [debug] [Thread-3  ]: Began running node model.billy_bulky.staging_shopify__products
[0m17:38:32.584169 [info ] [Thread-1  ]: 1 of 6 START sql view model staging.staging_shopify__customers ................. [RUN]
[0m17:38:32.585018 [info ] [Thread-2  ]: 2 of 6 START sql view model staging.staging_shopify__orders .................... [RUN]
[0m17:38:32.587678 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_E_COMMERCE_PUBLIC, now model.billy_bulky.staging_shopify__customers)
[0m17:38:32.585874 [info ] [Thread-3  ]: 3 of 6 START sql view model staging.staging_shopify__products .................. [RUN]
[0m17:38:32.588866 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_E_COMMERCE_intermediate, now model.billy_bulky.staging_shopify__orders)
[0m17:38:32.589480 [debug] [Thread-1  ]: Began compiling node model.billy_bulky.staging_shopify__customers
[0m17:38:32.590434 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly list_E_COMMERCE_staging, now model.billy_bulky.staging_shopify__products)
[0m17:38:32.590988 [debug] [Thread-2  ]: Began compiling node model.billy_bulky.staging_shopify__orders
[0m17:38:32.599585 [debug] [Thread-3  ]: Began compiling node model.billy_bulky.staging_shopify__products
[0m17:38:32.604072 [debug] [Thread-1  ]: Writing injected SQL for node "model.billy_bulky.staging_shopify__customers"
[0m17:38:32.607510 [debug] [Thread-2  ]: Writing injected SQL for node "model.billy_bulky.staging_shopify__orders"
[0m17:38:32.610511 [debug] [Thread-3  ]: Writing injected SQL for node "model.billy_bulky.staging_shopify__products"
[0m17:38:32.611428 [debug] [Thread-1  ]: Timing info for model.billy_bulky.staging_shopify__customers (compile): 17:38:32.591329 => 17:38:32.611172
[0m17:38:32.612007 [debug] [Thread-2  ]: Timing info for model.billy_bulky.staging_shopify__orders (compile): 17:38:32.604410 => 17:38:32.611748
[0m17:38:32.612471 [debug] [Thread-3  ]: Timing info for model.billy_bulky.staging_shopify__products (compile): 17:38:32.607820 => 17:38:32.612253
[0m17:38:32.612901 [debug] [Thread-1  ]: Began executing node model.billy_bulky.staging_shopify__customers
[0m17:38:32.613308 [debug] [Thread-2  ]: Began executing node model.billy_bulky.staging_shopify__orders
[0m17:38:32.613687 [debug] [Thread-3  ]: Began executing node model.billy_bulky.staging_shopify__products
[0m17:38:32.641493 [debug] [Thread-2  ]: Writing runtime sql for node "model.billy_bulky.staging_shopify__orders"
[0m17:38:32.642425 [debug] [Thread-1  ]: Writing runtime sql for node "model.billy_bulky.staging_shopify__customers"
[0m17:38:32.644696 [debug] [Thread-3  ]: Writing runtime sql for node "model.billy_bulky.staging_shopify__products"
[0m17:38:32.645896 [debug] [Thread-3  ]: Using snowflake connection "model.billy_bulky.staging_shopify__products"
[0m17:38:32.646466 [debug] [Thread-1  ]: Using snowflake connection "model.billy_bulky.staging_shopify__customers"
[0m17:38:32.646973 [debug] [Thread-2  ]: Using snowflake connection "model.billy_bulky.staging_shopify__orders"
[0m17:38:32.647241 [debug] [Thread-3  ]: On model.billy_bulky.staging_shopify__products: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.staging_shopify__products"} */
create or replace   view E_COMMERCE.staging.staging_shopify__products
  
   as (
    WITH products AS (
    SELECT * FROM SHOPIFY.PUBLIC.products
)

SELECT
    PRODUCT_ID
    , NAME
    , CATEGORY
    , PRICE
    , STOCK_LEVEL
FROM products
  );
[0m17:38:32.647551 [debug] [Thread-1  ]: On model.billy_bulky.staging_shopify__customers: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.staging_shopify__customers"} */
create or replace   view E_COMMERCE.staging.staging_shopify__customers
  
   as (
    WITH customers AS (
    SELECT * FROM SHOPIFY.PUBLIC.customers
)

SELECT
    CUSTOMER_ID
    , FIRST_NAME
    , LAST_NAME
    , EMAIL
    , JOIN_DATE
    , COUNTRY
FROM customers
  );
[0m17:38:32.647867 [debug] [Thread-2  ]: On model.billy_bulky.staging_shopify__orders: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.staging_shopify__orders"} */
create or replace   view E_COMMERCE.staging.staging_shopify__orders
  
   as (
    WITH orders AS (
    SELECT * FROM SHOPIFY.PUBLIC.orders
)

SELECT
    ORDER_ID
    , CUSTOMER_ID
    , PRODUCT_ID
    , QUANTITY
    , ORDER_DATE
    , STATUS
FROM orders
  );
[0m17:38:32.648151 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m17:38:32.648413 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:38:32.648662 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m17:38:33.911596 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m17:38:33.945598 [debug] [Thread-3  ]: Timing info for model.billy_bulky.staging_shopify__products (execute): 17:38:32.642601 => 17:38:33.945314
[0m17:38:33.946120 [debug] [Thread-3  ]: On model.billy_bulky.staging_shopify__products: Close
[0m17:38:33.948217 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m17:38:33.950757 [debug] [Thread-2  ]: Timing info for model.billy_bulky.staging_shopify__orders (execute): 17:38:32.632124 => 17:38:33.950523
[0m17:38:33.951617 [debug] [Thread-2  ]: On model.billy_bulky.staging_shopify__orders: Close
[0m17:38:33.952305 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m17:38:33.956110 [debug] [Thread-1  ]: Timing info for model.billy_bulky.staging_shopify__customers (execute): 17:38:32.613928 => 17:38:33.955906
[0m17:38:33.956568 [debug] [Thread-1  ]: On model.billy_bulky.staging_shopify__customers: Close
[0m17:38:34.376382 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5186d1e-2208-4d20-985d-9ca7a9edb09f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b155a30>]}
[0m17:38:34.377534 [info ] [Thread-3  ]: 3 of 6 OK created sql view model staging.staging_shopify__products ............. [[32mSUCCESS 1[0m in 1.79s]
[0m17:38:34.378589 [debug] [Thread-3  ]: Finished running node model.billy_bulky.staging_shopify__products
[0m17:38:34.495261 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5186d1e-2208-4d20-985d-9ca7a9edb09f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b0ce8e0>]}
[0m17:38:34.496960 [info ] [Thread-1  ]: 1 of 6 OK created sql view model staging.staging_shopify__customers ............ [[32mSUCCESS 1[0m in 1.91s]
[0m17:38:34.498179 [debug] [Thread-1  ]: Finished running node model.billy_bulky.staging_shopify__customers
[0m17:38:34.511935 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5186d1e-2208-4d20-985d-9ca7a9edb09f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ec81bb0>]}
[0m17:38:34.513023 [info ] [Thread-2  ]: 2 of 6 OK created sql view model staging.staging_shopify__orders ............... [[32mSUCCESS 1[0m in 1.92s]
[0m17:38:34.514009 [debug] [Thread-2  ]: Finished running node model.billy_bulky.staging_shopify__orders
[0m17:38:34.515092 [debug] [Thread-5  ]: Began running node model.billy_bulky.int_customers_segmentation
[0m17:38:34.515779 [info ] [Thread-5  ]: 4 of 6 START sql table model intermediate.int_customers_segmentation ........... [RUN]
[0m17:38:34.516902 [debug] [Thread-5  ]: Acquiring new snowflake connection 'model.billy_bulky.int_customers_segmentation'
[0m17:38:34.517591 [debug] [Thread-6  ]: Began running node model.billy_bulky.int_products_performance
[0m17:38:34.518158 [debug] [Thread-5  ]: Began compiling node model.billy_bulky.int_customers_segmentation
[0m17:38:34.518764 [debug] [Thread-7  ]: Began running node model.billy_bulky.int_sales_trends
[0m17:38:34.519521 [info ] [Thread-6  ]: 5 of 6 START sql table model intermediate.int_products_performance ............. [RUN]
[0m17:38:34.524793 [debug] [Thread-5  ]: Writing injected SQL for node "model.billy_bulky.int_customers_segmentation"
[0m17:38:34.525398 [info ] [Thread-7  ]: 6 of 6 START sql table model intermediate.int_sales_trends ..................... [RUN]
[0m17:38:34.526327 [debug] [Thread-6  ]: Acquiring new snowflake connection 'model.billy_bulky.int_products_performance'
[0m17:38:34.527294 [debug] [Thread-7  ]: Acquiring new snowflake connection 'model.billy_bulky.int_sales_trends'
[0m17:38:34.527800 [debug] [Thread-6  ]: Began compiling node model.billy_bulky.int_products_performance
[0m17:38:34.528253 [debug] [Thread-7  ]: Began compiling node model.billy_bulky.int_sales_trends
[0m17:38:34.532565 [debug] [Thread-6  ]: Writing injected SQL for node "model.billy_bulky.int_products_performance"
[0m17:38:34.533219 [debug] [Thread-5  ]: Timing info for model.billy_bulky.int_customers_segmentation (compile): 17:38:34.519941 => 17:38:34.532973
[0m17:38:34.536988 [debug] [Thread-7  ]: Writing injected SQL for node "model.billy_bulky.int_sales_trends"
[0m17:38:34.537546 [debug] [Thread-5  ]: Began executing node model.billy_bulky.int_customers_segmentation
[0m17:38:34.552062 [debug] [Thread-6  ]: Timing info for model.billy_bulky.int_products_performance (compile): 17:38:34.528574 => 17:38:34.551789
[0m17:38:34.559731 [debug] [Thread-6  ]: Began executing node model.billy_bulky.int_products_performance
[0m17:38:34.566479 [debug] [Thread-7  ]: Timing info for model.billy_bulky.int_sales_trends (compile): 17:38:34.533522 => 17:38:34.566232
[0m17:38:34.567002 [debug] [Thread-5  ]: Writing runtime sql for node "model.billy_bulky.int_customers_segmentation"
[0m17:38:34.570498 [debug] [Thread-6  ]: Writing runtime sql for node "model.billy_bulky.int_products_performance"
[0m17:38:34.570792 [debug] [Thread-7  ]: Began executing node model.billy_bulky.int_sales_trends
[0m17:38:34.573028 [debug] [Thread-7  ]: Writing runtime sql for node "model.billy_bulky.int_sales_trends"
[0m17:38:34.574754 [debug] [Thread-6  ]: Using snowflake connection "model.billy_bulky.int_products_performance"
[0m17:38:34.575083 [debug] [Thread-6  ]: On model.billy_bulky.int_products_performance: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.int_products_performance"} */
create or replace transient table E_COMMERCE.intermediate.int_products_performance
         as
        (WITH orders AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__orders
)

, products AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__products
)

, product_sales AS (
    SELECT
        o.PRODUCT_ID
        , COUNT(DISTINCT o.ORDER_ID) AS total_sales
        , SUM(o.QUANTITY) AS total_units_sold
        , SUM(o.QUANTITY * p.PRICE) AS total_sales_value
    FROM orders o
    INNER JOIN products p ON o.PRODUCT_ID = p.PRODUCT_ID
    WHERE o.STATUS NOT IN ('cancelled') 
    GROUP BY o.PRODUCT_ID
)

, product_averages AS (
    SELECT
        PRODUCT_ID
        , (total_sales_value / NULLIF(total_units_sold, 0)) AS average_sale_price
    FROM product_sales
)

, product_stock_turnover AS (
    SELECT
        p.PRODUCT_ID
        , p.STOCK_LEVEL
        , (total_units_sold / NULLIF(p.STOCK_LEVEL, 0)) AS turnover_rate
    FROM product_sales ps
    INNER JOIN products p ON ps.PRODUCT_ID = p.PRODUCT_ID
)

, final AS (
    SELECT
    p.PRODUCT_ID
    , p.NAME
    , p.CATEGORY
    , p.PRICE
    , pa.average_sale_price
    , ps.total_sales
    , ps.total_units_sold
    , ps.total_sales_value
    , pst.turnover_rate
    , p.STOCK_LEVEL
FROM products p
LEFT JOIN product_sales ps ON p.PRODUCT_ID = ps.PRODUCT_ID
LEFT JOIN product_averages pa ON p.PRODUCT_ID = pa.PRODUCT_ID
LEFT JOIN product_stock_turnover pst ON p.PRODUCT_ID = pst.PRODUCT_ID
)

SELECT * FROM final
        );
[0m17:38:34.575387 [debug] [Thread-6  ]: Opening a new connection, currently in state init
[0m17:38:34.576958 [debug] [Thread-5  ]: Using snowflake connection "model.billy_bulky.int_customers_segmentation"
[0m17:38:34.577666 [debug] [Thread-5  ]: On model.billy_bulky.int_customers_segmentation: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.int_customers_segmentation"} */
create or replace transient table E_COMMERCE.intermediate.int_customers_segmentation
         as
        (WITH customers AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__customers
)

, orders AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__orders
)

, products AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__products
)

, order_aggregates AS (
    SELECT
        o.CUSTOMER_ID
        , COUNT(DISTINCT o.ORDER_ID) AS frequency
        , SUM(o.QUANTITY * p.PRICE) AS monetary
        , AVG(o.QUANTITY * p.PRICE) AS average_order_value
        , MAX(o.ORDER_DATE) AS last_purchase_date
        , COUNT(CASE WHEN o.STATUS = 'cancelled' THEN 1 END) AS cancelled_orders
        , COUNT(*) AS total_orders
    FROM orders o
    JOIN products p ON o.PRODUCT_ID = p.PRODUCT_ID
    GROUP BY o.CUSTOMER_ID
)

, customer_tenure AS (
    SELECT
        CUSTOMER_ID
        , JOIN_DATE
        , CURRENT_DATE - JOIN_DATE AS tenure
    FROM customers
)

, customer_recency AS (
    SELECT
        CUSTOMER_ID
        , CURRENT_DATE - last_purchase_date AS recency
    FROM order_aggregates
)

, final AS (
    SELECT
        c.CUSTOMER_ID
        , c.FIRST_NAME
        , c.LAST_NAME
        , c.EMAIL
        , c.JOIN_DATE
        , c.COUNTRY
        , o.frequency
        , o.monetary
        , o.average_order_value
        , o.cancelled_orders
        , o.total_orders
        , CASE 
            WHEN o.total_orders > 0 THEN ROUND((o.cancelled_orders::FLOAT / o.total_orders) * 100, 2) 
            ELSE 0 
          END AS cancellation_rate
        , r.recency
        , t.tenure
    FROM customer_tenure t
    JOIN customers c ON t.CUSTOMER_ID = c.CUSTOMER_ID
    JOIN order_aggregates o ON c.CUSTOMER_ID = o.CUSTOMER_ID
    JOIN customer_recency r ON c.CUSTOMER_ID = r.CUSTOMER_ID
)

SELECT * FROM final
        );
[0m17:38:34.578028 [debug] [Thread-5  ]: Opening a new connection, currently in state init
[0m17:38:34.580440 [debug] [Thread-7  ]: Using snowflake connection "model.billy_bulky.int_sales_trends"
[0m17:38:34.581041 [debug] [Thread-7  ]: On model.billy_bulky.int_sales_trends: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.int_sales_trends"} */
create or replace transient table E_COMMERCE.intermediate.int_sales_trends
         as
        (WITH orders AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__orders
)

, products AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__products
)

, daily_sales AS (
    SELECT
        DATE(ORDER_DATE) AS sale_date
        , COUNT(DISTINCT ORDER_ID) AS total_orders
        , SUM(QUANTITY) AS total_units_sold
        , SUM(QUANTITY * PRICE) AS total_sales_value
    FROM orders AS o
    JOIN products AS p ON o.PRODUCT_ID = p.PRODUCT_ID
    WHERE o.STATUS NOT IN ('cancelled') 
    GROUP BY sale_date
)

, weekly_sales AS (
    SELECT
        DATE_TRUNC('week', sale_date) AS sale_week
        , SUM(total_orders) AS weekly_orders
        , SUM(total_units_sold) AS weekly_units_sold
        , SUM(total_sales_value) AS weekly_sales_value
    FROM daily_sales
    GROUP BY sale_week
)

, monthly_sales AS (
    SELECT
        DATE_TRUNC('month', sale_date) AS sale_month
        , SUM(total_orders) AS monthly_orders
        , SUM(total_units_sold) AS monthly_units_sold
        , SUM(total_sales_value) AS monthly_sales_value
    FROM daily_sales
    GROUP BY sale_month
)

, yearly_sales AS (
    SELECT
        DATE_TRUNC('year', sale_date) AS sale_year
        , SUM(total_orders) AS yearly_orders
        , SUM(total_units_sold) AS yearly_units_sold
        , SUM(total_sales_value) AS yearly_sales_value
    FROM daily_sales
    GROUP BY sale_year
)

SELECT
    d.sale_date
    , d.total_orders AS daily_orders
    , d.total_units_sold AS daily_units_sold
    , d.total_sales_value AS daily_sales_value
    , w.weekly_orders
    , w.weekly_units_sold
    , w.weekly_sales_value
    , m.monthly_orders
    , m.monthly_units_sold
    , m.monthly_sales_value
    , y.yearly_orders
    , y.yearly_units_sold
    , y.yearly_sales_value
FROM daily_sales d
LEFT JOIN weekly_sales w ON DATE_TRUNC('week', d.sale_date) = w.sale_week
LEFT JOIN monthly_sales m ON DATE_TRUNC('month', d.sale_date) = m.sale_month
LEFT JOIN yearly_sales y ON DATE_TRUNC('year', d.sale_date) = y.sale_year
        );
[0m17:38:34.581438 [debug] [Thread-7  ]: Opening a new connection, currently in state init
[0m17:38:37.362221 [debug] [Thread-7  ]: SQL status: SUCCESS 1 in 3.0 seconds
[0m17:38:37.364337 [debug] [Thread-6  ]: SQL status: SUCCESS 1 in 3.0 seconds
[0m17:38:37.369904 [debug] [Thread-7  ]: Timing info for model.billy_bulky.int_sales_trends (execute): 17:38:34.571097 => 17:38:37.369465
[0m17:38:37.373596 [debug] [Thread-6  ]: Timing info for model.billy_bulky.int_products_performance (execute): 17:38:34.559950 => 17:38:37.373227
[0m17:38:37.374358 [debug] [Thread-7  ]: On model.billy_bulky.int_sales_trends: Close
[0m17:38:37.375021 [debug] [Thread-6  ]: On model.billy_bulky.int_products_performance: Close
[0m17:38:37.570310 [debug] [Thread-5  ]: SQL status: SUCCESS 1 in 3.0 seconds
[0m17:38:37.576532 [debug] [Thread-5  ]: Timing info for model.billy_bulky.int_customers_segmentation (execute): 17:38:34.537904 => 17:38:37.576105
[0m17:38:37.577558 [debug] [Thread-5  ]: On model.billy_bulky.int_customers_segmentation: Close
[0m17:38:37.775710 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5186d1e-2208-4d20-985d-9ca7a9edb09f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12efe78b0>]}
[0m17:38:37.777418 [debug] [Thread-7  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5186d1e-2208-4d20-985d-9ca7a9edb09f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b7bfe20>]}
[0m17:38:37.778659 [info ] [Thread-6  ]: 5 of 6 OK created sql table model intermediate.int_products_performance ........ [[32mSUCCESS 1[0m in 3.25s]
[0m17:38:37.779957 [info ] [Thread-7  ]: 6 of 6 OK created sql table model intermediate.int_sales_trends ................ [[32mSUCCESS 1[0m in 3.25s]
[0m17:38:37.780959 [debug] [Thread-6  ]: Finished running node model.billy_bulky.int_products_performance
[0m17:38:37.781866 [debug] [Thread-7  ]: Finished running node model.billy_bulky.int_sales_trends
[0m17:38:37.980366 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5186d1e-2208-4d20-985d-9ca7a9edb09f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ec913d0>]}
[0m17:38:37.981788 [info ] [Thread-5  ]: 4 of 6 OK created sql table model intermediate.int_customers_segmentation ...... [[32mSUCCESS 1[0m in 3.46s]
[0m17:38:37.982859 [debug] [Thread-5  ]: Finished running node model.billy_bulky.int_customers_segmentation
[0m17:38:37.985891 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:38:37.986562 [debug] [MainThread]: Connection 'model.billy_bulky.staging_shopify__customers' was properly closed.
[0m17:38:37.987106 [debug] [MainThread]: Connection 'model.billy_bulky.staging_shopify__orders' was properly closed.
[0m17:38:37.987604 [debug] [MainThread]: Connection 'model.billy_bulky.staging_shopify__products' was properly closed.
[0m17:38:37.988084 [debug] [MainThread]: Connection 'model.billy_bulky.int_customers_segmentation' was properly closed.
[0m17:38:37.988559 [debug] [MainThread]: Connection 'model.billy_bulky.int_products_performance' was properly closed.
[0m17:38:37.989025 [debug] [MainThread]: Connection 'model.billy_bulky.int_sales_trends' was properly closed.
[0m17:38:37.989623 [info ] [MainThread]: 
[0m17:38:37.990111 [info ] [MainThread]: Finished running 3 view models, 3 table models in 0 hours 0 minutes and 9.02 seconds (9.02s).
[0m17:38:37.991857 [debug] [MainThread]: Command end result
[0m17:38:38.009796 [info ] [MainThread]: 
[0m17:38:38.010378 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:38:38.010804 [info ] [MainThread]: 
[0m17:38:38.011222 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m17:38:38.014378 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.27238, "process_user_time": 5.198934, "process_kernel_time": 0.484546, "process_mem_max_rss": "214712320", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:38:38.014999 [debug] [MainThread]: Command `dbt run` succeeded at 17:38:38.014866 after 10.27 seconds
[0m17:38:38.015402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102fb9ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b198130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b7cf040>]}
[0m17:38:38.015836 [debug] [MainThread]: Flushing usage events
[0m17:46:54.276927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104800250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10706c2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10706c850>]}


============================== 17:46:54.279783 | 63b910e9-89bd-43e6-90cf-d45bcee0d2e2 ==============================
[0m17:46:54.279783 [info ] [MainThread]: Running with dbt=1.7.1
[0m17:46:54.280129 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/bitlevi/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/bitlevi/Documents/billy_bulky_ecommerce/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:46:55.141184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '63b910e9-89bd-43e6-90cf-d45bcee0d2e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d719850>]}
[0m17:46:55.189502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '63b910e9-89bd-43e6-90cf-d45bcee0d2e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d62a490>]}
[0m17:46:55.190249 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m17:46:55.202343 [debug] [MainThread]: checksum: ad428e6dc3b353dcb23d0c4ebea8b20b180e94b873271ac2a054a8e446dac0e2, vars: {}, profile: , target: , version: 1.7.1
[0m17:46:55.236795 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 3 files added, 0 files changed.
[0m17:46:55.237287 [debug] [MainThread]: Partial parsing: added file: billy_bulky://models/marts/_marts__docs.md
[0m17:46:55.237518 [debug] [MainThread]: Partial parsing: added file: billy_bulky://models/marts/sales.sql
[0m17:46:55.237800 [debug] [MainThread]: Partial parsing: added file: billy_bulky://models/marts/_marts__models.yml
[0m17:46:55.238026 [debug] [MainThread]: Partial parsing: deleted file: billy_bulky://models/marts/orders.sql
[0m17:46:55.340861 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'sales_fact' in the 'models' section of file 'models/marts/_marts__models.yml'
[0m17:46:55.417284 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'orders' in the 'models' section of file 'models/staging/shopify/_shopify__schema.yml'
[0m17:46:55.482945 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.unique_sales_fact_order_id.8431c39e26' (models/marts/_marts__models.yml) depends on a node named 'sales_fact' in package '' which was not found
[0m17:46:55.483325 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_sales_fact_order_id.f43728f177' (models/marts/_marts__models.yml) depends on a node named 'sales_fact' in package '' which was not found
[0m17:46:55.483561 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_sales_fact_customer_id.f68521ea9a' (models/marts/_marts__models.yml) depends on a node named 'sales_fact' in package '' which was not found
[0m17:46:55.483785 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.relationships_sales_fact_customer_id__customer_id__ref_dim_customers_.a3d6e6ea82' (models/marts/_marts__models.yml) depends on a node named 'dim_customers' in package '' which was not found
[0m17:46:55.484009 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.relationships_sales_fact_customer_id__customer_id__ref_dim_customers_.a3d6e6ea82' (models/marts/_marts__models.yml) depends on a node named 'sales_fact' in package '' which was not found
[0m17:46:55.484228 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_sales_fact_product_id.19f5ce154e' (models/marts/_marts__models.yml) depends on a node named 'sales_fact' in package '' which was not found
[0m17:46:55.484439 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.relationships_sales_fact_product_id__product_id__ref_dim_products_.e51bdbe6df' (models/marts/_marts__models.yml) depends on a node named 'dim_products' in package '' which was not found
[0m17:46:55.484654 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.relationships_sales_fact_product_id__product_id__ref_dim_products_.e51bdbe6df' (models/marts/_marts__models.yml) depends on a node named 'sales_fact' in package '' which was not found
[0m17:46:55.484863 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_sales_fact_quantity.005f9fd430' (models/marts/_marts__models.yml) depends on a node named 'sales_fact' in package '' which was not found
[0m17:46:55.485077 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_sales_fact_order_date.fef7ccf6a7' (models/marts/_marts__models.yml) depends on a node named 'sales_fact' in package '' which was not found
[0m17:46:55.485283 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_sales_fact_status.eff8463bed' (models/marts/_marts__models.yml) depends on a node named 'sales_fact' in package '' which was not found
[0m17:46:55.485486 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_sales_fact_category.8c65c1dfee' (models/marts/_marts__models.yml) depends on a node named 'sales_fact' in package '' which was not found
[0m17:46:55.485698 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_sales_fact_unit_price.0053974229' (models/marts/_marts__models.yml) depends on a node named 'sales_fact' in package '' which was not found
[0m17:46:55.485905 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_sales_fact_total_price.989b49f0a3' (models/marts/_marts__models.yml) depends on a node named 'sales_fact' in package '' which was not found
[0m17:46:55.486110 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_sales_fact_country.c90b50e864' (models/marts/_marts__models.yml) depends on a node named 'sales_fact' in package '' which was not found
[0m17:46:55.486316 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.unique_orders_order_id.fed79b3a6e' (models/staging/shopify/_shopify__schema.yml) depends on a node named 'orders' in package '' which was not found
[0m17:46:55.486520 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_orders_order_id.cf6c17daed' (models/staging/shopify/_shopify__schema.yml) depends on a node named 'orders' in package '' which was not found
[0m17:46:55.486725 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_orders_customer_id.c5f02694af' (models/staging/shopify/_shopify__schema.yml) depends on a node named 'orders' in package '' which was not found
[0m17:46:55.486928 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_orders_product_id.3523c78a66' (models/staging/shopify/_shopify__schema.yml) depends on a node named 'orders' in package '' which was not found
[0m17:46:55.487137 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_orders_quantity.0e6bb23b03' (models/staging/shopify/_shopify__schema.yml) depends on a node named 'orders' in package '' which was not found
[0m17:46:55.487340 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_orders_order_date.6910a855fe' (models/staging/shopify/_shopify__schema.yml) depends on a node named 'orders' in package '' which was not found
[0m17:46:55.487542 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_orders_status.8a27272c0a' (models/staging/shopify/_shopify__schema.yml) depends on a node named 'orders' in package '' which was not found
[0m17:46:55.487754 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.accepted_values_orders_status__cancelled__processing__delivered__shipped.fbff2d9925' (models/staging/shopify/_shopify__schema.yml) depends on a node named 'orders' in package '' which was not found
[0m17:46:55.496209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '63b910e9-89bd-43e6-90cf-d45bcee0d2e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11df24040>]}
[0m17:46:55.508047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '63b910e9-89bd-43e6-90cf-d45bcee0d2e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11dd67a90>]}
[0m17:46:55.508400 [info ] [MainThread]: Found 8 models, 20 tests, 3 sources, 0 exposures, 0 metrics, 431 macros, 0 groups, 0 semantic models
[0m17:46:55.508629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '63b910e9-89bd-43e6-90cf-d45bcee0d2e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11dd67b80>]}
[0m17:46:55.509877 [info ] [MainThread]: 
[0m17:46:55.510386 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:46:55.511161 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE'
[0m17:46:55.519194 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE"
[0m17:46:55.519434 [debug] [ThreadPool]: On list_E_COMMERCE: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE"} */
show terse schemas in database E_COMMERCE
    limit 10000
[0m17:46:55.519635 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:46:55.520263 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE'
[0m17:46:55.521714 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE"
[0m17:46:55.521933 [debug] [ThreadPool]: On list_E_COMMERCE: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE"} */
show terse schemas in database E_COMMERCE
    limit 10000
[0m17:46:55.522122 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:46:55.523141 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE'
[0m17:46:55.524716 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE"
[0m17:46:55.524932 [debug] [ThreadPool]: On list_E_COMMERCE: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE"} */
show terse schemas in database E_COMMERCE
    limit 10000
[0m17:46:55.525115 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:46:57.119012 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.0 seconds
[0m17:46:57.124493 [debug] [ThreadPool]: On list_E_COMMERCE: Close
[0m17:46:57.126149 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.0 seconds
[0m17:46:57.128068 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.0 seconds
[0m17:46:57.133883 [debug] [ThreadPool]: On list_E_COMMERCE: Close
[0m17:46:57.136239 [debug] [ThreadPool]: On list_E_COMMERCE: Close
[0m17:46:57.514509 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_E_COMMERCE, now create_E_COMMERCE_PUBLIC)
[0m17:46:57.517059 [debug] [ThreadPool]: Creating schema "database: "E_COMMERCE"
schema: "PUBLIC"
"
[0m17:46:57.531270 [debug] [ThreadPool]: Using snowflake connection "create_E_COMMERCE_PUBLIC"
[0m17:46:57.532133 [debug] [ThreadPool]: On create_E_COMMERCE_PUBLIC: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "create_E_COMMERCE_PUBLIC"} */
create schema if not exists E_COMMERCE.PUBLIC
[0m17:46:57.532711 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:46:58.847325 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m17:46:58.851060 [debug] [ThreadPool]: On create_E_COMMERCE_PUBLIC: Close
[0m17:46:59.243200 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_E_COMMERCE, now list_E_COMMERCE_staging)
[0m17:46:59.244736 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_E_COMMERCE_PUBLIC, now list_E_COMMERCE_PUBLIC)
[0m17:46:59.247736 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_E_COMMERCE, now list_E_COMMERCE_intermediate)
[0m17:46:59.265325 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_staging"
[0m17:46:59.268762 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PUBLIC"
[0m17:46:59.272081 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_intermediate"
[0m17:46:59.272628 [debug] [ThreadPool]: On list_E_COMMERCE_staging: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE_staging"} */
show terse objects in E_COMMERCE.staging limit 10000
[0m17:46:59.273146 [debug] [ThreadPool]: On list_E_COMMERCE_PUBLIC: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE_PUBLIC"} */
show terse objects in E_COMMERCE.PUBLIC limit 10000
[0m17:46:59.273642 [debug] [ThreadPool]: On list_E_COMMERCE_intermediate: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE_intermediate"} */
show terse objects in E_COMMERCE.intermediate limit 10000
[0m17:46:59.274122 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:46:59.274552 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:46:59.274989 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:47:00.392272 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m17:47:00.399297 [debug] [ThreadPool]: On list_E_COMMERCE_intermediate: Close
[0m17:47:00.450968 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.0 seconds
[0m17:47:00.457459 [debug] [ThreadPool]: On list_E_COMMERCE_PUBLIC: Close
[0m17:47:00.479866 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m17:47:00.484951 [debug] [ThreadPool]: On list_E_COMMERCE_staging: Close
[0m17:47:00.991547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '63b910e9-89bd-43e6-90cf-d45bcee0d2e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d719c40>]}
[0m17:47:00.994420 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m17:47:00.995450 [info ] [MainThread]: 
[0m17:47:01.002713 [debug] [Thread-1  ]: Began running node model.billy_bulky.staging_shopify__customers
[0m17:47:01.003661 [debug] [Thread-2  ]: Began running node model.billy_bulky.staging_shopify__orders
[0m17:47:01.004405 [debug] [Thread-3  ]: Began running node model.billy_bulky.staging_shopify__products
[0m17:47:01.005343 [info ] [Thread-1  ]: 1 of 7 START sql view model staging.staging_shopify__customers ................. [RUN]
[0m17:47:01.006218 [info ] [Thread-2  ]: 2 of 7 START sql view model staging.staging_shopify__orders .................... [RUN]
[0m17:47:01.007641 [info ] [Thread-3  ]: 3 of 7 START sql view model staging.staging_shopify__products .................. [RUN]
[0m17:47:01.011983 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_E_COMMERCE_staging, now model.billy_bulky.staging_shopify__customers)
[0m17:47:01.013189 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_E_COMMERCE_PUBLIC, now model.billy_bulky.staging_shopify__orders)
[0m17:47:01.014374 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly list_E_COMMERCE_intermediate, now model.billy_bulky.staging_shopify__products)
[0m17:47:01.015117 [debug] [Thread-1  ]: Began compiling node model.billy_bulky.staging_shopify__customers
[0m17:47:01.015794 [debug] [Thread-2  ]: Began compiling node model.billy_bulky.staging_shopify__orders
[0m17:47:01.016438 [debug] [Thread-3  ]: Began compiling node model.billy_bulky.staging_shopify__products
[0m17:47:01.028627 [debug] [Thread-1  ]: Writing injected SQL for node "model.billy_bulky.staging_shopify__customers"
[0m17:47:01.032249 [debug] [Thread-2  ]: Writing injected SQL for node "model.billy_bulky.staging_shopify__orders"
[0m17:47:01.035567 [debug] [Thread-3  ]: Writing injected SQL for node "model.billy_bulky.staging_shopify__products"
[0m17:47:01.037555 [debug] [Thread-1  ]: Timing info for model.billy_bulky.staging_shopify__customers (compile): 17:47:01.016879 => 17:47:01.037289
[0m17:47:01.038042 [debug] [Thread-3  ]: Timing info for model.billy_bulky.staging_shopify__products (compile): 17:47:01.032604 => 17:47:01.037809
[0m17:47:01.038469 [debug] [Thread-2  ]: Timing info for model.billy_bulky.staging_shopify__orders (compile): 17:47:01.028967 => 17:47:01.038266
[0m17:47:01.038877 [debug] [Thread-1  ]: Began executing node model.billy_bulky.staging_shopify__customers
[0m17:47:01.039298 [debug] [Thread-3  ]: Began executing node model.billy_bulky.staging_shopify__products
[0m17:47:01.039708 [debug] [Thread-2  ]: Began executing node model.billy_bulky.staging_shopify__orders
[0m17:47:01.074202 [debug] [Thread-1  ]: Writing runtime sql for node "model.billy_bulky.staging_shopify__customers"
[0m17:47:01.074876 [debug] [Thread-3  ]: Writing runtime sql for node "model.billy_bulky.staging_shopify__products"
[0m17:47:01.077468 [debug] [Thread-2  ]: Writing runtime sql for node "model.billy_bulky.staging_shopify__orders"
[0m17:47:01.078425 [debug] [Thread-2  ]: Using snowflake connection "model.billy_bulky.staging_shopify__orders"
[0m17:47:01.078884 [debug] [Thread-1  ]: Using snowflake connection "model.billy_bulky.staging_shopify__customers"
[0m17:47:01.079136 [debug] [Thread-2  ]: On model.billy_bulky.staging_shopify__orders: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.staging_shopify__orders"} */
create or replace   view E_COMMERCE.staging.staging_shopify__orders
  
   as (
    WITH orders AS (
    SELECT * FROM SHOPIFY.PUBLIC.orders
)

SELECT
    ORDER_ID
    , CUSTOMER_ID
    , PRODUCT_ID
    , QUANTITY
    , ORDER_DATE
    , STATUS
FROM orders
  );
[0m17:47:01.079561 [debug] [Thread-3  ]: Using snowflake connection "model.billy_bulky.staging_shopify__products"
[0m17:47:01.079803 [debug] [Thread-1  ]: On model.billy_bulky.staging_shopify__customers: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.staging_shopify__customers"} */
create or replace   view E_COMMERCE.staging.staging_shopify__customers
  
   as (
    WITH customers AS (
    SELECT * FROM SHOPIFY.PUBLIC.customers
)

SELECT
    CUSTOMER_ID
    , FIRST_NAME
    , LAST_NAME
    , EMAIL
    , JOIN_DATE
    , COUNTRY
FROM customers
  );
[0m17:47:01.080036 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m17:47:01.080268 [debug] [Thread-3  ]: On model.billy_bulky.staging_shopify__products: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.staging_shopify__products"} */
create or replace   view E_COMMERCE.staging.staging_shopify__products
  
   as (
    WITH products AS (
    SELECT * FROM SHOPIFY.PUBLIC.products
)

SELECT
    PRODUCT_ID
    , NAME
    , CATEGORY
    , PRICE
    , STOCK_LEVEL
FROM products
  );
[0m17:47:01.080489 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:47:01.081086 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m17:47:02.531271 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m17:47:02.573852 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m17:47:02.574942 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m17:47:02.577742 [debug] [Thread-2  ]: Timing info for model.billy_bulky.staging_shopify__orders (execute): 17:47:01.075019 => 17:47:02.577418
[0m17:47:02.580894 [debug] [Thread-1  ]: Timing info for model.billy_bulky.staging_shopify__customers (execute): 17:47:01.039994 => 17:47:02.580640
[0m17:47:02.583771 [debug] [Thread-3  ]: Timing info for model.billy_bulky.staging_shopify__products (execute): 17:47:01.045864 => 17:47:02.583521
[0m17:47:02.584301 [debug] [Thread-2  ]: On model.billy_bulky.staging_shopify__orders: Close
[0m17:47:02.584774 [debug] [Thread-1  ]: On model.billy_bulky.staging_shopify__customers: Close
[0m17:47:02.585270 [debug] [Thread-3  ]: On model.billy_bulky.staging_shopify__products: Close
[0m17:47:02.949689 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63b910e9-89bd-43e6-90cf-d45bcee0d2e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122637820>]}
[0m17:47:02.953596 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63b910e9-89bd-43e6-90cf-d45bcee0d2e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1226312e0>]}
[0m17:47:02.955507 [info ] [Thread-1  ]: 1 of 7 OK created sql view model staging.staging_shopify__customers ............ [[32mSUCCESS 1[0m in 1.94s]
[0m17:47:02.957049 [info ] [Thread-3  ]: 3 of 7 OK created sql view model staging.staging_shopify__products ............. [[32mSUCCESS 1[0m in 1.94s]
[0m17:47:02.958921 [debug] [Thread-1  ]: Finished running node model.billy_bulky.staging_shopify__customers
[0m17:47:02.960259 [debug] [Thread-3  ]: Finished running node model.billy_bulky.staging_shopify__products
[0m17:47:02.962027 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63b910e9-89bd-43e6-90cf-d45bcee0d2e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122723a00>]}
[0m17:47:02.963873 [info ] [Thread-2  ]: 2 of 7 OK created sql view model staging.staging_shopify__orders ............... [[32mSUCCESS 1[0m in 1.95s]
[0m17:47:02.965050 [debug] [Thread-2  ]: Finished running node model.billy_bulky.staging_shopify__orders
[0m17:47:02.966831 [debug] [Thread-5  ]: Began running node model.billy_bulky.int_customers_segmentation
[0m17:47:02.968319 [debug] [Thread-6  ]: Began running node model.billy_bulky.int_products_performance
[0m17:47:02.969567 [info ] [Thread-5  ]: 4 of 7 START sql table model intermediate.int_customers_segmentation ........... [RUN]
[0m17:47:02.970606 [debug] [Thread-7  ]: Began running node model.billy_bulky.int_sales_trends
[0m17:47:02.971479 [debug] [Thread-8  ]: Began running node model.billy_bulky.sales
[0m17:47:02.972252 [info ] [Thread-6  ]: 5 of 7 START sql table model intermediate.int_products_performance ............. [RUN]
[0m17:47:02.973675 [debug] [Thread-5  ]: Acquiring new snowflake connection 'model.billy_bulky.int_customers_segmentation'
[0m17:47:02.974478 [info ] [Thread-7  ]: 6 of 7 START sql table model intermediate.int_sales_trends ..................... [RUN]
[0m17:47:02.975268 [info ] [Thread-8  ]: 7 of 7 START sql view model PUBLIC.sales ....................................... [RUN]
[0m17:47:02.976524 [debug] [Thread-6  ]: Acquiring new snowflake connection 'model.billy_bulky.int_products_performance'
[0m17:47:02.977194 [debug] [Thread-5  ]: Began compiling node model.billy_bulky.int_customers_segmentation
[0m17:47:02.978375 [debug] [Thread-7  ]: Acquiring new snowflake connection 'model.billy_bulky.int_sales_trends'
[0m17:47:02.979359 [debug] [Thread-8  ]: Acquiring new snowflake connection 'model.billy_bulky.sales'
[0m17:47:02.979880 [debug] [Thread-6  ]: Began compiling node model.billy_bulky.int_products_performance
[0m17:47:02.986039 [debug] [Thread-5  ]: Writing injected SQL for node "model.billy_bulky.int_customers_segmentation"
[0m17:47:02.986596 [debug] [Thread-7  ]: Began compiling node model.billy_bulky.int_sales_trends
[0m17:47:02.987033 [debug] [Thread-8  ]: Began compiling node model.billy_bulky.sales
[0m17:47:02.990866 [debug] [Thread-6  ]: Writing injected SQL for node "model.billy_bulky.int_products_performance"
[0m17:47:02.995067 [debug] [Thread-7  ]: Writing injected SQL for node "model.billy_bulky.int_sales_trends"
[0m17:47:02.999821 [debug] [Thread-8  ]: Writing injected SQL for node "model.billy_bulky.sales"
[0m17:47:03.000520 [debug] [Thread-5  ]: Timing info for model.billy_bulky.int_customers_segmentation (compile): 17:47:02.980214 => 17:47:03.000260
[0m17:47:03.001032 [debug] [Thread-6  ]: Timing info for model.billy_bulky.int_products_performance (compile): 17:47:02.987306 => 17:47:03.000816
[0m17:47:03.001516 [debug] [Thread-5  ]: Began executing node model.billy_bulky.int_customers_segmentation
[0m17:47:03.002020 [debug] [Thread-7  ]: Timing info for model.billy_bulky.int_sales_trends (compile): 17:47:02.991287 => 17:47:03.001783
[0m17:47:03.002426 [debug] [Thread-6  ]: Began executing node model.billy_bulky.int_products_performance
[0m17:47:03.009293 [debug] [Thread-8  ]: Timing info for model.billy_bulky.sales (compile): 17:47:02.995384 => 17:47:03.009030
[0m17:47:03.022345 [debug] [Thread-7  ]: Began executing node model.billy_bulky.int_sales_trends
[0m17:47:03.022815 [debug] [Thread-5  ]: Writing runtime sql for node "model.billy_bulky.int_customers_segmentation"
[0m17:47:03.024993 [debug] [Thread-6  ]: Writing runtime sql for node "model.billy_bulky.int_products_performance"
[0m17:47:03.025313 [debug] [Thread-8  ]: Began executing node model.billy_bulky.sales
[0m17:47:03.027385 [debug] [Thread-7  ]: Writing runtime sql for node "model.billy_bulky.int_sales_trends"
[0m17:47:03.029767 [debug] [Thread-8  ]: Writing runtime sql for node "model.billy_bulky.sales"
[0m17:47:03.031574 [debug] [Thread-5  ]: Using snowflake connection "model.billy_bulky.int_customers_segmentation"
[0m17:47:03.033021 [debug] [Thread-6  ]: Using snowflake connection "model.billy_bulky.int_products_performance"
[0m17:47:03.033363 [debug] [Thread-5  ]: On model.billy_bulky.int_customers_segmentation: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.int_customers_segmentation"} */
create or replace transient table E_COMMERCE.intermediate.int_customers_segmentation
         as
        (WITH customers AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__customers
)

, orders AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__orders
)

, products AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__products
)

, order_aggregates AS (
    SELECT
        o.CUSTOMER_ID
        , COUNT(DISTINCT o.ORDER_ID) AS frequency
        , SUM(o.QUANTITY * p.PRICE) AS monetary
        , AVG(o.QUANTITY * p.PRICE) AS average_order_value
        , MAX(o.ORDER_DATE) AS last_purchase_date
        , COUNT(CASE WHEN o.STATUS = 'cancelled' THEN 1 END) AS cancelled_orders
        , COUNT(*) AS total_orders
    FROM orders o
    JOIN products p ON o.PRODUCT_ID = p.PRODUCT_ID
    GROUP BY o.CUSTOMER_ID
)

, customer_tenure AS (
    SELECT
        CUSTOMER_ID
        , JOIN_DATE
        , CURRENT_DATE - JOIN_DATE AS tenure
    FROM customers
)

, customer_recency AS (
    SELECT
        CUSTOMER_ID
        , CURRENT_DATE - last_purchase_date AS recency
    FROM order_aggregates
)

, final AS (
    SELECT
        c.CUSTOMER_ID
        , c.FIRST_NAME
        , c.LAST_NAME
        , c.EMAIL
        , c.JOIN_DATE
        , c.COUNTRY
        , o.frequency
        , o.monetary
        , o.average_order_value
        , o.cancelled_orders
        , o.total_orders
        , CASE 
            WHEN o.total_orders > 0 THEN ROUND((o.cancelled_orders::FLOAT / o.total_orders) * 100, 2) 
            ELSE 0 
          END AS cancellation_rate
        , r.recency
        , t.tenure
    FROM customer_tenure t
    JOIN customers c ON t.CUSTOMER_ID = c.CUSTOMER_ID
    JOIN order_aggregates o ON c.CUSTOMER_ID = o.CUSTOMER_ID
    JOIN customer_recency r ON c.CUSTOMER_ID = r.CUSTOMER_ID
)

SELECT * FROM final
        );
[0m17:47:03.033800 [debug] [Thread-6  ]: On model.billy_bulky.int_products_performance: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.int_products_performance"} */
create or replace transient table E_COMMERCE.intermediate.int_products_performance
         as
        (WITH orders AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__orders
)

, products AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__products
)

, product_sales AS (
    SELECT
        o.PRODUCT_ID
        , COUNT(DISTINCT o.ORDER_ID) AS total_sales
        , SUM(o.QUANTITY) AS total_units_sold
        , SUM(o.QUANTITY * p.PRICE) AS total_sales_value
    FROM orders o
    INNER JOIN products p ON o.PRODUCT_ID = p.PRODUCT_ID
    WHERE o.STATUS NOT IN ('cancelled') 
    GROUP BY o.PRODUCT_ID
)

, product_averages AS (
    SELECT
        PRODUCT_ID
        , (total_sales_value / NULLIF(total_units_sold, 0)) AS average_sale_price
    FROM product_sales
)

, product_stock_turnover AS (
    SELECT
        p.PRODUCT_ID
        , p.STOCK_LEVEL
        , (total_units_sold / NULLIF(p.STOCK_LEVEL, 0)) AS turnover_rate
    FROM product_sales ps
    INNER JOIN products p ON ps.PRODUCT_ID = p.PRODUCT_ID
)

, final AS (
    SELECT
    p.PRODUCT_ID
    , p.NAME
    , p.CATEGORY
    , p.PRICE
    , pa.average_sale_price
    , ps.total_sales
    , ps.total_units_sold
    , ps.total_sales_value
    , pst.turnover_rate
    , p.STOCK_LEVEL
FROM products p
LEFT JOIN product_sales ps ON p.PRODUCT_ID = ps.PRODUCT_ID
LEFT JOIN product_averages pa ON p.PRODUCT_ID = pa.PRODUCT_ID
LEFT JOIN product_stock_turnover pst ON p.PRODUCT_ID = pst.PRODUCT_ID
)

SELECT * FROM final
        );
[0m17:47:03.034125 [debug] [Thread-5  ]: Opening a new connection, currently in state init
[0m17:47:03.035771 [debug] [Thread-7  ]: Using snowflake connection "model.billy_bulky.int_sales_trends"
[0m17:47:03.036003 [debug] [Thread-6  ]: Opening a new connection, currently in state init
[0m17:47:03.036930 [debug] [Thread-8  ]: Using snowflake connection "model.billy_bulky.sales"
[0m17:47:03.037566 [debug] [Thread-7  ]: On model.billy_bulky.int_sales_trends: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.int_sales_trends"} */
create or replace transient table E_COMMERCE.intermediate.int_sales_trends
         as
        (WITH orders AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__orders
)

, products AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__products
)

, daily_sales AS (
    SELECT
        DATE(ORDER_DATE) AS sale_date
        , COUNT(DISTINCT ORDER_ID) AS total_orders
        , SUM(QUANTITY) AS total_units_sold
        , SUM(QUANTITY * PRICE) AS total_sales_value
    FROM orders AS o
    JOIN products AS p ON o.PRODUCT_ID = p.PRODUCT_ID
    WHERE o.STATUS NOT IN ('cancelled') 
    GROUP BY sale_date
)

, weekly_sales AS (
    SELECT
        DATE_TRUNC('week', sale_date) AS sale_week
        , SUM(total_orders) AS weekly_orders
        , SUM(total_units_sold) AS weekly_units_sold
        , SUM(total_sales_value) AS weekly_sales_value
    FROM daily_sales
    GROUP BY sale_week
)

, monthly_sales AS (
    SELECT
        DATE_TRUNC('month', sale_date) AS sale_month
        , SUM(total_orders) AS monthly_orders
        , SUM(total_units_sold) AS monthly_units_sold
        , SUM(total_sales_value) AS monthly_sales_value
    FROM daily_sales
    GROUP BY sale_month
)

, yearly_sales AS (
    SELECT
        DATE_TRUNC('year', sale_date) AS sale_year
        , SUM(total_orders) AS yearly_orders
        , SUM(total_units_sold) AS yearly_units_sold
        , SUM(total_sales_value) AS yearly_sales_value
    FROM daily_sales
    GROUP BY sale_year
)

SELECT
    d.sale_date
    , d.total_orders AS daily_orders
    , d.total_units_sold AS daily_units_sold
    , d.total_sales_value AS daily_sales_value
    , w.weekly_orders
    , w.weekly_units_sold
    , w.weekly_sales_value
    , m.monthly_orders
    , m.monthly_units_sold
    , m.monthly_sales_value
    , y.yearly_orders
    , y.yearly_units_sold
    , y.yearly_sales_value
FROM daily_sales d
LEFT JOIN weekly_sales w ON DATE_TRUNC('week', d.sale_date) = w.sale_week
LEFT JOIN monthly_sales m ON DATE_TRUNC('month', d.sale_date) = m.sale_month
LEFT JOIN yearly_sales y ON DATE_TRUNC('year', d.sale_date) = y.sale_year
        );
[0m17:47:03.038509 [debug] [Thread-8  ]: On model.billy_bulky.sales: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.sales"} */
create or replace   view E_COMMERCE.PUBLIC.sales
  
   as (
    WITH customers AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__customers
)

, orders AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__orders
)

, products AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__products
)



, enriched_orders AS (
    SELECT
        o.ORDER_ID
        , o.CUSTOMER_ID
        , o.PRODUCT_ID
        , o.QUANTITY
        , o.ORDER_DATE
        , o.STATUS
        , p.CATEGORY
        , p.PRICE AS unit_price
        , (o.QUANTITY * p.PRICE) AS total_price
        , c.COUNTRY
    FROM orders o
    JOIN products p ON o.PRODUCT_ID = p.PRODUCT_ID
    JOIN customers c ON o.CUSTOMER_ID = c.CUSTOMER_ID
    WHERE o.STATUS NOT IN ('cancelled') 
)

, final AS (
SELECT
    e.ORDER_ID
    , e.CUSTOMER_ID
    , e.PRODUCT_ID
    , e.QUANTITY
    , e.ORDER_DATE
    , e.STATUS
    , e.CATEGORY
    , e.unit_price
    , e.total_price
    , e.COUNTRY
FROM enriched_orders e
)

SELECT * FROM final
  );
[0m17:47:03.038793 [debug] [Thread-7  ]: Opening a new connection, currently in state init
[0m17:47:03.039220 [debug] [Thread-8  ]: Opening a new connection, currently in state init
[0m17:47:04.557087 [debug] [Thread-8  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m17:47:04.566962 [debug] [Thread-8  ]: Timing info for model.billy_bulky.sales (execute): 17:47:03.027685 => 17:47:04.566203
[0m17:47:04.568339 [debug] [Thread-8  ]: On model.billy_bulky.sales: Close
[0m17:47:04.950261 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63b910e9-89bd-43e6-90cf-d45bcee0d2e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11df00550>]}
[0m17:47:04.953352 [info ] [Thread-8  ]: 7 of 7 OK created sql view model PUBLIC.sales .................................. [[32mSUCCESS 1[0m in 1.97s]
[0m17:47:04.954992 [debug] [Thread-8  ]: Finished running node model.billy_bulky.sales
[0m17:47:05.579030 [debug] [Thread-7  ]: SQL status: SUCCESS 1 in 3.0 seconds
[0m17:47:05.585330 [debug] [Thread-7  ]: Timing info for model.billy_bulky.int_sales_trends (execute): 17:47:03.025494 => 17:47:05.584881
[0m17:47:05.586193 [debug] [Thread-7  ]: On model.billy_bulky.int_sales_trends: Close
[0m17:47:05.671604 [debug] [Thread-5  ]: SQL status: SUCCESS 1 in 3.0 seconds
[0m17:47:05.679006 [debug] [Thread-5  ]: Timing info for model.billy_bulky.int_customers_segmentation (execute): 17:47:03.002710 => 17:47:05.678175
[0m17:47:05.680274 [debug] [Thread-5  ]: On model.billy_bulky.int_customers_segmentation: Close
[0m17:47:05.725989 [debug] [Thread-6  ]: SQL status: SUCCESS 1 in 3.0 seconds
[0m17:47:05.734351 [debug] [Thread-6  ]: Timing info for model.billy_bulky.int_products_performance (execute): 17:47:03.023028 => 17:47:05.733962
[0m17:47:05.735148 [debug] [Thread-6  ]: On model.billy_bulky.int_products_performance: Close
[0m17:47:05.939682 [debug] [Thread-7  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63b910e9-89bd-43e6-90cf-d45bcee0d2e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122703730>]}
[0m17:47:05.942734 [info ] [Thread-7  ]: 6 of 7 OK created sql table model intermediate.int_sales_trends ................ [[32mSUCCESS 1[0m in 2.96s]
[0m17:47:05.944897 [debug] [Thread-7  ]: Finished running node model.billy_bulky.int_sales_trends
[0m17:47:06.051234 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63b910e9-89bd-43e6-90cf-d45bcee0d2e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1227039a0>]}
[0m17:47:06.053765 [info ] [Thread-5  ]: 4 of 7 OK created sql table model intermediate.int_customers_segmentation ...... [[32mSUCCESS 1[0m in 3.08s]
[0m17:47:06.055598 [debug] [Thread-5  ]: Finished running node model.billy_bulky.int_customers_segmentation
[0m17:47:06.096873 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63b910e9-89bd-43e6-90cf-d45bcee0d2e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122758550>]}
[0m17:47:06.099793 [info ] [Thread-6  ]: 5 of 7 OK created sql table model intermediate.int_products_performance ........ [[32mSUCCESS 1[0m in 3.12s]
[0m17:47:06.102025 [debug] [Thread-6  ]: Finished running node model.billy_bulky.int_products_performance
[0m17:47:06.107034 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:47:06.108062 [debug] [MainThread]: Connection 'model.billy_bulky.staging_shopify__customers' was properly closed.
[0m17:47:06.108913 [debug] [MainThread]: Connection 'model.billy_bulky.staging_shopify__orders' was properly closed.
[0m17:47:06.109681 [debug] [MainThread]: Connection 'model.billy_bulky.staging_shopify__products' was properly closed.
[0m17:47:06.110310 [debug] [MainThread]: Connection 'model.billy_bulky.int_customers_segmentation' was properly closed.
[0m17:47:06.110923 [debug] [MainThread]: Connection 'model.billy_bulky.int_products_performance' was properly closed.
[0m17:47:06.111510 [debug] [MainThread]: Connection 'model.billy_bulky.int_sales_trends' was properly closed.
[0m17:47:06.112153 [debug] [MainThread]: Connection 'model.billy_bulky.sales' was properly closed.
[0m17:47:06.113016 [info ] [MainThread]: 
[0m17:47:06.113650 [info ] [MainThread]: Finished running 4 view models, 3 table models in 0 hours 0 minutes and 10.60 seconds (10.60s).
[0m17:47:06.116568 [debug] [MainThread]: Command end result
[0m17:47:06.138720 [info ] [MainThread]: 
[0m17:47:06.139356 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:47:06.139790 [info ] [MainThread]: 
[0m17:47:06.140243 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m17:47:06.143777 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.904525, "process_user_time": 5.89866, "process_kernel_time": 0.473559, "process_mem_max_rss": "211189760", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:47:06.144468 [debug] [MainThread]: Command `dbt run` succeeded at 17:47:06.144317 after 11.91 seconds
[0m17:47:06.144949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104800250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1215ef580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d726130>]}
[0m17:47:06.145433 [debug] [MainThread]: Flushing usage events
[0m17:49:35.499000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103431eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068f81f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068f8790>]}


============================== 17:49:35.501780 | 3f642a59-b2ed-4903-a34f-31aaf10ea838 ==============================
[0m17:49:35.501780 [info ] [MainThread]: Running with dbt=1.7.1
[0m17:49:35.502139 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/bitlevi/.dbt', 'log_path': '/Users/bitlevi/Documents/billy_bulky_ecommerce/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:49:36.359112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3f642a59-b2ed-4903-a34f-31aaf10ea838', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102e16940>]}
[0m17:49:36.406771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3f642a59-b2ed-4903-a34f-31aaf10ea838', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069150d0>]}
[0m17:49:36.407400 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m17:49:36.421235 [debug] [MainThread]: checksum: ad428e6dc3b353dcb23d0c4ebea8b20b180e94b873271ac2a054a8e446dac0e2, vars: {}, profile: , target: , version: 1.7.1
[0m17:49:36.431650 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m17:49:36.432040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3f642a59-b2ed-4903-a34f-31aaf10ea838', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137967070>]}
[0m17:49:37.032707 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'orders' in the 'models' section of file 'models/staging/shopify/_shopify__schema.yml'
[0m17:49:37.034273 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'products' in the 'models' section of file 'models/staging/shopify/_shopify__schema.yml'
[0m17:49:37.145912 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'sales_fact' in the 'models' section of file 'models/marts/_marts__models.yml'
[0m17:49:37.166757 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'int_customer_segmentation' in the 'models' section of file 'models/intermediate/customers/_int_customers__models.yml'
[0m17:49:37.180805 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'int_product_performance' in the 'models' section of file 'models/intermediate/products/_int_products__models.yml'
[0m17:49:37.209975 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.unique_orders_order_id.fed79b3a6e' (models/staging/shopify/_shopify__schema.yml) depends on a node named 'orders' in package '' which was not found
[0m17:49:37.210324 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_orders_order_id.cf6c17daed' (models/staging/shopify/_shopify__schema.yml) depends on a node named 'orders' in package '' which was not found
[0m17:49:37.210559 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_orders_customer_id.c5f02694af' (models/staging/shopify/_shopify__schema.yml) depends on a node named 'orders' in package '' which was not found
[0m17:49:37.210780 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_orders_product_id.3523c78a66' (models/staging/shopify/_shopify__schema.yml) depends on a node named 'orders' in package '' which was not found
[0m17:49:37.210990 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_orders_quantity.0e6bb23b03' (models/staging/shopify/_shopify__schema.yml) depends on a node named 'orders' in package '' which was not found
[0m17:49:37.211201 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_orders_order_date.6910a855fe' (models/staging/shopify/_shopify__schema.yml) depends on a node named 'orders' in package '' which was not found
[0m17:49:37.211411 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_orders_status.8a27272c0a' (models/staging/shopify/_shopify__schema.yml) depends on a node named 'orders' in package '' which was not found
[0m17:49:37.211620 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.accepted_values_orders_status__cancelled__processing__delivered__shipped.fbff2d9925' (models/staging/shopify/_shopify__schema.yml) depends on a node named 'orders' in package '' which was not found
[0m17:49:37.211833 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.unique_products_product_id.68edffb83d' (models/staging/shopify/_shopify__schema.yml) depends on a node named 'products' in package '' which was not found
[0m17:49:37.212043 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_products_product_id.33741cf88e' (models/staging/shopify/_shopify__schema.yml) depends on a node named 'products' in package '' which was not found
[0m17:49:37.212250 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_products_name.d755fc2381' (models/staging/shopify/_shopify__schema.yml) depends on a node named 'products' in package '' which was not found
[0m17:49:37.212458 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.accepted_values_products_category__books__electronics__home__toys__garden__clothing.e85e5b5f7b' (models/staging/shopify/_shopify__schema.yml) depends on a node named 'products' in package '' which was not found
[0m17:49:37.212670 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_products_price.3b5b0a69be' (models/staging/shopify/_shopify__schema.yml) depends on a node named 'products' in package '' which was not found
[0m17:49:37.212878 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_products_stock_level.ee79d71f38' (models/staging/shopify/_shopify__schema.yml) depends on a node named 'products' in package '' which was not found
[0m17:49:37.213085 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.unique_sales_fact_order_id.8431c39e26' (models/marts/_marts__models.yml) depends on a node named 'sales_fact' in package '' which was not found
[0m17:49:37.213289 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_sales_fact_order_id.f43728f177' (models/marts/_marts__models.yml) depends on a node named 'sales_fact' in package '' which was not found
[0m17:49:37.213495 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_sales_fact_customer_id.f68521ea9a' (models/marts/_marts__models.yml) depends on a node named 'sales_fact' in package '' which was not found
[0m17:49:37.213701 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.relationships_sales_fact_customer_id__customer_id__ref_dim_customers_.a3d6e6ea82' (models/marts/_marts__models.yml) depends on a node named 'dim_customers' in package '' which was not found
[0m17:49:37.213913 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.relationships_sales_fact_customer_id__customer_id__ref_dim_customers_.a3d6e6ea82' (models/marts/_marts__models.yml) depends on a node named 'sales_fact' in package '' which was not found
[0m17:49:37.214124 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_sales_fact_product_id.19f5ce154e' (models/marts/_marts__models.yml) depends on a node named 'sales_fact' in package '' which was not found
[0m17:49:37.214337 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.relationships_sales_fact_product_id__product_id__ref_dim_products_.e51bdbe6df' (models/marts/_marts__models.yml) depends on a node named 'dim_products' in package '' which was not found
[0m17:49:37.214547 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.relationships_sales_fact_product_id__product_id__ref_dim_products_.e51bdbe6df' (models/marts/_marts__models.yml) depends on a node named 'sales_fact' in package '' which was not found
[0m17:49:37.214765 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_sales_fact_quantity.005f9fd430' (models/marts/_marts__models.yml) depends on a node named 'sales_fact' in package '' which was not found
[0m17:49:37.214974 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_sales_fact_order_date.fef7ccf6a7' (models/marts/_marts__models.yml) depends on a node named 'sales_fact' in package '' which was not found
[0m17:49:37.215180 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_sales_fact_status.eff8463bed' (models/marts/_marts__models.yml) depends on a node named 'sales_fact' in package '' which was not found
[0m17:49:37.215389 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_sales_fact_category.8c65c1dfee' (models/marts/_marts__models.yml) depends on a node named 'sales_fact' in package '' which was not found
[0m17:49:37.215599 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_sales_fact_unit_price.0053974229' (models/marts/_marts__models.yml) depends on a node named 'sales_fact' in package '' which was not found
[0m17:49:37.215811 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_sales_fact_total_price.989b49f0a3' (models/marts/_marts__models.yml) depends on a node named 'sales_fact' in package '' which was not found
[0m17:49:37.216021 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_sales_fact_country.c90b50e864' (models/marts/_marts__models.yml) depends on a node named 'sales_fact' in package '' which was not found
[0m17:49:37.216232 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.unique_int_customer_segmentation_customer_id.93378a6f29' (models/intermediate/customers/_int_customers__models.yml) depends on a node named 'int_customer_segmentation' in package '' which was not found
[0m17:49:37.216446 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_int_customer_segmentation_customer_id.b278231c99' (models/intermediate/customers/_int_customers__models.yml) depends on a node named 'int_customer_segmentation' in package '' which was not found
[0m17:49:37.216663 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_int_customer_segmentation_email.e4880b86d9' (models/intermediate/customers/_int_customers__models.yml) depends on a node named 'int_customer_segmentation' in package '' which was not found
[0m17:49:37.216908 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.unique_int_customer_segmentation_email.525579524b' (models/intermediate/customers/_int_customers__models.yml) depends on a node named 'int_customer_segmentation' in package '' which was not found
[0m17:49:37.217126 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_int_customer_segmentation_frequency.f45b5cc0b0' (models/intermediate/customers/_int_customers__models.yml) depends on a node named 'int_customer_segmentation' in package '' which was not found
[0m17:49:37.217341 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_int_customer_segmentation_monetary.97dee85c9d' (models/intermediate/customers/_int_customers__models.yml) depends on a node named 'int_customer_segmentation' in package '' which was not found
[0m17:49:37.217556 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_int_customer_segmentation_average_order_value.15c482d127' (models/intermediate/customers/_int_customers__models.yml) depends on a node named 'int_customer_segmentation' in package '' which was not found
[0m17:49:37.217769 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_int_customer_segmentation_cancellation_rate.49f1f06ae7' (models/intermediate/customers/_int_customers__models.yml) depends on a node named 'int_customer_segmentation' in package '' which was not found
[0m17:49:37.217978 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_int_customer_segmentation_recency.b3e8e1b730' (models/intermediate/customers/_int_customers__models.yml) depends on a node named 'int_customer_segmentation' in package '' which was not found
[0m17:49:37.218185 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_int_customer_segmentation_tenure.9a1e5d8cf9' (models/intermediate/customers/_int_customers__models.yml) depends on a node named 'int_customer_segmentation' in package '' which was not found
[0m17:49:37.218410 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.relationships_int_customer_segmentation_customer_id__ref_staging_shopify__customers_.03801bedb5' (models/intermediate/customers/_int_customers__models.yml) depends on a node named 'int_customer_segmentation' in package '' which was not found
[0m17:49:37.218625 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.unique_int_product_performance_product_id.b828b9a3bd' (models/intermediate/products/_int_products__models.yml) depends on a node named 'int_product_performance' in package '' which was not found
[0m17:49:37.218836 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_int_product_performance_product_id.df41eb8b00' (models/intermediate/products/_int_products__models.yml) depends on a node named 'int_product_performance' in package '' which was not found
[0m17:49:37.219047 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_int_product_performance_name.84605c9ebd' (models/intermediate/products/_int_products__models.yml) depends on a node named 'int_product_performance' in package '' which was not found
[0m17:49:37.219257 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_int_product_performance_category.ce9d757af8' (models/intermediate/products/_int_products__models.yml) depends on a node named 'int_product_performance' in package '' which was not found
[0m17:49:37.219466 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_int_product_performance_price.d8cfbbbb6f' (models/intermediate/products/_int_products__models.yml) depends on a node named 'int_product_performance' in package '' which was not found
[0m17:49:37.219674 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_int_product_performance_average_sale_price.88051bf719' (models/intermediate/products/_int_products__models.yml) depends on a node named 'int_product_performance' in package '' which was not found
[0m17:49:37.219880 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_int_product_performance_total_sales.471d2d6538' (models/intermediate/products/_int_products__models.yml) depends on a node named 'int_product_performance' in package '' which was not found
[0m17:49:37.220087 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_int_product_performance_total_units_sold.1d57ff67fe' (models/intermediate/products/_int_products__models.yml) depends on a node named 'int_product_performance' in package '' which was not found
[0m17:49:37.220293 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_int_product_performance_total_sales_value.e22015eef1' (models/intermediate/products/_int_products__models.yml) depends on a node named 'int_product_performance' in package '' which was not found
[0m17:49:37.220503 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_int_product_performance_turnover_rate.2ba1e9ec16' (models/intermediate/products/_int_products__models.yml) depends on a node named 'int_product_performance' in package '' which was not found
[0m17:49:37.220718 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_int_product_performance_stock_level.8fd9f36e5b' (models/intermediate/products/_int_products__models.yml) depends on a node named 'int_product_performance' in package '' which was not found
[0m17:49:37.246936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3f642a59-b2ed-4903-a34f-31aaf10ea838', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1531470d0>]}
[0m17:49:37.260018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3f642a59-b2ed-4903-a34f-31aaf10ea838', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137e17190>]}
[0m17:49:37.260350 [info ] [MainThread]: Found 8 models, 20 tests, 3 sources, 0 exposures, 0 metrics, 431 macros, 0 groups, 0 semantic models
[0m17:49:37.260568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3f642a59-b2ed-4903-a34f-31aaf10ea838', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137eb52e0>]}
[0m17:49:37.261784 [info ] [MainThread]: 
[0m17:49:37.262270 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:49:37.263081 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE'
[0m17:49:37.269891 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE'
[0m17:49:37.272130 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE"
[0m17:49:37.273536 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE"
[0m17:49:37.273784 [debug] [ThreadPool]: On list_E_COMMERCE: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE"} */
show terse schemas in database E_COMMERCE
    limit 10000
[0m17:49:37.273980 [debug] [ThreadPool]: On list_E_COMMERCE: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE"} */
show terse schemas in database E_COMMERCE
    limit 10000
[0m17:49:37.274159 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:49:37.274326 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:49:38.618448 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m17:49:38.621193 [debug] [ThreadPool]: On list_E_COMMERCE: Close
[0m17:49:38.625076 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m17:49:38.627145 [debug] [ThreadPool]: On list_E_COMMERCE: Close
[0m17:49:39.012814 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_E_COMMERCE, now create_E_COMMERCE_marts)
[0m17:49:39.013588 [debug] [ThreadPool]: Creating schema "database: "E_COMMERCE"
schema: "marts"
"
[0m17:49:39.018179 [debug] [ThreadPool]: Using snowflake connection "create_E_COMMERCE_marts"
[0m17:49:39.018502 [debug] [ThreadPool]: On create_E_COMMERCE_marts: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "create_E_COMMERCE_marts"} */
create schema if not exists E_COMMERCE.marts
[0m17:49:39.018767 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:49:40.247196 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m17:49:40.252121 [debug] [ThreadPool]: On create_E_COMMERCE_marts: Close
[0m17:49:40.728119 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_E_COMMERCE, now list_E_COMMERCE_marts)
[0m17:49:40.730665 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_E_COMMERCE_marts, now list_E_COMMERCE_intermediate)
[0m17:49:40.747555 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_intermediate"
[0m17:49:40.753085 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_marts"
[0m17:49:40.753511 [debug] [ThreadPool]: On list_E_COMMERCE_intermediate: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE_intermediate"} */
show terse objects in E_COMMERCE.intermediate limit 10000
[0m17:49:40.753942 [debug] [ThreadPool]: On list_E_COMMERCE_marts: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE_marts"} */
show terse objects in E_COMMERCE.marts limit 10000
[0m17:49:40.754353 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:49:40.754751 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:49:41.949273 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m17:49:41.951225 [debug] [ThreadPool]: On list_E_COMMERCE_intermediate: Close
[0m17:49:42.000126 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.0 seconds
[0m17:49:42.002178 [debug] [ThreadPool]: On list_E_COMMERCE_marts: Close
[0m17:49:42.383663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3f642a59-b2ed-4903-a34f-31aaf10ea838', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153198040>]}
[0m17:49:42.385321 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m17:49:42.385931 [info ] [MainThread]: 
[0m17:49:42.390043 [debug] [Thread-1  ]: Began running node model.billy_bulky.staging_shopify__customers
[0m17:49:42.390847 [debug] [Thread-2  ]: Began running node model.billy_bulky.staging_shopify__orders
[0m17:49:42.392737 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_E_COMMERCE_marts, now model.billy_bulky.staging_shopify__customers)
[0m17:49:42.393857 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_E_COMMERCE_intermediate, now model.billy_bulky.staging_shopify__orders)
[0m17:49:42.391529 [debug] [Thread-3  ]: Began running node model.billy_bulky.staging_shopify__products
[0m17:49:42.395092 [debug] [Thread-1  ]: Began compiling node model.billy_bulky.staging_shopify__customers
[0m17:49:42.395732 [debug] [Thread-2  ]: Began compiling node model.billy_bulky.staging_shopify__orders
[0m17:49:42.396914 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.billy_bulky.staging_shopify__products'
[0m17:49:42.408671 [debug] [Thread-1  ]: Writing injected SQL for node "model.billy_bulky.staging_shopify__customers"
[0m17:49:42.413377 [debug] [Thread-2  ]: Writing injected SQL for node "model.billy_bulky.staging_shopify__orders"
[0m17:49:42.413951 [debug] [Thread-3  ]: Began compiling node model.billy_bulky.staging_shopify__products
[0m17:49:42.418100 [debug] [Thread-3  ]: Writing injected SQL for node "model.billy_bulky.staging_shopify__products"
[0m17:49:42.418988 [debug] [Thread-2  ]: Timing info for model.billy_bulky.staging_shopify__orders (compile): 17:49:42.409034 => 17:49:42.418704
[0m17:49:42.419552 [debug] [Thread-3  ]: Timing info for model.billy_bulky.staging_shopify__products (compile): 17:49:42.414457 => 17:49:42.419262
[0m17:49:42.420032 [debug] [Thread-1  ]: Timing info for model.billy_bulky.staging_shopify__customers (compile): 17:49:42.397272 => 17:49:42.419808
[0m17:49:42.420978 [debug] [Thread-2  ]: Finished running node model.billy_bulky.staging_shopify__orders
[0m17:49:42.421879 [debug] [Thread-3  ]: Finished running node model.billy_bulky.staging_shopify__products
[0m17:49:42.422733 [debug] [Thread-1  ]: Finished running node model.billy_bulky.staging_shopify__customers
[0m17:49:42.423441 [debug] [Thread-1  ]: Began running node model.billy_bulky.int_products_performance
[0m17:49:42.423881 [debug] [Thread-5  ]: Began running node model.billy_bulky.int_sales_trends
[0m17:49:42.424359 [info ] [Thread-1  ]: 1 of 4 START sql table model intermediate.int_products_performance ............. [RUN]
[0m17:49:42.425360 [debug] [Thread-7  ]: Began running node model.billy_bulky.int_customers_segmentation
[0m17:49:42.424988 [info ] [Thread-5  ]: 2 of 4 START sql table model intermediate.int_sales_trends ..................... [RUN]
[0m17:49:42.425875 [debug] [Thread-8  ]: Began running node model.billy_bulky.sales
[0m17:49:42.426526 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.billy_bulky.staging_shopify__customers, now model.billy_bulky.int_products_performance)
[0m17:49:42.427013 [info ] [Thread-7  ]: 3 of 4 START sql table model intermediate.int_customers_segmentation ........... [RUN]
[0m17:49:42.427798 [debug] [Thread-5  ]: Acquiring new snowflake connection 'model.billy_bulky.int_sales_trends'
[0m17:49:42.428235 [info ] [Thread-8  ]: 4 of 4 START sql table model marts.sales ....................................... [RUN]
[0m17:49:42.428637 [debug] [Thread-1  ]: Began compiling node model.billy_bulky.int_products_performance
[0m17:49:42.429561 [debug] [Thread-7  ]: Acquiring new snowflake connection 'model.billy_bulky.int_customers_segmentation'
[0m17:49:42.429943 [debug] [Thread-5  ]: Began compiling node model.billy_bulky.int_sales_trends
[0m17:49:42.430584 [debug] [Thread-8  ]: Acquiring new snowflake connection 'model.billy_bulky.sales'
[0m17:49:42.443411 [debug] [Thread-7  ]: Began compiling node model.billy_bulky.int_customers_segmentation
[0m17:49:42.446257 [debug] [Thread-1  ]: Writing injected SQL for node "model.billy_bulky.int_products_performance"
[0m17:49:42.459238 [debug] [Thread-8  ]: Began compiling node model.billy_bulky.sales
[0m17:49:42.463344 [debug] [Thread-5  ]: Writing injected SQL for node "model.billy_bulky.int_sales_trends"
[0m17:49:42.477390 [debug] [Thread-7  ]: Writing injected SQL for node "model.billy_bulky.int_customers_segmentation"
[0m17:49:42.486687 [debug] [Thread-8  ]: Writing injected SQL for node "model.billy_bulky.sales"
[0m17:49:42.487065 [debug] [Thread-1  ]: Timing info for model.billy_bulky.int_products_performance (compile): 17:49:42.430832 => 17:49:42.486903
[0m17:49:42.487441 [debug] [Thread-5  ]: Timing info for model.billy_bulky.int_sales_trends (compile): 17:49:42.446469 => 17:49:42.487301
[0m17:49:42.487766 [debug] [Thread-1  ]: Began executing node model.billy_bulky.int_products_performance
[0m17:49:42.488066 [debug] [Thread-7  ]: Timing info for model.billy_bulky.int_customers_segmentation (compile): 17:49:42.463565 => 17:49:42.487905
[0m17:49:42.488350 [debug] [Thread-5  ]: Began executing node model.billy_bulky.int_sales_trends
[0m17:49:42.494708 [debug] [Thread-8  ]: Timing info for model.billy_bulky.sales (compile): 17:49:42.477632 => 17:49:42.494503
[0m17:49:42.507482 [debug] [Thread-1  ]: Writing runtime sql for node "model.billy_bulky.int_products_performance"
[0m17:49:42.507767 [debug] [Thread-7  ]: Began executing node model.billy_bulky.int_customers_segmentation
[0m17:49:42.509641 [debug] [Thread-5  ]: Writing runtime sql for node "model.billy_bulky.int_sales_trends"
[0m17:49:42.509890 [debug] [Thread-8  ]: Began executing node model.billy_bulky.sales
[0m17:49:42.511779 [debug] [Thread-7  ]: Writing runtime sql for node "model.billy_bulky.int_customers_segmentation"
[0m17:49:42.513986 [debug] [Thread-8  ]: Writing runtime sql for node "model.billy_bulky.sales"
[0m17:49:42.515714 [debug] [Thread-1  ]: Using snowflake connection "model.billy_bulky.int_products_performance"
[0m17:49:42.517745 [debug] [Thread-5  ]: Using snowflake connection "model.billy_bulky.int_sales_trends"
[0m17:49:42.518150 [debug] [Thread-1  ]: On model.billy_bulky.int_products_performance: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.int_products_performance"} */
create or replace transient table E_COMMERCE.intermediate.int_products_performance
         as
        (WITH  __dbt__cte__staging_shopify__orders as (
WITH orders AS (
    SELECT * FROM SHOPIFY.PUBLIC.orders
)

SELECT
    ORDER_ID
    , CUSTOMER_ID
    , PRODUCT_ID
    , QUANTITY
    , ORDER_DATE
    , STATUS
FROM orders
),  __dbt__cte__staging_shopify__products as (
WITH products AS (
    SELECT * FROM SHOPIFY.PUBLIC.products
)

SELECT
    PRODUCT_ID
    , NAME
    , CATEGORY
    , PRICE
    , STOCK_LEVEL
FROM products
), orders AS (
    SELECT * FROM __dbt__cte__staging_shopify__orders
)

, products AS (
    SELECT * FROM __dbt__cte__staging_shopify__products
)

, product_sales AS (
    SELECT
        o.PRODUCT_ID
        , COUNT(DISTINCT o.ORDER_ID) AS total_sales
        , SUM(o.QUANTITY) AS total_units_sold
        , SUM(o.QUANTITY * p.PRICE) AS total_sales_value
    FROM orders o
    INNER JOIN products p ON o.PRODUCT_ID = p.PRODUCT_ID
    WHERE o.STATUS NOT IN ('cancelled') 
    GROUP BY o.PRODUCT_ID
)

, product_averages AS (
    SELECT
        PRODUCT_ID
        , (total_sales_value / NULLIF(total_units_sold, 0)) AS average_sale_price
    FROM product_sales
)

, product_stock_turnover AS (
    SELECT
        p.PRODUCT_ID
        , p.STOCK_LEVEL
        , (total_units_sold / NULLIF(p.STOCK_LEVEL, 0)) AS turnover_rate
    FROM product_sales ps
    INNER JOIN products p ON ps.PRODUCT_ID = p.PRODUCT_ID
)

, final AS (
    SELECT
    p.PRODUCT_ID
    , p.NAME
    , p.CATEGORY
    , p.PRICE
    , pa.average_sale_price
    , ps.total_sales
    , ps.total_units_sold
    , ps.total_sales_value
    , pst.turnover_rate
    , p.STOCK_LEVEL
FROM products p
LEFT JOIN product_sales ps ON p.PRODUCT_ID = ps.PRODUCT_ID
LEFT JOIN product_averages pa ON p.PRODUCT_ID = pa.PRODUCT_ID
LEFT JOIN product_stock_turnover pst ON p.PRODUCT_ID = pst.PRODUCT_ID
)

SELECT * FROM final
        );
[0m17:49:42.518566 [debug] [Thread-5  ]: On model.billy_bulky.int_sales_trends: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.int_sales_trends"} */
create or replace transient table E_COMMERCE.intermediate.int_sales_trends
         as
        (WITH  __dbt__cte__staging_shopify__orders as (
WITH orders AS (
    SELECT * FROM SHOPIFY.PUBLIC.orders
)

SELECT
    ORDER_ID
    , CUSTOMER_ID
    , PRODUCT_ID
    , QUANTITY
    , ORDER_DATE
    , STATUS
FROM orders
),  __dbt__cte__staging_shopify__products as (
WITH products AS (
    SELECT * FROM SHOPIFY.PUBLIC.products
)

SELECT
    PRODUCT_ID
    , NAME
    , CATEGORY
    , PRICE
    , STOCK_LEVEL
FROM products
), orders AS (
    SELECT * FROM __dbt__cte__staging_shopify__orders
)

, products AS (
    SELECT * FROM __dbt__cte__staging_shopify__products
)

, daily_sales AS (
    SELECT
        DATE(ORDER_DATE) AS sale_date
        , COUNT(DISTINCT ORDER_ID) AS total_orders
        , SUM(QUANTITY) AS total_units_sold
        , SUM(QUANTITY * PRICE) AS total_sales_value
    FROM orders AS o
    JOIN products AS p ON o.PRODUCT_ID = p.PRODUCT_ID
    WHERE o.STATUS NOT IN ('cancelled') 
    GROUP BY sale_date
)

, weekly_sales AS (
    SELECT
        DATE_TRUNC('week', sale_date) AS sale_week
        , SUM(total_orders) AS weekly_orders
        , SUM(total_units_sold) AS weekly_units_sold
        , SUM(total_sales_value) AS weekly_sales_value
    FROM daily_sales
    GROUP BY sale_week
)

, monthly_sales AS (
    SELECT
        DATE_TRUNC('month', sale_date) AS sale_month
        , SUM(total_orders) AS monthly_orders
        , SUM(total_units_sold) AS monthly_units_sold
        , SUM(total_sales_value) AS monthly_sales_value
    FROM daily_sales
    GROUP BY sale_month
)

, yearly_sales AS (
    SELECT
        DATE_TRUNC('year', sale_date) AS sale_year
        , SUM(total_orders) AS yearly_orders
        , SUM(total_units_sold) AS yearly_units_sold
        , SUM(total_sales_value) AS yearly_sales_value
    FROM daily_sales
    GROUP BY sale_year
)

SELECT
    d.sale_date
    , d.total_orders AS daily_orders
    , d.total_units_sold AS daily_units_sold
    , d.total_sales_value AS daily_sales_value
    , w.weekly_orders
    , w.weekly_units_sold
    , w.weekly_sales_value
    , m.monthly_orders
    , m.monthly_units_sold
    , m.monthly_sales_value
    , y.yearly_orders
    , y.yearly_units_sold
    , y.yearly_sales_value
FROM daily_sales d
LEFT JOIN weekly_sales w ON DATE_TRUNC('week', d.sale_date) = w.sale_week
LEFT JOIN monthly_sales m ON DATE_TRUNC('month', d.sale_date) = m.sale_month
LEFT JOIN yearly_sales y ON DATE_TRUNC('year', d.sale_date) = y.sale_year
        );
[0m17:49:42.518936 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:49:42.520258 [debug] [Thread-8  ]: Using snowflake connection "model.billy_bulky.sales"
[0m17:49:42.522039 [debug] [Thread-7  ]: Using snowflake connection "model.billy_bulky.int_customers_segmentation"
[0m17:49:42.522247 [debug] [Thread-5  ]: Opening a new connection, currently in state init
[0m17:49:42.522712 [debug] [Thread-8  ]: On model.billy_bulky.sales: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.sales"} */
create or replace transient table E_COMMERCE.marts.sales
         as
        (WITH  __dbt__cte__staging_shopify__customers as (
WITH customers AS (
    SELECT * FROM SHOPIFY.PUBLIC.customers
)

SELECT
    CUSTOMER_ID
    , FIRST_NAME
    , LAST_NAME
    , EMAIL
    , JOIN_DATE
    , COUNTRY
FROM customers
),  __dbt__cte__staging_shopify__orders as (
WITH orders AS (
    SELECT * FROM SHOPIFY.PUBLIC.orders
)

SELECT
    ORDER_ID
    , CUSTOMER_ID
    , PRODUCT_ID
    , QUANTITY
    , ORDER_DATE
    , STATUS
FROM orders
),  __dbt__cte__staging_shopify__products as (
WITH products AS (
    SELECT * FROM SHOPIFY.PUBLIC.products
)

SELECT
    PRODUCT_ID
    , NAME
    , CATEGORY
    , PRICE
    , STOCK_LEVEL
FROM products
), customers AS (
    SELECT * FROM __dbt__cte__staging_shopify__customers
)

, orders AS (
    SELECT * FROM __dbt__cte__staging_shopify__orders
)

, products AS (
    SELECT * FROM __dbt__cte__staging_shopify__products
)



, enriched_orders AS (
    SELECT
        o.ORDER_ID
        , o.CUSTOMER_ID
        , o.PRODUCT_ID
        , o.QUANTITY
        , o.ORDER_DATE
        , o.STATUS
        , p.CATEGORY
        , p.PRICE AS unit_price
        , (o.QUANTITY * p.PRICE) AS total_price
        , c.COUNTRY
    FROM orders o
    JOIN products p ON o.PRODUCT_ID = p.PRODUCT_ID
    JOIN customers c ON o.CUSTOMER_ID = c.CUSTOMER_ID
    WHERE o.STATUS NOT IN ('cancelled') 
)

, final AS (
SELECT
    e.ORDER_ID
    , e.CUSTOMER_ID
    , e.PRODUCT_ID
    , e.QUANTITY
    , e.ORDER_DATE
    , e.STATUS
    , e.CATEGORY
    , e.unit_price
    , e.total_price
    , e.COUNTRY
FROM enriched_orders e
)

SELECT * FROM final
        );
[0m17:49:42.523338 [debug] [Thread-7  ]: On model.billy_bulky.int_customers_segmentation: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.int_customers_segmentation"} */
create or replace transient table E_COMMERCE.intermediate.int_customers_segmentation
         as
        (WITH  __dbt__cte__staging_shopify__customers as (
WITH customers AS (
    SELECT * FROM SHOPIFY.PUBLIC.customers
)

SELECT
    CUSTOMER_ID
    , FIRST_NAME
    , LAST_NAME
    , EMAIL
    , JOIN_DATE
    , COUNTRY
FROM customers
),  __dbt__cte__staging_shopify__orders as (
WITH orders AS (
    SELECT * FROM SHOPIFY.PUBLIC.orders
)

SELECT
    ORDER_ID
    , CUSTOMER_ID
    , PRODUCT_ID
    , QUANTITY
    , ORDER_DATE
    , STATUS
FROM orders
),  __dbt__cte__staging_shopify__products as (
WITH products AS (
    SELECT * FROM SHOPIFY.PUBLIC.products
)

SELECT
    PRODUCT_ID
    , NAME
    , CATEGORY
    , PRICE
    , STOCK_LEVEL
FROM products
), customers AS (
    SELECT * FROM __dbt__cte__staging_shopify__customers
)

, orders AS (
    SELECT * FROM __dbt__cte__staging_shopify__orders
)

, products AS (
    SELECT * FROM __dbt__cte__staging_shopify__products
)

, order_aggregates AS (
    SELECT
        o.CUSTOMER_ID
        , COUNT(DISTINCT o.ORDER_ID) AS frequency
        , SUM(o.QUANTITY * p.PRICE) AS monetary
        , AVG(o.QUANTITY * p.PRICE) AS average_order_value
        , MAX(o.ORDER_DATE) AS last_purchase_date
        , COUNT(CASE WHEN o.STATUS = 'cancelled' THEN 1 END) AS cancelled_orders
        , COUNT(*) AS total_orders
    FROM orders o
    JOIN products p ON o.PRODUCT_ID = p.PRODUCT_ID
    GROUP BY o.CUSTOMER_ID
)

, customer_tenure AS (
    SELECT
        CUSTOMER_ID
        , JOIN_DATE
        , CURRENT_DATE - JOIN_DATE AS tenure
    FROM customers
)

, customer_recency AS (
    SELECT
        CUSTOMER_ID
        , CURRENT_DATE - last_purchase_date AS recency
    FROM order_aggregates
)

, final AS (
    SELECT
        c.CUSTOMER_ID
        , c.FIRST_NAME
        , c.LAST_NAME
        , c.EMAIL
        , c.JOIN_DATE
        , c.COUNTRY
        , o.frequency
        , o.monetary
        , o.average_order_value
        , o.cancelled_orders
        , o.total_orders
        , CASE 
            WHEN o.total_orders > 0 THEN ROUND((o.cancelled_orders::FLOAT / o.total_orders) * 100, 2) 
            ELSE 0 
          END AS cancellation_rate
        , r.recency
        , t.tenure
    FROM customer_tenure t
    JOIN customers c ON t.CUSTOMER_ID = c.CUSTOMER_ID
    JOIN order_aggregates o ON c.CUSTOMER_ID = o.CUSTOMER_ID
    JOIN customer_recency r ON c.CUSTOMER_ID = r.CUSTOMER_ID
)

SELECT * FROM final
        );
[0m17:49:42.524037 [debug] [Thread-8  ]: Opening a new connection, currently in state init
[0m17:49:42.524449 [debug] [Thread-7  ]: Opening a new connection, currently in state init
[0m17:49:45.328479 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 3.0 seconds
[0m17:49:45.353774 [debug] [Thread-7  ]: SQL status: SUCCESS 1 in 3.0 seconds
[0m17:49:45.370938 [debug] [Thread-1  ]: Timing info for model.billy_bulky.int_products_performance (execute): 17:49:42.488524 => 17:49:45.370674
[0m17:49:45.372060 [debug] [Thread-7  ]: Timing info for model.billy_bulky.int_customers_segmentation (execute): 17:49:42.510103 => 17:49:45.371831
[0m17:49:45.372494 [debug] [Thread-1  ]: On model.billy_bulky.int_products_performance: Close
[0m17:49:45.372915 [debug] [Thread-7  ]: On model.billy_bulky.int_customers_segmentation: Close
[0m17:49:45.494943 [debug] [Thread-8  ]: SQL status: SUCCESS 1 in 3.0 seconds
[0m17:49:45.501710 [debug] [Thread-8  ]: Timing info for model.billy_bulky.sales (execute): 17:49:42.512128 => 17:49:45.501323
[0m17:49:45.502447 [debug] [Thread-8  ]: On model.billy_bulky.sales: Close
[0m17:49:45.561350 [debug] [Thread-5  ]: SQL status: SUCCESS 1 in 3.0 seconds
[0m17:49:45.566329 [debug] [Thread-5  ]: Timing info for model.billy_bulky.int_sales_trends (execute): 17:49:42.507920 => 17:49:45.565948
[0m17:49:45.567042 [debug] [Thread-5  ]: On model.billy_bulky.int_sales_trends: Close
[0m17:49:45.731096 [debug] [Thread-7  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f642a59-b2ed-4903-a34f-31aaf10ea838', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15393e4f0>]}
[0m17:49:45.732732 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f642a59-b2ed-4903-a34f-31aaf10ea838', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1538ee4f0>]}
[0m17:49:45.733786 [info ] [Thread-7  ]: 3 of 4 OK created sql table model intermediate.int_customers_segmentation ...... [[32mSUCCESS 1[0m in 3.30s]
[0m17:49:45.734894 [info ] [Thread-1  ]: 1 of 4 OK created sql table model intermediate.int_products_performance ........ [[32mSUCCESS 1[0m in 3.31s]
[0m17:49:45.736865 [debug] [Thread-7  ]: Finished running node model.billy_bulky.int_customers_segmentation
[0m17:49:45.738635 [debug] [Thread-1  ]: Finished running node model.billy_bulky.int_products_performance
[0m17:49:45.859180 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f642a59-b2ed-4903-a34f-31aaf10ea838', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15396ac70>]}
[0m17:49:45.859884 [info ] [Thread-8  ]: 4 of 4 OK created sql table model marts.sales .................................. [[32mSUCCESS 1[0m in 3.43s]
[0m17:49:45.860447 [debug] [Thread-8  ]: Finished running node model.billy_bulky.sales
[0m17:49:45.916982 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f642a59-b2ed-4903-a34f-31aaf10ea838', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153818430>]}
[0m17:49:45.917743 [info ] [Thread-5  ]: 2 of 4 OK created sql table model intermediate.int_sales_trends ................ [[32mSUCCESS 1[0m in 3.49s]
[0m17:49:45.918388 [debug] [Thread-5  ]: Finished running node model.billy_bulky.int_sales_trends
[0m17:49:45.920169 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:49:45.920567 [debug] [MainThread]: Connection 'model.billy_bulky.int_products_performance' was properly closed.
[0m17:49:45.920895 [debug] [MainThread]: Connection 'model.billy_bulky.staging_shopify__orders' was properly closed.
[0m17:49:45.921163 [debug] [MainThread]: Connection 'model.billy_bulky.staging_shopify__products' was properly closed.
[0m17:49:45.921420 [debug] [MainThread]: Connection 'model.billy_bulky.int_sales_trends' was properly closed.
[0m17:49:45.921674 [debug] [MainThread]: Connection 'model.billy_bulky.int_customers_segmentation' was properly closed.
[0m17:49:45.921927 [debug] [MainThread]: Connection 'model.billy_bulky.sales' was properly closed.
[0m17:49:45.922231 [info ] [MainThread]: 
[0m17:49:45.922545 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 8.66 seconds (8.66s).
[0m17:49:45.923455 [debug] [MainThread]: Command end result
[0m17:49:45.935818 [info ] [MainThread]: 
[0m17:49:45.936205 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:49:45.936484 [info ] [MainThread]: 
[0m17:49:45.936767 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m17:49:45.939114 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.476674, "process_user_time": 5.705816, "process_kernel_time": 0.45005, "process_mem_max_rss": "213925888", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:49:45.939516 [debug] [MainThread]: Command `dbt run` succeeded at 17:49:45.939424 after 10.48 seconds
[0m17:49:45.939811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103431eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15215ad90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1538ee4f0>]}
[0m17:49:45.940111 [debug] [MainThread]: Flushing usage events
[0m18:20:08.427917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1031e8250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066952b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106695850>]}


============================== 18:20:08.430753 | d97f2547-8824-437e-9a36-64142ad27745 ==============================
[0m18:20:08.430753 [info ] [MainThread]: Running with dbt=1.7.1
[0m18:20:08.431142 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/bitlevi/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/bitlevi/Documents/billy_bulky_ecommerce/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:20:09.278748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd97f2547-8824-437e-9a36-64142ad27745', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106678fa0>]}
[0m18:20:09.326414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd97f2547-8824-437e-9a36-64142ad27745', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126bebca0>]}
[0m18:20:09.327000 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m18:20:09.341022 [debug] [MainThread]: checksum: ad428e6dc3b353dcb23d0c4ebea8b20b180e94b873271ac2a054a8e446dac0e2, vars: {}, profile: , target: , version: 1.7.1
[0m18:20:09.356414 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading billy_bulky: marts/_marts__models.yml - Runtime Error
    Syntax error near line 65
    ------------------------------
    62 |         tests:
    63 |           - not_null
    64 | 
    65 | - name: dim_customers
    66 |     description: "The customers table is a dimensional model in the marts layer that provides a 360-degree view of customers, including total orders and total spend, useful for analytics and reporting purposes."
    67 |     columns:
    68 |       - name: customer_id
    
    Raw Error:
    ------------------------------
    while parsing a block mapping
      in "<unicode string>", line 1, column 1
    did not find expected key
      in "<unicode string>", line 65, column 1
[0m18:20:09.358490 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.96547675, "process_user_time": 3.654931, "process_kernel_time": 0.352445, "process_mem_max_rss": "193495040", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:20:09.358935 [debug] [MainThread]: Command `dbt run` failed at 18:20:09.358840 after 0.97 seconds
[0m18:20:09.359213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1031e8250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126dbb280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1274fe280>]}
[0m18:20:09.359476 [debug] [MainThread]: Flushing usage events
[0m18:20:37.876254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10671d250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f892b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f89850>]}


============================== 18:20:37.878930 | 49912b30-4ab9-4ba2-8f01-3d25a678b702 ==============================
[0m18:20:37.878930 [info ] [MainThread]: Running with dbt=1.7.1
[0m18:20:37.879275 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/bitlevi/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/bitlevi/Documents/billy_bulky_ecommerce/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:20:38.587322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '49912b30-4ab9-4ba2-8f01-3d25a678b702', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f6cfa0>]}
[0m18:20:38.635258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '49912b30-4ab9-4ba2-8f01-3d25a678b702', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130facca0>]}
[0m18:20:38.635909 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m18:20:38.648660 [debug] [MainThread]: checksum: ad428e6dc3b353dcb23d0c4ebea8b20b180e94b873271ac2a054a8e446dac0e2, vars: {}, profile: , target: , version: 1.7.1
[0m18:20:38.682546 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m18:20:38.683202 [debug] [MainThread]: Partial parsing: updated file: billy_bulky://models/marts/_marts__models.yml
[0m18:20:38.683514 [debug] [MainThread]: Partial parsing: updated file: billy_bulky://models/marts/customers.sql
[0m18:20:38.786580 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'sales_fact' in the 'models' section of file 'models/marts/_marts__models.yml'
[0m18:20:38.788655 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'dim_customers' in the 'models' section of file 'models/marts/_marts__models.yml'
[0m18:20:38.915085 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.unique_sales_fact_order_id.8431c39e26' (models/marts/_marts__models.yml) depends on a node named 'sales_fact' in package '' which was not found
[0m18:20:38.915477 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_sales_fact_order_id.f43728f177' (models/marts/_marts__models.yml) depends on a node named 'sales_fact' in package '' which was not found
[0m18:20:38.915706 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_sales_fact_customer_id.f68521ea9a' (models/marts/_marts__models.yml) depends on a node named 'sales_fact' in package '' which was not found
[0m18:20:38.915936 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.relationships_sales_fact_customer_id__customer_id__ref_dim_customers_.a3d6e6ea82' (models/marts/_marts__models.yml) depends on a node named 'dim_customers' in package '' which was not found
[0m18:20:38.916150 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.relationships_sales_fact_customer_id__customer_id__ref_dim_customers_.a3d6e6ea82' (models/marts/_marts__models.yml) depends on a node named 'sales_fact' in package '' which was not found
[0m18:20:38.916363 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_sales_fact_product_id.19f5ce154e' (models/marts/_marts__models.yml) depends on a node named 'sales_fact' in package '' which was not found
[0m18:20:38.916572 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.relationships_sales_fact_product_id__product_id__ref_dim_products_.e51bdbe6df' (models/marts/_marts__models.yml) depends on a node named 'dim_products' in package '' which was not found
[0m18:20:38.916782 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.relationships_sales_fact_product_id__product_id__ref_dim_products_.e51bdbe6df' (models/marts/_marts__models.yml) depends on a node named 'sales_fact' in package '' which was not found
[0m18:20:38.916989 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_sales_fact_quantity.005f9fd430' (models/marts/_marts__models.yml) depends on a node named 'sales_fact' in package '' which was not found
[0m18:20:38.917195 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_sales_fact_order_date.fef7ccf6a7' (models/marts/_marts__models.yml) depends on a node named 'sales_fact' in package '' which was not found
[0m18:20:38.917399 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_sales_fact_status.eff8463bed' (models/marts/_marts__models.yml) depends on a node named 'sales_fact' in package '' which was not found
[0m18:20:38.917602 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_sales_fact_category.8c65c1dfee' (models/marts/_marts__models.yml) depends on a node named 'sales_fact' in package '' which was not found
[0m18:20:38.917804 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_sales_fact_unit_price.0053974229' (models/marts/_marts__models.yml) depends on a node named 'sales_fact' in package '' which was not found
[0m18:20:38.918006 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_sales_fact_total_price.989b49f0a3' (models/marts/_marts__models.yml) depends on a node named 'sales_fact' in package '' which was not found
[0m18:20:38.918207 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_sales_fact_country.c90b50e864' (models/marts/_marts__models.yml) depends on a node named 'sales_fact' in package '' which was not found
[0m18:20:38.918413 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.unique_dim_customers_customer_id.15c9f1e2fd' (models/marts/_marts__models.yml) depends on a node named 'dim_customers' in package '' which was not found
[0m18:20:38.918617 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_dim_customers_customer_id.dd91cd1c8d' (models/marts/_marts__models.yml) depends on a node named 'dim_customers' in package '' which was not found
[0m18:20:38.918823 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.unique_dim_customers_email.0472f7c2e8' (models/marts/_marts__models.yml) depends on a node named 'dim_customers' in package '' which was not found
[0m18:20:38.919024 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_dim_customers_email.ed68b54d1a' (models/marts/_marts__models.yml) depends on a node named 'dim_customers' in package '' which was not found
[0m18:20:38.919222 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_dim_customers_join_date.be46b852b3' (models/marts/_marts__models.yml) depends on a node named 'dim_customers' in package '' which was not found
[0m18:20:38.919423 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_dim_customers_total_orders.6e18bb41d9' (models/marts/_marts__models.yml) depends on a node named 'dim_customers' in package '' which was not found
[0m18:20:38.919624 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_dim_customers_total_spent.0ff6f454ed' (models/marts/_marts__models.yml) depends on a node named 'dim_customers' in package '' which was not found
[0m18:20:38.930375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '49912b30-4ab9-4ba2-8f01-3d25a678b702', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1320320d0>]}
[0m18:20:38.943063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '49912b30-4ab9-4ba2-8f01-3d25a678b702', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x131d3ffd0>]}
[0m18:20:38.943410 [info ] [MainThread]: Found 8 models, 20 tests, 3 sources, 0 exposures, 0 metrics, 431 macros, 0 groups, 0 semantic models
[0m18:20:38.943626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49912b30-4ab9-4ba2-8f01-3d25a678b702', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x131d3fe50>]}
[0m18:20:38.944819 [info ] [MainThread]: 
[0m18:20:38.945290 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:20:38.945998 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE'
[0m18:20:38.954132 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE"
[0m18:20:38.954699 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE'
[0m18:20:38.954930 [debug] [ThreadPool]: On list_E_COMMERCE: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE"} */
show terse schemas in database E_COMMERCE
    limit 10000
[0m18:20:38.956923 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE"
[0m18:20:38.957337 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:20:38.957593 [debug] [ThreadPool]: On list_E_COMMERCE: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE"} */
show terse schemas in database E_COMMERCE
    limit 10000
[0m18:20:38.958788 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:20:40.517632 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.0 seconds
[0m18:20:40.520908 [debug] [ThreadPool]: On list_E_COMMERCE: Close
[0m18:20:43.931726 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 5.0 seconds
[0m18:20:43.936062 [debug] [ThreadPool]: On list_E_COMMERCE: Close
[0m18:20:44.451560 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_E_COMMERCE, now list_E_COMMERCE_marts)
[0m18:20:44.454650 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_E_COMMERCE, now list_E_COMMERCE_intermediate)
[0m18:20:44.470391 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_marts"
[0m18:20:44.471489 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_intermediate"
[0m18:20:44.471976 [debug] [ThreadPool]: On list_E_COMMERCE_marts: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE_marts"} */
show terse objects in E_COMMERCE.marts limit 10000
[0m18:20:44.472581 [debug] [ThreadPool]: On list_E_COMMERCE_intermediate: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE_intermediate"} */
show terse objects in E_COMMERCE.intermediate limit 10000
[0m18:20:44.473013 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:20:44.473379 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:20:46.638337 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 2.0 seconds
[0m18:20:46.645242 [debug] [ThreadPool]: On list_E_COMMERCE_marts: Close
[0m18:20:46.687063 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.0 seconds
[0m18:20:46.693677 [debug] [ThreadPool]: On list_E_COMMERCE_intermediate: Close
[0m18:20:47.085367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49912b30-4ab9-4ba2-8f01-3d25a678b702', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1320aa6a0>]}
[0m18:20:47.088031 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m18:20:47.089370 [info ] [MainThread]: 
[0m18:20:47.095013 [debug] [Thread-1  ]: Began running node model.billy_bulky.staging_shopify__customers
[0m18:20:47.095980 [debug] [Thread-2  ]: Began running node model.billy_bulky.staging_shopify__orders
[0m18:20:47.098128 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_E_COMMERCE_marts, now model.billy_bulky.staging_shopify__customers)
[0m18:20:47.099145 [debug] [Thread-3  ]: Began running node model.billy_bulky.staging_shopify__products
[0m18:20:47.100474 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_E_COMMERCE_intermediate, now model.billy_bulky.staging_shopify__orders)
[0m18:20:47.101311 [debug] [Thread-1  ]: Began compiling node model.billy_bulky.staging_shopify__customers
[0m18:20:47.102773 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.billy_bulky.staging_shopify__products'
[0m18:20:47.103582 [debug] [Thread-2  ]: Began compiling node model.billy_bulky.staging_shopify__orders
[0m18:20:47.111835 [debug] [Thread-1  ]: Writing injected SQL for node "model.billy_bulky.staging_shopify__customers"
[0m18:20:47.112222 [debug] [Thread-3  ]: Began compiling node model.billy_bulky.staging_shopify__products
[0m18:20:47.114684 [debug] [Thread-2  ]: Writing injected SQL for node "model.billy_bulky.staging_shopify__orders"
[0m18:20:47.117374 [debug] [Thread-3  ]: Writing injected SQL for node "model.billy_bulky.staging_shopify__products"
[0m18:20:47.118397 [debug] [Thread-1  ]: Timing info for model.billy_bulky.staging_shopify__customers (compile): 18:20:47.104088 => 18:20:47.118196
[0m18:20:47.118786 [debug] [Thread-2  ]: Timing info for model.billy_bulky.staging_shopify__orders (compile): 18:20:47.112443 => 18:20:47.118596
[0m18:20:47.119142 [debug] [Thread-3  ]: Timing info for model.billy_bulky.staging_shopify__products (compile): 18:20:47.114978 => 18:20:47.118978
[0m18:20:47.119844 [debug] [Thread-1  ]: Finished running node model.billy_bulky.staging_shopify__customers
[0m18:20:47.120612 [debug] [Thread-2  ]: Finished running node model.billy_bulky.staging_shopify__orders
[0m18:20:47.121324 [debug] [Thread-3  ]: Finished running node model.billy_bulky.staging_shopify__products
[0m18:20:47.122583 [debug] [Thread-5  ]: Began running node model.billy_bulky.customers
[0m18:20:47.122963 [debug] [Thread-6  ]: Began running node model.billy_bulky.int_customers_segmentation
[0m18:20:47.123658 [debug] [Thread-7  ]: Began running node model.billy_bulky.int_products_performance
[0m18:20:47.123371 [info ] [Thread-5  ]: 1 of 5 START sql table model marts.customers ................................... [RUN]
[0m18:20:47.124101 [debug] [Thread-8  ]: Began running node model.billy_bulky.int_sales_trends
[0m18:20:47.124723 [debug] [Thread-9  ]: Began running node model.billy_bulky.sales
[0m18:20:47.124464 [info ] [Thread-6  ]: 2 of 5 START sql table model intermediate.int_customers_segmentation ........... [RUN]
[0m18:20:47.125171 [info ] [Thread-7  ]: 3 of 5 START sql table model intermediate.int_products_performance ............. [RUN]
[0m18:20:47.125809 [debug] [Thread-5  ]: Acquiring new snowflake connection 'model.billy_bulky.customers'
[0m18:20:47.126173 [info ] [Thread-8  ]: 4 of 5 START sql table model intermediate.int_sales_trends ..................... [RUN]
[0m18:20:47.126570 [info ] [Thread-9  ]: 5 of 5 START sql table model marts.sales ....................................... [RUN]
[0m18:20:47.127249 [debug] [Thread-6  ]: Acquiring new snowflake connection 'model.billy_bulky.int_customers_segmentation'
[0m18:20:47.127977 [debug] [Thread-7  ]: Acquiring new snowflake connection 'model.billy_bulky.int_products_performance'
[0m18:20:47.128352 [debug] [Thread-5  ]: Began compiling node model.billy_bulky.customers
[0m18:20:47.129013 [debug] [Thread-8  ]: Acquiring new snowflake connection 'model.billy_bulky.int_sales_trends'
[0m18:20:47.129818 [debug] [Thread-9  ]: Acquiring new snowflake connection 'model.billy_bulky.sales'
[0m18:20:47.130265 [debug] [Thread-6  ]: Began compiling node model.billy_bulky.int_customers_segmentation
[0m18:20:47.130697 [debug] [Thread-7  ]: Began compiling node model.billy_bulky.int_products_performance
[0m18:20:47.143666 [debug] [Thread-8  ]: Began compiling node model.billy_bulky.int_sales_trends
[0m18:20:47.145512 [debug] [Thread-5  ]: Writing injected SQL for node "model.billy_bulky.customers"
[0m18:20:47.145863 [debug] [Thread-9  ]: Began compiling node model.billy_bulky.sales
[0m18:20:47.171493 [debug] [Thread-7  ]: Writing injected SQL for node "model.billy_bulky.int_products_performance"
[0m18:20:47.175907 [debug] [Thread-6  ]: Writing injected SQL for node "model.billy_bulky.int_customers_segmentation"
[0m18:20:47.189286 [debug] [Thread-8  ]: Writing injected SQL for node "model.billy_bulky.int_sales_trends"
[0m18:20:47.196938 [debug] [Thread-9  ]: Writing injected SQL for node "model.billy_bulky.sales"
[0m18:20:47.197536 [debug] [Thread-6  ]: Timing info for model.billy_bulky.int_customers_segmentation (compile): 18:20:47.146080 => 18:20:47.197353
[0m18:20:47.197777 [debug] [Thread-6  ]: Began executing node model.billy_bulky.int_customers_segmentation
[0m18:20:47.210495 [debug] [Thread-8  ]: Timing info for model.billy_bulky.int_sales_trends (compile): 18:20:47.176096 => 18:20:47.210284
[0m18:20:47.216479 [debug] [Thread-6  ]: Writing runtime sql for node "model.billy_bulky.int_customers_segmentation"
[0m18:20:47.216801 [debug] [Thread-5  ]: Timing info for model.billy_bulky.customers (compile): 18:20:47.130966 => 18:20:47.216654
[0m18:20:47.217082 [debug] [Thread-8  ]: Began executing node model.billy_bulky.int_sales_trends
[0m18:20:47.217416 [debug] [Thread-9  ]: Timing info for model.billy_bulky.sales (compile): 18:20:47.189462 => 18:20:47.217264
[0m18:20:47.217753 [debug] [Thread-7  ]: Timing info for model.billy_bulky.int_products_performance (compile): 18:20:47.153203 => 18:20:47.217625
[0m18:20:47.217979 [debug] [Thread-5  ]: Began executing node model.billy_bulky.customers
[0m18:20:47.219793 [debug] [Thread-8  ]: Writing runtime sql for node "model.billy_bulky.int_sales_trends"
[0m18:20:47.220082 [debug] [Thread-9  ]: Began executing node model.billy_bulky.sales
[0m18:20:47.221969 [debug] [Thread-6  ]: Using snowflake connection "model.billy_bulky.int_customers_segmentation"
[0m18:20:47.222193 [debug] [Thread-7  ]: Began executing node model.billy_bulky.int_products_performance
[0m18:20:47.223791 [debug] [Thread-5  ]: Writing runtime sql for node "model.billy_bulky.customers"
[0m18:20:47.225513 [debug] [Thread-9  ]: Writing runtime sql for node "model.billy_bulky.sales"
[0m18:20:47.225845 [debug] [Thread-6  ]: On model.billy_bulky.int_customers_segmentation: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.int_customers_segmentation"} */
create or replace transient table E_COMMERCE.intermediate.int_customers_segmentation
         as
        (WITH  __dbt__cte__staging_shopify__customers as (
WITH customers AS (
    SELECT * FROM SHOPIFY.PUBLIC.customers
)

SELECT
    CUSTOMER_ID
    , FIRST_NAME
    , LAST_NAME
    , EMAIL
    , JOIN_DATE
    , COUNTRY
FROM customers
),  __dbt__cte__staging_shopify__orders as (
WITH orders AS (
    SELECT * FROM SHOPIFY.PUBLIC.orders
)

SELECT
    ORDER_ID
    , CUSTOMER_ID
    , PRODUCT_ID
    , QUANTITY
    , ORDER_DATE
    , STATUS
FROM orders
),  __dbt__cte__staging_shopify__products as (
WITH products AS (
    SELECT * FROM SHOPIFY.PUBLIC.products
)

SELECT
    PRODUCT_ID
    , NAME
    , CATEGORY
    , PRICE
    , STOCK_LEVEL
FROM products
), customers AS (
    SELECT * FROM __dbt__cte__staging_shopify__customers
)

, orders AS (
    SELECT * FROM __dbt__cte__staging_shopify__orders
)

, products AS (
    SELECT * FROM __dbt__cte__staging_shopify__products
)

, order_aggregates AS (
    SELECT
        o.CUSTOMER_ID
        , COUNT(DISTINCT o.ORDER_ID) AS frequency
        , SUM(o.QUANTITY * p.PRICE) AS monetary
        , AVG(o.QUANTITY * p.PRICE) AS average_order_value
        , MAX(o.ORDER_DATE) AS last_purchase_date
        , COUNT(CASE WHEN o.STATUS = 'cancelled' THEN 1 END) AS cancelled_orders
        , COUNT(*) AS total_orders
    FROM orders o
    JOIN products p ON o.PRODUCT_ID = p.PRODUCT_ID
    GROUP BY o.CUSTOMER_ID
)

, customer_tenure AS (
    SELECT
        CUSTOMER_ID
        , JOIN_DATE
        , CURRENT_DATE - JOIN_DATE AS tenure
    FROM customers
)

, customer_recency AS (
    SELECT
        CUSTOMER_ID
        , CURRENT_DATE - last_purchase_date AS recency
    FROM order_aggregates
)

, final AS (
    SELECT
        c.CUSTOMER_ID
        , c.FIRST_NAME
        , c.LAST_NAME
        , c.EMAIL
        , c.JOIN_DATE
        , c.COUNTRY
        , o.frequency
        , o.monetary
        , o.average_order_value
        , o.cancelled_orders
        , o.total_orders
        , CASE 
            WHEN o.total_orders > 0 THEN ROUND((o.cancelled_orders::FLOAT / o.total_orders) * 100, 2) 
            ELSE 0 
          END AS cancellation_rate
        , r.recency
        , t.tenure
    FROM customer_tenure t
    JOIN customers c ON t.CUSTOMER_ID = c.CUSTOMER_ID
    JOIN order_aggregates o ON c.CUSTOMER_ID = o.CUSTOMER_ID
    JOIN customer_recency r ON c.CUSTOMER_ID = r.CUSTOMER_ID
)

SELECT * FROM final
        );
[0m18:20:47.227611 [debug] [Thread-7  ]: Writing runtime sql for node "model.billy_bulky.int_products_performance"
[0m18:20:47.229490 [debug] [Thread-8  ]: Using snowflake connection "model.billy_bulky.int_sales_trends"
[0m18:20:47.229803 [debug] [Thread-6  ]: Opening a new connection, currently in state init
[0m18:20:47.230242 [debug] [Thread-8  ]: On model.billy_bulky.int_sales_trends: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.int_sales_trends"} */
create or replace transient table E_COMMERCE.intermediate.int_sales_trends
         as
        (WITH  __dbt__cte__staging_shopify__orders as (
WITH orders AS (
    SELECT * FROM SHOPIFY.PUBLIC.orders
)

SELECT
    ORDER_ID
    , CUSTOMER_ID
    , PRODUCT_ID
    , QUANTITY
    , ORDER_DATE
    , STATUS
FROM orders
),  __dbt__cte__staging_shopify__products as (
WITH products AS (
    SELECT * FROM SHOPIFY.PUBLIC.products
)

SELECT
    PRODUCT_ID
    , NAME
    , CATEGORY
    , PRICE
    , STOCK_LEVEL
FROM products
), orders AS (
    SELECT * FROM __dbt__cte__staging_shopify__orders
)

, products AS (
    SELECT * FROM __dbt__cte__staging_shopify__products
)

, daily_sales AS (
    SELECT
        DATE(ORDER_DATE) AS sale_date
        , COUNT(DISTINCT ORDER_ID) AS total_orders
        , SUM(QUANTITY) AS total_units_sold
        , SUM(QUANTITY * PRICE) AS total_sales_value
    FROM orders AS o
    JOIN products AS p ON o.PRODUCT_ID = p.PRODUCT_ID
    WHERE o.STATUS NOT IN ('cancelled') 
    GROUP BY sale_date
)

, weekly_sales AS (
    SELECT
        DATE_TRUNC('week', sale_date) AS sale_week
        , SUM(total_orders) AS weekly_orders
        , SUM(total_units_sold) AS weekly_units_sold
        , SUM(total_sales_value) AS weekly_sales_value
    FROM daily_sales
    GROUP BY sale_week
)

, monthly_sales AS (
    SELECT
        DATE_TRUNC('month', sale_date) AS sale_month
        , SUM(total_orders) AS monthly_orders
        , SUM(total_units_sold) AS monthly_units_sold
        , SUM(total_sales_value) AS monthly_sales_value
    FROM daily_sales
    GROUP BY sale_month
)

, yearly_sales AS (
    SELECT
        DATE_TRUNC('year', sale_date) AS sale_year
        , SUM(total_orders) AS yearly_orders
        , SUM(total_units_sold) AS yearly_units_sold
        , SUM(total_sales_value) AS yearly_sales_value
    FROM daily_sales
    GROUP BY sale_year
)

SELECT
    d.sale_date
    , d.total_orders AS daily_orders
    , d.total_units_sold AS daily_units_sold
    , d.total_sales_value AS daily_sales_value
    , w.weekly_orders
    , w.weekly_units_sold
    , w.weekly_sales_value
    , m.monthly_orders
    , m.monthly_units_sold
    , m.monthly_sales_value
    , y.yearly_orders
    , y.yearly_units_sold
    , y.yearly_sales_value
FROM daily_sales d
LEFT JOIN weekly_sales w ON DATE_TRUNC('week', d.sale_date) = w.sale_week
LEFT JOIN monthly_sales m ON DATE_TRUNC('month', d.sale_date) = m.sale_month
LEFT JOIN yearly_sales y ON DATE_TRUNC('year', d.sale_date) = y.sale_year
        );
[0m18:20:47.231610 [debug] [Thread-9  ]: Using snowflake connection "model.billy_bulky.sales"
[0m18:20:47.232932 [debug] [Thread-5  ]: Using snowflake connection "model.billy_bulky.customers"
[0m18:20:47.233333 [debug] [Thread-8  ]: Opening a new connection, currently in state init
[0m18:20:47.233820 [debug] [Thread-9  ]: On model.billy_bulky.sales: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.sales"} */
create or replace transient table E_COMMERCE.marts.sales
         as
        (WITH  __dbt__cte__staging_shopify__customers as (
WITH customers AS (
    SELECT * FROM SHOPIFY.PUBLIC.customers
)

SELECT
    CUSTOMER_ID
    , FIRST_NAME
    , LAST_NAME
    , EMAIL
    , JOIN_DATE
    , COUNTRY
FROM customers
),  __dbt__cte__staging_shopify__orders as (
WITH orders AS (
    SELECT * FROM SHOPIFY.PUBLIC.orders
)

SELECT
    ORDER_ID
    , CUSTOMER_ID
    , PRODUCT_ID
    , QUANTITY
    , ORDER_DATE
    , STATUS
FROM orders
),  __dbt__cte__staging_shopify__products as (
WITH products AS (
    SELECT * FROM SHOPIFY.PUBLIC.products
)

SELECT
    PRODUCT_ID
    , NAME
    , CATEGORY
    , PRICE
    , STOCK_LEVEL
FROM products
), customers AS (
    SELECT * FROM __dbt__cte__staging_shopify__customers
)

, orders AS (
    SELECT * FROM __dbt__cte__staging_shopify__orders
)

, products AS (
    SELECT * FROM __dbt__cte__staging_shopify__products
)



, enriched_orders AS (
    SELECT
        o.ORDER_ID
        , o.CUSTOMER_ID
        , o.PRODUCT_ID
        , o.QUANTITY
        , o.ORDER_DATE
        , o.STATUS
        , p.CATEGORY
        , p.PRICE AS unit_price
        , (o.QUANTITY * p.PRICE) AS total_price
        , c.COUNTRY
    FROM orders o
    JOIN products p ON o.PRODUCT_ID = p.PRODUCT_ID
    JOIN customers c ON o.CUSTOMER_ID = c.CUSTOMER_ID
    WHERE o.STATUS NOT IN ('cancelled') 
)

, final AS (
SELECT
    e.ORDER_ID
    , e.CUSTOMER_ID
    , e.PRODUCT_ID
    , e.QUANTITY
    , e.ORDER_DATE
    , e.STATUS
    , e.CATEGORY
    , e.unit_price
    , e.total_price
    , e.COUNTRY
FROM enriched_orders e
)

SELECT * FROM final
        );
[0m18:20:47.235430 [debug] [Thread-7  ]: Using snowflake connection "model.billy_bulky.int_products_performance"
[0m18:20:47.235951 [debug] [Thread-5  ]: On model.billy_bulky.customers: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.customers"} */
create or replace transient table E_COMMERCE.marts.customers
         as
        (WITH  __dbt__cte__staging_shopify__customers as (
WITH customers AS (
    SELECT * FROM SHOPIFY.PUBLIC.customers
)

SELECT
    CUSTOMER_ID
    , FIRST_NAME
    , LAST_NAME
    , EMAIL
    , JOIN_DATE
    , COUNTRY
FROM customers
),  __dbt__cte__staging_shopify__orders as (
WITH orders AS (
    SELECT * FROM SHOPIFY.PUBLIC.orders
)

SELECT
    ORDER_ID
    , CUSTOMER_ID
    , PRODUCT_ID
    , QUANTITY
    , ORDER_DATE
    , STATUS
FROM orders
),  __dbt__cte__staging_shopify__products as (
WITH products AS (
    SELECT * FROM SHOPIFY.PUBLIC.products
)

SELECT
    PRODUCT_ID
    , NAME
    , CATEGORY
    , PRICE
    , STOCK_LEVEL
FROM products
), customers AS (
    SELECT * FROM __dbt__cte__staging_shopify__customers
)

, orders AS (
    SELECT * FROM __dbt__cte__staging_shopify__orders
)

, products AS (
    SELECT * FROM __dbt__cte__staging_shopify__products
)

, source AS (
    SELECT
        c.CUSTOMER_ID
        , c.FIRST_NAME
        , c.LAST_NAME
        , c.EMAIL
        , c.JOIN_DATE
        , c.COUNTRY
        , COUNT(o.ORDER_ID) AS total_orders
        , SUM(o.QUANTITY * p.PRICE) AS total_spent
    FROM customers c
    LEFT JOIN orders o ON c.CUSTOMER_ID = o.CUSTOMER_ID
    LEFT JOIN products p ON o.PRODUCT_ID = p.PRODUCT_ID
    WHERE o.STATUS NOT IN ('cancelled')
    GROUP BY c.CUSTOMER_ID, c.FIRST_NAME, c.LAST_NAME, c.EMAIL, c.JOIN_DATE, c.COUNTRY
)

, final AS (
SELECT
    s.CUSTOMER_ID
    , s.FIRST_NAME
    , s.LAST_NAME
    , s.EMAIL
    , s.JOIN_DATE
    , s.COUNTRY
    , s.total_orders
    , s.total_spent
    , CASE WHEN s.total_spent > 1000 THEN 'VIP' ELSE 'Regular' END AS customer_segment -- Example segmentation
FROM source s
)

SELECT * FROM final
        );
[0m18:20:47.236584 [debug] [Thread-9  ]: Opening a new connection, currently in state init
[0m18:20:47.236930 [debug] [Thread-7  ]: On model.billy_bulky.int_products_performance: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.int_products_performance"} */
create or replace transient table E_COMMERCE.intermediate.int_products_performance
         as
        (WITH  __dbt__cte__staging_shopify__orders as (
WITH orders AS (
    SELECT * FROM SHOPIFY.PUBLIC.orders
)

SELECT
    ORDER_ID
    , CUSTOMER_ID
    , PRODUCT_ID
    , QUANTITY
    , ORDER_DATE
    , STATUS
FROM orders
),  __dbt__cte__staging_shopify__products as (
WITH products AS (
    SELECT * FROM SHOPIFY.PUBLIC.products
)

SELECT
    PRODUCT_ID
    , NAME
    , CATEGORY
    , PRICE
    , STOCK_LEVEL
FROM products
), orders AS (
    SELECT * FROM __dbt__cte__staging_shopify__orders
)

, products AS (
    SELECT * FROM __dbt__cte__staging_shopify__products
)

, product_sales AS (
    SELECT
        o.PRODUCT_ID
        , COUNT(DISTINCT o.ORDER_ID) AS total_sales
        , SUM(o.QUANTITY) AS total_units_sold
        , SUM(o.QUANTITY * p.PRICE) AS total_sales_value
    FROM orders o
    INNER JOIN products p ON o.PRODUCT_ID = p.PRODUCT_ID
    WHERE o.STATUS NOT IN ('cancelled') 
    GROUP BY o.PRODUCT_ID
)

, product_averages AS (
    SELECT
        PRODUCT_ID
        , (total_sales_value / NULLIF(total_units_sold, 0)) AS average_sale_price
    FROM product_sales
)

, product_stock_turnover AS (
    SELECT
        p.PRODUCT_ID
        , p.STOCK_LEVEL
        , (total_units_sold / NULLIF(p.STOCK_LEVEL, 0)) AS turnover_rate
    FROM product_sales ps
    INNER JOIN products p ON ps.PRODUCT_ID = p.PRODUCT_ID
)

, final AS (
    SELECT
    p.PRODUCT_ID
    , p.NAME
    , p.CATEGORY
    , p.PRICE
    , pa.average_sale_price
    , ps.total_sales
    , ps.total_units_sold
    , ps.total_sales_value
    , pst.turnover_rate
    , p.STOCK_LEVEL
FROM products p
LEFT JOIN product_sales ps ON p.PRODUCT_ID = ps.PRODUCT_ID
LEFT JOIN product_averages pa ON p.PRODUCT_ID = pa.PRODUCT_ID
LEFT JOIN product_stock_turnover pst ON p.PRODUCT_ID = pst.PRODUCT_ID
)

SELECT * FROM final
        );
[0m18:20:47.237442 [debug] [Thread-5  ]: Opening a new connection, currently in state init
[0m18:20:47.238184 [debug] [Thread-7  ]: Opening a new connection, currently in state init
[0m18:20:50.074302 [debug] [Thread-5  ]: SQL status: SUCCESS 1 in 3.0 seconds
[0m18:20:50.105768 [debug] [Thread-5  ]: Timing info for model.billy_bulky.customers (execute): 18:20:47.222338 => 18:20:50.105561
[0m18:20:50.106224 [debug] [Thread-5  ]: On model.billy_bulky.customers: Close
[0m18:20:50.187052 [debug] [Thread-8  ]: SQL status: SUCCESS 1 in 3.0 seconds
[0m18:20:50.199398 [debug] [Thread-8  ]: Timing info for model.billy_bulky.int_sales_trends (execute): 18:20:47.218155 => 18:20:50.198808
[0m18:20:50.200512 [debug] [Thread-8  ]: On model.billy_bulky.int_sales_trends: Close
[0m18:20:50.207185 [debug] [Thread-6  ]: SQL status: SUCCESS 1 in 3.0 seconds
[0m18:20:50.212864 [debug] [Thread-6  ]: Timing info for model.billy_bulky.int_customers_segmentation (execute): 18:20:47.197914 => 18:20:50.212414
[0m18:20:50.214394 [debug] [Thread-9  ]: SQL status: SUCCESS 1 in 3.0 seconds
[0m18:20:50.214832 [debug] [Thread-6  ]: On model.billy_bulky.int_customers_segmentation: Close
[0m18:20:50.217081 [debug] [Thread-9  ]: Timing info for model.billy_bulky.sales (execute): 18:20:47.223984 => 18:20:50.216902
[0m18:20:50.218320 [debug] [Thread-9  ]: On model.billy_bulky.sales: Close
[0m18:20:50.232589 [debug] [Thread-7  ]: SQL status: SUCCESS 1 in 3.0 seconds
[0m18:20:50.234758 [debug] [Thread-7  ]: Timing info for model.billy_bulky.int_products_performance (execute): 18:20:47.226114 => 18:20:50.234599
[0m18:20:50.235070 [debug] [Thread-7  ]: On model.billy_bulky.int_products_performance: Close
[0m18:20:50.587100 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49912b30-4ab9-4ba2-8f01-3d25a678b702', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13542d460>]}
[0m18:20:50.589777 [info ] [Thread-8  ]: 4 of 5 OK created sql table model intermediate.int_sales_trends ................ [[32mSUCCESS 1[0m in 3.46s]
[0m18:20:50.592698 [debug] [Thread-8  ]: Finished running node model.billy_bulky.int_sales_trends
[0m18:20:50.599408 [debug] [Thread-9  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49912b30-4ab9-4ba2-8f01-3d25a678b702', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1352b71c0>]}
[0m18:20:50.600772 [info ] [Thread-9  ]: 5 of 5 OK created sql table model marts.sales .................................. [[32mSUCCESS 1[0m in 3.47s]
[0m18:20:50.601831 [debug] [Thread-9  ]: Finished running node model.billy_bulky.sales
[0m18:20:50.619080 [debug] [Thread-7  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49912b30-4ab9-4ba2-8f01-3d25a678b702', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1351d1a60>]}
[0m18:20:50.620362 [info ] [Thread-7  ]: 3 of 5 OK created sql table model intermediate.int_products_performance ........ [[32mSUCCESS 1[0m in 3.49s]
[0m18:20:50.622192 [debug] [Thread-7  ]: Finished running node model.billy_bulky.int_products_performance
[0m18:20:50.902032 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49912b30-4ab9-4ba2-8f01-3d25a678b702', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1351f0d60>]}
[0m18:20:50.903814 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49912b30-4ab9-4ba2-8f01-3d25a678b702', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1351aa880>]}
[0m18:20:50.905215 [info ] [Thread-6  ]: 2 of 5 OK created sql table model intermediate.int_customers_segmentation ...... [[32mSUCCESS 1[0m in 3.77s]
[0m18:20:50.906757 [debug] [Thread-6  ]: Finished running node model.billy_bulky.int_customers_segmentation
[0m18:20:50.907934 [info ] [Thread-5  ]: 1 of 5 OK created sql table model marts.customers .............................. [[32mSUCCESS 1[0m in 3.78s]
[0m18:20:50.910322 [debug] [Thread-5  ]: Finished running node model.billy_bulky.customers
[0m18:20:50.913802 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:20:50.914295 [debug] [MainThread]: Connection 'model.billy_bulky.staging_shopify__customers' was properly closed.
[0m18:20:50.914622 [debug] [MainThread]: Connection 'model.billy_bulky.staging_shopify__orders' was properly closed.
[0m18:20:50.914929 [debug] [MainThread]: Connection 'model.billy_bulky.staging_shopify__products' was properly closed.
[0m18:20:50.915225 [debug] [MainThread]: Connection 'model.billy_bulky.customers' was properly closed.
[0m18:20:50.915515 [debug] [MainThread]: Connection 'model.billy_bulky.int_customers_segmentation' was properly closed.
[0m18:20:50.915806 [debug] [MainThread]: Connection 'model.billy_bulky.int_products_performance' was properly closed.
[0m18:20:50.916086 [debug] [MainThread]: Connection 'model.billy_bulky.int_sales_trends' was properly closed.
[0m18:20:50.916371 [debug] [MainThread]: Connection 'model.billy_bulky.sales' was properly closed.
[0m18:20:50.916799 [info ] [MainThread]: 
[0m18:20:50.917252 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 11.97 seconds (11.97s).
[0m18:20:50.918512 [debug] [MainThread]: Command end result
[0m18:20:50.935477 [info ] [MainThread]: 
[0m18:20:50.936057 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:20:50.936463 [info ] [MainThread]: 
[0m18:20:50.936862 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m18:20:50.939531 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.097179, "process_user_time": 5.119461, "process_kernel_time": 0.394828, "process_mem_max_rss": "223412224", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:20:50.940216 [debug] [MainThread]: Command `dbt run` succeeded at 18:20:50.940074 after 13.10 seconds
[0m18:20:50.940634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10671d250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1311749d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x131174d00>]}
[0m18:20:50.941054 [debug] [MainThread]: Flushing usage events
[0m18:25:24.201760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102a69eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052b81f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052b8790>]}


============================== 18:25:24.204788 | 80f60291-1ebc-4612-86c4-865f70aad7f9 ==============================
[0m18:25:24.204788 [info ] [MainThread]: Running with dbt=1.7.1
[0m18:25:24.205166 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/bitlevi/Documents/billy_bulky_ecommerce/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/bitlevi/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:25:25.115747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '80f60291-1ebc-4612-86c4-865f70aad7f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10255a940>]}
[0m18:25:25.165648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '80f60291-1ebc-4612-86c4-865f70aad7f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052d50d0>]}
[0m18:25:25.166456 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m18:25:25.178827 [debug] [MainThread]: checksum: ad428e6dc3b353dcb23d0c4ebea8b20b180e94b873271ac2a054a8e446dac0e2, vars: {}, profile: , target: , version: 1.7.1
[0m18:25:25.214301 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 2 files changed.
[0m18:25:25.214802 [debug] [MainThread]: Partial parsing: added file: billy_bulky://models/marts/products.sql
[0m18:25:25.215218 [debug] [MainThread]: Partial parsing: updated file: billy_bulky://models/marts/_marts__models.yml
[0m18:25:25.215497 [debug] [MainThread]: Partial parsing: updated file: billy_bulky://models/marts/customers.sql
[0m18:25:25.446567 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two schema.yml entries for the same resource named customers. Resources and their associated columns may only be described a single time. To fix this, remove the resource entry for customers in one of these files:
   - models/staging/shopify/_shopify__schema.yml
  models/marts/_marts__models.yml
[0m18:25:25.448361 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.2832544, "process_user_time": 3.931894, "process_kernel_time": 0.35356, "process_mem_max_rss": "196706304", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:25:25.448717 [debug] [MainThread]: Command `dbt run` failed at 18:25:25.448643 after 1.28 seconds
[0m18:25:25.448944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102a69eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126ac7f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126ac7220>]}
[0m18:25:25.449180 [debug] [MainThread]: Flushing usage events
[0m18:26:09.065464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1032290d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a78400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a78a30>]}


============================== 18:26:09.068162 | efdff01b-8c04-4274-a13b-0b07190c700f ==============================
[0m18:26:09.068162 [info ] [MainThread]: Running with dbt=1.7.1
[0m18:26:09.068518 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/bitlevi/Documents/billy_bulky_ecommerce/logs', 'debug': 'False', 'profiles_dir': '/Users/bitlevi/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:26:09.882243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'efdff01b-8c04-4274-a13b-0b07190c700f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a78460>]}
[0m18:26:09.929581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'efdff01b-8c04-4274-a13b-0b07190c700f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d0a4310>]}
[0m18:26:09.930288 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m18:26:09.949921 [debug] [MainThread]: checksum: ad428e6dc3b353dcb23d0c4ebea8b20b180e94b873271ac2a054a8e446dac0e2, vars: {}, profile: , target: , version: 1.7.1
[0m18:26:09.983553 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 2 files changed.
[0m18:26:09.984045 [debug] [MainThread]: Partial parsing: added file: billy_bulky://models/marts/products.sql
[0m18:26:09.984445 [debug] [MainThread]: Partial parsing: updated file: billy_bulky://models/marts/_marts__models.yml
[0m18:26:09.984717 [debug] [MainThread]: Partial parsing: updated file: billy_bulky://models/marts/customers.sql
[0m18:26:10.209621 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two schema.yml entries for the same resource named customers. Resources and their associated columns may only be described a single time. To fix this, remove the resource entry for customers in one of these files:
   - models/staging/shopify/_shopify__schema.yml
  models/marts/_marts__models.yml
[0m18:26:10.211196 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.178348, "process_user_time": 3.8878, "process_kernel_time": 0.284243, "process_mem_max_rss": "198885376", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:26:10.211538 [debug] [MainThread]: Command `dbt run` failed at 18:26:10.211458 after 1.18 seconds
[0m18:26:10.211786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1032290d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11eba97c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11eba9490>]}
[0m18:26:10.212033 [debug] [MainThread]: Flushing usage events
[0m18:27:11.334325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10538deb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bdcf70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bdc4f0>]}


============================== 18:27:11.337098 | da53736f-7c33-40b9-a110-959c6db74a92 ==============================
[0m18:27:11.337098 [info ] [MainThread]: Running with dbt=1.7.1
[0m18:27:11.337454 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/bitlevi/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/bitlevi/Documents/billy_bulky_ecommerce/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:27:12.164025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'da53736f-7c33-40b9-a110-959c6db74a92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bdc490>]}
[0m18:27:12.213329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'da53736f-7c33-40b9-a110-959c6db74a92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e219100>]}
[0m18:27:12.215065 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m18:27:12.227725 [debug] [MainThread]: checksum: ad428e6dc3b353dcb23d0c4ebea8b20b180e94b873271ac2a054a8e446dac0e2, vars: {}, profile: , target: , version: 1.7.1
[0m18:27:12.261709 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 2 files changed.
[0m18:27:12.262229 [debug] [MainThread]: Partial parsing: added file: billy_bulky://models/marts/products.sql
[0m18:27:12.262627 [debug] [MainThread]: Partial parsing: updated file: billy_bulky://models/marts/_marts__models.yml
[0m18:27:12.262908 [debug] [MainThread]: Partial parsing: updated file: billy_bulky://models/marts/customers.sql
[0m18:27:12.488332 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two schema.yml entries for the same resource named customers. Resources and their associated columns may only be described a single time. To fix this, remove the resource entry for customers in one of these files:
   - models/staging/shopify/_shopify__schema.yml
  models/marts/_marts__models.yml
[0m18:27:12.489879 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.1894417, "process_user_time": 3.89549, "process_kernel_time": 0.286861, "process_mem_max_rss": "199032832", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:27:12.490210 [debug] [MainThread]: Command `dbt run` failed at 18:27:12.490134 after 1.19 seconds
[0m18:27:12.490459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10538deb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11eecf6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11eee0820>]}
[0m18:27:12.490712 [debug] [MainThread]: Flushing usage events
[0m18:27:49.392293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070a5eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099110d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109911cd0>]}


============================== 18:27:49.395142 | 913cbe99-5b8b-4081-b2d1-c6cfd3e7c693 ==============================
[0m18:27:49.395142 [info ] [MainThread]: Running with dbt=1.7.1
[0m18:27:49.395516 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/bitlevi/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/bitlevi/Documents/billy_bulky_ecommerce/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:27:50.242561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '913cbe99-5b8b-4081-b2d1-c6cfd3e7c693', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13451e310>]}
[0m18:27:50.290282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '913cbe99-5b8b-4081-b2d1-c6cfd3e7c693', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1344f3dc0>]}
[0m18:27:50.290884 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m18:27:50.303494 [debug] [MainThread]: checksum: ad428e6dc3b353dcb23d0c4ebea8b20b180e94b873271ac2a054a8e446dac0e2, vars: {}, profile: , target: , version: 1.7.1
[0m18:27:50.338795 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 2 files changed.
[0m18:27:50.339346 [debug] [MainThread]: Partial parsing: added file: billy_bulky://models/marts/products.sql
[0m18:27:50.339778 [debug] [MainThread]: Partial parsing: updated file: billy_bulky://models/marts/_marts__models.yml
[0m18:27:50.340064 [debug] [MainThread]: Partial parsing: updated file: billy_bulky://models/marts/customers.sql
[0m18:27:50.445121 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'marts_customers' in the 'models' section of file 'models/marts/_marts__models.yml'
[0m18:27:50.447654 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'marts_sales' in the 'models' section of file 'models/marts/_marts__models.yml'
[0m18:27:50.449322 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'marts_products' in the 'models' section of file 'models/marts/_marts__models.yml'
[0m18:27:50.580901 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.unique_marts_customers_customer_id.9c72620f57' (models/marts/_marts__models.yml) depends on a node named 'marts_customers' in package '' which was not found
[0m18:27:50.581251 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_customers_customer_id.fc7763eff9' (models/marts/_marts__models.yml) depends on a node named 'marts_customers' in package '' which was not found
[0m18:27:50.581487 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.unique_marts_customers_email.6210d26820' (models/marts/_marts__models.yml) depends on a node named 'marts_customers' in package '' which was not found
[0m18:27:50.581718 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_customers_email.637d2131e6' (models/marts/_marts__models.yml) depends on a node named 'marts_customers' in package '' which was not found
[0m18:27:50.581935 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_customers_join_date.6378efd424' (models/marts/_marts__models.yml) depends on a node named 'marts_customers' in package '' which was not found
[0m18:27:50.582153 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_customers_total_orders.7cdc5122e5' (models/marts/_marts__models.yml) depends on a node named 'marts_customers' in package '' which was not found
[0m18:27:50.582365 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_customers_total_spent.d5343aecc7' (models/marts/_marts__models.yml) depends on a node named 'marts_customers' in package '' which was not found
[0m18:27:50.582572 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.unique_marts_sales_order_id.825e23650b' (models/marts/_marts__models.yml) depends on a node named 'marts_sales' in package '' which was not found
[0m18:27:50.582788 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_sales_order_id.842b56ef2f' (models/marts/_marts__models.yml) depends on a node named 'marts_sales' in package '' which was not found
[0m18:27:50.582999 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_sales_customer_id.189ac71c42' (models/marts/_marts__models.yml) depends on a node named 'marts_sales' in package '' which was not found
[0m18:27:50.583219 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.relationships_marts_sales_customer_id__customer_id__ref_customers_.74e21c3398' (models/marts/_marts__models.yml) depends on a node named 'marts_sales' in package '' which was not found
[0m18:27:50.583427 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_sales_product_id.12beecf4f2' (models/marts/_marts__models.yml) depends on a node named 'marts_sales' in package '' which was not found
[0m18:27:50.583642 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.relationships_marts_sales_product_id__product_id__ref_products_.77e7665182' (models/marts/_marts__models.yml) depends on a node named 'marts_sales' in package '' which was not found
[0m18:27:50.583854 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_sales_quantity.ea8c580869' (models/marts/_marts__models.yml) depends on a node named 'marts_sales' in package '' which was not found
[0m18:27:50.584062 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_sales_order_date.90eaa9e7fe' (models/marts/_marts__models.yml) depends on a node named 'marts_sales' in package '' which was not found
[0m18:27:50.584268 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_sales_status.e9b4b90247' (models/marts/_marts__models.yml) depends on a node named 'marts_sales' in package '' which was not found
[0m18:27:50.584473 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_sales_category.a98218f68d' (models/marts/_marts__models.yml) depends on a node named 'marts_sales' in package '' which was not found
[0m18:27:50.584678 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_sales_unit_price.321f152a2a' (models/marts/_marts__models.yml) depends on a node named 'marts_sales' in package '' which was not found
[0m18:27:50.584882 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_sales_total_price.015724a7e6' (models/marts/_marts__models.yml) depends on a node named 'marts_sales' in package '' which was not found
[0m18:27:50.585087 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_sales_country.5f628b732c' (models/marts/_marts__models.yml) depends on a node named 'marts_sales' in package '' which was not found
[0m18:27:50.585295 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.unique_marts_products_product_id.e96f554683' (models/marts/_marts__models.yml) depends on a node named 'marts_products' in package '' which was not found
[0m18:27:50.585506 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_products_product_id.9b354ae761' (models/marts/_marts__models.yml) depends on a node named 'marts_products' in package '' which was not found
[0m18:27:50.585721 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_products_name.f0d9c8d191' (models/marts/_marts__models.yml) depends on a node named 'marts_products' in package '' which was not found
[0m18:27:50.585934 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_products_category.1212ed3683' (models/marts/_marts__models.yml) depends on a node named 'marts_products' in package '' which was not found
[0m18:27:50.586141 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_products_price.d6207a2896' (models/marts/_marts__models.yml) depends on a node named 'marts_products' in package '' which was not found
[0m18:27:50.586350 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_products_total_units_sold.6822a804df' (models/marts/_marts__models.yml) depends on a node named 'marts_products' in package '' which was not found
[0m18:27:50.586566 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_products_total_sales_value.b0a2a654b3' (models/marts/_marts__models.yml) depends on a node named 'marts_products' in package '' which was not found
[0m18:27:50.597926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '913cbe99-5b8b-4081-b2d1-c6cfd3e7c693', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1366820d0>]}
[0m18:27:50.611356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '913cbe99-5b8b-4081-b2d1-c6cfd3e7c693', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135a2a0a0>]}
[0m18:27:50.611704 [info ] [MainThread]: Found 9 models, 20 tests, 3 sources, 0 exposures, 0 metrics, 431 macros, 0 groups, 0 semantic models
[0m18:27:50.611933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '913cbe99-5b8b-4081-b2d1-c6cfd3e7c693', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135a2a1f0>]}
[0m18:27:50.613181 [info ] [MainThread]: 
[0m18:27:50.613666 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:27:50.614390 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE'
[0m18:27:50.622578 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE"
[0m18:27:50.623115 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE'
[0m18:27:50.623368 [debug] [ThreadPool]: On list_E_COMMERCE: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE"} */
show terse schemas in database E_COMMERCE
    limit 10000
[0m18:27:50.625253 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE"
[0m18:27:50.625496 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:27:50.625690 [debug] [ThreadPool]: On list_E_COMMERCE: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE"} */
show terse schemas in database E_COMMERCE
    limit 10000
[0m18:27:50.626468 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:27:52.592074 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.0 seconds
[0m18:27:52.593570 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.0 seconds
[0m18:27:52.596210 [debug] [ThreadPool]: On list_E_COMMERCE: Close
[0m18:27:52.598428 [debug] [ThreadPool]: On list_E_COMMERCE: Close
[0m18:27:53.016631 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_E_COMMERCE, now list_E_COMMERCE_intermediate)
[0m18:27:53.017955 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_E_COMMERCE, now list_E_COMMERCE_marts)
[0m18:27:53.023885 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_intermediate"
[0m18:27:53.026875 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_marts"
[0m18:27:53.027296 [debug] [ThreadPool]: On list_E_COMMERCE_intermediate: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE_intermediate"} */
show terse objects in E_COMMERCE.intermediate limit 10000
[0m18:27:53.027585 [debug] [ThreadPool]: On list_E_COMMERCE_marts: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE_marts"} */
show terse objects in E_COMMERCE.marts limit 10000
[0m18:27:53.027810 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:27:53.028004 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:27:54.288033 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m18:27:54.292892 [debug] [ThreadPool]: On list_E_COMMERCE_intermediate: Close
[0m18:27:54.294365 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m18:27:54.298703 [debug] [ThreadPool]: On list_E_COMMERCE_marts: Close
[0m18:27:54.690530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '913cbe99-5b8b-4081-b2d1-c6cfd3e7c693', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1345c93a0>]}
[0m18:27:54.692148 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m18:27:54.693091 [info ] [MainThread]: 
[0m18:27:54.697267 [debug] [Thread-1  ]: Began running node model.billy_bulky.staging_shopify__customers
[0m18:27:54.697966 [debug] [Thread-2  ]: Began running node model.billy_bulky.staging_shopify__orders
[0m18:27:54.699318 [debug] [Thread-3  ]: Began running node model.billy_bulky.staging_shopify__products
[0m18:27:54.700014 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_E_COMMERCE_intermediate, now model.billy_bulky.staging_shopify__customers)
[0m18:27:54.700876 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_E_COMMERCE_marts, now model.billy_bulky.staging_shopify__orders)
[0m18:27:54.701819 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.billy_bulky.staging_shopify__products'
[0m18:27:54.702325 [debug] [Thread-1  ]: Began compiling node model.billy_bulky.staging_shopify__customers
[0m18:27:54.702784 [debug] [Thread-2  ]: Began compiling node model.billy_bulky.staging_shopify__orders
[0m18:27:54.703227 [debug] [Thread-3  ]: Began compiling node model.billy_bulky.staging_shopify__products
[0m18:27:54.712899 [debug] [Thread-1  ]: Writing injected SQL for node "model.billy_bulky.staging_shopify__customers"
[0m18:27:54.716475 [debug] [Thread-2  ]: Writing injected SQL for node "model.billy_bulky.staging_shopify__orders"
[0m18:27:54.720992 [debug] [Thread-3  ]: Writing injected SQL for node "model.billy_bulky.staging_shopify__products"
[0m18:27:54.722282 [debug] [Thread-1  ]: Timing info for model.billy_bulky.staging_shopify__customers (compile): 18:27:54.703530 => 18:27:54.722012
[0m18:27:54.722769 [debug] [Thread-2  ]: Timing info for model.billy_bulky.staging_shopify__orders (compile): 18:27:54.713267 => 18:27:54.722530
[0m18:27:54.723180 [debug] [Thread-3  ]: Timing info for model.billy_bulky.staging_shopify__products (compile): 18:27:54.716849 => 18:27:54.722988
[0m18:27:54.724211 [debug] [Thread-1  ]: Finished running node model.billy_bulky.staging_shopify__customers
[0m18:27:54.725179 [debug] [Thread-2  ]: Finished running node model.billy_bulky.staging_shopify__orders
[0m18:27:54.726183 [debug] [Thread-3  ]: Finished running node model.billy_bulky.staging_shopify__products
[0m18:27:54.727218 [debug] [Thread-5  ]: Began running node model.billy_bulky.customers
[0m18:27:54.727643 [debug] [Thread-6  ]: Began running node model.billy_bulky.int_customers_segmentation
[0m18:27:54.728085 [debug] [Thread-7  ]: Began running node model.billy_bulky.int_products_performance
[0m18:27:54.728939 [debug] [Thread-8  ]: Began running node model.billy_bulky.int_sales_trends
[0m18:27:54.728613 [info ] [Thread-5  ]: 1 of 6 START sql table model marts.customers ................................... [RUN]
[0m18:27:54.729628 [debug] [Thread-9  ]: Began running node model.billy_bulky.products
[0m18:27:54.730022 [info ] [Thread-6  ]: 2 of 6 START sql table model intermediate.int_customers_segmentation ........... [RUN]
[0m18:27:54.730388 [debug] [Thread-10 ]: Began running node model.billy_bulky.sales
[0m18:27:54.730771 [info ] [Thread-7  ]: 3 of 6 START sql table model intermediate.int_products_performance ............. [RUN]
[0m18:27:54.731157 [info ] [Thread-8  ]: 4 of 6 START sql table model intermediate.int_sales_trends ..................... [RUN]
[0m18:27:54.731801 [debug] [Thread-5  ]: Acquiring new snowflake connection 'model.billy_bulky.customers'
[0m18:27:54.732188 [info ] [Thread-9  ]: 5 of 6 START sql table model marts.products .................................... [RUN]
[0m18:27:54.732797 [debug] [Thread-6  ]: Acquiring new snowflake connection 'model.billy_bulky.int_customers_segmentation'
[0m18:27:54.733148 [info ] [Thread-10 ]: 6 of 6 START sql table model marts.sales ....................................... [RUN]
[0m18:27:54.733799 [debug] [Thread-7  ]: Acquiring new snowflake connection 'model.billy_bulky.int_products_performance'
[0m18:27:54.734400 [debug] [Thread-8  ]: Acquiring new snowflake connection 'model.billy_bulky.int_sales_trends'
[0m18:27:54.734722 [debug] [Thread-5  ]: Began compiling node model.billy_bulky.customers
[0m18:27:54.735291 [debug] [Thread-9  ]: Acquiring new snowflake connection 'model.billy_bulky.products'
[0m18:27:54.735603 [debug] [Thread-6  ]: Began compiling node model.billy_bulky.int_customers_segmentation
[0m18:27:54.736151 [debug] [Thread-10 ]: Acquiring new snowflake connection 'model.billy_bulky.sales'
[0m18:27:54.736456 [debug] [Thread-7  ]: Began compiling node model.billy_bulky.int_products_performance
[0m18:27:54.736750 [debug] [Thread-8  ]: Began compiling node model.billy_bulky.int_sales_trends
[0m18:27:54.748273 [debug] [Thread-5  ]: Writing injected SQL for node "model.billy_bulky.customers"
[0m18:27:54.748674 [debug] [Thread-9  ]: Began compiling node model.billy_bulky.products
[0m18:27:54.761326 [debug] [Thread-10 ]: Began compiling node model.billy_bulky.sales
[0m18:27:54.763693 [debug] [Thread-6  ]: Writing injected SQL for node "model.billy_bulky.int_customers_segmentation"
[0m18:27:54.774248 [debug] [Thread-7  ]: Writing injected SQL for node "model.billy_bulky.int_products_performance"
[0m18:27:54.788675 [debug] [Thread-8  ]: Writing injected SQL for node "model.billy_bulky.int_sales_trends"
[0m18:27:54.794575 [debug] [Thread-9  ]: Writing injected SQL for node "model.billy_bulky.products"
[0m18:27:54.802226 [debug] [Thread-10 ]: Writing injected SQL for node "model.billy_bulky.sales"
[0m18:27:54.802603 [debug] [Thread-5  ]: Timing info for model.billy_bulky.customers (compile): 18:27:54.736934 => 18:27:54.802446
[0m18:27:54.803103 [debug] [Thread-5  ]: Began executing node model.billy_bulky.customers
[0m18:27:54.821221 [debug] [Thread-5  ]: Writing runtime sql for node "model.billy_bulky.customers"
[0m18:27:54.821667 [debug] [Thread-7  ]: Timing info for model.billy_bulky.int_products_performance (compile): 18:27:54.763898 => 18:27:54.821487
[0m18:27:54.822046 [debug] [Thread-9  ]: Timing info for model.billy_bulky.products (compile): 18:27:54.788924 => 18:27:54.821892
[0m18:27:54.822405 [debug] [Thread-10 ]: Timing info for model.billy_bulky.sales (compile): 18:27:54.794808 => 18:27:54.822262
[0m18:27:54.822662 [debug] [Thread-7  ]: Began executing node model.billy_bulky.int_products_performance
[0m18:27:54.822970 [debug] [Thread-8  ]: Timing info for model.billy_bulky.int_sales_trends (compile): 18:27:54.774532 => 18:27:54.822842
[0m18:27:54.823196 [debug] [Thread-9  ]: Began executing node model.billy_bulky.products
[0m18:27:54.823473 [debug] [Thread-6  ]: Timing info for model.billy_bulky.int_customers_segmentation (compile): 18:27:54.748857 => 18:27:54.823348
[0m18:27:54.823686 [debug] [Thread-10 ]: Began executing node model.billy_bulky.sales
[0m18:27:54.825090 [debug] [Thread-5  ]: Using snowflake connection "model.billy_bulky.customers"
[0m18:27:54.826947 [debug] [Thread-7  ]: Writing runtime sql for node "model.billy_bulky.int_products_performance"
[0m18:27:54.827186 [debug] [Thread-8  ]: Began executing node model.billy_bulky.int_sales_trends
[0m18:27:54.829518 [debug] [Thread-9  ]: Writing runtime sql for node "model.billy_bulky.products"
[0m18:27:54.829777 [debug] [Thread-6  ]: Began executing node model.billy_bulky.int_customers_segmentation
[0m18:27:54.831430 [debug] [Thread-10 ]: Writing runtime sql for node "model.billy_bulky.sales"
[0m18:27:54.831752 [debug] [Thread-5  ]: On model.billy_bulky.customers: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.customers"} */
create or replace transient table E_COMMERCE.marts.customers
         as
        (WITH  __dbt__cte__staging_shopify__customers as (
WITH customers AS (
    SELECT * FROM SHOPIFY.PUBLIC.customers
)

SELECT
    CUSTOMER_ID
    , FIRST_NAME
    , LAST_NAME
    , EMAIL
    , JOIN_DATE
    , COUNTRY
FROM customers
),  __dbt__cte__staging_shopify__orders as (
WITH orders AS (
    SELECT * FROM SHOPIFY.PUBLIC.orders
)

SELECT
    ORDER_ID
    , CUSTOMER_ID
    , PRODUCT_ID
    , QUANTITY
    , ORDER_DATE
    , STATUS
FROM orders
),  __dbt__cte__staging_shopify__products as (
WITH products AS (
    SELECT * FROM SHOPIFY.PUBLIC.products
)

SELECT
    PRODUCT_ID
    , NAME
    , CATEGORY
    , PRICE
    , STOCK_LEVEL
FROM products
), customers AS (
    SELECT * FROM __dbt__cte__staging_shopify__customers
)

, orders AS (
    SELECT * FROM __dbt__cte__staging_shopify__orders
)

, products AS (
    SELECT * FROM __dbt__cte__staging_shopify__products
)

, source AS (
    SELECT
        c.CUSTOMER_ID
        , c.FIRST_NAME
        , c.LAST_NAME
        , c.EMAIL
        , c.JOIN_DATE
        , c.COUNTRY
        , COUNT(o.ORDER_ID) AS total_orders
        , SUM(o.QUANTITY * p.PRICE) AS total_spent
    FROM customers c
    LEFT JOIN orders o ON c.CUSTOMER_ID = o.CUSTOMER_ID
    LEFT JOIN products p ON o.PRODUCT_ID = p.PRODUCT_ID
    WHERE o.STATUS NOT IN ('cancelled')
    GROUP BY c.CUSTOMER_ID, c.FIRST_NAME, c.LAST_NAME, c.EMAIL, c.JOIN_DATE, c.COUNTRY
)

, final AS (
SELECT
    s.CUSTOMER_ID
    , s.FIRST_NAME
    , s.LAST_NAME
    , s.EMAIL
    , s.JOIN_DATE
    , s.COUNTRY
    , s.total_orders
    , s.total_spent
    , CASE WHEN s.total_spent > 1000 THEN 'VIP' ELSE 'Regular' END AS customer_segment 
FROM source s
)

SELECT * FROM final
        );
[0m18:27:54.833535 [debug] [Thread-8  ]: Writing runtime sql for node "model.billy_bulky.int_sales_trends"
[0m18:27:54.835364 [debug] [Thread-6  ]: Writing runtime sql for node "model.billy_bulky.int_customers_segmentation"
[0m18:27:54.836877 [debug] [Thread-7  ]: Using snowflake connection "model.billy_bulky.int_products_performance"
[0m18:27:54.837199 [debug] [Thread-5  ]: Opening a new connection, currently in state init
[0m18:27:54.838208 [debug] [Thread-9  ]: Using snowflake connection "model.billy_bulky.products"
[0m18:27:54.839617 [debug] [Thread-10 ]: Using snowflake connection "model.billy_bulky.sales"
[0m18:27:54.840003 [debug] [Thread-7  ]: On model.billy_bulky.int_products_performance: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.int_products_performance"} */
create or replace transient table E_COMMERCE.intermediate.int_products_performance
         as
        (WITH  __dbt__cte__staging_shopify__orders as (
WITH orders AS (
    SELECT * FROM SHOPIFY.PUBLIC.orders
)

SELECT
    ORDER_ID
    , CUSTOMER_ID
    , PRODUCT_ID
    , QUANTITY
    , ORDER_DATE
    , STATUS
FROM orders
),  __dbt__cte__staging_shopify__products as (
WITH products AS (
    SELECT * FROM SHOPIFY.PUBLIC.products
)

SELECT
    PRODUCT_ID
    , NAME
    , CATEGORY
    , PRICE
    , STOCK_LEVEL
FROM products
), orders AS (
    SELECT * FROM __dbt__cte__staging_shopify__orders
)

, products AS (
    SELECT * FROM __dbt__cte__staging_shopify__products
)

, product_sales AS (
    SELECT
        o.PRODUCT_ID
        , COUNT(DISTINCT o.ORDER_ID) AS total_sales
        , SUM(o.QUANTITY) AS total_units_sold
        , SUM(o.QUANTITY * p.PRICE) AS total_sales_value
    FROM orders o
    INNER JOIN products p ON o.PRODUCT_ID = p.PRODUCT_ID
    WHERE o.STATUS NOT IN ('cancelled') 
    GROUP BY o.PRODUCT_ID
)

, product_averages AS (
    SELECT
        PRODUCT_ID
        , (total_sales_value / NULLIF(total_units_sold, 0)) AS average_sale_price
    FROM product_sales
)

, product_stock_turnover AS (
    SELECT
        p.PRODUCT_ID
        , p.STOCK_LEVEL
        , (total_units_sold / NULLIF(p.STOCK_LEVEL, 0)) AS turnover_rate
    FROM product_sales ps
    INNER JOIN products p ON ps.PRODUCT_ID = p.PRODUCT_ID
)

, final AS (
    SELECT
    p.PRODUCT_ID
    , p.NAME
    , p.CATEGORY
    , p.PRICE
    , pa.average_sale_price
    , ps.total_sales
    , ps.total_units_sold
    , ps.total_sales_value
    , pst.turnover_rate
    , p.STOCK_LEVEL
FROM products p
LEFT JOIN product_sales ps ON p.PRODUCT_ID = ps.PRODUCT_ID
LEFT JOIN product_averages pa ON p.PRODUCT_ID = pa.PRODUCT_ID
LEFT JOIN product_stock_turnover pst ON p.PRODUCT_ID = pst.PRODUCT_ID
)

SELECT * FROM final
        );
[0m18:27:54.840589 [debug] [Thread-9  ]: On model.billy_bulky.products: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.products"} */
create or replace transient table E_COMMERCE.marts.products
         as
        (WITH  __dbt__cte__staging_shopify__orders as (
WITH orders AS (
    SELECT * FROM SHOPIFY.PUBLIC.orders
)

SELECT
    ORDER_ID
    , CUSTOMER_ID
    , PRODUCT_ID
    , QUANTITY
    , ORDER_DATE
    , STATUS
FROM orders
),  __dbt__cte__staging_shopify__products as (
WITH products AS (
    SELECT * FROM SHOPIFY.PUBLIC.products
)

SELECT
    PRODUCT_ID
    , NAME
    , CATEGORY
    , PRICE
    , STOCK_LEVEL
FROM products
), orders AS (
    SELECT * FROM __dbt__cte__staging_shopify__orders
)

, products AS (
    SELECT * FROM __dbt__cte__staging_shopify__products
)


, product_sales AS (
    SELECT
        PRODUCT_ID
        , SUM(QUANTITY) AS total_units_sold
        , SUM(QUANTITY * PRICE) AS total_sales_value
    FROM orders
    WHERE STATUS NOT IN ('cancelled')
    GROUP BY PRODUCT_ID
)

SELECT
    p.PRODUCT_ID
    , p.NAME
    , p.CATEGORY
    , p.PRICE
    , COALESCE(ps.total_units_sold, 0) AS total_units_sold
    , COALESCE(ps.total_sales_value, 0) AS total_sales_value
FROM products p
LEFT JOIN product_sales ps ON p.PRODUCT_ID = ps.PRODUCT_ID
        );
[0m18:27:54.842679 [debug] [Thread-8  ]: Using snowflake connection "model.billy_bulky.int_sales_trends"
[0m18:27:54.844612 [debug] [Thread-6  ]: Using snowflake connection "model.billy_bulky.int_customers_segmentation"
[0m18:27:54.844886 [debug] [Thread-10 ]: On model.billy_bulky.sales: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.sales"} */
create or replace transient table E_COMMERCE.marts.sales
         as
        (WITH  __dbt__cte__staging_shopify__customers as (
WITH customers AS (
    SELECT * FROM SHOPIFY.PUBLIC.customers
)

SELECT
    CUSTOMER_ID
    , FIRST_NAME
    , LAST_NAME
    , EMAIL
    , JOIN_DATE
    , COUNTRY
FROM customers
),  __dbt__cte__staging_shopify__orders as (
WITH orders AS (
    SELECT * FROM SHOPIFY.PUBLIC.orders
)

SELECT
    ORDER_ID
    , CUSTOMER_ID
    , PRODUCT_ID
    , QUANTITY
    , ORDER_DATE
    , STATUS
FROM orders
),  __dbt__cte__staging_shopify__products as (
WITH products AS (
    SELECT * FROM SHOPIFY.PUBLIC.products
)

SELECT
    PRODUCT_ID
    , NAME
    , CATEGORY
    , PRICE
    , STOCK_LEVEL
FROM products
), customers AS (
    SELECT * FROM __dbt__cte__staging_shopify__customers
)

, orders AS (
    SELECT * FROM __dbt__cte__staging_shopify__orders
)

, products AS (
    SELECT * FROM __dbt__cte__staging_shopify__products
)



, enriched_orders AS (
    SELECT
        o.ORDER_ID
        , o.CUSTOMER_ID
        , o.PRODUCT_ID
        , o.QUANTITY
        , o.ORDER_DATE
        , o.STATUS
        , p.CATEGORY
        , p.PRICE AS unit_price
        , (o.QUANTITY * p.PRICE) AS total_price
        , c.COUNTRY
    FROM orders o
    JOIN products p ON o.PRODUCT_ID = p.PRODUCT_ID
    JOIN customers c ON o.CUSTOMER_ID = c.CUSTOMER_ID
    WHERE o.STATUS NOT IN ('cancelled') 
)

, final AS (
SELECT
    e.ORDER_ID
    , e.CUSTOMER_ID
    , e.PRODUCT_ID
    , e.QUANTITY
    , e.ORDER_DATE
    , e.STATUS
    , e.CATEGORY
    , e.unit_price
    , e.total_price
    , e.COUNTRY
FROM enriched_orders e
)

SELECT * FROM final
        );
[0m18:27:54.845440 [debug] [Thread-7  ]: Opening a new connection, currently in state init
[0m18:27:54.845701 [debug] [Thread-9  ]: Opening a new connection, currently in state init
[0m18:27:54.846045 [debug] [Thread-8  ]: On model.billy_bulky.int_sales_trends: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.int_sales_trends"} */
create or replace transient table E_COMMERCE.intermediate.int_sales_trends
         as
        (WITH  __dbt__cte__staging_shopify__orders as (
WITH orders AS (
    SELECT * FROM SHOPIFY.PUBLIC.orders
)

SELECT
    ORDER_ID
    , CUSTOMER_ID
    , PRODUCT_ID
    , QUANTITY
    , ORDER_DATE
    , STATUS
FROM orders
),  __dbt__cte__staging_shopify__products as (
WITH products AS (
    SELECT * FROM SHOPIFY.PUBLIC.products
)

SELECT
    PRODUCT_ID
    , NAME
    , CATEGORY
    , PRICE
    , STOCK_LEVEL
FROM products
), orders AS (
    SELECT * FROM __dbt__cte__staging_shopify__orders
)

, products AS (
    SELECT * FROM __dbt__cte__staging_shopify__products
)

, daily_sales AS (
    SELECT
        DATE(ORDER_DATE) AS sale_date
        , COUNT(DISTINCT ORDER_ID) AS total_orders
        , SUM(QUANTITY) AS total_units_sold
        , SUM(QUANTITY * PRICE) AS total_sales_value
    FROM orders AS o
    JOIN products AS p ON o.PRODUCT_ID = p.PRODUCT_ID
    WHERE o.STATUS NOT IN ('cancelled') 
    GROUP BY sale_date
)

, weekly_sales AS (
    SELECT
        DATE_TRUNC('week', sale_date) AS sale_week
        , SUM(total_orders) AS weekly_orders
        , SUM(total_units_sold) AS weekly_units_sold
        , SUM(total_sales_value) AS weekly_sales_value
    FROM daily_sales
    GROUP BY sale_week
)

, monthly_sales AS (
    SELECT
        DATE_TRUNC('month', sale_date) AS sale_month
        , SUM(total_orders) AS monthly_orders
        , SUM(total_units_sold) AS monthly_units_sold
        , SUM(total_sales_value) AS monthly_sales_value
    FROM daily_sales
    GROUP BY sale_month
)

, yearly_sales AS (
    SELECT
        DATE_TRUNC('year', sale_date) AS sale_year
        , SUM(total_orders) AS yearly_orders
        , SUM(total_units_sold) AS yearly_units_sold
        , SUM(total_sales_value) AS yearly_sales_value
    FROM daily_sales
    GROUP BY sale_year
)

SELECT
    d.sale_date
    , d.total_orders AS daily_orders
    , d.total_units_sold AS daily_units_sold
    , d.total_sales_value AS daily_sales_value
    , w.weekly_orders
    , w.weekly_units_sold
    , w.weekly_sales_value
    , m.monthly_orders
    , m.monthly_units_sold
    , m.monthly_sales_value
    , y.yearly_orders
    , y.yearly_units_sold
    , y.yearly_sales_value
FROM daily_sales d
LEFT JOIN weekly_sales w ON DATE_TRUNC('week', d.sale_date) = w.sale_week
LEFT JOIN monthly_sales m ON DATE_TRUNC('month', d.sale_date) = m.sale_month
LEFT JOIN yearly_sales y ON DATE_TRUNC('year', d.sale_date) = y.sale_year
        );
[0m18:27:54.846469 [debug] [Thread-6  ]: On model.billy_bulky.int_customers_segmentation: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.int_customers_segmentation"} */
create or replace transient table E_COMMERCE.intermediate.int_customers_segmentation
         as
        (WITH  __dbt__cte__staging_shopify__customers as (
WITH customers AS (
    SELECT * FROM SHOPIFY.PUBLIC.customers
)

SELECT
    CUSTOMER_ID
    , FIRST_NAME
    , LAST_NAME
    , EMAIL
    , JOIN_DATE
    , COUNTRY
FROM customers
),  __dbt__cte__staging_shopify__orders as (
WITH orders AS (
    SELECT * FROM SHOPIFY.PUBLIC.orders
)

SELECT
    ORDER_ID
    , CUSTOMER_ID
    , PRODUCT_ID
    , QUANTITY
    , ORDER_DATE
    , STATUS
FROM orders
),  __dbt__cte__staging_shopify__products as (
WITH products AS (
    SELECT * FROM SHOPIFY.PUBLIC.products
)

SELECT
    PRODUCT_ID
    , NAME
    , CATEGORY
    , PRICE
    , STOCK_LEVEL
FROM products
), customers AS (
    SELECT * FROM __dbt__cte__staging_shopify__customers
)

, orders AS (
    SELECT * FROM __dbt__cte__staging_shopify__orders
)

, products AS (
    SELECT * FROM __dbt__cte__staging_shopify__products
)

, order_aggregates AS (
    SELECT
        o.CUSTOMER_ID
        , COUNT(DISTINCT o.ORDER_ID) AS frequency
        , SUM(o.QUANTITY * p.PRICE) AS monetary
        , AVG(o.QUANTITY * p.PRICE) AS average_order_value
        , MAX(o.ORDER_DATE) AS last_purchase_date
        , COUNT(CASE WHEN o.STATUS = 'cancelled' THEN 1 END) AS cancelled_orders
        , COUNT(*) AS total_orders
    FROM orders o
    JOIN products p ON o.PRODUCT_ID = p.PRODUCT_ID
    GROUP BY o.CUSTOMER_ID
)

, customer_tenure AS (
    SELECT
        CUSTOMER_ID
        , JOIN_DATE
        , CURRENT_DATE - JOIN_DATE AS tenure
    FROM customers
)

, customer_recency AS (
    SELECT
        CUSTOMER_ID
        , CURRENT_DATE - last_purchase_date AS recency
    FROM order_aggregates
)

, final AS (
    SELECT
        c.CUSTOMER_ID
        , c.FIRST_NAME
        , c.LAST_NAME
        , c.EMAIL
        , c.JOIN_DATE
        , c.COUNTRY
        , o.frequency
        , o.monetary
        , o.average_order_value
        , o.cancelled_orders
        , o.total_orders
        , CASE 
            WHEN o.total_orders > 0 THEN ROUND((o.cancelled_orders::FLOAT / o.total_orders) * 100, 2) 
            ELSE 0 
          END AS cancellation_rate
        , r.recency
        , t.tenure
    FROM customer_tenure t
    JOIN customers c ON t.CUSTOMER_ID = c.CUSTOMER_ID
    JOIN order_aggregates o ON c.CUSTOMER_ID = o.CUSTOMER_ID
    JOIN customer_recency r ON c.CUSTOMER_ID = r.CUSTOMER_ID
)

SELECT * FROM final
        );
[0m18:27:54.846855 [debug] [Thread-10 ]: Opening a new connection, currently in state init
[0m18:27:54.848201 [debug] [Thread-8  ]: Opening a new connection, currently in state init
[0m18:27:54.848711 [debug] [Thread-6  ]: Opening a new connection, currently in state init
[0m18:27:56.741008 [debug] [Thread-9  ]: Snowflake adapter: Snowflake query id: 01b075b7-0001-8349-0004-d8be000152ce
[0m18:27:56.741578 [debug] [Thread-9  ]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 41 at position 25
invalid identifier 'PRICE'
[0m18:27:56.742144 [debug] [Thread-9  ]: Timing info for model.billy_bulky.products (execute): 18:27:54.827335 => 18:27:56.741926
[0m18:27:56.742519 [debug] [Thread-9  ]: On model.billy_bulky.products: Close
[0m18:27:57.066965 [debug] [Thread-10 ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m18:27:57.098605 [debug] [Thread-10 ]: Timing info for model.billy_bulky.sales (execute): 18:27:54.829937 => 18:27:57.098305
[0m18:27:57.099183 [debug] [Thread-10 ]: On model.billy_bulky.sales: Close
[0m18:27:57.209271 [debug] [Thread-9  ]: Database Error in model products (models/marts/products.sql)
  000904 (42000): SQL compilation error: error line 41 at position 25
  invalid identifier 'PRICE'
  compiled Code at target/run/billy_bulky/models/marts/products.sql
[0m18:27:57.210061 [debug] [Thread-9  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '913cbe99-5b8b-4081-b2d1-c6cfd3e7c693', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1376725b0>]}
[0m18:27:57.210949 [error] [Thread-9  ]: 5 of 6 ERROR creating sql table model marts.products ........................... [[31mERROR[0m in 2.47s]
[0m18:27:57.211822 [debug] [Thread-9  ]: Finished running node model.billy_bulky.products
[0m18:27:57.499116 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '913cbe99-5b8b-4081-b2d1-c6cfd3e7c693', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13762dd60>]}
[0m18:27:57.500720 [info ] [Thread-10 ]: 6 of 6 OK created sql table model marts.sales .................................. [[32mSUCCESS 1[0m in 2.76s]
[0m18:27:57.501967 [debug] [Thread-10 ]: Finished running node model.billy_bulky.sales
[0m18:27:57.557732 [debug] [Thread-5  ]: SQL status: SUCCESS 1 in 3.0 seconds
[0m18:27:57.560684 [debug] [Thread-5  ]: Timing info for model.billy_bulky.customers (execute): 18:27:54.803302 => 18:27:57.560450
[0m18:27:57.561133 [debug] [Thread-5  ]: On model.billy_bulky.customers: Close
[0m18:27:57.810720 [debug] [Thread-8  ]: SQL status: SUCCESS 1 in 3.0 seconds
[0m18:27:57.812357 [debug] [Thread-6  ]: SQL status: SUCCESS 1 in 3.0 seconds
[0m18:27:57.817715 [debug] [Thread-8  ]: Timing info for model.billy_bulky.int_sales_trends (execute): 18:27:54.832017 => 18:27:57.817290
[0m18:27:57.821824 [debug] [Thread-6  ]: Timing info for model.billy_bulky.int_customers_segmentation (execute): 18:27:54.833771 => 18:27:57.821461
[0m18:27:57.822547 [debug] [Thread-8  ]: On model.billy_bulky.int_sales_trends: Close
[0m18:27:57.823228 [debug] [Thread-6  ]: On model.billy_bulky.int_customers_segmentation: Close
[0m18:27:58.122209 [debug] [Thread-7  ]: SQL status: SUCCESS 1 in 3.0 seconds
[0m18:27:58.129916 [debug] [Thread-7  ]: Timing info for model.billy_bulky.int_products_performance (execute): 18:27:54.825237 => 18:27:58.129526
[0m18:27:58.131509 [debug] [Thread-7  ]: On model.billy_bulky.int_products_performance: Close
[0m18:27:58.135231 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '913cbe99-5b8b-4081-b2d1-c6cfd3e7c693', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137774df0>]}
[0m18:27:58.136665 [info ] [Thread-5  ]: 1 of 6 OK created sql table model marts.customers .............................. [[32mSUCCESS 1[0m in 3.40s]
[0m18:27:58.138606 [debug] [Thread-5  ]: Finished running node model.billy_bulky.customers
[0m18:27:58.328547 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '913cbe99-5b8b-4081-b2d1-c6cfd3e7c693', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137626670>]}
[0m18:27:58.330190 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '913cbe99-5b8b-4081-b2d1-c6cfd3e7c693', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1377e8fd0>]}
[0m18:27:58.331363 [info ] [Thread-8  ]: 4 of 6 OK created sql table model intermediate.int_sales_trends ................ [[32mSUCCESS 1[0m in 3.59s]
[0m18:27:58.333336 [debug] [Thread-8  ]: Finished running node model.billy_bulky.int_sales_trends
[0m18:27:58.332256 [info ] [Thread-6  ]: 2 of 6 OK created sql table model intermediate.int_customers_segmentation ...... [[32mSUCCESS 1[0m in 3.60s]
[0m18:27:58.334604 [debug] [Thread-6  ]: Finished running node model.billy_bulky.int_customers_segmentation
[0m18:27:58.577477 [debug] [Thread-7  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '913cbe99-5b8b-4081-b2d1-c6cfd3e7c693', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13762d070>]}
[0m18:27:58.578400 [info ] [Thread-7  ]: 3 of 6 OK created sql table model intermediate.int_products_performance ........ [[32mSUCCESS 1[0m in 3.84s]
[0m18:27:58.579154 [debug] [Thread-7  ]: Finished running node model.billy_bulky.int_products_performance
[0m18:27:58.581254 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:27:58.581679 [debug] [MainThread]: Connection 'model.billy_bulky.staging_shopify__customers' was properly closed.
[0m18:27:58.582037 [debug] [MainThread]: Connection 'model.billy_bulky.staging_shopify__orders' was properly closed.
[0m18:27:58.582380 [debug] [MainThread]: Connection 'model.billy_bulky.staging_shopify__products' was properly closed.
[0m18:27:58.582722 [debug] [MainThread]: Connection 'model.billy_bulky.customers' was properly closed.
[0m18:27:58.583057 [debug] [MainThread]: Connection 'model.billy_bulky.int_customers_segmentation' was properly closed.
[0m18:27:58.583393 [debug] [MainThread]: Connection 'model.billy_bulky.int_products_performance' was properly closed.
[0m18:27:58.583732 [debug] [MainThread]: Connection 'model.billy_bulky.int_sales_trends' was properly closed.
[0m18:27:58.584061 [debug] [MainThread]: Connection 'model.billy_bulky.products' was properly closed.
[0m18:27:58.584389 [debug] [MainThread]: Connection 'model.billy_bulky.sales' was properly closed.
[0m18:27:58.584781 [info ] [MainThread]: 
[0m18:27:58.585145 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 7.97 seconds (7.97s).
[0m18:27:58.586502 [debug] [MainThread]: Command end result
[0m18:27:58.600779 [info ] [MainThread]: 
[0m18:27:58.601209 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:27:58.601526 [info ] [MainThread]: 
[0m18:27:58.601833 [error] [MainThread]:   Database Error in model products (models/marts/products.sql)
  000904 (42000): SQL compilation error: error line 41 at position 25
  invalid identifier 'PRICE'
  compiled Code at target/run/billy_bulky/models/marts/products.sql
[0m18:27:58.602147 [info ] [MainThread]: 
[0m18:27:58.602461 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m18:27:58.604862 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 9.24828, "process_user_time": 5.246887, "process_kernel_time": 0.362262, "process_mem_max_rss": "227065856", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:27:58.605423 [debug] [MainThread]: Command `dbt run` failed at 18:27:58.605308 after 9.25 seconds
[0m18:27:58.605780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070a5eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13452a9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13442c250>]}
[0m18:27:58.606154 [debug] [MainThread]: Flushing usage events
[0m18:32:40.845273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073e0250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112bd52b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112bd5850>]}


============================== 18:32:40.848841 | f14a3539-293c-461a-8056-c0cd1692a237 ==============================
[0m18:32:40.848841 [info ] [MainThread]: Running with dbt=1.7.1
[0m18:32:40.849216 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/bitlevi/Documents/billy_bulky_ecommerce/logs', 'version_check': 'True', 'profiles_dir': '/Users/bitlevi/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:32:41.698493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f14a3539-293c-461a-8056-c0cd1692a237', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112bb8fa0>]}
[0m18:32:41.746150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f14a3539-293c-461a-8056-c0cd1692a237', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137f6cca0>]}
[0m18:32:41.746839 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m18:32:41.760238 [debug] [MainThread]: checksum: ad428e6dc3b353dcb23d0c4ebea8b20b180e94b873271ac2a054a8e446dac0e2, vars: {}, profile: , target: , version: 1.7.1
[0m18:32:41.797098 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:32:41.797766 [debug] [MainThread]: Partial parsing: updated file: billy_bulky://models/marts/products.sql
[0m18:32:41.881876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f14a3539-293c-461a-8056-c0cd1692a237', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1456280d0>]}
[0m18:32:41.892732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f14a3539-293c-461a-8056-c0cd1692a237', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144a5a8b0>]}
[0m18:32:41.893065 [info ] [MainThread]: Found 9 models, 20 tests, 3 sources, 0 exposures, 0 metrics, 431 macros, 0 groups, 0 semantic models
[0m18:32:41.893302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f14a3539-293c-461a-8056-c0cd1692a237', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144a5a8e0>]}
[0m18:32:41.894544 [info ] [MainThread]: 
[0m18:32:41.895046 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:32:41.895872 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE'
[0m18:32:41.904492 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE"
[0m18:32:41.905026 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE'
[0m18:32:41.905246 [debug] [ThreadPool]: On list_E_COMMERCE: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE"} */
show terse schemas in database E_COMMERCE
    limit 10000
[0m18:32:41.906877 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE"
[0m18:32:41.907200 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:32:41.907406 [debug] [ThreadPool]: On list_E_COMMERCE: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE"} */
show terse schemas in database E_COMMERCE
    limit 10000
[0m18:32:41.908511 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:32:43.430544 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.0 seconds
[0m18:32:43.433795 [debug] [ThreadPool]: On list_E_COMMERCE: Close
[0m18:32:43.437693 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.0 seconds
[0m18:32:43.440184 [debug] [ThreadPool]: On list_E_COMMERCE: Close
[0m18:32:43.831542 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_E_COMMERCE, now list_E_COMMERCE_intermediate)
[0m18:32:43.834251 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_E_COMMERCE, now list_E_COMMERCE_marts)
[0m18:32:43.854184 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_marts"
[0m18:32:43.856795 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_intermediate"
[0m18:32:43.857238 [debug] [ThreadPool]: On list_E_COMMERCE_marts: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE_marts"} */
show terse objects in E_COMMERCE.marts limit 10000
[0m18:32:43.857711 [debug] [ThreadPool]: On list_E_COMMERCE_intermediate: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE_intermediate"} */
show terse objects in E_COMMERCE.intermediate limit 10000
[0m18:32:43.858158 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:32:43.858538 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:32:45.255012 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m18:32:45.256648 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m18:32:45.259258 [debug] [ThreadPool]: On list_E_COMMERCE_marts: Close
[0m18:32:45.261579 [debug] [ThreadPool]: On list_E_COMMERCE_intermediate: Close
[0m18:32:45.775973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f14a3539-293c-461a-8056-c0cd1692a237', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144a5a460>]}
[0m18:32:45.777731 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m18:32:45.778417 [info ] [MainThread]: 
[0m18:32:45.783379 [debug] [Thread-1  ]: Began running node model.billy_bulky.staging_shopify__customers
[0m18:32:45.784276 [debug] [Thread-2  ]: Began running node model.billy_bulky.staging_shopify__orders
[0m18:32:45.786850 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_E_COMMERCE_intermediate, now model.billy_bulky.staging_shopify__customers)
[0m18:32:45.787969 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_E_COMMERCE_marts, now model.billy_bulky.staging_shopify__orders)
[0m18:32:45.789465 [debug] [Thread-3  ]: Began running node model.billy_bulky.staging_shopify__products
[0m18:32:45.790101 [debug] [Thread-1  ]: Began compiling node model.billy_bulky.staging_shopify__customers
[0m18:32:45.790718 [debug] [Thread-2  ]: Began compiling node model.billy_bulky.staging_shopify__orders
[0m18:32:45.791828 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.billy_bulky.staging_shopify__products'
[0m18:32:45.802791 [debug] [Thread-1  ]: Writing injected SQL for node "model.billy_bulky.staging_shopify__customers"
[0m18:32:45.806299 [debug] [Thread-2  ]: Writing injected SQL for node "model.billy_bulky.staging_shopify__orders"
[0m18:32:45.806821 [debug] [Thread-3  ]: Began compiling node model.billy_bulky.staging_shopify__products
[0m18:32:45.810389 [debug] [Thread-3  ]: Writing injected SQL for node "model.billy_bulky.staging_shopify__products"
[0m18:32:45.811705 [debug] [Thread-1  ]: Timing info for model.billy_bulky.staging_shopify__customers (compile): 18:32:45.792199 => 18:32:45.811410
[0m18:32:45.812233 [debug] [Thread-2  ]: Timing info for model.billy_bulky.staging_shopify__orders (compile): 18:32:45.803124 => 18:32:45.811989
[0m18:32:45.812676 [debug] [Thread-3  ]: Timing info for model.billy_bulky.staging_shopify__products (compile): 18:32:45.807244 => 18:32:45.812468
[0m18:32:45.813583 [debug] [Thread-1  ]: Finished running node model.billy_bulky.staging_shopify__customers
[0m18:32:45.814458 [debug] [Thread-2  ]: Finished running node model.billy_bulky.staging_shopify__orders
[0m18:32:45.815297 [debug] [Thread-3  ]: Finished running node model.billy_bulky.staging_shopify__products
[0m18:32:45.816213 [debug] [Thread-5  ]: Began running node model.billy_bulky.customers
[0m18:32:45.816737 [debug] [Thread-6  ]: Began running node model.billy_bulky.int_customers_segmentation
[0m18:32:45.817539 [debug] [Thread-7  ]: Began running node model.billy_bulky.int_products_performance
[0m18:32:45.817189 [info ] [Thread-5  ]: 1 of 6 START sql table model marts.customers ................................... [RUN]
[0m18:32:45.818050 [debug] [Thread-8  ]: Began running node model.billy_bulky.int_sales_trends
[0m18:32:45.818747 [debug] [Thread-9  ]: Began running node model.billy_bulky.products
[0m18:32:45.818451 [info ] [Thread-6  ]: 2 of 6 START sql table model intermediate.int_customers_segmentation ........... [RUN]
[0m18:32:45.819386 [debug] [Thread-10 ]: Began running node model.billy_bulky.sales
[0m18:32:45.819792 [info ] [Thread-7  ]: 3 of 6 START sql table model intermediate.int_products_performance ............. [RUN]
[0m18:32:45.820506 [debug] [Thread-5  ]: Acquiring new snowflake connection 'model.billy_bulky.customers'
[0m18:32:45.820936 [info ] [Thread-8  ]: 4 of 6 START sql table model intermediate.int_sales_trends ..................... [RUN]
[0m18:32:45.821364 [info ] [Thread-9  ]: 5 of 6 START sql table model marts.products .................................... [RUN]
[0m18:32:45.822027 [debug] [Thread-6  ]: Acquiring new snowflake connection 'model.billy_bulky.int_customers_segmentation'
[0m18:32:45.822416 [info ] [Thread-10 ]: 6 of 6 START sql table model marts.sales ....................................... [RUN]
[0m18:32:45.823070 [debug] [Thread-7  ]: Acquiring new snowflake connection 'model.billy_bulky.int_products_performance'
[0m18:32:45.823413 [debug] [Thread-5  ]: Began compiling node model.billy_bulky.customers
[0m18:32:45.824031 [debug] [Thread-8  ]: Acquiring new snowflake connection 'model.billy_bulky.int_sales_trends'
[0m18:32:45.824637 [debug] [Thread-9  ]: Acquiring new snowflake connection 'model.billy_bulky.products'
[0m18:32:45.824983 [debug] [Thread-6  ]: Began compiling node model.billy_bulky.int_customers_segmentation
[0m18:32:45.825593 [debug] [Thread-10 ]: Acquiring new snowflake connection 'model.billy_bulky.sales'
[0m18:32:45.825936 [debug] [Thread-7  ]: Began compiling node model.billy_bulky.int_products_performance
[0m18:32:45.838202 [debug] [Thread-5  ]: Writing injected SQL for node "model.billy_bulky.customers"
[0m18:32:45.838547 [debug] [Thread-8  ]: Began compiling node model.billy_bulky.int_sales_trends
[0m18:32:45.838844 [debug] [Thread-9  ]: Began compiling node model.billy_bulky.products
[0m18:32:45.851500 [debug] [Thread-10 ]: Began compiling node model.billy_bulky.sales
[0m18:32:45.854617 [debug] [Thread-6  ]: Writing injected SQL for node "model.billy_bulky.int_customers_segmentation"
[0m18:32:45.866455 [debug] [Thread-7  ]: Writing injected SQL for node "model.billy_bulky.int_products_performance"
[0m18:32:45.880166 [debug] [Thread-8  ]: Writing injected SQL for node "model.billy_bulky.int_sales_trends"
[0m18:32:45.885705 [debug] [Thread-5  ]: Timing info for model.billy_bulky.customers (compile): 18:32:45.826155 => 18:32:45.885536
[0m18:32:45.887024 [debug] [Thread-9  ]: Writing injected SQL for node "model.billy_bulky.products"
[0m18:32:45.894522 [debug] [Thread-10 ]: Writing injected SQL for node "model.billy_bulky.sales"
[0m18:32:45.895034 [debug] [Thread-5  ]: Began executing node model.billy_bulky.customers
[0m18:32:45.895414 [debug] [Thread-6  ]: Timing info for model.billy_bulky.int_customers_segmentation (compile): 18:32:45.839030 => 18:32:45.895274
[0m18:32:45.901687 [debug] [Thread-7  ]: Timing info for model.billy_bulky.int_products_performance (compile): 18:32:45.854801 => 18:32:45.901514
[0m18:32:45.908261 [debug] [Thread-6  ]: Began executing node model.billy_bulky.int_customers_segmentation
[0m18:32:45.914452 [debug] [Thread-5  ]: Writing runtime sql for node "model.billy_bulky.customers"
[0m18:32:45.914773 [debug] [Thread-9  ]: Timing info for model.billy_bulky.products (compile): 18:32:45.880356 => 18:32:45.914644
[0m18:32:45.915020 [debug] [Thread-8  ]: Timing info for model.billy_bulky.int_sales_trends (compile): 18:32:45.866701 => 18:32:45.914902
[0m18:32:45.915272 [debug] [Thread-10 ]: Timing info for model.billy_bulky.sales (compile): 18:32:45.887181 => 18:32:45.915142
[0m18:32:45.915495 [debug] [Thread-7  ]: Began executing node model.billy_bulky.int_products_performance
[0m18:32:45.917143 [debug] [Thread-6  ]: Writing runtime sql for node "model.billy_bulky.int_customers_segmentation"
[0m18:32:45.917430 [debug] [Thread-9  ]: Began executing node model.billy_bulky.products
[0m18:32:45.917682 [debug] [Thread-8  ]: Began executing node model.billy_bulky.int_sales_trends
[0m18:32:45.917913 [debug] [Thread-10 ]: Began executing node model.billy_bulky.sales
[0m18:32:45.919363 [debug] [Thread-5  ]: Using snowflake connection "model.billy_bulky.customers"
[0m18:32:45.920968 [debug] [Thread-7  ]: Writing runtime sql for node "model.billy_bulky.int_products_performance"
[0m18:32:45.922620 [debug] [Thread-9  ]: Writing runtime sql for node "model.billy_bulky.products"
[0m18:32:45.924260 [debug] [Thread-8  ]: Writing runtime sql for node "model.billy_bulky.int_sales_trends"
[0m18:32:45.925850 [debug] [Thread-10 ]: Writing runtime sql for node "model.billy_bulky.sales"
[0m18:32:45.926187 [debug] [Thread-5  ]: On model.billy_bulky.customers: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.customers"} */
create or replace transient table E_COMMERCE.marts.customers
         as
        (WITH  __dbt__cte__staging_shopify__customers as (
WITH customers AS (
    SELECT * FROM SHOPIFY.PUBLIC.customers
)

SELECT
    CUSTOMER_ID
    , FIRST_NAME
    , LAST_NAME
    , EMAIL
    , JOIN_DATE
    , COUNTRY
FROM customers
),  __dbt__cte__staging_shopify__orders as (
WITH orders AS (
    SELECT * FROM SHOPIFY.PUBLIC.orders
)

SELECT
    ORDER_ID
    , CUSTOMER_ID
    , PRODUCT_ID
    , QUANTITY
    , ORDER_DATE
    , STATUS
FROM orders
),  __dbt__cte__staging_shopify__products as (
WITH products AS (
    SELECT * FROM SHOPIFY.PUBLIC.products
)

SELECT
    PRODUCT_ID
    , NAME
    , CATEGORY
    , PRICE
    , STOCK_LEVEL
FROM products
), customers AS (
    SELECT * FROM __dbt__cte__staging_shopify__customers
)

, orders AS (
    SELECT * FROM __dbt__cte__staging_shopify__orders
)

, products AS (
    SELECT * FROM __dbt__cte__staging_shopify__products
)

, source AS (
    SELECT
        c.CUSTOMER_ID
        , c.FIRST_NAME
        , c.LAST_NAME
        , c.EMAIL
        , c.JOIN_DATE
        , c.COUNTRY
        , COUNT(o.ORDER_ID) AS total_orders
        , SUM(o.QUANTITY * p.PRICE) AS total_spent
    FROM customers c
    LEFT JOIN orders o ON c.CUSTOMER_ID = o.CUSTOMER_ID
    LEFT JOIN products p ON o.PRODUCT_ID = p.PRODUCT_ID
    WHERE o.STATUS NOT IN ('cancelled')
    GROUP BY c.CUSTOMER_ID, c.FIRST_NAME, c.LAST_NAME, c.EMAIL, c.JOIN_DATE, c.COUNTRY
)

, final AS (
SELECT
    s.CUSTOMER_ID
    , s.FIRST_NAME
    , s.LAST_NAME
    , s.EMAIL
    , s.JOIN_DATE
    , s.COUNTRY
    , s.total_orders
    , s.total_spent
    , CASE WHEN s.total_spent > 1000 THEN 'VIP' ELSE 'Regular' END AS customer_segment 
FROM source s
)

SELECT * FROM final
        );
[0m18:32:45.928058 [debug] [Thread-6  ]: Using snowflake connection "model.billy_bulky.int_customers_segmentation"
[0m18:32:45.928479 [debug] [Thread-5  ]: Opening a new connection, currently in state init
[0m18:32:45.928833 [debug] [Thread-6  ]: On model.billy_bulky.int_customers_segmentation: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.int_customers_segmentation"} */
create or replace transient table E_COMMERCE.intermediate.int_customers_segmentation
         as
        (WITH  __dbt__cte__staging_shopify__customers as (
WITH customers AS (
    SELECT * FROM SHOPIFY.PUBLIC.customers
)

SELECT
    CUSTOMER_ID
    , FIRST_NAME
    , LAST_NAME
    , EMAIL
    , JOIN_DATE
    , COUNTRY
FROM customers
),  __dbt__cte__staging_shopify__orders as (
WITH orders AS (
    SELECT * FROM SHOPIFY.PUBLIC.orders
)

SELECT
    ORDER_ID
    , CUSTOMER_ID
    , PRODUCT_ID
    , QUANTITY
    , ORDER_DATE
    , STATUS
FROM orders
),  __dbt__cte__staging_shopify__products as (
WITH products AS (
    SELECT * FROM SHOPIFY.PUBLIC.products
)

SELECT
    PRODUCT_ID
    , NAME
    , CATEGORY
    , PRICE
    , STOCK_LEVEL
FROM products
), customers AS (
    SELECT * FROM __dbt__cte__staging_shopify__customers
)

, orders AS (
    SELECT * FROM __dbt__cte__staging_shopify__orders
)

, products AS (
    SELECT * FROM __dbt__cte__staging_shopify__products
)

, order_aggregates AS (
    SELECT
        o.CUSTOMER_ID
        , COUNT(DISTINCT o.ORDER_ID) AS frequency
        , SUM(o.QUANTITY * p.PRICE) AS monetary
        , AVG(o.QUANTITY * p.PRICE) AS average_order_value
        , MAX(o.ORDER_DATE) AS last_purchase_date
        , COUNT(CASE WHEN o.STATUS = 'cancelled' THEN 1 END) AS cancelled_orders
        , COUNT(*) AS total_orders
    FROM orders o
    JOIN products p ON o.PRODUCT_ID = p.PRODUCT_ID
    GROUP BY o.CUSTOMER_ID
)

, customer_tenure AS (
    SELECT
        CUSTOMER_ID
        , JOIN_DATE
        , CURRENT_DATE - JOIN_DATE AS tenure
    FROM customers
)

, customer_recency AS (
    SELECT
        CUSTOMER_ID
        , CURRENT_DATE - last_purchase_date AS recency
    FROM order_aggregates
)

, final AS (
    SELECT
        c.CUSTOMER_ID
        , c.FIRST_NAME
        , c.LAST_NAME
        , c.EMAIL
        , c.JOIN_DATE
        , c.COUNTRY
        , o.frequency
        , o.monetary
        , o.average_order_value
        , o.cancelled_orders
        , o.total_orders
        , CASE 
            WHEN o.total_orders > 0 THEN ROUND((o.cancelled_orders::FLOAT / o.total_orders) * 100, 2) 
            ELSE 0 
          END AS cancellation_rate
        , r.recency
        , t.tenure
    FROM customer_tenure t
    JOIN customers c ON t.CUSTOMER_ID = c.CUSTOMER_ID
    JOIN order_aggregates o ON c.CUSTOMER_ID = o.CUSTOMER_ID
    JOIN customer_recency r ON c.CUSTOMER_ID = r.CUSTOMER_ID
)

SELECT * FROM final
        );
[0m18:32:45.929994 [debug] [Thread-9  ]: Using snowflake connection "model.billy_bulky.products"
[0m18:32:45.931441 [debug] [Thread-7  ]: Using snowflake connection "model.billy_bulky.int_products_performance"
[0m18:32:45.931891 [debug] [Thread-6  ]: Opening a new connection, currently in state init
[0m18:32:45.933428 [debug] [Thread-10 ]: Using snowflake connection "model.billy_bulky.sales"
[0m18:32:45.933703 [debug] [Thread-9  ]: On model.billy_bulky.products: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.products"} */
create or replace transient table E_COMMERCE.marts.products
         as
        (WITH  __dbt__cte__staging_shopify__orders as (
WITH orders AS (
    SELECT * FROM SHOPIFY.PUBLIC.orders
)

SELECT
    ORDER_ID
    , CUSTOMER_ID
    , PRODUCT_ID
    , QUANTITY
    , ORDER_DATE
    , STATUS
FROM orders
),  __dbt__cte__staging_shopify__products as (
WITH products AS (
    SELECT * FROM SHOPIFY.PUBLIC.products
)

SELECT
    PRODUCT_ID
    , NAME
    , CATEGORY
    , PRICE
    , STOCK_LEVEL
FROM products
), orders AS (
    SELECT * FROM __dbt__cte__staging_shopify__orders
)

, products AS (
    SELECT * FROM __dbt__cte__staging_shopify__products
)


, product_sales AS (
    SELECT
        o.PRODUCT_ID
        , SUM(o.QUANTITY) AS total_units_sold
        , SUM(o.QUANTITY * p.PRICE) AS total_sales_value
    FROM orders o
    JOIN products p ON o.PRODUCT_ID = p.PRODUCT_ID
    WHERE o.STATUS NOT IN ('cancelled')
    GROUP BY o.PRODUCT_ID
)

, final AS (
    SELECT
    p.PRODUCT_ID
    , p.NAME
    , p.CATEGORY
    , p.PRICE
    , COALESCE(ps.total_units_sold, 0) AS total_units_sold
    , COALESCE(ps.total_sales_value, 0) AS total_sales_value
FROM products p
LEFT JOIN product_sales ps ON p.PRODUCT_ID = ps.PRODUCT_ID)

SELECT * FROM final
        );
[0m18:32:45.935616 [debug] [Thread-8  ]: Using snowflake connection "model.billy_bulky.int_sales_trends"
[0m18:32:45.935927 [debug] [Thread-7  ]: On model.billy_bulky.int_products_performance: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.int_products_performance"} */
create or replace transient table E_COMMERCE.intermediate.int_products_performance
         as
        (WITH  __dbt__cte__staging_shopify__orders as (
WITH orders AS (
    SELECT * FROM SHOPIFY.PUBLIC.orders
)

SELECT
    ORDER_ID
    , CUSTOMER_ID
    , PRODUCT_ID
    , QUANTITY
    , ORDER_DATE
    , STATUS
FROM orders
),  __dbt__cte__staging_shopify__products as (
WITH products AS (
    SELECT * FROM SHOPIFY.PUBLIC.products
)

SELECT
    PRODUCT_ID
    , NAME
    , CATEGORY
    , PRICE
    , STOCK_LEVEL
FROM products
), orders AS (
    SELECT * FROM __dbt__cte__staging_shopify__orders
)

, products AS (
    SELECT * FROM __dbt__cte__staging_shopify__products
)

, product_sales AS (
    SELECT
        o.PRODUCT_ID
        , COUNT(DISTINCT o.ORDER_ID) AS total_sales
        , SUM(o.QUANTITY) AS total_units_sold
        , SUM(o.QUANTITY * p.PRICE) AS total_sales_value
    FROM orders o
    INNER JOIN products p ON o.PRODUCT_ID = p.PRODUCT_ID
    WHERE o.STATUS NOT IN ('cancelled') 
    GROUP BY o.PRODUCT_ID
)

, product_averages AS (
    SELECT
        PRODUCT_ID
        , (total_sales_value / NULLIF(total_units_sold, 0)) AS average_sale_price
    FROM product_sales
)

, product_stock_turnover AS (
    SELECT
        p.PRODUCT_ID
        , p.STOCK_LEVEL
        , (total_units_sold / NULLIF(p.STOCK_LEVEL, 0)) AS turnover_rate
    FROM product_sales ps
    INNER JOIN products p ON ps.PRODUCT_ID = p.PRODUCT_ID
)

, final AS (
    SELECT
    p.PRODUCT_ID
    , p.NAME
    , p.CATEGORY
    , p.PRICE
    , pa.average_sale_price
    , ps.total_sales
    , ps.total_units_sold
    , ps.total_sales_value
    , pst.turnover_rate
    , p.STOCK_LEVEL
FROM products p
LEFT JOIN product_sales ps ON p.PRODUCT_ID = ps.PRODUCT_ID
LEFT JOIN product_averages pa ON p.PRODUCT_ID = pa.PRODUCT_ID
LEFT JOIN product_stock_turnover pst ON p.PRODUCT_ID = pst.PRODUCT_ID
)

SELECT * FROM final
        );
[0m18:32:45.936892 [debug] [Thread-10 ]: On model.billy_bulky.sales: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.sales"} */
create or replace transient table E_COMMERCE.marts.sales
         as
        (WITH  __dbt__cte__staging_shopify__customers as (
WITH customers AS (
    SELECT * FROM SHOPIFY.PUBLIC.customers
)

SELECT
    CUSTOMER_ID
    , FIRST_NAME
    , LAST_NAME
    , EMAIL
    , JOIN_DATE
    , COUNTRY
FROM customers
),  __dbt__cte__staging_shopify__orders as (
WITH orders AS (
    SELECT * FROM SHOPIFY.PUBLIC.orders
)

SELECT
    ORDER_ID
    , CUSTOMER_ID
    , PRODUCT_ID
    , QUANTITY
    , ORDER_DATE
    , STATUS
FROM orders
),  __dbt__cte__staging_shopify__products as (
WITH products AS (
    SELECT * FROM SHOPIFY.PUBLIC.products
)

SELECT
    PRODUCT_ID
    , NAME
    , CATEGORY
    , PRICE
    , STOCK_LEVEL
FROM products
), customers AS (
    SELECT * FROM __dbt__cte__staging_shopify__customers
)

, orders AS (
    SELECT * FROM __dbt__cte__staging_shopify__orders
)

, products AS (
    SELECT * FROM __dbt__cte__staging_shopify__products
)



, enriched_orders AS (
    SELECT
        o.ORDER_ID
        , o.CUSTOMER_ID
        , o.PRODUCT_ID
        , o.QUANTITY
        , o.ORDER_DATE
        , o.STATUS
        , p.CATEGORY
        , p.PRICE AS unit_price
        , (o.QUANTITY * p.PRICE) AS total_price
        , c.COUNTRY
    FROM orders o
    JOIN products p ON o.PRODUCT_ID = p.PRODUCT_ID
    JOIN customers c ON o.CUSTOMER_ID = c.CUSTOMER_ID
    WHERE o.STATUS NOT IN ('cancelled') 
)

, final AS (
SELECT
    e.ORDER_ID
    , e.CUSTOMER_ID
    , e.PRODUCT_ID
    , e.QUANTITY
    , e.ORDER_DATE
    , e.STATUS
    , e.CATEGORY
    , e.unit_price
    , e.total_price
    , e.COUNTRY
FROM enriched_orders e
)

SELECT * FROM final
        );
[0m18:32:45.937202 [debug] [Thread-9  ]: Opening a new connection, currently in state init
[0m18:32:45.937742 [debug] [Thread-8  ]: On model.billy_bulky.int_sales_trends: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.int_sales_trends"} */
create or replace transient table E_COMMERCE.intermediate.int_sales_trends
         as
        (WITH  __dbt__cte__staging_shopify__orders as (
WITH orders AS (
    SELECT * FROM SHOPIFY.PUBLIC.orders
)

SELECT
    ORDER_ID
    , CUSTOMER_ID
    , PRODUCT_ID
    , QUANTITY
    , ORDER_DATE
    , STATUS
FROM orders
),  __dbt__cte__staging_shopify__products as (
WITH products AS (
    SELECT * FROM SHOPIFY.PUBLIC.products
)

SELECT
    PRODUCT_ID
    , NAME
    , CATEGORY
    , PRICE
    , STOCK_LEVEL
FROM products
), orders AS (
    SELECT * FROM __dbt__cte__staging_shopify__orders
)

, products AS (
    SELECT * FROM __dbt__cte__staging_shopify__products
)

, daily_sales AS (
    SELECT
        DATE(ORDER_DATE) AS sale_date
        , COUNT(DISTINCT ORDER_ID) AS total_orders
        , SUM(QUANTITY) AS total_units_sold
        , SUM(QUANTITY * PRICE) AS total_sales_value
    FROM orders AS o
    JOIN products AS p ON o.PRODUCT_ID = p.PRODUCT_ID
    WHERE o.STATUS NOT IN ('cancelled') 
    GROUP BY sale_date
)

, weekly_sales AS (
    SELECT
        DATE_TRUNC('week', sale_date) AS sale_week
        , SUM(total_orders) AS weekly_orders
        , SUM(total_units_sold) AS weekly_units_sold
        , SUM(total_sales_value) AS weekly_sales_value
    FROM daily_sales
    GROUP BY sale_week
)

, monthly_sales AS (
    SELECT
        DATE_TRUNC('month', sale_date) AS sale_month
        , SUM(total_orders) AS monthly_orders
        , SUM(total_units_sold) AS monthly_units_sold
        , SUM(total_sales_value) AS monthly_sales_value
    FROM daily_sales
    GROUP BY sale_month
)

, yearly_sales AS (
    SELECT
        DATE_TRUNC('year', sale_date) AS sale_year
        , SUM(total_orders) AS yearly_orders
        , SUM(total_units_sold) AS yearly_units_sold
        , SUM(total_sales_value) AS yearly_sales_value
    FROM daily_sales
    GROUP BY sale_year
)

SELECT
    d.sale_date
    , d.total_orders AS daily_orders
    , d.total_units_sold AS daily_units_sold
    , d.total_sales_value AS daily_sales_value
    , w.weekly_orders
    , w.weekly_units_sold
    , w.weekly_sales_value
    , m.monthly_orders
    , m.monthly_units_sold
    , m.monthly_sales_value
    , y.yearly_orders
    , y.yearly_units_sold
    , y.yearly_sales_value
FROM daily_sales d
LEFT JOIN weekly_sales w ON DATE_TRUNC('week', d.sale_date) = w.sale_week
LEFT JOIN monthly_sales m ON DATE_TRUNC('month', d.sale_date) = m.sale_month
LEFT JOIN yearly_sales y ON DATE_TRUNC('year', d.sale_date) = y.sale_year
        );
[0m18:32:45.938157 [debug] [Thread-7  ]: Opening a new connection, currently in state init
[0m18:32:45.938532 [debug] [Thread-10 ]: Opening a new connection, currently in state init
[0m18:32:45.939408 [debug] [Thread-8  ]: Opening a new connection, currently in state init
[0m18:32:48.332645 [debug] [Thread-7  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m18:32:48.367096 [debug] [Thread-7  ]: Timing info for model.billy_bulky.int_products_performance (execute): 18:32:45.919495 => 18:32:48.366801
[0m18:32:48.367680 [debug] [Thread-7  ]: On model.billy_bulky.int_products_performance: Close
[0m18:32:48.371501 [debug] [Thread-10 ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m18:32:48.374396 [debug] [Thread-10 ]: Timing info for model.billy_bulky.sales (execute): 18:32:45.924412 => 18:32:48.374143
[0m18:32:48.374918 [debug] [Thread-10 ]: On model.billy_bulky.sales: Close
[0m18:32:48.378348 [debug] [Thread-8  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m18:32:48.380770 [debug] [Thread-8  ]: Timing info for model.billy_bulky.int_sales_trends (execute): 18:32:45.922792 => 18:32:48.380564
[0m18:32:48.381471 [debug] [Thread-8  ]: On model.billy_bulky.int_sales_trends: Close
[0m18:32:48.382102 [debug] [Thread-9  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m18:32:48.385491 [debug] [Thread-9  ]: Timing info for model.billy_bulky.products (execute): 18:32:45.921159 => 18:32:48.385294
[0m18:32:48.386062 [debug] [Thread-9  ]: On model.billy_bulky.products: Close
[0m18:32:48.421303 [debug] [Thread-5  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m18:32:48.422089 [debug] [Thread-6  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m18:32:48.424603 [debug] [Thread-5  ]: Timing info for model.billy_bulky.customers (execute): 18:32:45.895659 => 18:32:48.424385
[0m18:32:48.426850 [debug] [Thread-6  ]: Timing info for model.billy_bulky.int_customers_segmentation (execute): 18:32:45.915645 => 18:32:48.426631
[0m18:32:48.427300 [debug] [Thread-5  ]: On model.billy_bulky.customers: Close
[0m18:32:48.427667 [debug] [Thread-6  ]: On model.billy_bulky.int_customers_segmentation: Close
[0m18:32:48.744505 [debug] [Thread-7  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f14a3539-293c-461a-8056-c0cd1692a237', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146514250>]}
[0m18:32:48.745998 [info ] [Thread-7  ]: 3 of 6 OK created sql table model intermediate.int_products_performance ........ [[32mSUCCESS 1[0m in 2.92s]
[0m18:32:48.747108 [debug] [Thread-7  ]: Finished running node model.billy_bulky.int_products_performance
[0m18:32:48.757142 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f14a3539-293c-461a-8056-c0cd1692a237', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1465f5280>]}
[0m18:32:48.758582 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f14a3539-293c-461a-8056-c0cd1692a237', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1464fec10>]}
[0m18:32:48.759700 [info ] [Thread-10 ]: 6 of 6 OK created sql table model marts.sales .................................. [[32mSUCCESS 1[0m in 2.93s]
[0m18:32:48.761589 [debug] [Thread-10 ]: Finished running node model.billy_bulky.sales
[0m18:32:48.760560 [info ] [Thread-8  ]: 4 of 6 OK created sql table model intermediate.int_sales_trends ................ [[32mSUCCESS 1[0m in 2.93s]
[0m18:32:48.762913 [debug] [Thread-8  ]: Finished running node model.billy_bulky.int_sales_trends
[0m18:32:48.786413 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f14a3539-293c-461a-8056-c0cd1692a237', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14667ed30>]}
[0m18:32:48.787473 [info ] [Thread-6  ]: 2 of 6 OK created sql table model intermediate.int_customers_segmentation ...... [[32mSUCCESS 1[0m in 2.96s]
[0m18:32:48.788700 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f14a3539-293c-461a-8056-c0cd1692a237', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1107c0070>]}
[0m18:32:48.789555 [debug] [Thread-6  ]: Finished running node model.billy_bulky.int_customers_segmentation
[0m18:32:48.790340 [info ] [Thread-5  ]: 1 of 6 OK created sql table model marts.customers .............................. [[32mSUCCESS 1[0m in 2.97s]
[0m18:32:48.791532 [debug] [Thread-5  ]: Finished running node model.billy_bulky.customers
[0m18:32:48.801512 [debug] [Thread-9  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f14a3539-293c-461a-8056-c0cd1692a237', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1464c6400>]}
[0m18:32:48.802256 [info ] [Thread-9  ]: 5 of 6 OK created sql table model marts.products ............................... [[32mSUCCESS 1[0m in 2.98s]
[0m18:32:48.802873 [debug] [Thread-9  ]: Finished running node model.billy_bulky.products
[0m18:32:48.804649 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:32:48.805013 [debug] [MainThread]: Connection 'model.billy_bulky.staging_shopify__customers' was properly closed.
[0m18:32:48.805320 [debug] [MainThread]: Connection 'model.billy_bulky.staging_shopify__orders' was properly closed.
[0m18:32:48.805613 [debug] [MainThread]: Connection 'model.billy_bulky.staging_shopify__products' was properly closed.
[0m18:32:48.805900 [debug] [MainThread]: Connection 'model.billy_bulky.customers' was properly closed.
[0m18:32:48.806191 [debug] [MainThread]: Connection 'model.billy_bulky.int_customers_segmentation' was properly closed.
[0m18:32:48.806478 [debug] [MainThread]: Connection 'model.billy_bulky.int_products_performance' was properly closed.
[0m18:32:48.806763 [debug] [MainThread]: Connection 'model.billy_bulky.int_sales_trends' was properly closed.
[0m18:32:48.807046 [debug] [MainThread]: Connection 'model.billy_bulky.products' was properly closed.
[0m18:32:48.807342 [debug] [MainThread]: Connection 'model.billy_bulky.sales' was properly closed.
[0m18:32:48.807712 [info ] [MainThread]: 
[0m18:32:48.808087 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 6.91 seconds (6.91s).
[0m18:32:48.809388 [debug] [MainThread]: Command end result
[0m18:32:48.822994 [info ] [MainThread]: 
[0m18:32:48.823417 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:32:48.823712 [info ] [MainThread]: 
[0m18:32:48.824011 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m18:32:48.826404 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.019937, "process_user_time": 5.113861, "process_kernel_time": 0.420409, "process_mem_max_rss": "218169344", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:32:48.826963 [debug] [MainThread]: Command `dbt run` succeeded at 18:32:48.826846 after 8.02 seconds
[0m18:32:48.827321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073e0250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1465fabe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14568cf40>]}
[0m18:32:48.827719 [debug] [MainThread]: Flushing usage events
[0m18:37:25.996794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070a1250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10990e2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10990e850>]}


============================== 18:37:25.999988 | 7a99845f-3220-42f2-ac33-c1ee750a6a2e ==============================
[0m18:37:25.999988 [info ] [MainThread]: Running with dbt=1.7.1
[0m18:37:26.000350 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/bitlevi/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/bitlevi/Documents/billy_bulky_ecommerce/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt compile', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:37:26.940877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7a99845f-3220-42f2-ac33-c1ee750a6a2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098f0fa0>]}
[0m18:37:26.992173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7a99845f-3220-42f2-ac33-c1ee750a6a2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120debca0>]}
[0m18:37:26.993838 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m18:37:27.008578 [debug] [MainThread]: checksum: ad428e6dc3b353dcb23d0c4ebea8b20b180e94b873271ac2a054a8e446dac0e2, vars: {}, profile: , target: , version: 1.7.1
[0m18:37:27.046335 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:37:27.046930 [debug] [MainThread]: Partial parsing: updated file: billy_bulky://models/marts/_marts__docs.md
[0m18:37:27.061736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7a99845f-3220-42f2-ac33-c1ee750a6a2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12440c0d0>]}
[0m18:37:27.073013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7a99845f-3220-42f2-ac33-c1ee750a6a2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1243def10>]}
[0m18:37:27.073384 [info ] [MainThread]: Found 9 models, 20 tests, 3 sources, 0 exposures, 0 metrics, 431 macros, 0 groups, 0 semantic models
[0m18:37:27.073633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a99845f-3220-42f2-ac33-c1ee750a6a2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121745820>]}
[0m18:37:27.075295 [info ] [MainThread]: 
[0m18:37:27.075910 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:37:27.076801 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_marts'
[0m18:37:27.086691 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_marts"
[0m18:37:27.087304 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_intermediate'
[0m18:37:27.087530 [debug] [ThreadPool]: On list_E_COMMERCE_marts: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE_marts"} */
show terse objects in E_COMMERCE.marts limit 10000
[0m18:37:27.089186 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_intermediate"
[0m18:37:27.089430 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:37:27.089639 [debug] [ThreadPool]: On list_E_COMMERCE_intermediate: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE_intermediate"} */
show terse objects in E_COMMERCE.intermediate limit 10000
[0m18:37:27.090753 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:37:28.488430 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m18:37:28.490380 [debug] [ThreadPool]: On list_E_COMMERCE_marts: Close
[0m18:37:28.547610 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m18:37:28.549442 [debug] [ThreadPool]: On list_E_COMMERCE_intermediate: Close
[0m18:37:28.908506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a99845f-3220-42f2-ac33-c1ee750a6a2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1216b4d00>]}
[0m18:37:28.909240 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m18:37:28.909522 [info ] [MainThread]: 
[0m18:37:28.912749 [debug] [Thread-1  ]: Began running node model.billy_bulky.staging_shopify__customers
[0m18:37:28.913765 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_E_COMMERCE_marts, now model.billy_bulky.staging_shopify__customers)
[0m18:37:28.914096 [debug] [Thread-3  ]: Began running node model.billy_bulky.staging_shopify__orders
[0m18:37:28.914361 [debug] [Thread-1  ]: Began compiling node model.billy_bulky.staging_shopify__customers
[0m18:37:28.914607 [debug] [Thread-4  ]: Began running node model.billy_bulky.staging_shopify__products
[0m18:37:28.915120 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.billy_bulky.staging_shopify__orders'
[0m18:37:28.921162 [debug] [Thread-1  ]: Writing injected SQL for node "model.billy_bulky.staging_shopify__customers"
[0m18:37:28.921812 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.billy_bulky.staging_shopify__products'
[0m18:37:28.922119 [debug] [Thread-3  ]: Began compiling node model.billy_bulky.staging_shopify__orders
[0m18:37:28.922418 [debug] [Thread-4  ]: Began compiling node model.billy_bulky.staging_shopify__products
[0m18:37:28.924696 [debug] [Thread-3  ]: Writing injected SQL for node "model.billy_bulky.staging_shopify__orders"
[0m18:37:28.926966 [debug] [Thread-4  ]: Writing injected SQL for node "model.billy_bulky.staging_shopify__products"
[0m18:37:28.927577 [debug] [Thread-1  ]: Timing info for model.billy_bulky.staging_shopify__customers (compile): 18:37:28.915298 => 18:37:28.927396
[0m18:37:28.928291 [debug] [Thread-1  ]: Finished running node model.billy_bulky.staging_shopify__customers
[0m18:37:28.928803 [debug] [Thread-3  ]: Timing info for model.billy_bulky.staging_shopify__orders (compile): 18:37:28.922583 => 18:37:28.928636
[0m18:37:28.929427 [debug] [Thread-3  ]: Finished running node model.billy_bulky.staging_shopify__orders
[0m18:37:28.929854 [debug] [Thread-4  ]: Timing info for model.billy_bulky.staging_shopify__products (compile): 18:37:28.924973 => 18:37:28.929716
[0m18:37:28.930398 [debug] [Thread-4  ]: Finished running node model.billy_bulky.staging_shopify__products
[0m18:37:28.930973 [debug] [Thread-6  ]: Began running node model.billy_bulky.customers
[0m18:37:28.931453 [debug] [Thread-6  ]: Acquiring new snowflake connection 'model.billy_bulky.customers'
[0m18:37:28.931689 [debug] [Thread-6  ]: Began compiling node model.billy_bulky.customers
[0m18:37:28.941327 [debug] [Thread-6  ]: Writing injected SQL for node "model.billy_bulky.customers"
[0m18:37:28.941731 [debug] [Thread-7  ]: Began running node model.billy_bulky.int_customers_segmentation
[0m18:37:28.941983 [debug] [Thread-8  ]: Began running node model.billy_bulky.int_products_performance
[0m18:37:28.942288 [debug] [Thread-9  ]: Began running node model.billy_bulky.int_sales_trends
[0m18:37:28.942808 [debug] [Thread-7  ]: Acquiring new snowflake connection 'model.billy_bulky.int_customers_segmentation'
[0m18:37:28.943051 [debug] [Thread-10 ]: Began running node model.billy_bulky.products
[0m18:37:28.943406 [debug] [Thread-2  ]: Began running node model.billy_bulky.sales
[0m18:37:28.943881 [debug] [Thread-8  ]: Acquiring new snowflake connection 'model.billy_bulky.int_products_performance'
[0m18:37:28.944361 [debug] [Thread-9  ]: Acquiring new snowflake connection 'model.billy_bulky.int_sales_trends'
[0m18:37:28.944603 [debug] [Thread-7  ]: Began compiling node model.billy_bulky.int_customers_segmentation
[0m18:37:28.944866 [debug] [Thread-6  ]: Timing info for model.billy_bulky.customers (compile): 18:37:28.931831 => 18:37:28.944733
[0m18:37:28.945287 [debug] [Thread-10 ]: Acquiring new snowflake connection 'model.billy_bulky.products'
[0m18:37:28.945662 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_E_COMMERCE_intermediate, now model.billy_bulky.sales)
[0m18:37:28.945885 [debug] [Thread-8  ]: Began compiling node model.billy_bulky.int_products_performance
[0m18:37:28.946098 [debug] [Thread-9  ]: Began compiling node model.billy_bulky.int_sales_trends
[0m18:37:28.958960 [debug] [Thread-6  ]: Began executing node model.billy_bulky.customers
[0m18:37:28.959836 [debug] [Thread-7  ]: Writing injected SQL for node "model.billy_bulky.int_customers_segmentation"
[0m18:37:28.960151 [debug] [Thread-10 ]: Began compiling node model.billy_bulky.products
[0m18:37:28.960384 [debug] [Thread-2  ]: Began compiling node model.billy_bulky.sales
[0m18:37:28.970828 [debug] [Thread-8  ]: Writing injected SQL for node "model.billy_bulky.int_products_performance"
[0m18:37:28.983975 [debug] [Thread-6  ]: Timing info for model.billy_bulky.customers (execute): 18:37:28.983733 => 18:37:28.983749
[0m18:37:28.984989 [debug] [Thread-9  ]: Writing injected SQL for node "model.billy_bulky.int_sales_trends"
[0m18:37:28.993107 [debug] [Thread-10 ]: Writing injected SQL for node "model.billy_bulky.products"
[0m18:37:29.001303 [debug] [Thread-2  ]: Writing injected SQL for node "model.billy_bulky.sales"
[0m18:37:29.002259 [debug] [Thread-6  ]: Finished running node model.billy_bulky.customers
[0m18:37:29.002570 [debug] [Thread-7  ]: Timing info for model.billy_bulky.int_customers_segmentation (compile): 18:37:28.946235 => 18:37:29.002429
[0m18:37:29.002876 [debug] [Thread-8  ]: Timing info for model.billy_bulky.int_products_performance (compile): 18:37:28.960532 => 18:37:29.002751
[0m18:37:29.003630 [debug] [Thread-9  ]: Timing info for model.billy_bulky.int_sales_trends (compile): 18:37:28.971111 => 18:37:29.003452
[0m18:37:29.003935 [debug] [Thread-10 ]: Timing info for model.billy_bulky.products (compile): 18:37:28.985252 => 18:37:29.003804
[0m18:37:29.004185 [debug] [Thread-1  ]: Began running node test.billy_bulky.email_customers_email.7779cc02dc
[0m18:37:29.004416 [debug] [Thread-7  ]: Began executing node model.billy_bulky.int_customers_segmentation
[0m18:37:29.004651 [debug] [Thread-3  ]: Began running node test.billy_bulky.not_null_customers_customer_id.5c9bf9911d
[0m18:37:29.004883 [debug] [Thread-4  ]: Began running node test.billy_bulky.not_null_customers_email.da3cfcd534
[0m18:37:29.005150 [debug] [Thread-2  ]: Timing info for model.billy_bulky.sales (compile): 18:37:28.993328 => 18:37:29.005006
[0m18:37:29.005379 [debug] [Thread-5  ]: Began running node test.billy_bulky.not_null_customers_join_date.faf8f07bc9
[0m18:37:29.005606 [debug] [Thread-8  ]: Began executing node model.billy_bulky.int_products_performance
[0m18:37:29.005838 [debug] [Thread-6  ]: Began running node test.billy_bulky.unique_customers_customer_id.c5af1ff4b1
[0m18:37:29.006066 [debug] [Thread-9  ]: Began executing node model.billy_bulky.int_sales_trends
[0m18:37:29.006292 [debug] [Thread-10 ]: Began executing node model.billy_bulky.products
[0m18:37:29.006833 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.billy_bulky.staging_shopify__customers, now test.billy_bulky.email_customers_email.7779cc02dc)
[0m18:37:29.007124 [debug] [Thread-7  ]: Timing info for model.billy_bulky.int_customers_segmentation (execute): 18:37:29.006990 => 18:37:29.006995
[0m18:37:29.007533 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.billy_bulky.staging_shopify__orders, now test.billy_bulky.not_null_customers_customer_id.5c9bf9911d)
[0m18:37:29.007952 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.billy_bulky.staging_shopify__products, now test.billy_bulky.not_null_customers_email.da3cfcd534)
[0m18:37:29.008195 [debug] [Thread-2  ]: Began executing node model.billy_bulky.sales
[0m18:37:29.008642 [debug] [Thread-5  ]: Acquiring new snowflake connection 'test.billy_bulky.not_null_customers_join_date.faf8f07bc9'
[0m18:37:29.008952 [debug] [Thread-8  ]: Timing info for model.billy_bulky.int_products_performance (execute): 18:37:29.008817 => 18:37:29.008824
[0m18:37:29.009352 [debug] [Thread-6  ]: Re-using an available connection from the pool (formerly model.billy_bulky.customers, now test.billy_bulky.unique_customers_customer_id.c5af1ff4b1)
[0m18:37:29.009639 [debug] [Thread-9  ]: Timing info for model.billy_bulky.int_sales_trends (execute): 18:37:29.009517 => 18:37:29.009520
[0m18:37:29.009916 [debug] [Thread-10 ]: Timing info for model.billy_bulky.products (execute): 18:37:29.009788 => 18:37:29.009792
[0m18:37:29.010146 [debug] [Thread-1  ]: Began compiling node test.billy_bulky.email_customers_email.7779cc02dc
[0m18:37:29.010701 [debug] [Thread-7  ]: Finished running node model.billy_bulky.int_customers_segmentation
[0m18:37:29.010924 [debug] [Thread-3  ]: Began compiling node test.billy_bulky.not_null_customers_customer_id.5c9bf9911d
[0m18:37:29.011153 [debug] [Thread-4  ]: Began compiling node test.billy_bulky.not_null_customers_email.da3cfcd534
[0m18:37:29.011418 [debug] [Thread-2  ]: Timing info for model.billy_bulky.sales (execute): 18:37:29.011297 => 18:37:29.011301
[0m18:37:29.011637 [debug] [Thread-5  ]: Began compiling node test.billy_bulky.not_null_customers_join_date.faf8f07bc9
[0m18:37:29.012162 [debug] [Thread-8  ]: Finished running node model.billy_bulky.int_products_performance
[0m18:37:29.012388 [debug] [Thread-6  ]: Began compiling node test.billy_bulky.unique_customers_customer_id.c5af1ff4b1
[0m18:37:29.012912 [debug] [Thread-9  ]: Finished running node model.billy_bulky.int_sales_trends
[0m18:37:29.013520 [debug] [Thread-10 ]: Finished running node model.billy_bulky.products
[0m18:37:29.018633 [debug] [Thread-7  ]: Began running node test.billy_bulky.unique_customers_email.e77c92eb54
[0m18:37:29.024283 [debug] [Thread-3  ]: Writing injected SQL for node "test.billy_bulky.not_null_customers_customer_id.5c9bf9911d"
[0m18:37:29.027130 [debug] [Thread-4  ]: Writing injected SQL for node "test.billy_bulky.not_null_customers_email.da3cfcd534"
[0m18:37:29.027801 [debug] [Thread-2  ]: Finished running node model.billy_bulky.sales
[0m18:37:29.030436 [debug] [Thread-5  ]: Writing injected SQL for node "test.billy_bulky.not_null_customers_join_date.faf8f07bc9"
[0m18:37:29.030966 [debug] [Thread-1  ]: Timing info for test.billy_bulky.email_customers_email.7779cc02dc (compile): 18:37:29.013694 => 18:37:29.030825
[0m18:37:29.035977 [debug] [Thread-6  ]: Writing injected SQL for node "test.billy_bulky.unique_customers_customer_id.c5af1ff4b1"
[0m18:37:29.036686 [debug] [Thread-8  ]: Began running node test.billy_bulky.not_null_int_sales_trends_daily_orders.96da3a5baa
[0m18:37:29.036937 [debug] [Thread-9  ]: Began running node test.billy_bulky.not_null_int_sales_trends_daily_sales_value.070e4ffb27
[0m18:37:29.037406 [debug] [Thread-7  ]: Re-using an available connection from the pool (formerly model.billy_bulky.int_customers_segmentation, now test.billy_bulky.unique_customers_email.e77c92eb54)
[0m18:37:29.037675 [debug] [Thread-10 ]: Began running node test.billy_bulky.not_null_int_sales_trends_daily_units_sold.cfceaad553
[0m18:37:29.038055 [debug] [Thread-2  ]: Began running node test.billy_bulky.not_null_int_sales_trends_monthly_orders.e6a6b6c9bd
[0m18:37:29.041813 [debug] [Thread-8  ]: Re-using an available connection from the pool (formerly model.billy_bulky.int_products_performance, now test.billy_bulky.not_null_int_sales_trends_daily_orders.96da3a5baa)
[0m18:37:29.042384 [debug] [Thread-9  ]: Re-using an available connection from the pool (formerly model.billy_bulky.int_sales_trends, now test.billy_bulky.not_null_int_sales_trends_daily_sales_value.070e4ffb27)
[0m18:37:29.042700 [debug] [Thread-3  ]: Timing info for test.billy_bulky.not_null_customers_customer_id.5c9bf9911d (compile): 18:37:29.018914 => 18:37:29.042562
[0m18:37:29.042959 [debug] [Thread-4  ]: Timing info for test.billy_bulky.not_null_customers_email.da3cfcd534 (compile): 18:37:29.024569 => 18:37:29.042843
[0m18:37:29.043200 [debug] [Thread-6  ]: Timing info for test.billy_bulky.unique_customers_customer_id.c5af1ff4b1 (compile): 18:37:29.031214 => 18:37:29.043084
[0m18:37:29.045204 [debug] [Thread-5  ]: Timing info for test.billy_bulky.not_null_customers_join_date.faf8f07bc9 (compile): 18:37:29.027953 => 18:37:29.045054
[0m18:37:29.045477 [debug] [Thread-7  ]: Began compiling node test.billy_bulky.unique_customers_email.e77c92eb54
[0m18:37:29.045931 [debug] [Thread-10 ]: Re-using an available connection from the pool (formerly model.billy_bulky.products, now test.billy_bulky.not_null_int_sales_trends_daily_units_sold.cfceaad553)
[0m18:37:29.048079 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.billy_bulky.sales, now test.billy_bulky.not_null_int_sales_trends_monthly_orders.e6a6b6c9bd)
[0m18:37:29.048398 [debug] [Thread-8  ]: Began compiling node test.billy_bulky.not_null_int_sales_trends_daily_orders.96da3a5baa
[0m18:37:29.048787 [debug] [Thread-9  ]: Began compiling node test.billy_bulky.not_null_int_sales_trends_daily_sales_value.070e4ffb27
[0m18:37:29.049120 [debug] [Thread-3  ]: Began executing node test.billy_bulky.not_null_customers_customer_id.5c9bf9911d
[0m18:37:29.050871 [debug] [Thread-4  ]: Began executing node test.billy_bulky.not_null_customers_email.da3cfcd534
[0m18:37:29.051121 [debug] [Thread-6  ]: Began executing node test.billy_bulky.unique_customers_customer_id.c5af1ff4b1
[0m18:37:29.051368 [debug] [Thread-5  ]: Began executing node test.billy_bulky.not_null_customers_join_date.faf8f07bc9
[0m18:37:29.054398 [debug] [Thread-7  ]: Writing injected SQL for node "test.billy_bulky.unique_customers_email.e77c92eb54"
[0m18:37:29.054722 [debug] [Thread-10 ]: Began compiling node test.billy_bulky.not_null_int_sales_trends_daily_units_sold.cfceaad553
[0m18:37:29.055275 [debug] [Thread-2  ]: Began compiling node test.billy_bulky.not_null_int_sales_trends_monthly_orders.e6a6b6c9bd
[0m18:37:29.058198 [debug] [Thread-8  ]: Writing injected SQL for node "test.billy_bulky.not_null_int_sales_trends_daily_orders.96da3a5baa"
[0m18:37:29.062175 [debug] [Thread-9  ]: Writing injected SQL for node "test.billy_bulky.not_null_int_sales_trends_daily_sales_value.070e4ffb27"
[0m18:37:29.062576 [debug] [Thread-3  ]: Timing info for test.billy_bulky.not_null_customers_customer_id.5c9bf9911d (execute): 18:37:29.062419 => 18:37:29.062427
[0m18:37:29.062900 [debug] [Thread-4  ]: Timing info for test.billy_bulky.not_null_customers_email.da3cfcd534 (execute): 18:37:29.062762 => 18:37:29.062767
[0m18:37:29.063206 [debug] [Thread-6  ]: Timing info for test.billy_bulky.unique_customers_customer_id.c5af1ff4b1 (execute): 18:37:29.063076 => 18:37:29.063079
[0m18:37:29.063529 [debug] [Thread-5  ]: Timing info for test.billy_bulky.not_null_customers_join_date.faf8f07bc9 (execute): 18:37:29.063404 => 18:37:29.063407
[0m18:37:29.072896 [debug] [Thread-10 ]: Writing injected SQL for node "test.billy_bulky.not_null_int_sales_trends_daily_units_sold.cfceaad553"
[0m18:37:29.075960 [debug] [Thread-2  ]: Writing injected SQL for node "test.billy_bulky.not_null_int_sales_trends_monthly_orders.e6a6b6c9bd"
[0m18:37:29.076331 [debug] [Thread-7  ]: Timing info for test.billy_bulky.unique_customers_email.e77c92eb54 (compile): 18:37:29.051589 => 18:37:29.076160
[0m18:37:29.076760 [debug] [Thread-1  ]: Compilation Error in test email_customers_email (models/staging/shopify/_shopify__schema.yml)
  'test_email' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m18:37:29.077520 [debug] [Thread-3  ]: Finished running node test.billy_bulky.not_null_customers_customer_id.5c9bf9911d
[0m18:37:29.078100 [debug] [Thread-4  ]: Finished running node test.billy_bulky.not_null_customers_email.da3cfcd534
[0m18:37:29.078627 [debug] [Thread-6  ]: Finished running node test.billy_bulky.unique_customers_customer_id.c5af1ff4b1
[0m18:37:29.079288 [debug] [Thread-5  ]: Finished running node test.billy_bulky.not_null_customers_join_date.faf8f07bc9
[0m18:37:29.079647 [debug] [Thread-8  ]: Timing info for test.billy_bulky.not_null_int_sales_trends_daily_orders.96da3a5baa (compile): 18:37:29.055441 => 18:37:29.079509
[0m18:37:29.079904 [debug] [Thread-9  ]: Timing info for test.billy_bulky.not_null_int_sales_trends_daily_sales_value.070e4ffb27 (compile): 18:37:29.059642 => 18:37:29.079781
[0m18:37:29.080245 [debug] [Thread-7  ]: Began executing node test.billy_bulky.unique_customers_email.e77c92eb54
[0m18:37:29.080650 [debug] [Thread-1  ]: Finished running node test.billy_bulky.email_customers_email.7779cc02dc
[0m18:37:29.081015 [debug] [Thread-3  ]: Began running node test.billy_bulky.not_null_int_sales_trends_monthly_sales_value.bbb69f3d4a
[0m18:37:29.081283 [debug] [Thread-2  ]: Timing info for test.billy_bulky.not_null_int_sales_trends_monthly_orders.e6a6b6c9bd (compile): 18:37:29.073268 => 18:37:29.081157
[0m18:37:29.081574 [debug] [Thread-10 ]: Timing info for test.billy_bulky.not_null_int_sales_trends_daily_units_sold.cfceaad553 (compile): 18:37:29.070097 => 18:37:29.081441
[0m18:37:29.081884 [debug] [Thread-4  ]: Began running node test.billy_bulky.not_null_int_sales_trends_monthly_units_sold.ee96488ac3
[0m18:37:29.082167 [debug] [Thread-6  ]: Began running node test.billy_bulky.not_null_int_sales_trends_sale_date.f72c75cc10
[0m18:37:29.082447 [debug] [Thread-5  ]: Began running node test.billy_bulky.not_null_int_sales_trends_weekly_orders.9f9ad69d2c
[0m18:37:29.082723 [debug] [Thread-8  ]: Began executing node test.billy_bulky.not_null_int_sales_trends_daily_orders.96da3a5baa
[0m18:37:29.082981 [debug] [Thread-9  ]: Began executing node test.billy_bulky.not_null_int_sales_trends_daily_sales_value.070e4ffb27
[0m18:37:29.083266 [debug] [Thread-7  ]: Timing info for test.billy_bulky.unique_customers_email.e77c92eb54 (execute): 18:37:29.083134 => 18:37:29.083139
[0m18:37:29.083552 [debug] [Thread-1  ]: Began running node test.billy_bulky.not_null_int_sales_trends_weekly_sales_value.502ef6aeae
[0m18:37:29.084044 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.billy_bulky.not_null_customers_customer_id.5c9bf9911d, now test.billy_bulky.not_null_int_sales_trends_monthly_sales_value.bbb69f3d4a)
[0m18:37:29.084288 [debug] [Thread-2  ]: Began executing node test.billy_bulky.not_null_int_sales_trends_monthly_orders.e6a6b6c9bd
[0m18:37:29.084522 [debug] [Thread-10 ]: Began executing node test.billy_bulky.not_null_int_sales_trends_daily_units_sold.cfceaad553
[0m18:37:29.084929 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.billy_bulky.not_null_customers_email.da3cfcd534, now test.billy_bulky.not_null_int_sales_trends_monthly_units_sold.ee96488ac3)
[0m18:37:29.085315 [debug] [Thread-6  ]: Re-using an available connection from the pool (formerly test.billy_bulky.unique_customers_customer_id.c5af1ff4b1, now test.billy_bulky.not_null_int_sales_trends_sale_date.f72c75cc10)
[0m18:37:29.085699 [debug] [Thread-5  ]: Re-using an available connection from the pool (formerly test.billy_bulky.not_null_customers_join_date.faf8f07bc9, now test.billy_bulky.not_null_int_sales_trends_weekly_orders.9f9ad69d2c)
[0m18:37:29.085973 [debug] [Thread-8  ]: Timing info for test.billy_bulky.not_null_int_sales_trends_daily_orders.96da3a5baa (execute): 18:37:29.085843 => 18:37:29.085847
[0m18:37:29.086241 [debug] [Thread-9  ]: Timing info for test.billy_bulky.not_null_int_sales_trends_daily_sales_value.070e4ffb27 (execute): 18:37:29.086116 => 18:37:29.086120
[0m18:37:29.086784 [debug] [Thread-7  ]: Finished running node test.billy_bulky.unique_customers_email.e77c92eb54
[0m18:37:29.087175 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.billy_bulky.email_customers_email.7779cc02dc, now test.billy_bulky.not_null_int_sales_trends_weekly_sales_value.502ef6aeae)
[0m18:37:29.087406 [debug] [Thread-3  ]: Began compiling node test.billy_bulky.not_null_int_sales_trends_monthly_sales_value.bbb69f3d4a
[0m18:37:29.087691 [debug] [Thread-2  ]: Timing info for test.billy_bulky.not_null_int_sales_trends_monthly_orders.e6a6b6c9bd (execute): 18:37:29.087556 => 18:37:29.087560
[0m18:37:29.087951 [debug] [Thread-10 ]: Timing info for test.billy_bulky.not_null_int_sales_trends_daily_units_sold.cfceaad553 (execute): 18:37:29.087833 => 18:37:29.087835
[0m18:37:29.088178 [debug] [Thread-4  ]: Began compiling node test.billy_bulky.not_null_int_sales_trends_monthly_units_sold.ee96488ac3
[0m18:37:29.088405 [debug] [Thread-6  ]: Began compiling node test.billy_bulky.not_null_int_sales_trends_sale_date.f72c75cc10
[0m18:37:29.088625 [debug] [Thread-5  ]: Began compiling node test.billy_bulky.not_null_int_sales_trends_weekly_orders.9f9ad69d2c
[0m18:37:29.089196 [debug] [Thread-8  ]: Finished running node test.billy_bulky.not_null_int_sales_trends_daily_orders.96da3a5baa
[0m18:37:29.089759 [debug] [Thread-9  ]: Finished running node test.billy_bulky.not_null_int_sales_trends_daily_sales_value.070e4ffb27
[0m18:37:29.090040 [debug] [Thread-7  ]: Began running node test.billy_bulky.not_null_int_sales_trends_weekly_units_sold.5fb3438f7f
[0m18:37:29.090311 [debug] [Thread-1  ]: Began compiling node test.billy_bulky.not_null_int_sales_trends_weekly_sales_value.502ef6aeae
[0m18:37:29.094145 [debug] [Thread-3  ]: Writing injected SQL for node "test.billy_bulky.not_null_int_sales_trends_monthly_sales_value.bbb69f3d4a"
[0m18:37:29.094803 [debug] [Thread-2  ]: Finished running node test.billy_bulky.not_null_int_sales_trends_monthly_orders.e6a6b6c9bd
[0m18:37:29.095320 [debug] [Thread-10 ]: Finished running node test.billy_bulky.not_null_int_sales_trends_daily_units_sold.cfceaad553
[0m18:37:29.098240 [debug] [Thread-4  ]: Writing injected SQL for node "test.billy_bulky.not_null_int_sales_trends_monthly_units_sold.ee96488ac3"
[0m18:37:29.101173 [debug] [Thread-6  ]: Writing injected SQL for node "test.billy_bulky.not_null_int_sales_trends_sale_date.f72c75cc10"
[0m18:37:29.103890 [debug] [Thread-5  ]: Writing injected SQL for node "test.billy_bulky.not_null_int_sales_trends_weekly_orders.9f9ad69d2c"
[0m18:37:29.104234 [debug] [Thread-8  ]: Began running node test.billy_bulky.not_null_int_sales_trends_yearly_orders.e9720dbf16
[0m18:37:29.104501 [debug] [Thread-9  ]: Began running node test.billy_bulky.not_null_int_sales_trends_yearly_sales_value.ebdab7a01e
[0m18:37:29.104967 [debug] [Thread-7  ]: Re-using an available connection from the pool (formerly test.billy_bulky.unique_customers_email.e77c92eb54, now test.billy_bulky.not_null_int_sales_trends_weekly_units_sold.5fb3438f7f)
[0m18:37:29.107727 [debug] [Thread-1  ]: Writing injected SQL for node "test.billy_bulky.not_null_int_sales_trends_weekly_sales_value.502ef6aeae"
[0m18:37:29.108136 [debug] [Thread-2  ]: Began running node test.billy_bulky.not_null_int_sales_trends_yearly_units_sold.758913b07d
[0m18:37:29.108399 [debug] [Thread-10 ]: Began running node test.billy_bulky.unique_int_sales_trends_sale_date.9f7845245b
[0m18:37:29.109153 [debug] [Thread-8  ]: Re-using an available connection from the pool (formerly test.billy_bulky.not_null_int_sales_trends_daily_orders.96da3a5baa, now test.billy_bulky.not_null_int_sales_trends_yearly_orders.e9720dbf16)
[0m18:37:29.109441 [debug] [Thread-6  ]: Timing info for test.billy_bulky.not_null_int_sales_trends_sale_date.f72c75cc10 (compile): 18:37:29.098508 => 18:37:29.109311
[0m18:37:29.109757 [debug] [Thread-3  ]: Timing info for test.billy_bulky.not_null_int_sales_trends_monthly_sales_value.bbb69f3d4a (compile): 18:37:29.090458 => 18:37:29.109603
[0m18:37:29.110150 [debug] [Thread-9  ]: Re-using an available connection from the pool (formerly test.billy_bulky.not_null_int_sales_trends_daily_sales_value.070e4ffb27, now test.billy_bulky.not_null_int_sales_trends_yearly_sales_value.ebdab7a01e)
[0m18:37:29.110408 [debug] [Thread-4  ]: Timing info for test.billy_bulky.not_null_int_sales_trends_monthly_units_sold.ee96488ac3 (compile): 18:37:29.095472 => 18:37:29.110284
[0m18:37:29.110662 [debug] [Thread-7  ]: Began compiling node test.billy_bulky.not_null_int_sales_trends_weekly_units_sold.5fb3438f7f
[0m18:37:29.110936 [debug] [Thread-5  ]: Timing info for test.billy_bulky.not_null_int_sales_trends_weekly_orders.9f9ad69d2c (compile): 18:37:29.101399 => 18:37:29.110804
[0m18:37:29.111374 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.billy_bulky.not_null_int_sales_trends_monthly_orders.e6a6b6c9bd, now test.billy_bulky.not_null_int_sales_trends_yearly_units_sold.758913b07d)
[0m18:37:29.111774 [debug] [Thread-10 ]: Re-using an available connection from the pool (formerly test.billy_bulky.not_null_int_sales_trends_daily_units_sold.cfceaad553, now test.billy_bulky.unique_int_sales_trends_sale_date.9f7845245b)
[0m18:37:29.112039 [debug] [Thread-8  ]: Began compiling node test.billy_bulky.not_null_int_sales_trends_yearly_orders.e9720dbf16
[0m18:37:29.112316 [debug] [Thread-1  ]: Timing info for test.billy_bulky.not_null_int_sales_trends_weekly_sales_value.502ef6aeae (compile): 18:37:29.105131 => 18:37:29.112187
[0m18:37:29.112539 [debug] [Thread-6  ]: Began executing node test.billy_bulky.not_null_int_sales_trends_sale_date.f72c75cc10
[0m18:37:29.112777 [debug] [Thread-3  ]: Began executing node test.billy_bulky.not_null_int_sales_trends_monthly_sales_value.bbb69f3d4a
[0m18:37:29.113021 [debug] [Thread-9  ]: Began compiling node test.billy_bulky.not_null_int_sales_trends_yearly_sales_value.ebdab7a01e
[0m18:37:29.113249 [debug] [Thread-4  ]: Began executing node test.billy_bulky.not_null_int_sales_trends_monthly_units_sold.ee96488ac3
[0m18:37:29.116248 [debug] [Thread-7  ]: Writing injected SQL for node "test.billy_bulky.not_null_int_sales_trends_weekly_units_sold.5fb3438f7f"
[0m18:37:29.116587 [debug] [Thread-5  ]: Began executing node test.billy_bulky.not_null_int_sales_trends_weekly_orders.9f9ad69d2c
[0m18:37:29.116875 [debug] [Thread-2  ]: Began compiling node test.billy_bulky.not_null_int_sales_trends_yearly_units_sold.758913b07d
[0m18:37:29.117155 [debug] [Thread-10 ]: Began compiling node test.billy_bulky.unique_int_sales_trends_sale_date.9f7845245b
[0m18:37:29.120249 [debug] [Thread-8  ]: Writing injected SQL for node "test.billy_bulky.not_null_int_sales_trends_yearly_orders.e9720dbf16"
[0m18:37:29.120612 [debug] [Thread-1  ]: Began executing node test.billy_bulky.not_null_int_sales_trends_weekly_sales_value.502ef6aeae
[0m18:37:29.120923 [debug] [Thread-6  ]: Timing info for test.billy_bulky.not_null_int_sales_trends_sale_date.f72c75cc10 (execute): 18:37:29.120773 => 18:37:29.120780
[0m18:37:29.121215 [debug] [Thread-3  ]: Timing info for test.billy_bulky.not_null_int_sales_trends_monthly_sales_value.bbb69f3d4a (execute): 18:37:29.121081 => 18:37:29.121085
[0m18:37:29.124070 [debug] [Thread-9  ]: Writing injected SQL for node "test.billy_bulky.not_null_int_sales_trends_yearly_sales_value.ebdab7a01e"
[0m18:37:29.124470 [debug] [Thread-4  ]: Timing info for test.billy_bulky.not_null_int_sales_trends_monthly_units_sold.ee96488ac3 (execute): 18:37:29.124318 => 18:37:29.124325
[0m18:37:29.124849 [debug] [Thread-5  ]: Timing info for test.billy_bulky.not_null_int_sales_trends_weekly_orders.9f9ad69d2c (execute): 18:37:29.124711 => 18:37:29.124715
[0m18:37:29.128465 [debug] [Thread-2  ]: Writing injected SQL for node "test.billy_bulky.not_null_int_sales_trends_yearly_units_sold.758913b07d"
[0m18:37:29.131293 [debug] [Thread-10 ]: Writing injected SQL for node "test.billy_bulky.unique_int_sales_trends_sale_date.9f7845245b"
[0m18:37:29.131670 [debug] [Thread-7  ]: Timing info for test.billy_bulky.not_null_int_sales_trends_weekly_units_sold.5fb3438f7f (compile): 18:37:29.113402 => 18:37:29.131516
[0m18:37:29.131995 [debug] [Thread-1  ]: Timing info for test.billy_bulky.not_null_int_sales_trends_weekly_sales_value.502ef6aeae (execute): 18:37:29.131855 => 18:37:29.131861
[0m18:37:29.132609 [debug] [Thread-6  ]: Finished running node test.billy_bulky.not_null_int_sales_trends_sale_date.f72c75cc10
[0m18:37:29.133142 [debug] [Thread-3  ]: Finished running node test.billy_bulky.not_null_int_sales_trends_monthly_sales_value.bbb69f3d4a
[0m18:37:29.133779 [debug] [Thread-4  ]: Finished running node test.billy_bulky.not_null_int_sales_trends_monthly_units_sold.ee96488ac3
[0m18:37:29.134035 [debug] [Thread-8  ]: Timing info for test.billy_bulky.not_null_int_sales_trends_yearly_orders.e9720dbf16 (compile): 18:37:29.117323 => 18:37:29.133911
[0m18:37:29.134578 [debug] [Thread-5  ]: Finished running node test.billy_bulky.not_null_int_sales_trends_weekly_orders.9f9ad69d2c
[0m18:37:29.134870 [debug] [Thread-9  ]: Timing info for test.billy_bulky.not_null_int_sales_trends_yearly_sales_value.ebdab7a01e (compile): 18:37:29.121370 => 18:37:29.134748
[0m18:37:29.135172 [debug] [Thread-7  ]: Began executing node test.billy_bulky.not_null_int_sales_trends_weekly_units_sold.5fb3438f7f
[0m18:37:29.135757 [debug] [Thread-1  ]: Finished running node test.billy_bulky.not_null_int_sales_trends_weekly_sales_value.502ef6aeae
[0m18:37:29.136036 [debug] [Thread-10 ]: Timing info for test.billy_bulky.unique_int_sales_trends_sale_date.9f7845245b (compile): 18:37:29.128722 => 18:37:29.135909
[0m18:37:29.136310 [debug] [Thread-2  ]: Timing info for test.billy_bulky.not_null_int_sales_trends_yearly_units_sold.758913b07d (compile): 18:37:29.124996 => 18:37:29.136181
[0m18:37:29.136714 [debug] [Thread-8  ]: Began executing node test.billy_bulky.not_null_int_sales_trends_yearly_orders.e9720dbf16
[0m18:37:29.137000 [debug] [Thread-9  ]: Began executing node test.billy_bulky.not_null_int_sales_trends_yearly_sales_value.ebdab7a01e
[0m18:37:29.137286 [debug] [Thread-7  ]: Timing info for test.billy_bulky.not_null_int_sales_trends_weekly_units_sold.5fb3438f7f (execute): 18:37:29.137148 => 18:37:29.137152
[0m18:37:29.137573 [debug] [Thread-10 ]: Began executing node test.billy_bulky.unique_int_sales_trends_sale_date.9f7845245b
[0m18:37:29.137804 [debug] [Thread-2  ]: Began executing node test.billy_bulky.not_null_int_sales_trends_yearly_units_sold.758913b07d
[0m18:37:29.138104 [debug] [Thread-8  ]: Timing info for test.billy_bulky.not_null_int_sales_trends_yearly_orders.e9720dbf16 (execute): 18:37:29.137976 => 18:37:29.137979
[0m18:37:29.138383 [debug] [Thread-9  ]: Timing info for test.billy_bulky.not_null_int_sales_trends_yearly_sales_value.ebdab7a01e (execute): 18:37:29.138262 => 18:37:29.138264
[0m18:37:29.138969 [debug] [Thread-7  ]: Finished running node test.billy_bulky.not_null_int_sales_trends_weekly_units_sold.5fb3438f7f
[0m18:37:29.139255 [debug] [Thread-10 ]: Timing info for test.billy_bulky.unique_int_sales_trends_sale_date.9f7845245b (execute): 18:37:29.139128 => 18:37:29.139131
[0m18:37:29.139540 [debug] [Thread-2  ]: Timing info for test.billy_bulky.not_null_int_sales_trends_yearly_units_sold.758913b07d (execute): 18:37:29.139404 => 18:37:29.139408
[0m18:37:29.140092 [debug] [Thread-8  ]: Finished running node test.billy_bulky.not_null_int_sales_trends_yearly_orders.e9720dbf16
[0m18:37:29.140643 [debug] [Thread-9  ]: Finished running node test.billy_bulky.not_null_int_sales_trends_yearly_sales_value.ebdab7a01e
[0m18:37:29.141234 [debug] [Thread-10 ]: Finished running node test.billy_bulky.unique_int_sales_trends_sale_date.9f7845245b
[0m18:37:29.141756 [debug] [Thread-2  ]: Finished running node test.billy_bulky.not_null_int_sales_trends_yearly_units_sold.758913b07d
[0m18:37:29.142120 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:37:29.142342 [debug] [MainThread]: Connection 'test.billy_bulky.not_null_int_sales_trends_weekly_sales_value.502ef6aeae' was properly closed.
[0m18:37:29.142558 [debug] [MainThread]: Connection 'test.billy_bulky.not_null_int_sales_trends_yearly_units_sold.758913b07d' was properly closed.
[0m18:37:29.142766 [debug] [MainThread]: Connection 'test.billy_bulky.not_null_int_sales_trends_monthly_sales_value.bbb69f3d4a' was properly closed.
[0m18:37:29.142937 [debug] [MainThread]: Connection 'test.billy_bulky.not_null_int_sales_trends_monthly_units_sold.ee96488ac3' was properly closed.
[0m18:37:29.143101 [debug] [MainThread]: Connection 'test.billy_bulky.not_null_int_sales_trends_sale_date.f72c75cc10' was properly closed.
[0m18:37:29.143262 [debug] [MainThread]: Connection 'test.billy_bulky.not_null_int_sales_trends_weekly_units_sold.5fb3438f7f' was properly closed.
[0m18:37:29.143421 [debug] [MainThread]: Connection 'test.billy_bulky.not_null_int_sales_trends_yearly_orders.e9720dbf16' was properly closed.
[0m18:37:29.143584 [debug] [MainThread]: Connection 'test.billy_bulky.not_null_int_sales_trends_yearly_sales_value.ebdab7a01e' was properly closed.
[0m18:37:29.143743 [debug] [MainThread]: Connection 'test.billy_bulky.unique_int_sales_trends_sale_date.9f7845245b' was properly closed.
[0m18:37:29.143901 [debug] [MainThread]: Connection 'test.billy_bulky.not_null_int_sales_trends_weekly_orders.9f9ad69d2c' was properly closed.
[0m18:37:29.144248 [error] [MainThread]: Encountered an error:
Runtime Error
  Compilation Error in test email_customers_email (models/staging/shopify/_shopify__schema.yml)
    'test_email' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m18:37:29.146246 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_wall_clock_time": 3.186075, "process_user_time": 4.315044, "process_kernel_time": 0.407462, "process_mem_max_rss": "210288640", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:37:29.146655 [debug] [MainThread]: Command `dbt compile` failed at 18:37:29.146570 after 3.19 seconds
[0m18:37:29.146926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070a1250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124a74be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123f62640>]}
[0m18:37:29.147176 [debug] [MainThread]: Flushing usage events
[0m18:38:09.879377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104be9eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080b8f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080b8790>]}


============================== 18:38:09.882484 | 3467e897-fcbf-47a6-b335-d74325fe1b84 ==============================
[0m18:38:09.882484 [info ] [MainThread]: Running with dbt=1.7.1
[0m18:38:09.882856 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/bitlevi/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/bitlevi/Documents/billy_bulky_ecommerce/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt compile', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:38:10.713911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3467e897-fcbf-47a6-b335-d74325fe1b84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080b87c0>]}
[0m18:38:10.761433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3467e897-fcbf-47a6-b335-d74325fe1b84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15aeda100>]}
[0m18:38:10.762050 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m18:38:10.775532 [debug] [MainThread]: checksum: ad428e6dc3b353dcb23d0c4ebea8b20b180e94b873271ac2a054a8e446dac0e2, vars: {}, profile: , target: , version: 1.7.1
[0m18:38:10.810242 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:38:10.810922 [debug] [MainThread]: Partial parsing: updated file: billy_bulky://models/staging/shopify/_shopify__schema.yml
[0m18:38:11.015735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3467e897-fcbf-47a6-b335-d74325fe1b84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15bd7f0d0>]}
[0m18:38:11.024899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3467e897-fcbf-47a6-b335-d74325fe1b84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15bb6afd0>]}
[0m18:38:11.025261 [info ] [MainThread]: Found 9 models, 19 tests, 3 sources, 0 exposures, 0 metrics, 431 macros, 0 groups, 0 semantic models
[0m18:38:11.025503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3467e897-fcbf-47a6-b335-d74325fe1b84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15bb6aeb0>]}
[0m18:38:11.028038 [info ] [MainThread]: 
[0m18:38:11.028817 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:38:11.029674 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_marts'
[0m18:38:11.039323 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_marts"
[0m18:38:11.039855 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_intermediate'
[0m18:38:11.040100 [debug] [ThreadPool]: On list_E_COMMERCE_marts: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE_marts"} */
show terse objects in E_COMMERCE.marts limit 10000
[0m18:38:11.041715 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_intermediate"
[0m18:38:11.041966 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:38:11.042169 [debug] [ThreadPool]: On list_E_COMMERCE_intermediate: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE_intermediate"} */
show terse objects in E_COMMERCE.intermediate limit 10000
[0m18:38:11.042670 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:38:12.948157 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.0 seconds
[0m18:38:12.951100 [debug] [ThreadPool]: On list_E_COMMERCE_marts: Close
[0m18:38:14.001449 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 3.0 seconds
[0m18:38:14.004198 [debug] [ThreadPool]: On list_E_COMMERCE_intermediate: Close
[0m18:38:14.478824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3467e897-fcbf-47a6-b335-d74325fe1b84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15bb6ad00>]}
[0m18:38:14.480482 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m18:38:14.481148 [info ] [MainThread]: 
[0m18:38:14.485406 [debug] [Thread-1  ]: Began running node model.billy_bulky.staging_shopify__customers
[0m18:38:14.486115 [debug] [Thread-2  ]: Began running node model.billy_bulky.staging_shopify__orders
[0m18:38:14.487447 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_E_COMMERCE_marts, now model.billy_bulky.staging_shopify__customers)
[0m18:38:14.488247 [debug] [Thread-3  ]: Began running node model.billy_bulky.staging_shopify__products
[0m18:38:14.489158 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_E_COMMERCE_intermediate, now model.billy_bulky.staging_shopify__orders)
[0m18:38:14.489739 [debug] [Thread-1  ]: Began compiling node model.billy_bulky.staging_shopify__customers
[0m18:38:14.490769 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.billy_bulky.staging_shopify__products'
[0m18:38:14.491327 [debug] [Thread-2  ]: Began compiling node model.billy_bulky.staging_shopify__orders
[0m18:38:14.502078 [debug] [Thread-1  ]: Writing injected SQL for node "model.billy_bulky.staging_shopify__customers"
[0m18:38:14.502644 [debug] [Thread-3  ]: Began compiling node model.billy_bulky.staging_shopify__products
[0m18:38:14.505939 [debug] [Thread-2  ]: Writing injected SQL for node "model.billy_bulky.staging_shopify__orders"
[0m18:38:14.509497 [debug] [Thread-3  ]: Writing injected SQL for node "model.billy_bulky.staging_shopify__products"
[0m18:38:14.510421 [debug] [Thread-1  ]: Timing info for model.billy_bulky.staging_shopify__customers (compile): 18:38:14.491685 => 18:38:14.510151
[0m18:38:14.511554 [debug] [Thread-1  ]: Finished running node model.billy_bulky.staging_shopify__customers
[0m18:38:14.512491 [debug] [Thread-3  ]: Timing info for model.billy_bulky.staging_shopify__products (compile): 18:38:14.506351 => 18:38:14.512206
[0m18:38:14.512999 [debug] [Thread-2  ]: Timing info for model.billy_bulky.staging_shopify__orders (compile): 18:38:14.503001 => 18:38:14.512775
[0m18:38:14.513778 [debug] [Thread-3  ]: Finished running node model.billy_bulky.staging_shopify__products
[0m18:38:14.514594 [debug] [Thread-2  ]: Finished running node model.billy_bulky.staging_shopify__orders
[0m18:38:14.515339 [debug] [Thread-5  ]: Began running node model.billy_bulky.customers
[0m18:38:14.515802 [debug] [Thread-6  ]: Began running node model.billy_bulky.int_customers_segmentation
[0m18:38:14.516508 [debug] [Thread-5  ]: Acquiring new snowflake connection 'model.billy_bulky.customers'
[0m18:38:14.516896 [debug] [Thread-7  ]: Began running node model.billy_bulky.int_products_performance
[0m18:38:14.517320 [debug] [Thread-8  ]: Began running node model.billy_bulky.int_sales_trends
[0m18:38:14.517980 [debug] [Thread-6  ]: Acquiring new snowflake connection 'model.billy_bulky.int_customers_segmentation'
[0m18:38:14.518339 [debug] [Thread-9  ]: Began running node model.billy_bulky.products
[0m18:38:14.518726 [debug] [Thread-10 ]: Began running node model.billy_bulky.sales
[0m18:38:14.519090 [debug] [Thread-5  ]: Began compiling node model.billy_bulky.customers
[0m18:38:14.519797 [debug] [Thread-7  ]: Acquiring new snowflake connection 'model.billy_bulky.int_products_performance'
[0m18:38:14.520481 [debug] [Thread-8  ]: Acquiring new snowflake connection 'model.billy_bulky.int_sales_trends'
[0m18:38:14.520834 [debug] [Thread-6  ]: Began compiling node model.billy_bulky.int_customers_segmentation
[0m18:38:14.521498 [debug] [Thread-9  ]: Acquiring new snowflake connection 'model.billy_bulky.products'
[0m18:38:14.522166 [debug] [Thread-10 ]: Acquiring new snowflake connection 'model.billy_bulky.sales'
[0m18:38:14.535170 [debug] [Thread-7  ]: Began compiling node model.billy_bulky.int_products_performance
[0m18:38:14.535688 [debug] [Thread-5  ]: Writing injected SQL for node "model.billy_bulky.customers"
[0m18:38:14.535993 [debug] [Thread-8  ]: Began compiling node model.billy_bulky.int_sales_trends
[0m18:38:14.548919 [debug] [Thread-9  ]: Began compiling node model.billy_bulky.products
[0m18:38:14.551601 [debug] [Thread-6  ]: Writing injected SQL for node "model.billy_bulky.int_customers_segmentation"
[0m18:38:14.551869 [debug] [Thread-10 ]: Began compiling node model.billy_bulky.sales
[0m18:38:14.562538 [debug] [Thread-7  ]: Writing injected SQL for node "model.billy_bulky.int_products_performance"
[0m18:38:14.582775 [debug] [Thread-9  ]: Writing injected SQL for node "model.billy_bulky.products"
[0m18:38:14.583659 [debug] [Thread-8  ]: Writing injected SQL for node "model.billy_bulky.int_sales_trends"
[0m18:38:14.591542 [debug] [Thread-10 ]: Writing injected SQL for node "model.billy_bulky.sales"
[0m18:38:14.591901 [debug] [Thread-5  ]: Timing info for model.billy_bulky.customers (compile): 18:38:14.522410 => 18:38:14.591752
[0m18:38:14.592467 [debug] [Thread-6  ]: Timing info for model.billy_bulky.int_customers_segmentation (compile): 18:38:14.536195 => 18:38:14.592322
[0m18:38:14.592705 [debug] [Thread-5  ]: Began executing node model.billy_bulky.customers
[0m18:38:14.593010 [debug] [Thread-6  ]: Began executing node model.billy_bulky.int_customers_segmentation
[0m18:38:14.593307 [debug] [Thread-7  ]: Timing info for model.billy_bulky.int_products_performance (compile): 18:38:14.552031 => 18:38:14.593183
[0m18:38:14.593546 [debug] [Thread-9  ]: Timing info for model.billy_bulky.products (compile): 18:38:14.569065 => 18:38:14.593435
[0m18:38:14.593806 [debug] [Thread-5  ]: Timing info for model.billy_bulky.customers (execute): 18:38:14.593689 => 18:38:14.593695
[0m18:38:14.594032 [debug] [Thread-8  ]: Timing info for model.billy_bulky.int_sales_trends (compile): 18:38:14.562775 => 18:38:14.593920
[0m18:38:14.594253 [debug] [Thread-10 ]: Timing info for model.billy_bulky.sales (compile): 18:38:14.583825 => 18:38:14.594146
[0m18:38:14.594511 [debug] [Thread-6  ]: Timing info for model.billy_bulky.int_customers_segmentation (execute): 18:38:14.594389 => 18:38:14.594392
[0m18:38:14.594748 [debug] [Thread-7  ]: Began executing node model.billy_bulky.int_products_performance
[0m18:38:14.594987 [debug] [Thread-9  ]: Began executing node model.billy_bulky.products
[0m18:38:14.595587 [debug] [Thread-5  ]: Finished running node model.billy_bulky.customers
[0m18:38:14.595832 [debug] [Thread-8  ]: Began executing node model.billy_bulky.int_sales_trends
[0m18:38:14.596091 [debug] [Thread-10 ]: Began executing node model.billy_bulky.sales
[0m18:38:14.596657 [debug] [Thread-6  ]: Finished running node model.billy_bulky.int_customers_segmentation
[0m18:38:14.596919 [debug] [Thread-7  ]: Timing info for model.billy_bulky.int_products_performance (execute): 18:38:14.596797 => 18:38:14.596800
[0m18:38:14.597172 [debug] [Thread-9  ]: Timing info for model.billy_bulky.products (execute): 18:38:14.597055 => 18:38:14.597058
[0m18:38:14.597626 [debug] [Thread-8  ]: Timing info for model.billy_bulky.int_sales_trends (execute): 18:38:14.597471 => 18:38:14.597476
[0m18:38:14.597874 [debug] [Thread-1  ]: Began running node test.billy_bulky.not_null_customers_customer_id.5c9bf9911d
[0m18:38:14.598110 [debug] [Thread-3  ]: Began running node test.billy_bulky.not_null_customers_email.da3cfcd534
[0m18:38:14.598336 [debug] [Thread-2  ]: Began running node test.billy_bulky.not_null_customers_join_date.faf8f07bc9
[0m18:38:14.598591 [debug] [Thread-10 ]: Timing info for model.billy_bulky.sales (execute): 18:38:14.598470 => 18:38:14.598473
[0m18:38:14.598811 [debug] [Thread-4  ]: Began running node test.billy_bulky.unique_customers_customer_id.c5af1ff4b1
[0m18:38:14.599139 [debug] [Thread-5  ]: Began running node test.billy_bulky.unique_customers_email.e77c92eb54
[0m18:38:14.599686 [debug] [Thread-7  ]: Finished running node model.billy_bulky.int_products_performance
[0m18:38:14.600182 [debug] [Thread-9  ]: Finished running node model.billy_bulky.products
[0m18:38:14.600670 [debug] [Thread-8  ]: Finished running node model.billy_bulky.int_sales_trends
[0m18:38:14.601049 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.billy_bulky.staging_shopify__customers, now test.billy_bulky.not_null_customers_customer_id.5c9bf9911d)
[0m18:38:14.601422 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.billy_bulky.staging_shopify__products, now test.billy_bulky.not_null_customers_email.da3cfcd534)
[0m18:38:14.601792 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.billy_bulky.staging_shopify__orders, now test.billy_bulky.not_null_customers_join_date.faf8f07bc9)
[0m18:38:14.602266 [debug] [Thread-10 ]: Finished running node model.billy_bulky.sales
[0m18:38:14.602660 [debug] [Thread-4  ]: Acquiring new snowflake connection 'test.billy_bulky.unique_customers_customer_id.c5af1ff4b1'
[0m18:38:14.603066 [debug] [Thread-5  ]: Re-using an available connection from the pool (formerly model.billy_bulky.customers, now test.billy_bulky.unique_customers_email.e77c92eb54)
[0m18:38:14.603610 [debug] [Thread-1  ]: Began compiling node test.billy_bulky.not_null_customers_customer_id.5c9bf9911d
[0m18:38:14.603840 [debug] [Thread-6  ]: Began running node test.billy_bulky.not_null_int_sales_trends_daily_orders.96da3a5baa
[0m18:38:14.604055 [debug] [Thread-3  ]: Began compiling node test.billy_bulky.not_null_customers_email.da3cfcd534
[0m18:38:14.604261 [debug] [Thread-7  ]: Began running node test.billy_bulky.not_null_int_sales_trends_daily_sales_value.070e4ffb27
[0m18:38:14.604466 [debug] [Thread-2  ]: Began compiling node test.billy_bulky.not_null_customers_join_date.faf8f07bc9
[0m18:38:14.604671 [debug] [Thread-9  ]: Began running node test.billy_bulky.not_null_int_sales_trends_daily_units_sold.cfceaad553
[0m18:38:14.604920 [debug] [Thread-10 ]: Began running node test.billy_bulky.not_null_int_sales_trends_monthly_orders.e6a6b6c9bd
[0m18:38:14.605131 [debug] [Thread-8  ]: Began running node test.billy_bulky.not_null_int_sales_trends_monthly_sales_value.bbb69f3d4a
[0m18:38:14.605364 [debug] [Thread-4  ]: Began compiling node test.billy_bulky.unique_customers_customer_id.c5af1ff4b1
[0m18:38:14.605569 [debug] [Thread-5  ]: Began compiling node test.billy_bulky.unique_customers_email.e77c92eb54
[0m18:38:14.611887 [debug] [Thread-6  ]: Re-using an available connection from the pool (formerly model.billy_bulky.int_customers_segmentation, now test.billy_bulky.not_null_int_sales_trends_daily_orders.96da3a5baa)
[0m18:38:14.613286 [debug] [Thread-1  ]: Writing injected SQL for node "test.billy_bulky.not_null_customers_customer_id.5c9bf9911d"
[0m18:38:14.615806 [debug] [Thread-3  ]: Writing injected SQL for node "test.billy_bulky.not_null_customers_email.da3cfcd534"
[0m18:38:14.616203 [debug] [Thread-7  ]: Re-using an available connection from the pool (formerly model.billy_bulky.int_products_performance, now test.billy_bulky.not_null_int_sales_trends_daily_sales_value.070e4ffb27)
[0m18:38:14.618654 [debug] [Thread-2  ]: Writing injected SQL for node "test.billy_bulky.not_null_customers_join_date.faf8f07bc9"
[0m18:38:14.619071 [debug] [Thread-9  ]: Re-using an available connection from the pool (formerly model.billy_bulky.products, now test.billy_bulky.not_null_int_sales_trends_daily_units_sold.cfceaad553)
[0m18:38:14.619449 [debug] [Thread-10 ]: Re-using an available connection from the pool (formerly model.billy_bulky.sales, now test.billy_bulky.not_null_int_sales_trends_monthly_orders.e6a6b6c9bd)
[0m18:38:14.619813 [debug] [Thread-8  ]: Re-using an available connection from the pool (formerly model.billy_bulky.int_sales_trends, now test.billy_bulky.not_null_int_sales_trends_monthly_sales_value.bbb69f3d4a)
[0m18:38:14.623595 [debug] [Thread-4  ]: Writing injected SQL for node "test.billy_bulky.unique_customers_customer_id.c5af1ff4b1"
[0m18:38:14.627190 [debug] [Thread-5  ]: Writing injected SQL for node "test.billy_bulky.unique_customers_email.e77c92eb54"
[0m18:38:14.627547 [debug] [Thread-6  ]: Began compiling node test.billy_bulky.not_null_int_sales_trends_daily_orders.96da3a5baa
[0m18:38:14.627938 [debug] [Thread-7  ]: Began compiling node test.billy_bulky.not_null_int_sales_trends_daily_sales_value.070e4ffb27
[0m18:38:14.628425 [debug] [Thread-3  ]: Timing info for test.billy_bulky.not_null_customers_email.da3cfcd534 (compile): 18:38:14.613452 => 18:38:14.628270
[0m18:38:14.628644 [debug] [Thread-9  ]: Began compiling node test.billy_bulky.not_null_int_sales_trends_daily_units_sold.cfceaad553
[0m18:38:14.628877 [debug] [Thread-2  ]: Timing info for test.billy_bulky.not_null_customers_join_date.faf8f07bc9 (compile): 18:38:14.616352 => 18:38:14.628764
[0m18:38:14.629108 [debug] [Thread-1  ]: Timing info for test.billy_bulky.not_null_customers_customer_id.5c9bf9911d (compile): 18:38:14.605704 => 18:38:14.628996
[0m18:38:14.629322 [debug] [Thread-10 ]: Began compiling node test.billy_bulky.not_null_int_sales_trends_monthly_orders.e6a6b6c9bd
[0m18:38:14.629534 [debug] [Thread-8  ]: Began compiling node test.billy_bulky.not_null_int_sales_trends_monthly_sales_value.bbb69f3d4a
[0m18:38:14.632246 [debug] [Thread-6  ]: Writing injected SQL for node "test.billy_bulky.not_null_int_sales_trends_daily_orders.96da3a5baa"
[0m18:38:14.634739 [debug] [Thread-7  ]: Writing injected SQL for node "test.billy_bulky.not_null_int_sales_trends_daily_sales_value.070e4ffb27"
[0m18:38:14.634992 [debug] [Thread-3  ]: Began executing node test.billy_bulky.not_null_customers_email.da3cfcd534
[0m18:38:14.635261 [debug] [Thread-4  ]: Timing info for test.billy_bulky.unique_customers_customer_id.c5af1ff4b1 (compile): 18:38:14.619974 => 18:38:14.635131
[0m18:38:14.635530 [debug] [Thread-5  ]: Timing info for test.billy_bulky.unique_customers_email.e77c92eb54 (compile): 18:38:14.623790 => 18:38:14.635412
[0m18:38:14.638060 [debug] [Thread-9  ]: Writing injected SQL for node "test.billy_bulky.not_null_int_sales_trends_daily_units_sold.cfceaad553"
[0m18:38:14.638336 [debug] [Thread-2  ]: Began executing node test.billy_bulky.not_null_customers_join_date.faf8f07bc9
[0m18:38:14.638581 [debug] [Thread-1  ]: Began executing node test.billy_bulky.not_null_customers_customer_id.5c9bf9911d
[0m18:38:14.641240 [debug] [Thread-10 ]: Writing injected SQL for node "test.billy_bulky.not_null_int_sales_trends_monthly_orders.e6a6b6c9bd"
[0m18:38:14.643730 [debug] [Thread-8  ]: Writing injected SQL for node "test.billy_bulky.not_null_int_sales_trends_monthly_sales_value.bbb69f3d4a"
[0m18:38:14.644178 [debug] [Thread-3  ]: Timing info for test.billy_bulky.not_null_customers_email.da3cfcd534 (execute): 18:38:14.644015 => 18:38:14.644023
[0m18:38:14.644448 [debug] [Thread-4  ]: Began executing node test.billy_bulky.unique_customers_customer_id.c5af1ff4b1
[0m18:38:14.644722 [debug] [Thread-5  ]: Began executing node test.billy_bulky.unique_customers_email.e77c92eb54
[0m18:38:14.645002 [debug] [Thread-6  ]: Timing info for test.billy_bulky.not_null_int_sales_trends_daily_orders.96da3a5baa (compile): 18:38:14.629741 => 18:38:14.644876
[0m18:38:14.645282 [debug] [Thread-7  ]: Timing info for test.billy_bulky.not_null_int_sales_trends_daily_sales_value.070e4ffb27 (compile): 18:38:14.632459 => 18:38:14.645151
[0m18:38:14.645576 [debug] [Thread-2  ]: Timing info for test.billy_bulky.not_null_customers_join_date.faf8f07bc9 (execute): 18:38:14.645436 => 18:38:14.645440
[0m18:38:14.645854 [debug] [Thread-1  ]: Timing info for test.billy_bulky.not_null_customers_customer_id.5c9bf9911d (execute): 18:38:14.645726 => 18:38:14.645730
[0m18:38:14.646146 [debug] [Thread-9  ]: Timing info for test.billy_bulky.not_null_int_sales_trends_daily_units_sold.cfceaad553 (compile): 18:38:14.635664 => 18:38:14.646023
[0m18:38:14.646758 [debug] [Thread-3  ]: Finished running node test.billy_bulky.not_null_customers_email.da3cfcd534
[0m18:38:14.647071 [debug] [Thread-10 ]: Timing info for test.billy_bulky.not_null_int_sales_trends_monthly_orders.e6a6b6c9bd (compile): 18:38:14.638734 => 18:38:14.646946
[0m18:38:14.647334 [debug] [Thread-4  ]: Timing info for test.billy_bulky.unique_customers_customer_id.c5af1ff4b1 (execute): 18:38:14.647205 => 18:38:14.647209
[0m18:38:14.647596 [debug] [Thread-8  ]: Timing info for test.billy_bulky.not_null_int_sales_trends_monthly_sales_value.bbb69f3d4a (compile): 18:38:14.641428 => 18:38:14.647466
[0m18:38:14.647872 [debug] [Thread-5  ]: Timing info for test.billy_bulky.unique_customers_email.e77c92eb54 (execute): 18:38:14.647746 => 18:38:14.647749
[0m18:38:14.648097 [debug] [Thread-6  ]: Began executing node test.billy_bulky.not_null_int_sales_trends_daily_orders.96da3a5baa
[0m18:38:14.648316 [debug] [Thread-7  ]: Began executing node test.billy_bulky.not_null_int_sales_trends_daily_sales_value.070e4ffb27
[0m18:38:14.648820 [debug] [Thread-2  ]: Finished running node test.billy_bulky.not_null_customers_join_date.faf8f07bc9
[0m18:38:14.649320 [debug] [Thread-1  ]: Finished running node test.billy_bulky.not_null_customers_customer_id.5c9bf9911d
[0m18:38:14.649541 [debug] [Thread-9  ]: Began executing node test.billy_bulky.not_null_int_sales_trends_daily_units_sold.cfceaad553
[0m18:38:14.649821 [debug] [Thread-3  ]: Began running node test.billy_bulky.not_null_int_sales_trends_monthly_units_sold.ee96488ac3
[0m18:38:14.650044 [debug] [Thread-10 ]: Began executing node test.billy_bulky.not_null_int_sales_trends_monthly_orders.e6a6b6c9bd
[0m18:38:14.650577 [debug] [Thread-4  ]: Finished running node test.billy_bulky.unique_customers_customer_id.c5af1ff4b1
[0m18:38:14.650794 [debug] [Thread-8  ]: Began executing node test.billy_bulky.not_null_int_sales_trends_monthly_sales_value.bbb69f3d4a
[0m18:38:14.651312 [debug] [Thread-5  ]: Finished running node test.billy_bulky.unique_customers_email.e77c92eb54
[0m18:38:14.651591 [debug] [Thread-6  ]: Timing info for test.billy_bulky.not_null_int_sales_trends_daily_orders.96da3a5baa (execute): 18:38:14.651462 => 18:38:14.651466
[0m18:38:14.651863 [debug] [Thread-7  ]: Timing info for test.billy_bulky.not_null_int_sales_trends_daily_sales_value.070e4ffb27 (execute): 18:38:14.651737 => 18:38:14.651740
[0m18:38:14.652131 [debug] [Thread-2  ]: Began running node test.billy_bulky.not_null_int_sales_trends_sale_date.f72c75cc10
[0m18:38:14.652400 [debug] [Thread-1  ]: Began running node test.billy_bulky.not_null_int_sales_trends_weekly_orders.9f9ad69d2c
[0m18:38:14.652683 [debug] [Thread-9  ]: Timing info for test.billy_bulky.not_null_int_sales_trends_daily_units_sold.cfceaad553 (execute): 18:38:14.652560 => 18:38:14.652563
[0m18:38:14.653064 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.billy_bulky.not_null_customers_email.da3cfcd534, now test.billy_bulky.not_null_int_sales_trends_monthly_units_sold.ee96488ac3)
[0m18:38:14.653507 [debug] [Thread-10 ]: Timing info for test.billy_bulky.not_null_int_sales_trends_monthly_orders.e6a6b6c9bd (execute): 18:38:14.653207 => 18:38:14.653210
[0m18:38:14.653762 [debug] [Thread-4  ]: Began running node test.billy_bulky.not_null_int_sales_trends_weekly_sales_value.502ef6aeae
[0m18:38:14.654052 [debug] [Thread-8  ]: Timing info for test.billy_bulky.not_null_int_sales_trends_monthly_sales_value.bbb69f3d4a (execute): 18:38:14.653924 => 18:38:14.653927
[0m18:38:14.654294 [debug] [Thread-5  ]: Began running node test.billy_bulky.not_null_int_sales_trends_weekly_units_sold.5fb3438f7f
[0m18:38:14.654811 [debug] [Thread-6  ]: Finished running node test.billy_bulky.not_null_int_sales_trends_daily_orders.96da3a5baa
[0m18:38:14.655303 [debug] [Thread-7  ]: Finished running node test.billy_bulky.not_null_int_sales_trends_daily_sales_value.070e4ffb27
[0m18:38:14.655672 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.billy_bulky.not_null_customers_join_date.faf8f07bc9, now test.billy_bulky.not_null_int_sales_trends_sale_date.f72c75cc10)
[0m18:38:14.656047 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.billy_bulky.not_null_customers_customer_id.5c9bf9911d, now test.billy_bulky.not_null_int_sales_trends_weekly_orders.9f9ad69d2c)
[0m18:38:14.656586 [debug] [Thread-9  ]: Finished running node test.billy_bulky.not_null_int_sales_trends_daily_units_sold.cfceaad553
[0m18:38:14.656838 [debug] [Thread-3  ]: Began compiling node test.billy_bulky.not_null_int_sales_trends_monthly_units_sold.ee96488ac3
[0m18:38:14.657367 [debug] [Thread-10 ]: Finished running node test.billy_bulky.not_null_int_sales_trends_monthly_orders.e6a6b6c9bd
[0m18:38:14.657747 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.billy_bulky.unique_customers_customer_id.c5af1ff4b1, now test.billy_bulky.not_null_int_sales_trends_weekly_sales_value.502ef6aeae)
[0m18:38:14.658287 [debug] [Thread-8  ]: Finished running node test.billy_bulky.not_null_int_sales_trends_monthly_sales_value.bbb69f3d4a
[0m18:38:14.658662 [debug] [Thread-5  ]: Re-using an available connection from the pool (formerly test.billy_bulky.unique_customers_email.e77c92eb54, now test.billy_bulky.not_null_int_sales_trends_weekly_units_sold.5fb3438f7f)
[0m18:38:14.658929 [debug] [Thread-6  ]: Began running node test.billy_bulky.not_null_int_sales_trends_yearly_orders.e9720dbf16
[0m18:38:14.659219 [debug] [Thread-7  ]: Began running node test.billy_bulky.not_null_int_sales_trends_yearly_sales_value.ebdab7a01e
[0m18:38:14.659460 [debug] [Thread-2  ]: Began compiling node test.billy_bulky.not_null_int_sales_trends_sale_date.f72c75cc10
[0m18:38:14.659684 [debug] [Thread-1  ]: Began compiling node test.billy_bulky.not_null_int_sales_trends_weekly_orders.9f9ad69d2c
[0m18:38:14.659941 [debug] [Thread-9  ]: Began running node test.billy_bulky.not_null_int_sales_trends_yearly_units_sold.758913b07d
[0m18:38:14.662749 [debug] [Thread-3  ]: Writing injected SQL for node "test.billy_bulky.not_null_int_sales_trends_monthly_units_sold.ee96488ac3"
[0m18:38:14.663040 [debug] [Thread-10 ]: Began running node test.billy_bulky.unique_int_sales_trends_sale_date.9f7845245b
[0m18:38:14.663265 [debug] [Thread-4  ]: Began compiling node test.billy_bulky.not_null_int_sales_trends_weekly_sales_value.502ef6aeae
[0m18:38:14.663550 [debug] [Thread-5  ]: Began compiling node test.billy_bulky.not_null_int_sales_trends_weekly_units_sold.5fb3438f7f
[0m18:38:14.663928 [debug] [Thread-6  ]: Re-using an available connection from the pool (formerly test.billy_bulky.not_null_int_sales_trends_daily_orders.96da3a5baa, now test.billy_bulky.not_null_int_sales_trends_yearly_orders.e9720dbf16)
[0m18:38:14.664297 [debug] [Thread-7  ]: Re-using an available connection from the pool (formerly test.billy_bulky.not_null_int_sales_trends_daily_sales_value.070e4ffb27, now test.billy_bulky.not_null_int_sales_trends_yearly_sales_value.ebdab7a01e)
[0m18:38:14.667501 [debug] [Thread-2  ]: Writing injected SQL for node "test.billy_bulky.not_null_int_sales_trends_sale_date.f72c75cc10"
[0m18:38:14.669969 [debug] [Thread-1  ]: Writing injected SQL for node "test.billy_bulky.not_null_int_sales_trends_weekly_orders.9f9ad69d2c"
[0m18:38:14.670399 [debug] [Thread-9  ]: Re-using an available connection from the pool (formerly test.billy_bulky.not_null_int_sales_trends_daily_units_sold.cfceaad553, now test.billy_bulky.not_null_int_sales_trends_yearly_units_sold.758913b07d)
[0m18:38:14.670928 [debug] [Thread-10 ]: Re-using an available connection from the pool (formerly test.billy_bulky.not_null_int_sales_trends_monthly_orders.e6a6b6c9bd, now test.billy_bulky.unique_int_sales_trends_sale_date.9f7845245b)
[0m18:38:14.673310 [debug] [Thread-4  ]: Writing injected SQL for node "test.billy_bulky.not_null_int_sales_trends_weekly_sales_value.502ef6aeae"
[0m18:38:14.675849 [debug] [Thread-5  ]: Writing injected SQL for node "test.billy_bulky.not_null_int_sales_trends_weekly_units_sold.5fb3438f7f"
[0m18:38:14.676184 [debug] [Thread-3  ]: Timing info for test.billy_bulky.not_null_int_sales_trends_monthly_units_sold.ee96488ac3 (compile): 18:38:14.660105 => 18:38:14.676043
[0m18:38:14.676420 [debug] [Thread-6  ]: Began compiling node test.billy_bulky.not_null_int_sales_trends_yearly_orders.e9720dbf16
[0m18:38:14.676664 [debug] [Thread-7  ]: Began compiling node test.billy_bulky.not_null_int_sales_trends_yearly_sales_value.ebdab7a01e
[0m18:38:14.676979 [debug] [Thread-9  ]: Began compiling node test.billy_bulky.not_null_int_sales_trends_yearly_units_sold.758913b07d
[0m18:38:14.677226 [debug] [Thread-10 ]: Began compiling node test.billy_bulky.unique_int_sales_trends_sale_date.9f7845245b
[0m18:38:14.677621 [debug] [Thread-2  ]: Timing info for test.billy_bulky.not_null_int_sales_trends_sale_date.f72c75cc10 (compile): 18:38:14.664437 => 18:38:14.677479
[0m18:38:14.677888 [debug] [Thread-1  ]: Timing info for test.billy_bulky.not_null_int_sales_trends_weekly_orders.9f9ad69d2c (compile): 18:38:14.667674 => 18:38:14.677758
[0m18:38:14.678170 [debug] [Thread-3  ]: Began executing node test.billy_bulky.not_null_int_sales_trends_monthly_units_sold.ee96488ac3
[0m18:38:14.678464 [debug] [Thread-4  ]: Timing info for test.billy_bulky.not_null_int_sales_trends_weekly_sales_value.502ef6aeae (compile): 18:38:14.671113 => 18:38:14.678336
[0m18:38:14.681014 [debug] [Thread-6  ]: Writing injected SQL for node "test.billy_bulky.not_null_int_sales_trends_yearly_orders.e9720dbf16"
[0m18:38:14.683411 [debug] [Thread-7  ]: Writing injected SQL for node "test.billy_bulky.not_null_int_sales_trends_yearly_sales_value.ebdab7a01e"
[0m18:38:14.683677 [debug] [Thread-5  ]: Timing info for test.billy_bulky.not_null_int_sales_trends_weekly_units_sold.5fb3438f7f (compile): 18:38:14.673512 => 18:38:14.683552
[0m18:38:14.686201 [debug] [Thread-9  ]: Writing injected SQL for node "test.billy_bulky.not_null_int_sales_trends_yearly_units_sold.758913b07d"
[0m18:38:14.689365 [debug] [Thread-10 ]: Writing injected SQL for node "test.billy_bulky.unique_int_sales_trends_sale_date.9f7845245b"
[0m18:38:14.689618 [debug] [Thread-2  ]: Began executing node test.billy_bulky.not_null_int_sales_trends_sale_date.f72c75cc10
[0m18:38:14.689848 [debug] [Thread-1  ]: Began executing node test.billy_bulky.not_null_int_sales_trends_weekly_orders.9f9ad69d2c
[0m18:38:14.690143 [debug] [Thread-3  ]: Timing info for test.billy_bulky.not_null_int_sales_trends_monthly_units_sold.ee96488ac3 (execute): 18:38:14.690004 => 18:38:14.690011
[0m18:38:14.690377 [debug] [Thread-4  ]: Began executing node test.billy_bulky.not_null_int_sales_trends_weekly_sales_value.502ef6aeae
[0m18:38:14.690700 [debug] [Thread-5  ]: Began executing node test.billy_bulky.not_null_int_sales_trends_weekly_units_sold.5fb3438f7f
[0m18:38:14.691139 [debug] [Thread-6  ]: Timing info for test.billy_bulky.not_null_int_sales_trends_yearly_orders.e9720dbf16 (compile): 18:38:14.678599 => 18:38:14.691008
[0m18:38:14.691390 [debug] [Thread-7  ]: Timing info for test.billy_bulky.not_null_int_sales_trends_yearly_sales_value.ebdab7a01e (compile): 18:38:14.681194 => 18:38:14.691272
[0m18:38:14.691720 [debug] [Thread-2  ]: Timing info for test.billy_bulky.not_null_int_sales_trends_sale_date.f72c75cc10 (execute): 18:38:14.691591 => 18:38:14.691597
[0m18:38:14.691987 [debug] [Thread-9  ]: Timing info for test.billy_bulky.not_null_int_sales_trends_yearly_units_sold.758913b07d (compile): 18:38:14.683829 => 18:38:14.691867
[0m18:38:14.692273 [debug] [Thread-1  ]: Timing info for test.billy_bulky.not_null_int_sales_trends_weekly_orders.9f9ad69d2c (execute): 18:38:14.692127 => 18:38:14.692132
[0m18:38:14.692919 [debug] [Thread-3  ]: Finished running node test.billy_bulky.not_null_int_sales_trends_monthly_units_sold.ee96488ac3
[0m18:38:14.693198 [debug] [Thread-4  ]: Timing info for test.billy_bulky.not_null_int_sales_trends_weekly_sales_value.502ef6aeae (execute): 18:38:14.693075 => 18:38:14.693079
[0m18:38:14.693459 [debug] [Thread-10 ]: Timing info for test.billy_bulky.unique_int_sales_trends_sale_date.9f7845245b (compile): 18:38:14.686367 => 18:38:14.693324
[0m18:38:14.693717 [debug] [Thread-5  ]: Timing info for test.billy_bulky.not_null_int_sales_trends_weekly_units_sold.5fb3438f7f (execute): 18:38:14.693600 => 18:38:14.693603
[0m18:38:14.693938 [debug] [Thread-6  ]: Began executing node test.billy_bulky.not_null_int_sales_trends_yearly_orders.e9720dbf16
[0m18:38:14.694154 [debug] [Thread-7  ]: Began executing node test.billy_bulky.not_null_int_sales_trends_yearly_sales_value.ebdab7a01e
[0m18:38:14.694665 [debug] [Thread-2  ]: Finished running node test.billy_bulky.not_null_int_sales_trends_sale_date.f72c75cc10
[0m18:38:14.694887 [debug] [Thread-9  ]: Began executing node test.billy_bulky.not_null_int_sales_trends_yearly_units_sold.758913b07d
[0m18:38:14.695387 [debug] [Thread-1  ]: Finished running node test.billy_bulky.not_null_int_sales_trends_weekly_orders.9f9ad69d2c
[0m18:38:14.695942 [debug] [Thread-4  ]: Finished running node test.billy_bulky.not_null_int_sales_trends_weekly_sales_value.502ef6aeae
[0m18:38:14.696157 [debug] [Thread-10 ]: Began executing node test.billy_bulky.unique_int_sales_trends_sale_date.9f7845245b
[0m18:38:14.696660 [debug] [Thread-5  ]: Finished running node test.billy_bulky.not_null_int_sales_trends_weekly_units_sold.5fb3438f7f
[0m18:38:14.696916 [debug] [Thread-6  ]: Timing info for test.billy_bulky.not_null_int_sales_trends_yearly_orders.e9720dbf16 (execute): 18:38:14.696795 => 18:38:14.696799
[0m18:38:14.697185 [debug] [Thread-7  ]: Timing info for test.billy_bulky.not_null_int_sales_trends_yearly_sales_value.ebdab7a01e (execute): 18:38:14.697060 => 18:38:14.697064
[0m18:38:14.697507 [debug] [Thread-9  ]: Timing info for test.billy_bulky.not_null_int_sales_trends_yearly_units_sold.758913b07d (execute): 18:38:14.697381 => 18:38:14.697384
[0m18:38:14.697858 [debug] [Thread-10 ]: Timing info for test.billy_bulky.unique_int_sales_trends_sale_date.9f7845245b (execute): 18:38:14.697733 => 18:38:14.697736
[0m18:38:14.698411 [debug] [Thread-6  ]: Finished running node test.billy_bulky.not_null_int_sales_trends_yearly_orders.e9720dbf16
[0m18:38:14.698936 [debug] [Thread-7  ]: Finished running node test.billy_bulky.not_null_int_sales_trends_yearly_sales_value.ebdab7a01e
[0m18:38:14.699432 [debug] [Thread-9  ]: Finished running node test.billy_bulky.not_null_int_sales_trends_yearly_units_sold.758913b07d
[0m18:38:14.699918 [debug] [Thread-10 ]: Finished running node test.billy_bulky.unique_int_sales_trends_sale_date.9f7845245b
[0m18:38:14.700663 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:38:14.700865 [debug] [MainThread]: Connection 'test.billy_bulky.not_null_int_sales_trends_weekly_orders.9f9ad69d2c' was properly closed.
[0m18:38:14.701045 [debug] [MainThread]: Connection 'test.billy_bulky.not_null_int_sales_trends_sale_date.f72c75cc10' was properly closed.
[0m18:38:14.701219 [debug] [MainThread]: Connection 'test.billy_bulky.not_null_int_sales_trends_monthly_units_sold.ee96488ac3' was properly closed.
[0m18:38:14.701381 [debug] [MainThread]: Connection 'test.billy_bulky.not_null_int_sales_trends_weekly_units_sold.5fb3438f7f' was properly closed.
[0m18:38:14.701540 [debug] [MainThread]: Connection 'test.billy_bulky.not_null_int_sales_trends_yearly_orders.e9720dbf16' was properly closed.
[0m18:38:14.701698 [debug] [MainThread]: Connection 'test.billy_bulky.not_null_int_sales_trends_yearly_sales_value.ebdab7a01e' was properly closed.
[0m18:38:14.701862 [debug] [MainThread]: Connection 'test.billy_bulky.not_null_int_sales_trends_monthly_sales_value.bbb69f3d4a' was properly closed.
[0m18:38:14.702022 [debug] [MainThread]: Connection 'test.billy_bulky.not_null_int_sales_trends_yearly_units_sold.758913b07d' was properly closed.
[0m18:38:14.702178 [debug] [MainThread]: Connection 'test.billy_bulky.unique_int_sales_trends_sale_date.9f7845245b' was properly closed.
[0m18:38:14.702334 [debug] [MainThread]: Connection 'test.billy_bulky.not_null_int_sales_trends_weekly_sales_value.502ef6aeae' was properly closed.
[0m18:38:14.704174 [debug] [MainThread]: Command end result
[0m18:38:14.714030 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 4.871522, "process_user_time": 4.412036, "process_kernel_time": 0.392753, "process_mem_max_rss": "214335488", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:38:14.714413 [debug] [MainThread]: Command `dbt compile` succeeded at 18:38:14.714338 after 4.87 seconds
[0m18:38:14.714642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104be9eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15af29b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15c553700>]}
[0m18:38:14.714894 [debug] [MainThread]: Flushing usage events
[0m18:38:24.335326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107395250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10514c490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109be4760>]}


============================== 18:38:24.337953 | a0b7e568-7486-4778-a436-9811e2da66d8 ==============================
[0m18:38:24.337953 [info ] [MainThread]: Running with dbt=1.7.1
[0m18:38:24.338305 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/bitlevi/.dbt', 'log_path': '/Users/bitlevi/Documents/billy_bulky_ecommerce/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt docs generate', 'send_anonymous_usage_stats': 'True'}
[0m18:38:24.943204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a0b7e568-7486-4778-a436-9811e2da66d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10514c490>]}
[0m18:38:24.992477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a0b7e568-7486-4778-a436-9811e2da66d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ff2bd00>]}
[0m18:38:24.993223 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m18:38:25.004544 [debug] [MainThread]: checksum: ad428e6dc3b353dcb23d0c4ebea8b20b180e94b873271ac2a054a8e446dac0e2, vars: {}, profile: , target: , version: 1.7.1
[0m18:38:25.040591 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:38:25.040964 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:38:25.046524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a0b7e568-7486-4778-a436-9811e2da66d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1207149a0>]}
[0m18:38:25.049690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a0b7e568-7486-4778-a436-9811e2da66d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1205d6640>]}
[0m18:38:25.049984 [info ] [MainThread]: Found 9 models, 19 tests, 3 sources, 0 exposures, 0 metrics, 431 macros, 0 groups, 0 semantic models
[0m18:38:25.050218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a0b7e568-7486-4778-a436-9811e2da66d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1205d66a0>]}
[0m18:38:25.051696 [info ] [MainThread]: 
[0m18:38:25.052202 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:38:25.052964 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_intermediate'
[0m18:38:25.063010 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_intermediate"
[0m18:38:25.063630 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_marts'
[0m18:38:25.063853 [debug] [ThreadPool]: On list_E_COMMERCE_intermediate: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE_intermediate"} */
show terse objects in E_COMMERCE.intermediate limit 10000
[0m18:38:25.065474 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_marts"
[0m18:38:25.065687 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:38:25.065884 [debug] [ThreadPool]: On list_E_COMMERCE_marts: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE_marts"} */
show terse objects in E_COMMERCE.marts limit 10000
[0m18:38:25.066965 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:38:26.374668 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m18:38:26.377982 [debug] [ThreadPool]: On list_E_COMMERCE_intermediate: Close
[0m18:38:26.381976 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m18:38:26.385146 [debug] [ThreadPool]: On list_E_COMMERCE_marts: Close
[0m18:38:26.980694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a0b7e568-7486-4778-a436-9811e2da66d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ffbfbe0>]}
[0m18:38:26.982208 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m18:38:26.982862 [info ] [MainThread]: 
[0m18:38:26.987884 [debug] [Thread-1  ]: Began running node model.billy_bulky.staging_shopify__customers
[0m18:38:26.989286 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_E_COMMERCE_intermediate, now model.billy_bulky.staging_shopify__customers)
[0m18:38:26.990261 [debug] [Thread-1  ]: Began compiling node model.billy_bulky.staging_shopify__customers
[0m18:38:26.990901 [debug] [Thread-3  ]: Began running node model.billy_bulky.staging_shopify__orders
[0m18:38:26.997939 [debug] [Thread-4  ]: Began running node model.billy_bulky.staging_shopify__products
[0m18:38:27.003281 [debug] [Thread-1  ]: Writing injected SQL for node "model.billy_bulky.staging_shopify__customers"
[0m18:38:27.004424 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.billy_bulky.staging_shopify__orders'
[0m18:38:27.005311 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.billy_bulky.staging_shopify__products'
[0m18:38:27.005891 [debug] [Thread-3  ]: Began compiling node model.billy_bulky.staging_shopify__orders
[0m18:38:27.006459 [debug] [Thread-4  ]: Began compiling node model.billy_bulky.staging_shopify__products
[0m18:38:27.010422 [debug] [Thread-3  ]: Writing injected SQL for node "model.billy_bulky.staging_shopify__orders"
[0m18:38:27.011163 [debug] [Thread-1  ]: Timing info for model.billy_bulky.staging_shopify__customers (compile): 18:38:26.991264 => 18:38:27.010880
[0m18:38:27.014558 [debug] [Thread-4  ]: Writing injected SQL for node "model.billy_bulky.staging_shopify__products"
[0m18:38:27.015632 [debug] [Thread-1  ]: Finished running node model.billy_bulky.staging_shopify__customers
[0m18:38:27.016357 [debug] [Thread-3  ]: Timing info for model.billy_bulky.staging_shopify__orders (compile): 18:38:27.006817 => 18:38:27.016116
[0m18:38:27.017250 [debug] [Thread-3  ]: Finished running node model.billy_bulky.staging_shopify__orders
[0m18:38:27.017800 [debug] [Thread-4  ]: Timing info for model.billy_bulky.staging_shopify__products (compile): 18:38:27.011468 => 18:38:27.017576
[0m18:38:27.018632 [debug] [Thread-4  ]: Finished running node model.billy_bulky.staging_shopify__products
[0m18:38:27.019472 [debug] [Thread-6  ]: Began running node model.billy_bulky.customers
[0m18:38:27.019963 [debug] [Thread-7  ]: Began running node model.billy_bulky.int_customers_segmentation
[0m18:38:27.020416 [debug] [Thread-8  ]: Began running node model.billy_bulky.int_products_performance
[0m18:38:27.021167 [debug] [Thread-6  ]: Acquiring new snowflake connection 'model.billy_bulky.customers'
[0m18:38:27.021529 [debug] [Thread-9  ]: Began running node model.billy_bulky.int_sales_trends
[0m18:38:27.021917 [debug] [Thread-10 ]: Began running node model.billy_bulky.products
[0m18:38:27.022266 [debug] [Thread-2  ]: Began running node model.billy_bulky.sales
[0m18:38:27.022893 [debug] [Thread-7  ]: Acquiring new snowflake connection 'model.billy_bulky.int_customers_segmentation'
[0m18:38:27.023531 [debug] [Thread-8  ]: Acquiring new snowflake connection 'model.billy_bulky.int_products_performance'
[0m18:38:27.023899 [debug] [Thread-6  ]: Began compiling node model.billy_bulky.customers
[0m18:38:27.024578 [debug] [Thread-9  ]: Acquiring new snowflake connection 'model.billy_bulky.int_sales_trends'
[0m18:38:27.025277 [debug] [Thread-10 ]: Acquiring new snowflake connection 'model.billy_bulky.products'
[0m18:38:27.025893 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_E_COMMERCE_marts, now model.billy_bulky.sales)
[0m18:38:27.026305 [debug] [Thread-7  ]: Began compiling node model.billy_bulky.int_customers_segmentation
[0m18:38:27.026689 [debug] [Thread-8  ]: Began compiling node model.billy_bulky.int_products_performance
[0m18:38:27.039551 [debug] [Thread-9  ]: Began compiling node model.billy_bulky.int_sales_trends
[0m18:38:27.039325 [debug] [Thread-6  ]: Writing injected SQL for node "model.billy_bulky.customers"
[0m18:38:27.039948 [debug] [Thread-10 ]: Began compiling node model.billy_bulky.products
[0m18:38:27.040228 [debug] [Thread-2  ]: Began compiling node model.billy_bulky.sales
[0m18:38:27.063116 [debug] [Thread-8  ]: Writing injected SQL for node "model.billy_bulky.int_products_performance"
[0m18:38:27.067710 [debug] [Thread-7  ]: Writing injected SQL for node "model.billy_bulky.int_customers_segmentation"
[0m18:38:27.081347 [debug] [Thread-9  ]: Writing injected SQL for node "model.billy_bulky.int_sales_trends"
[0m18:38:27.087733 [debug] [Thread-10 ]: Writing injected SQL for node "model.billy_bulky.products"
[0m18:38:27.094404 [debug] [Thread-6  ]: Timing info for model.billy_bulky.customers (compile): 18:38:27.026922 => 18:38:27.094236
[0m18:38:27.095772 [debug] [Thread-2  ]: Writing injected SQL for node "model.billy_bulky.sales"
[0m18:38:27.096324 [debug] [Thread-6  ]: Began executing node model.billy_bulky.customers
[0m18:38:27.096681 [debug] [Thread-7  ]: Timing info for model.billy_bulky.int_customers_segmentation (compile): 18:38:27.040405 => 18:38:27.096521
[0m18:38:27.096995 [debug] [Thread-9  ]: Timing info for model.billy_bulky.int_sales_trends (compile): 18:38:27.067871 => 18:38:27.096843
[0m18:38:27.097308 [debug] [Thread-8  ]: Timing info for model.billy_bulky.int_products_performance (compile): 18:38:27.052036 => 18:38:27.097177
[0m18:38:27.097578 [debug] [Thread-10 ]: Timing info for model.billy_bulky.products (compile): 18:38:27.081543 => 18:38:27.097444
[0m18:38:27.097844 [debug] [Thread-6  ]: Timing info for model.billy_bulky.customers (execute): 18:38:27.097717 => 18:38:27.097723
[0m18:38:27.098089 [debug] [Thread-7  ]: Began executing node model.billy_bulky.int_customers_segmentation
[0m18:38:27.098337 [debug] [Thread-2  ]: Timing info for model.billy_bulky.sales (compile): 18:38:27.087947 => 18:38:27.098218
[0m18:38:27.098555 [debug] [Thread-9  ]: Began executing node model.billy_bulky.int_sales_trends
[0m18:38:27.098794 [debug] [Thread-8  ]: Began executing node model.billy_bulky.int_products_performance
[0m18:38:27.099008 [debug] [Thread-10 ]: Began executing node model.billy_bulky.products
[0m18:38:27.099587 [debug] [Thread-6  ]: Finished running node model.billy_bulky.customers
[0m18:38:27.099872 [debug] [Thread-7  ]: Timing info for model.billy_bulky.int_customers_segmentation (execute): 18:38:27.099741 => 18:38:27.099745
[0m18:38:27.100097 [debug] [Thread-2  ]: Began executing node model.billy_bulky.sales
[0m18:38:27.100365 [debug] [Thread-9  ]: Timing info for model.billy_bulky.int_sales_trends (execute): 18:38:27.100241 => 18:38:27.100244
[0m18:38:27.100634 [debug] [Thread-8  ]: Timing info for model.billy_bulky.int_products_performance (execute): 18:38:27.100507 => 18:38:27.100511
[0m18:38:27.100895 [debug] [Thread-10 ]: Timing info for model.billy_bulky.products (execute): 18:38:27.100780 => 18:38:27.100783
[0m18:38:27.101517 [debug] [Thread-7  ]: Finished running node model.billy_bulky.int_customers_segmentation
[0m18:38:27.102861 [debug] [Thread-1  ]: Began running node test.billy_bulky.not_null_customers_customer_id.5c9bf9911d
[0m18:38:27.103120 [debug] [Thread-2  ]: Timing info for model.billy_bulky.sales (execute): 18:38:27.102995 => 18:38:27.102998
[0m18:38:27.103348 [debug] [Thread-3  ]: Began running node test.billy_bulky.not_null_customers_email.da3cfcd534
[0m18:38:27.103575 [debug] [Thread-4  ]: Began running node test.billy_bulky.not_null_customers_join_date.faf8f07bc9
[0m18:38:27.103794 [debug] [Thread-5  ]: Began running node test.billy_bulky.unique_customers_customer_id.c5af1ff4b1
[0m18:38:27.104017 [debug] [Thread-6  ]: Began running node test.billy_bulky.unique_customers_email.e77c92eb54
[0m18:38:27.104507 [debug] [Thread-9  ]: Finished running node model.billy_bulky.int_sales_trends
[0m18:38:27.104992 [debug] [Thread-8  ]: Finished running node model.billy_bulky.int_products_performance
[0m18:38:27.105469 [debug] [Thread-10 ]: Finished running node model.billy_bulky.products
[0m18:38:27.105895 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.billy_bulky.staging_shopify__customers, now test.billy_bulky.not_null_customers_customer_id.5c9bf9911d)
[0m18:38:27.106379 [debug] [Thread-2  ]: Finished running node model.billy_bulky.sales
[0m18:38:27.106812 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.billy_bulky.staging_shopify__orders, now test.billy_bulky.not_null_customers_email.da3cfcd534)
[0m18:38:27.107215 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.billy_bulky.staging_shopify__products, now test.billy_bulky.not_null_customers_join_date.faf8f07bc9)
[0m18:38:27.107658 [debug] [Thread-5  ]: Acquiring new snowflake connection 'test.billy_bulky.unique_customers_customer_id.c5af1ff4b1'
[0m18:38:27.108049 [debug] [Thread-6  ]: Re-using an available connection from the pool (formerly model.billy_bulky.customers, now test.billy_bulky.unique_customers_email.e77c92eb54)
[0m18:38:27.108684 [debug] [Thread-7  ]: Began running node test.billy_bulky.not_null_int_sales_trends_daily_orders.96da3a5baa
[0m18:38:27.108897 [debug] [Thread-1  ]: Began compiling node test.billy_bulky.not_null_customers_customer_id.5c9bf9911d
[0m18:38:27.109109 [debug] [Thread-9  ]: Began running node test.billy_bulky.not_null_int_sales_trends_daily_sales_value.070e4ffb27
[0m18:38:27.109343 [debug] [Thread-2  ]: Began running node test.billy_bulky.not_null_int_sales_trends_daily_units_sold.cfceaad553
[0m18:38:27.109547 [debug] [Thread-8  ]: Began running node test.billy_bulky.not_null_int_sales_trends_monthly_orders.e6a6b6c9bd
[0m18:38:27.109753 [debug] [Thread-3  ]: Began compiling node test.billy_bulky.not_null_customers_email.da3cfcd534
[0m18:38:27.109976 [debug] [Thread-10 ]: Began running node test.billy_bulky.not_null_int_sales_trends_monthly_sales_value.bbb69f3d4a
[0m18:38:27.110182 [debug] [Thread-4  ]: Began compiling node test.billy_bulky.not_null_customers_join_date.faf8f07bc9
[0m18:38:27.110384 [debug] [Thread-5  ]: Began compiling node test.billy_bulky.unique_customers_customer_id.c5af1ff4b1
[0m18:38:27.110582 [debug] [Thread-6  ]: Began compiling node test.billy_bulky.unique_customers_email.e77c92eb54
[0m18:38:27.110935 [debug] [Thread-7  ]: Re-using an available connection from the pool (formerly model.billy_bulky.int_customers_segmentation, now test.billy_bulky.not_null_int_sales_trends_daily_orders.96da3a5baa)
[0m18:38:27.118078 [debug] [Thread-1  ]: Writing injected SQL for node "test.billy_bulky.not_null_customers_customer_id.5c9bf9911d"
[0m18:38:27.118467 [debug] [Thread-9  ]: Re-using an available connection from the pool (formerly model.billy_bulky.int_sales_trends, now test.billy_bulky.not_null_int_sales_trends_daily_sales_value.070e4ffb27)
[0m18:38:27.118836 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.billy_bulky.sales, now test.billy_bulky.not_null_int_sales_trends_daily_units_sold.cfceaad553)
[0m18:38:27.119186 [debug] [Thread-8  ]: Re-using an available connection from the pool (formerly model.billy_bulky.int_products_performance, now test.billy_bulky.not_null_int_sales_trends_monthly_orders.e6a6b6c9bd)
[0m18:38:27.121622 [debug] [Thread-3  ]: Writing injected SQL for node "test.billy_bulky.not_null_customers_email.da3cfcd534"
[0m18:38:27.122008 [debug] [Thread-10 ]: Re-using an available connection from the pool (formerly model.billy_bulky.products, now test.billy_bulky.not_null_int_sales_trends_monthly_sales_value.bbb69f3d4a)
[0m18:38:27.124503 [debug] [Thread-4  ]: Writing injected SQL for node "test.billy_bulky.not_null_customers_join_date.faf8f07bc9"
[0m18:38:27.128145 [debug] [Thread-5  ]: Writing injected SQL for node "test.billy_bulky.unique_customers_customer_id.c5af1ff4b1"
[0m18:38:27.130389 [debug] [Thread-6  ]: Writing injected SQL for node "test.billy_bulky.unique_customers_email.e77c92eb54"
[0m18:38:27.130636 [debug] [Thread-7  ]: Began compiling node test.billy_bulky.not_null_int_sales_trends_daily_orders.96da3a5baa
[0m18:38:27.130945 [debug] [Thread-9  ]: Began compiling node test.billy_bulky.not_null_int_sales_trends_daily_sales_value.070e4ffb27
[0m18:38:27.131224 [debug] [Thread-2  ]: Began compiling node test.billy_bulky.not_null_int_sales_trends_daily_units_sold.cfceaad553
[0m18:38:27.131454 [debug] [Thread-8  ]: Began compiling node test.billy_bulky.not_null_int_sales_trends_monthly_orders.e6a6b6c9bd
[0m18:38:27.131760 [debug] [Thread-10 ]: Began compiling node test.billy_bulky.not_null_int_sales_trends_monthly_sales_value.bbb69f3d4a
[0m18:38:27.132044 [debug] [Thread-1  ]: Timing info for test.billy_bulky.not_null_customers_customer_id.5c9bf9911d (compile): 18:38:27.111072 => 18:38:27.131917
[0m18:38:27.132335 [debug] [Thread-3  ]: Timing info for test.billy_bulky.not_null_customers_email.da3cfcd534 (compile): 18:38:27.119325 => 18:38:27.132205
[0m18:38:27.132752 [debug] [Thread-5  ]: Timing info for test.billy_bulky.unique_customers_customer_id.c5af1ff4b1 (compile): 18:38:27.124692 => 18:38:27.132617
[0m18:38:27.133083 [debug] [Thread-4  ]: Timing info for test.billy_bulky.not_null_customers_join_date.faf8f07bc9 (compile): 18:38:27.122151 => 18:38:27.132953
[0m18:38:27.135634 [debug] [Thread-7  ]: Writing injected SQL for node "test.billy_bulky.not_null_int_sales_trends_daily_orders.96da3a5baa"
[0m18:38:27.138769 [debug] [Thread-9  ]: Writing injected SQL for node "test.billy_bulky.not_null_int_sales_trends_daily_sales_value.070e4ffb27"
[0m18:38:27.141266 [debug] [Thread-2  ]: Writing injected SQL for node "test.billy_bulky.not_null_int_sales_trends_daily_units_sold.cfceaad553"
[0m18:38:27.141574 [debug] [Thread-6  ]: Timing info for test.billy_bulky.unique_customers_email.e77c92eb54 (compile): 18:38:27.128311 => 18:38:27.141439
[0m18:38:27.143978 [debug] [Thread-8  ]: Writing injected SQL for node "test.billy_bulky.not_null_int_sales_trends_monthly_orders.e6a6b6c9bd"
[0m18:38:27.146438 [debug] [Thread-10 ]: Writing injected SQL for node "test.billy_bulky.not_null_int_sales_trends_monthly_sales_value.bbb69f3d4a"
[0m18:38:27.146694 [debug] [Thread-1  ]: Began executing node test.billy_bulky.not_null_customers_customer_id.5c9bf9911d
[0m18:38:27.146938 [debug] [Thread-3  ]: Began executing node test.billy_bulky.not_null_customers_email.da3cfcd534
[0m18:38:27.147169 [debug] [Thread-5  ]: Began executing node test.billy_bulky.unique_customers_customer_id.c5af1ff4b1
[0m18:38:27.147391 [debug] [Thread-4  ]: Began executing node test.billy_bulky.not_null_customers_join_date.faf8f07bc9
[0m18:38:27.147744 [debug] [Thread-6  ]: Began executing node test.billy_bulky.unique_customers_email.e77c92eb54
[0m18:38:27.148143 [debug] [Thread-7  ]: Timing info for test.billy_bulky.not_null_int_sales_trends_daily_orders.96da3a5baa (compile): 18:38:27.133253 => 18:38:27.148008
[0m18:38:27.148448 [debug] [Thread-2  ]: Timing info for test.billy_bulky.not_null_int_sales_trends_daily_units_sold.cfceaad553 (compile): 18:38:27.138953 => 18:38:27.148315
[0m18:38:27.148759 [debug] [Thread-8  ]: Timing info for test.billy_bulky.not_null_int_sales_trends_monthly_orders.e6a6b6c9bd (compile): 18:38:27.141711 => 18:38:27.148631
[0m18:38:27.149022 [debug] [Thread-1  ]: Timing info for test.billy_bulky.not_null_customers_customer_id.5c9bf9911d (execute): 18:38:27.148899 => 18:38:27.148905
[0m18:38:27.149306 [debug] [Thread-9  ]: Timing info for test.billy_bulky.not_null_int_sales_trends_daily_sales_value.070e4ffb27 (compile): 18:38:27.135805 => 18:38:27.149169
[0m18:38:27.149565 [debug] [Thread-3  ]: Timing info for test.billy_bulky.not_null_customers_email.da3cfcd534 (execute): 18:38:27.149444 => 18:38:27.149447
[0m18:38:27.149803 [debug] [Thread-10 ]: Timing info for test.billy_bulky.not_null_int_sales_trends_monthly_sales_value.bbb69f3d4a (compile): 18:38:27.144154 => 18:38:27.149686
[0m18:38:27.150054 [debug] [Thread-5  ]: Timing info for test.billy_bulky.unique_customers_customer_id.c5af1ff4b1 (execute): 18:38:27.149939 => 18:38:27.149942
[0m18:38:27.150305 [debug] [Thread-4  ]: Timing info for test.billy_bulky.not_null_customers_join_date.faf8f07bc9 (execute): 18:38:27.150186 => 18:38:27.150190
[0m18:38:27.150549 [debug] [Thread-6  ]: Timing info for test.billy_bulky.unique_customers_email.e77c92eb54 (execute): 18:38:27.150439 => 18:38:27.150441
[0m18:38:27.150760 [debug] [Thread-7  ]: Began executing node test.billy_bulky.not_null_int_sales_trends_daily_orders.96da3a5baa
[0m18:38:27.150976 [debug] [Thread-2  ]: Began executing node test.billy_bulky.not_null_int_sales_trends_daily_units_sold.cfceaad553
[0m18:38:27.151191 [debug] [Thread-8  ]: Began executing node test.billy_bulky.not_null_int_sales_trends_monthly_orders.e6a6b6c9bd
[0m18:38:27.151716 [debug] [Thread-1  ]: Finished running node test.billy_bulky.not_null_customers_customer_id.5c9bf9911d
[0m18:38:27.151936 [debug] [Thread-9  ]: Began executing node test.billy_bulky.not_null_int_sales_trends_daily_sales_value.070e4ffb27
[0m18:38:27.152442 [debug] [Thread-3  ]: Finished running node test.billy_bulky.not_null_customers_email.da3cfcd534
[0m18:38:27.152666 [debug] [Thread-10 ]: Began executing node test.billy_bulky.not_null_int_sales_trends_monthly_sales_value.bbb69f3d4a
[0m18:38:27.153160 [debug] [Thread-5  ]: Finished running node test.billy_bulky.unique_customers_customer_id.c5af1ff4b1
[0m18:38:27.153647 [debug] [Thread-4  ]: Finished running node test.billy_bulky.not_null_customers_join_date.faf8f07bc9
[0m18:38:27.154130 [debug] [Thread-6  ]: Finished running node test.billy_bulky.unique_customers_email.e77c92eb54
[0m18:38:27.154380 [debug] [Thread-7  ]: Timing info for test.billy_bulky.not_null_int_sales_trends_daily_orders.96da3a5baa (execute): 18:38:27.154260 => 18:38:27.154263
[0m18:38:27.154647 [debug] [Thread-2  ]: Timing info for test.billy_bulky.not_null_int_sales_trends_daily_units_sold.cfceaad553 (execute): 18:38:27.154520 => 18:38:27.154523
[0m18:38:27.154902 [debug] [Thread-8  ]: Timing info for test.billy_bulky.not_null_int_sales_trends_monthly_orders.e6a6b6c9bd (execute): 18:38:27.154781 => 18:38:27.154784
[0m18:38:27.155158 [debug] [Thread-1  ]: Began running node test.billy_bulky.not_null_int_sales_trends_monthly_units_sold.ee96488ac3
[0m18:38:27.155441 [debug] [Thread-9  ]: Timing info for test.billy_bulky.not_null_int_sales_trends_daily_sales_value.070e4ffb27 (execute): 18:38:27.155325 => 18:38:27.155327
[0m18:38:27.155677 [debug] [Thread-3  ]: Began running node test.billy_bulky.not_null_int_sales_trends_sale_date.f72c75cc10
[0m18:38:27.155954 [debug] [Thread-10 ]: Timing info for test.billy_bulky.not_null_int_sales_trends_monthly_sales_value.bbb69f3d4a (execute): 18:38:27.155835 => 18:38:27.155838
[0m18:38:27.156184 [debug] [Thread-5  ]: Began running node test.billy_bulky.not_null_int_sales_trends_weekly_orders.9f9ad69d2c
[0m18:38:27.156444 [debug] [Thread-4  ]: Began running node test.billy_bulky.not_null_int_sales_trends_weekly_sales_value.502ef6aeae
[0m18:38:27.156715 [debug] [Thread-6  ]: Began running node test.billy_bulky.not_null_int_sales_trends_weekly_units_sold.5fb3438f7f
[0m18:38:27.157220 [debug] [Thread-7  ]: Finished running node test.billy_bulky.not_null_int_sales_trends_daily_orders.96da3a5baa
[0m18:38:27.157725 [debug] [Thread-2  ]: Finished running node test.billy_bulky.not_null_int_sales_trends_daily_units_sold.cfceaad553
[0m18:38:27.158209 [debug] [Thread-8  ]: Finished running node test.billy_bulky.not_null_int_sales_trends_monthly_orders.e6a6b6c9bd
[0m18:38:27.158574 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.billy_bulky.not_null_customers_customer_id.5c9bf9911d, now test.billy_bulky.not_null_int_sales_trends_monthly_units_sold.ee96488ac3)
[0m18:38:27.159068 [debug] [Thread-9  ]: Finished running node test.billy_bulky.not_null_int_sales_trends_daily_sales_value.070e4ffb27
[0m18:38:27.159424 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.billy_bulky.not_null_customers_email.da3cfcd534, now test.billy_bulky.not_null_int_sales_trends_sale_date.f72c75cc10)
[0m18:38:27.159916 [debug] [Thread-10 ]: Finished running node test.billy_bulky.not_null_int_sales_trends_monthly_sales_value.bbb69f3d4a
[0m18:38:27.160270 [debug] [Thread-5  ]: Re-using an available connection from the pool (formerly test.billy_bulky.unique_customers_customer_id.c5af1ff4b1, now test.billy_bulky.not_null_int_sales_trends_weekly_orders.9f9ad69d2c)
[0m18:38:27.160634 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.billy_bulky.not_null_customers_join_date.faf8f07bc9, now test.billy_bulky.not_null_int_sales_trends_weekly_sales_value.502ef6aeae)
[0m18:38:27.160991 [debug] [Thread-6  ]: Re-using an available connection from the pool (formerly test.billy_bulky.unique_customers_email.e77c92eb54, now test.billy_bulky.not_null_int_sales_trends_weekly_units_sold.5fb3438f7f)
[0m18:38:27.161243 [debug] [Thread-7  ]: Began running node test.billy_bulky.not_null_int_sales_trends_yearly_orders.e9720dbf16
[0m18:38:27.161481 [debug] [Thread-2  ]: Began running node test.billy_bulky.not_null_int_sales_trends_yearly_sales_value.ebdab7a01e
[0m18:38:27.161744 [debug] [Thread-8  ]: Began running node test.billy_bulky.not_null_int_sales_trends_yearly_units_sold.758913b07d
[0m18:38:27.161960 [debug] [Thread-1  ]: Began compiling node test.billy_bulky.not_null_int_sales_trends_monthly_units_sold.ee96488ac3
[0m18:38:27.162203 [debug] [Thread-9  ]: Began running node test.billy_bulky.unique_int_sales_trends_sale_date.9f7845245b
[0m18:38:27.162407 [debug] [Thread-3  ]: Began compiling node test.billy_bulky.not_null_int_sales_trends_sale_date.f72c75cc10
[0m18:38:27.162688 [debug] [Thread-5  ]: Began compiling node test.billy_bulky.not_null_int_sales_trends_weekly_orders.9f9ad69d2c
[0m18:38:27.162910 [debug] [Thread-4  ]: Began compiling node test.billy_bulky.not_null_int_sales_trends_weekly_sales_value.502ef6aeae
[0m18:38:27.163121 [debug] [Thread-6  ]: Began compiling node test.billy_bulky.not_null_int_sales_trends_weekly_units_sold.5fb3438f7f
[0m18:38:27.163485 [debug] [Thread-7  ]: Re-using an available connection from the pool (formerly test.billy_bulky.not_null_int_sales_trends_daily_orders.96da3a5baa, now test.billy_bulky.not_null_int_sales_trends_yearly_orders.e9720dbf16)
[0m18:38:27.163871 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.billy_bulky.not_null_int_sales_trends_daily_units_sold.cfceaad553, now test.billy_bulky.not_null_int_sales_trends_yearly_sales_value.ebdab7a01e)
[0m18:38:27.164224 [debug] [Thread-8  ]: Re-using an available connection from the pool (formerly test.billy_bulky.not_null_int_sales_trends_monthly_orders.e6a6b6c9bd, now test.billy_bulky.not_null_int_sales_trends_yearly_units_sold.758913b07d)
[0m18:38:27.166994 [debug] [Thread-1  ]: Writing injected SQL for node "test.billy_bulky.not_null_int_sales_trends_monthly_units_sold.ee96488ac3"
[0m18:38:27.167421 [debug] [Thread-9  ]: Re-using an available connection from the pool (formerly test.billy_bulky.not_null_int_sales_trends_daily_sales_value.070e4ffb27, now test.billy_bulky.unique_int_sales_trends_sale_date.9f7845245b)
[0m18:38:27.169866 [debug] [Thread-3  ]: Writing injected SQL for node "test.billy_bulky.not_null_int_sales_trends_sale_date.f72c75cc10"
[0m18:38:27.172287 [debug] [Thread-5  ]: Writing injected SQL for node "test.billy_bulky.not_null_int_sales_trends_weekly_orders.9f9ad69d2c"
[0m18:38:27.175451 [debug] [Thread-4  ]: Writing injected SQL for node "test.billy_bulky.not_null_int_sales_trends_weekly_sales_value.502ef6aeae"
[0m18:38:27.177785 [debug] [Thread-6  ]: Writing injected SQL for node "test.billy_bulky.not_null_int_sales_trends_weekly_units_sold.5fb3438f7f"
[0m18:38:27.178028 [debug] [Thread-7  ]: Began compiling node test.billy_bulky.not_null_int_sales_trends_yearly_orders.e9720dbf16
[0m18:38:27.178250 [debug] [Thread-2  ]: Began compiling node test.billy_bulky.not_null_int_sales_trends_yearly_sales_value.ebdab7a01e
[0m18:38:27.178463 [debug] [Thread-8  ]: Began compiling node test.billy_bulky.not_null_int_sales_trends_yearly_units_sold.758913b07d
[0m18:38:27.178719 [debug] [Thread-9  ]: Began compiling node test.billy_bulky.unique_int_sales_trends_sale_date.9f7845245b
[0m18:38:27.179115 [debug] [Thread-1  ]: Timing info for test.billy_bulky.not_null_int_sales_trends_monthly_units_sold.ee96488ac3 (compile): 18:38:27.164365 => 18:38:27.178988
[0m18:38:27.179439 [debug] [Thread-3  ]: Timing info for test.billy_bulky.not_null_int_sales_trends_sale_date.f72c75cc10 (compile): 18:38:27.167574 => 18:38:27.179310
[0m18:38:27.181894 [debug] [Thread-7  ]: Writing injected SQL for node "test.billy_bulky.not_null_int_sales_trends_yearly_orders.e9720dbf16"
[0m18:38:27.184284 [debug] [Thread-2  ]: Writing injected SQL for node "test.billy_bulky.not_null_int_sales_trends_yearly_sales_value.ebdab7a01e"
[0m18:38:27.184555 [debug] [Thread-6  ]: Timing info for test.billy_bulky.not_null_int_sales_trends_weekly_units_sold.5fb3438f7f (compile): 18:38:27.175619 => 18:38:27.184429
[0m18:38:27.184842 [debug] [Thread-4  ]: Timing info for test.billy_bulky.not_null_int_sales_trends_weekly_sales_value.502ef6aeae (compile): 18:38:27.172448 => 18:38:27.184712
[0m18:38:27.185102 [debug] [Thread-5  ]: Timing info for test.billy_bulky.not_null_int_sales_trends_weekly_orders.9f9ad69d2c (compile): 18:38:27.170030 => 18:38:27.184974
[0m18:38:27.187501 [debug] [Thread-8  ]: Writing injected SQL for node "test.billy_bulky.not_null_int_sales_trends_yearly_units_sold.758913b07d"
[0m18:38:27.189878 [debug] [Thread-9  ]: Writing injected SQL for node "test.billy_bulky.unique_int_sales_trends_sale_date.9f7845245b"
[0m18:38:27.190132 [debug] [Thread-1  ]: Began executing node test.billy_bulky.not_null_int_sales_trends_monthly_units_sold.ee96488ac3
[0m18:38:27.190367 [debug] [Thread-3  ]: Began executing node test.billy_bulky.not_null_int_sales_trends_sale_date.f72c75cc10
[0m18:38:27.190680 [debug] [Thread-6  ]: Began executing node test.billy_bulky.not_null_int_sales_trends_weekly_units_sold.5fb3438f7f
[0m18:38:27.190955 [debug] [Thread-4  ]: Began executing node test.billy_bulky.not_null_int_sales_trends_weekly_sales_value.502ef6aeae
[0m18:38:27.191212 [debug] [Thread-5  ]: Began executing node test.billy_bulky.not_null_int_sales_trends_weekly_orders.9f9ad69d2c
[0m18:38:27.191476 [debug] [Thread-7  ]: Timing info for test.billy_bulky.not_null_int_sales_trends_yearly_orders.e9720dbf16 (compile): 18:38:27.179623 => 18:38:27.191348
[0m18:38:27.191728 [debug] [Thread-2  ]: Timing info for test.billy_bulky.not_null_int_sales_trends_yearly_sales_value.ebdab7a01e (compile): 18:38:27.182113 => 18:38:27.191611
[0m18:38:27.192069 [debug] [Thread-1  ]: Timing info for test.billy_bulky.not_null_int_sales_trends_monthly_units_sold.ee96488ac3 (execute): 18:38:27.191934 => 18:38:27.191939
[0m18:38:27.192373 [debug] [Thread-3  ]: Timing info for test.billy_bulky.not_null_int_sales_trends_sale_date.f72c75cc10 (execute): 18:38:27.192247 => 18:38:27.192250
[0m18:38:27.192629 [debug] [Thread-8  ]: Timing info for test.billy_bulky.not_null_int_sales_trends_yearly_units_sold.758913b07d (compile): 18:38:27.185248 => 18:38:27.192512
[0m18:38:27.192897 [debug] [Thread-6  ]: Timing info for test.billy_bulky.not_null_int_sales_trends_weekly_units_sold.5fb3438f7f (execute): 18:38:27.192757 => 18:38:27.192761
[0m18:38:27.193150 [debug] [Thread-9  ]: Timing info for test.billy_bulky.unique_int_sales_trends_sale_date.9f7845245b (compile): 18:38:27.187656 => 18:38:27.193031
[0m18:38:27.193405 [debug] [Thread-4  ]: Timing info for test.billy_bulky.not_null_int_sales_trends_weekly_sales_value.502ef6aeae (execute): 18:38:27.193283 => 18:38:27.193286
[0m18:38:27.193653 [debug] [Thread-5  ]: Timing info for test.billy_bulky.not_null_int_sales_trends_weekly_orders.9f9ad69d2c (execute): 18:38:27.193538 => 18:38:27.193542
[0m18:38:27.193865 [debug] [Thread-7  ]: Began executing node test.billy_bulky.not_null_int_sales_trends_yearly_orders.e9720dbf16
[0m18:38:27.194081 [debug] [Thread-2  ]: Began executing node test.billy_bulky.not_null_int_sales_trends_yearly_sales_value.ebdab7a01e
[0m18:38:27.194595 [debug] [Thread-1  ]: Finished running node test.billy_bulky.not_null_int_sales_trends_monthly_units_sold.ee96488ac3
[0m18:38:27.195090 [debug] [Thread-3  ]: Finished running node test.billy_bulky.not_null_int_sales_trends_sale_date.f72c75cc10
[0m18:38:27.195308 [debug] [Thread-8  ]: Began executing node test.billy_bulky.not_null_int_sales_trends_yearly_units_sold.758913b07d
[0m18:38:27.195811 [debug] [Thread-6  ]: Finished running node test.billy_bulky.not_null_int_sales_trends_weekly_units_sold.5fb3438f7f
[0m18:38:27.196038 [debug] [Thread-9  ]: Began executing node test.billy_bulky.unique_int_sales_trends_sale_date.9f7845245b
[0m18:38:27.196533 [debug] [Thread-4  ]: Finished running node test.billy_bulky.not_null_int_sales_trends_weekly_sales_value.502ef6aeae
[0m18:38:27.197013 [debug] [Thread-5  ]: Finished running node test.billy_bulky.not_null_int_sales_trends_weekly_orders.9f9ad69d2c
[0m18:38:27.197277 [debug] [Thread-7  ]: Timing info for test.billy_bulky.not_null_int_sales_trends_yearly_orders.e9720dbf16 (execute): 18:38:27.197158 => 18:38:27.197161
[0m18:38:27.197549 [debug] [Thread-2  ]: Timing info for test.billy_bulky.not_null_int_sales_trends_yearly_sales_value.ebdab7a01e (execute): 18:38:27.197425 => 18:38:27.197429
[0m18:38:27.197907 [debug] [Thread-8  ]: Timing info for test.billy_bulky.not_null_int_sales_trends_yearly_units_sold.758913b07d (execute): 18:38:27.197775 => 18:38:27.197778
[0m18:38:27.198221 [debug] [Thread-9  ]: Timing info for test.billy_bulky.unique_int_sales_trends_sale_date.9f7845245b (execute): 18:38:27.198094 => 18:38:27.198097
[0m18:38:27.198809 [debug] [Thread-7  ]: Finished running node test.billy_bulky.not_null_int_sales_trends_yearly_orders.e9720dbf16
[0m18:38:27.199303 [debug] [Thread-2  ]: Finished running node test.billy_bulky.not_null_int_sales_trends_yearly_sales_value.ebdab7a01e
[0m18:38:27.199790 [debug] [Thread-8  ]: Finished running node test.billy_bulky.not_null_int_sales_trends_yearly_units_sold.758913b07d
[0m18:38:27.200268 [debug] [Thread-9  ]: Finished running node test.billy_bulky.unique_int_sales_trends_sale_date.9f7845245b
[0m18:38:27.200971 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:38:27.201161 [debug] [MainThread]: Connection 'test.billy_bulky.not_null_int_sales_trends_monthly_units_sold.ee96488ac3' was properly closed.
[0m18:38:27.201326 [debug] [MainThread]: Connection 'test.billy_bulky.not_null_int_sales_trends_yearly_sales_value.ebdab7a01e' was properly closed.
[0m18:38:27.201484 [debug] [MainThread]: Connection 'test.billy_bulky.not_null_int_sales_trends_sale_date.f72c75cc10' was properly closed.
[0m18:38:27.201640 [debug] [MainThread]: Connection 'test.billy_bulky.not_null_int_sales_trends_weekly_sales_value.502ef6aeae' was properly closed.
[0m18:38:27.201795 [debug] [MainThread]: Connection 'test.billy_bulky.not_null_int_sales_trends_weekly_units_sold.5fb3438f7f' was properly closed.
[0m18:38:27.201949 [debug] [MainThread]: Connection 'test.billy_bulky.not_null_int_sales_trends_yearly_orders.e9720dbf16' was properly closed.
[0m18:38:27.202102 [debug] [MainThread]: Connection 'test.billy_bulky.not_null_int_sales_trends_yearly_units_sold.758913b07d' was properly closed.
[0m18:38:27.202256 [debug] [MainThread]: Connection 'test.billy_bulky.unique_int_sales_trends_sale_date.9f7845245b' was properly closed.
[0m18:38:27.202411 [debug] [MainThread]: Connection 'test.billy_bulky.not_null_int_sales_trends_monthly_sales_value.bbb69f3d4a' was properly closed.
[0m18:38:27.202570 [debug] [MainThread]: Connection 'test.billy_bulky.not_null_int_sales_trends_weekly_orders.9f9ad69d2c' was properly closed.
[0m18:38:27.204438 [debug] [MainThread]: Command end result
[0m18:38:27.215383 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m18:38:27.215610 [info ] [MainThread]: Building catalog
[0m18:38:27.216630 [debug] [ThreadPool]: Acquiring new snowflake connection 'E_COMMERCE.information_schema'
[0m18:38:27.225537 [debug] [ThreadPool]: Using snowflake connection "E_COMMERCE.information_schema"
[0m18:38:27.226012 [debug] [ThreadPool]: On E_COMMERCE.information_schema: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "E_COMMERCE.information_schema"} */
with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        coalesce(table_type, 'DYNAMIC TABLE') as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from E_COMMERCE.INFORMATION_SCHEMA.tables
            where (
                (
                    upper("table_schema") = upper('intermediate')
                    and upper("table_name") = upper('int_sales_trends')
                )
             or 
                (
                    upper("table_schema") = upper('marts')
                    and upper("table_name") = upper('customers')
                )
             or 
                (
                    upper("table_schema") = upper('intermediate')
                    and upper("table_name") = upper('int_customers_segmentation')
                )
             or 
                (
                    upper("table_schema") = upper('intermediate')
                    and upper("table_name") = upper('int_products_performance')
                )
             or 
                (
                    upper("table_schema") = upper('marts')
                    and upper("table_name") = upper('products')
                )
             or 
                (
                    upper("table_schema") = upper('marts')
                    and upper("table_name") = upper('sales')
                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from E_COMMERCE.INFORMATION_SCHEMA.columns
            where (
                (
                    upper("table_schema") = upper('intermediate')
                    and upper("table_name") = upper('int_sales_trends')
                )
             or 
                (
                    upper("table_schema") = upper('marts')
                    and upper("table_name") = upper('customers')
                )
             or 
                (
                    upper("table_schema") = upper('intermediate')
                    and upper("table_name") = upper('int_customers_segmentation')
                )
             or 
                (
                    upper("table_schema") = upper('intermediate')
                    and upper("table_name") = upper('int_products_performance')
                )
             or 
                (
                    upper("table_schema") = upper('marts')
                    and upper("table_name") = upper('products')
                )
             or 
                (
                    upper("table_schema") = upper('marts')
                    and upper("table_name") = upper('sales')
                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
[0m18:38:27.226343 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:38:31.069641 [debug] [ThreadPool]: SQL status: SUCCESS 62 in 4.0 seconds
[0m18:38:31.101527 [debug] [ThreadPool]: On E_COMMERCE.information_schema: Close
[0m18:38:31.990599 [info ] [MainThread]: Catalog written to /Users/bitlevi/Documents/billy_bulky_ecommerce/target/catalog.json
[0m18:38:31.993485 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 7.6912975, "process_user_time": 4.269775, "process_kernel_time": 0.274055, "process_mem_max_rss": "214548480", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:38:31.994200 [debug] [MainThread]: Command `dbt docs generate` succeeded at 18:38:31.994058 after 7.69 seconds
[0m18:38:31.994580 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m18:38:31.994898 [debug] [MainThread]: Connection 'E_COMMERCE.information_schema' was properly closed.
[0m18:38:31.995271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107395250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120047490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ff43c10>]}
[0m18:38:31.995719 [debug] [MainThread]: Flushing usage events
[0m18:38:37.679042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104601250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040f29a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e6ed90>]}


============================== 18:38:37.681841 | 2256caf6-a322-48c9-abcc-272ebfbe3e2a ==============================
[0m18:38:37.681841 [info ] [MainThread]: Running with dbt=1.7.1
[0m18:38:37.682184 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/bitlevi/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/bitlevi/Documents/billy_bulky_ecommerce/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt docs serve', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:38:38.244786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2256caf6-a322-48c9-abcc-272ebfbe3e2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040f29a0>]}
[0m18:38:38.292360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2256caf6-a322-48c9-abcc-272ebfbe3e2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d113160>]}
[0m18:39:25.526539 [error] [MainThread]: Encountered an error:

[0m18:39:25.559053 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/bitlevi/Library/Python/3.9/lib/python/site-packages/dbt/cli/requires.py", line 90, in wrapper
    result, success = func(*args, **kwargs)
  File "/Users/bitlevi/Library/Python/3.9/lib/python/site-packages/dbt/cli/requires.py", line 75, in wrapper
    return func(*args, **kwargs)
  File "/Users/bitlevi/Library/Python/3.9/lib/python/site-packages/dbt/cli/requires.py", line 168, in wrapper
    return func(*args, **kwargs)
  File "/Users/bitlevi/Library/Python/3.9/lib/python/site-packages/dbt/cli/requires.py", line 197, in wrapper
    return func(*args, **kwargs)
  File "/Users/bitlevi/Library/Python/3.9/lib/python/site-packages/dbt/cli/requires.py", line 244, in wrapper
    return func(*args, **kwargs)
  File "/Users/bitlevi/Library/Python/3.9/lib/python/site-packages/dbt/cli/main.py", line 324, in docs_serve
    results = task.run()
  File "/Users/bitlevi/Library/Python/3.9/lib/python/site-packages/dbt/task/serve.py", line 28, in run
    httpd.serve_forever()
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/socketserver.py", line 232, in serve_forever
    ready = selector.select(poll_interval)
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/selectors.py", line 416, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt

[0m18:39:25.563451 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_wall_clock_time": 47.91624, "process_user_time": 3.514208, "process_kernel_time": 0.214685, "process_mem_max_rss": "190988288", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:39:25.564352 [debug] [MainThread]: Command `dbt docs serve` failed at 18:39:25.564182 after 47.92 seconds
[0m18:39:25.564855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104601250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d2c1640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d2a1b80>]}
[0m18:39:25.565335 [debug] [MainThread]: Flushing usage events
[0m18:54:50.528135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107069eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b5b910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098b8130>]}


============================== 18:54:50.530737 | e456e668-1282-468f-9173-6757e27e7c40 ==============================
[0m18:54:50.530737 [info ] [MainThread]: Running with dbt=1.7.1
[0m18:54:50.531085 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/bitlevi/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/bitlevi/Documents/billy_bulky_ecommerce/billy_bulky_ecommerce/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:54:51.086647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e456e668-1282-468f-9173-6757e27e7c40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b5b910>]}
[0m18:54:51.134422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e456e668-1282-468f-9173-6757e27e7c40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x129ba4a30>]}
[0m18:54:51.135041 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m18:54:51.148408 [debug] [MainThread]: checksum: ad428e6dc3b353dcb23d0c4ebea8b20b180e94b873271ac2a054a8e446dac0e2, vars: {}, profile: , target: , version: 1.7.1
[0m18:54:51.185864 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:54:51.186177 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:54:51.191097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e456e668-1282-468f-9173-6757e27e7c40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12d1bcfa0>]}
[0m18:54:51.201784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e456e668-1282-468f-9173-6757e27e7c40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12cd0e670>]}
[0m18:54:51.202114 [info ] [MainThread]: Found 9 models, 19 tests, 3 sources, 0 exposures, 0 metrics, 431 macros, 0 groups, 0 semantic models
[0m18:54:51.202346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e456e668-1282-468f-9173-6757e27e7c40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12cd0e5b0>]}
[0m18:54:51.203619 [info ] [MainThread]: 
[0m18:54:51.204107 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:54:51.204889 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE'
[0m18:54:51.213360 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE"
[0m18:54:51.214036 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE'
[0m18:54:51.214345 [debug] [ThreadPool]: On list_E_COMMERCE: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE"} */
show terse schemas in database E_COMMERCE
    limit 10000
[0m18:54:51.216089 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE"
[0m18:54:51.216306 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:54:51.216497 [debug] [ThreadPool]: On list_E_COMMERCE: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE"} */
show terse schemas in database E_COMMERCE
    limit 10000
[0m18:54:51.217964 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:54:52.636984 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m18:54:52.638209 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m18:54:52.640388 [debug] [ThreadPool]: On list_E_COMMERCE: Close
[0m18:54:52.642174 [debug] [ThreadPool]: On list_E_COMMERCE: Close
[0m18:54:53.008169 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_E_COMMERCE, now list_E_COMMERCE_marts)
[0m18:54:53.011030 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_E_COMMERCE, now list_E_COMMERCE_intermediate)
[0m18:54:53.026935 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_intermediate"
[0m18:54:53.023874 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_marts"
[0m18:54:53.027599 [debug] [ThreadPool]: On list_E_COMMERCE_intermediate: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE_intermediate"} */
show terse objects in E_COMMERCE.intermediate limit 10000
[0m18:54:53.028069 [debug] [ThreadPool]: On list_E_COMMERCE_marts: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE_marts"} */
show terse objects in E_COMMERCE.marts limit 10000
[0m18:54:53.028484 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:54:53.028892 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:54:54.154526 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m18:54:54.159337 [debug] [ThreadPool]: On list_E_COMMERCE_intermediate: Close
[0m18:54:54.191795 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m18:54:54.195905 [debug] [ThreadPool]: On list_E_COMMERCE_marts: Close
[0m18:54:54.571532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e456e668-1282-468f-9173-6757e27e7c40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12d192eb0>]}
[0m18:54:54.573135 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m18:54:54.573813 [info ] [MainThread]: 
[0m18:54:54.578443 [debug] [Thread-1  ]: Began running node model.billy_bulky.staging_shopify__customers
[0m18:54:54.579287 [debug] [Thread-2  ]: Began running node model.billy_bulky.staging_shopify__orders
[0m18:54:54.580927 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_E_COMMERCE_marts, now model.billy_bulky.staging_shopify__customers)
[0m18:54:54.581940 [debug] [Thread-3  ]: Began running node model.billy_bulky.staging_shopify__products
[0m18:54:54.583154 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_E_COMMERCE_intermediate, now model.billy_bulky.staging_shopify__orders)
[0m18:54:54.583840 [debug] [Thread-1  ]: Began compiling node model.billy_bulky.staging_shopify__customers
[0m18:54:54.584897 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.billy_bulky.staging_shopify__products'
[0m18:54:54.585460 [debug] [Thread-2  ]: Began compiling node model.billy_bulky.staging_shopify__orders
[0m18:54:54.596814 [debug] [Thread-1  ]: Writing injected SQL for node "model.billy_bulky.staging_shopify__customers"
[0m18:54:54.597355 [debug] [Thread-3  ]: Began compiling node model.billy_bulky.staging_shopify__products
[0m18:54:54.601125 [debug] [Thread-2  ]: Writing injected SQL for node "model.billy_bulky.staging_shopify__orders"
[0m18:54:54.604594 [debug] [Thread-3  ]: Writing injected SQL for node "model.billy_bulky.staging_shopify__products"
[0m18:54:54.605403 [debug] [Thread-1  ]: Timing info for model.billy_bulky.staging_shopify__customers (compile): 18:54:54.585808 => 18:54:54.605154
[0m18:54:54.606350 [debug] [Thread-1  ]: Finished running node model.billy_bulky.staging_shopify__customers
[0m18:54:54.607004 [debug] [Thread-2  ]: Timing info for model.billy_bulky.staging_shopify__orders (compile): 18:54:54.597678 => 18:54:54.606601
[0m18:54:54.608071 [debug] [Thread-2  ]: Finished running node model.billy_bulky.staging_shopify__orders
[0m18:54:54.608546 [debug] [Thread-3  ]: Timing info for model.billy_bulky.staging_shopify__products (compile): 18:54:54.601550 => 18:54:54.608332
[0m18:54:54.609484 [debug] [Thread-3  ]: Finished running node model.billy_bulky.staging_shopify__products
[0m18:54:54.610241 [debug] [Thread-5  ]: Began running node model.billy_bulky.customers
[0m18:54:54.610660 [debug] [Thread-6  ]: Began running node model.billy_bulky.int_customers_segmentation
[0m18:54:54.611167 [info ] [Thread-5  ]: 1 of 6 START sql table model marts.customers ................................... [RUN]
[0m18:54:54.611625 [debug] [Thread-7  ]: Began running node model.billy_bulky.int_products_performance
[0m18:54:54.612103 [debug] [Thread-8  ]: Began running node model.billy_bulky.int_sales_trends
[0m18:54:54.612582 [debug] [Thread-9  ]: Began running node model.billy_bulky.products
[0m18:54:54.613404 [debug] [Thread-10 ]: Began running node model.billy_bulky.sales
[0m18:54:54.613070 [info ] [Thread-6  ]: 2 of 6 START sql table model intermediate.int_customers_segmentation ........... [RUN]
[0m18:54:54.614306 [debug] [Thread-5  ]: Acquiring new snowflake connection 'model.billy_bulky.customers'
[0m18:54:54.614800 [info ] [Thread-7  ]: 3 of 6 START sql table model intermediate.int_products_performance ............. [RUN]
[0m18:54:54.615281 [info ] [Thread-8  ]: 4 of 6 START sql table model intermediate.int_sales_trends ..................... [RUN]
[0m18:54:54.615727 [info ] [Thread-9  ]: 5 of 6 START sql table model marts.products .................................... [RUN]
[0m18:54:54.616197 [info ] [Thread-10 ]: 6 of 6 START sql table model marts.sales ....................................... [RUN]
[0m18:54:54.616957 [debug] [Thread-6  ]: Acquiring new snowflake connection 'model.billy_bulky.int_customers_segmentation'
[0m18:54:54.617339 [debug] [Thread-5  ]: Began compiling node model.billy_bulky.customers
[0m18:54:54.618008 [debug] [Thread-7  ]: Acquiring new snowflake connection 'model.billy_bulky.int_products_performance'
[0m18:54:54.618678 [debug] [Thread-8  ]: Acquiring new snowflake connection 'model.billy_bulky.int_sales_trends'
[0m18:54:54.619302 [debug] [Thread-9  ]: Acquiring new snowflake connection 'model.billy_bulky.products'
[0m18:54:54.619930 [debug] [Thread-10 ]: Acquiring new snowflake connection 'model.billy_bulky.sales'
[0m18:54:54.620275 [debug] [Thread-6  ]: Began compiling node model.billy_bulky.int_customers_segmentation
[0m18:54:54.632899 [debug] [Thread-5  ]: Writing injected SQL for node "model.billy_bulky.customers"
[0m18:54:54.633343 [debug] [Thread-7  ]: Began compiling node model.billy_bulky.int_products_performance
[0m18:54:54.633686 [debug] [Thread-8  ]: Began compiling node model.billy_bulky.int_sales_trends
[0m18:54:54.633969 [debug] [Thread-9  ]: Began compiling node model.billy_bulky.products
[0m18:54:54.634242 [debug] [Thread-10 ]: Began compiling node model.billy_bulky.sales
[0m18:54:54.650499 [debug] [Thread-6  ]: Writing injected SQL for node "model.billy_bulky.int_customers_segmentation"
[0m18:54:54.661361 [debug] [Thread-7  ]: Writing injected SQL for node "model.billy_bulky.int_products_performance"
[0m18:54:54.668208 [debug] [Thread-5  ]: Timing info for model.billy_bulky.customers (compile): 18:54:54.620503 => 18:54:54.667980
[0m18:54:54.682523 [debug] [Thread-8  ]: Writing injected SQL for node "model.billy_bulky.int_sales_trends"
[0m18:54:54.682866 [debug] [Thread-9  ]: Writing injected SQL for node "model.billy_bulky.products"
[0m18:54:54.691548 [debug] [Thread-10 ]: Writing injected SQL for node "model.billy_bulky.sales"
[0m18:54:54.691892 [debug] [Thread-5  ]: Began executing node model.billy_bulky.customers
[0m18:54:54.692429 [debug] [Thread-8  ]: Timing info for model.billy_bulky.int_sales_trends (compile): 18:54:54.661692 => 18:54:54.692286
[0m18:54:54.692748 [debug] [Thread-6  ]: Timing info for model.billy_bulky.int_customers_segmentation (compile): 18:54:54.634420 => 18:54:54.692612
[0m18:54:54.699417 [debug] [Thread-7  ]: Timing info for model.billy_bulky.int_products_performance (compile): 18:54:54.650800 => 18:54:54.699210
[0m18:54:54.699701 [debug] [Thread-9  ]: Timing info for model.billy_bulky.products (compile): 18:54:54.674702 => 18:54:54.699583
[0m18:54:54.710968 [debug] [Thread-5  ]: Writing runtime sql for node "model.billy_bulky.customers"
[0m18:54:54.711286 [debug] [Thread-8  ]: Began executing node model.billy_bulky.int_sales_trends
[0m18:54:54.711554 [debug] [Thread-6  ]: Began executing node model.billy_bulky.int_customers_segmentation
[0m18:54:54.711810 [debug] [Thread-10 ]: Timing info for model.billy_bulky.sales (compile): 18:54:54.683031 => 18:54:54.711688
[0m18:54:54.712046 [debug] [Thread-7  ]: Began executing node model.billy_bulky.int_products_performance
[0m18:54:54.712270 [debug] [Thread-9  ]: Began executing node model.billy_bulky.products
[0m18:54:54.714348 [debug] [Thread-8  ]: Writing runtime sql for node "model.billy_bulky.int_sales_trends"
[0m18:54:54.716318 [debug] [Thread-6  ]: Writing runtime sql for node "model.billy_bulky.int_customers_segmentation"
[0m18:54:54.716658 [debug] [Thread-10 ]: Began executing node model.billy_bulky.sales
[0m18:54:54.718424 [debug] [Thread-7  ]: Writing runtime sql for node "model.billy_bulky.int_products_performance"
[0m18:54:54.720086 [debug] [Thread-9  ]: Writing runtime sql for node "model.billy_bulky.products"
[0m18:54:54.721465 [debug] [Thread-5  ]: Using snowflake connection "model.billy_bulky.customers"
[0m18:54:54.723738 [debug] [Thread-10 ]: Writing runtime sql for node "model.billy_bulky.sales"
[0m18:54:54.724242 [debug] [Thread-5  ]: On model.billy_bulky.customers: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.customers"} */
create or replace transient table E_COMMERCE.marts.customers
         as
        (WITH  __dbt__cte__staging_shopify__customers as (
WITH customers AS (
    SELECT * FROM SHOPIFY.PUBLIC.customers
)

SELECT
    CUSTOMER_ID
    , FIRST_NAME
    , LAST_NAME
    , EMAIL
    , JOIN_DATE
    , COUNTRY
FROM customers
),  __dbt__cte__staging_shopify__orders as (
WITH orders AS (
    SELECT * FROM SHOPIFY.PUBLIC.orders
)

SELECT
    ORDER_ID
    , CUSTOMER_ID
    , PRODUCT_ID
    , QUANTITY
    , ORDER_DATE
    , STATUS
FROM orders
),  __dbt__cte__staging_shopify__products as (
WITH products AS (
    SELECT * FROM SHOPIFY.PUBLIC.products
)

SELECT
    PRODUCT_ID
    , NAME
    , CATEGORY
    , PRICE
    , STOCK_LEVEL
FROM products
), customers AS (
    SELECT * FROM __dbt__cte__staging_shopify__customers
)

, orders AS (
    SELECT * FROM __dbt__cte__staging_shopify__orders
)

, products AS (
    SELECT * FROM __dbt__cte__staging_shopify__products
)

, source AS (
    SELECT
        c.CUSTOMER_ID
        , c.FIRST_NAME
        , c.LAST_NAME
        , c.EMAIL
        , c.JOIN_DATE
        , c.COUNTRY
        , COUNT(o.ORDER_ID) AS total_orders
        , SUM(o.QUANTITY * p.PRICE) AS total_spent
    FROM customers c
    LEFT JOIN orders o ON c.CUSTOMER_ID = o.CUSTOMER_ID
    LEFT JOIN products p ON o.PRODUCT_ID = p.PRODUCT_ID
    WHERE o.STATUS NOT IN ('cancelled')
    GROUP BY c.CUSTOMER_ID, c.FIRST_NAME, c.LAST_NAME, c.EMAIL, c.JOIN_DATE, c.COUNTRY
)

, final AS (
SELECT
    s.CUSTOMER_ID
    , s.FIRST_NAME
    , s.LAST_NAME
    , s.EMAIL
    , s.JOIN_DATE
    , s.COUNTRY
    , s.total_orders
    , s.total_spent
    , CASE WHEN s.total_spent > 1000 THEN 'VIP' ELSE 'Regular' END AS customer_segment 
FROM source s
)

SELECT * FROM final
        );
[0m18:54:54.726200 [debug] [Thread-8  ]: Using snowflake connection "model.billy_bulky.int_sales_trends"
[0m18:54:54.728157 [debug] [Thread-6  ]: Using snowflake connection "model.billy_bulky.int_customers_segmentation"
[0m18:54:54.729429 [debug] [Thread-9  ]: Using snowflake connection "model.billy_bulky.products"
[0m18:54:54.729720 [debug] [Thread-5  ]: Opening a new connection, currently in state init
[0m18:54:54.731222 [debug] [Thread-7  ]: Using snowflake connection "model.billy_bulky.int_products_performance"
[0m18:54:54.731577 [debug] [Thread-8  ]: On model.billy_bulky.int_sales_trends: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.int_sales_trends"} */
create or replace transient table E_COMMERCE.intermediate.int_sales_trends
         as
        (WITH  __dbt__cte__staging_shopify__orders as (
WITH orders AS (
    SELECT * FROM SHOPIFY.PUBLIC.orders
)

SELECT
    ORDER_ID
    , CUSTOMER_ID
    , PRODUCT_ID
    , QUANTITY
    , ORDER_DATE
    , STATUS
FROM orders
),  __dbt__cte__staging_shopify__products as (
WITH products AS (
    SELECT * FROM SHOPIFY.PUBLIC.products
)

SELECT
    PRODUCT_ID
    , NAME
    , CATEGORY
    , PRICE
    , STOCK_LEVEL
FROM products
), orders AS (
    SELECT * FROM __dbt__cte__staging_shopify__orders
)

, products AS (
    SELECT * FROM __dbt__cte__staging_shopify__products
)

, daily_sales AS (
    SELECT
        DATE(ORDER_DATE) AS sale_date
        , COUNT(DISTINCT ORDER_ID) AS total_orders
        , SUM(QUANTITY) AS total_units_sold
        , SUM(QUANTITY * PRICE) AS total_sales_value
    FROM orders AS o
    JOIN products AS p ON o.PRODUCT_ID = p.PRODUCT_ID
    WHERE o.STATUS NOT IN ('cancelled') 
    GROUP BY sale_date
)

, weekly_sales AS (
    SELECT
        DATE_TRUNC('week', sale_date) AS sale_week
        , SUM(total_orders) AS weekly_orders
        , SUM(total_units_sold) AS weekly_units_sold
        , SUM(total_sales_value) AS weekly_sales_value
    FROM daily_sales
    GROUP BY sale_week
)

, monthly_sales AS (
    SELECT
        DATE_TRUNC('month', sale_date) AS sale_month
        , SUM(total_orders) AS monthly_orders
        , SUM(total_units_sold) AS monthly_units_sold
        , SUM(total_sales_value) AS monthly_sales_value
    FROM daily_sales
    GROUP BY sale_month
)

, yearly_sales AS (
    SELECT
        DATE_TRUNC('year', sale_date) AS sale_year
        , SUM(total_orders) AS yearly_orders
        , SUM(total_units_sold) AS yearly_units_sold
        , SUM(total_sales_value) AS yearly_sales_value
    FROM daily_sales
    GROUP BY sale_year
)

SELECT
    d.sale_date
    , d.total_orders AS daily_orders
    , d.total_units_sold AS daily_units_sold
    , d.total_sales_value AS daily_sales_value
    , w.weekly_orders
    , w.weekly_units_sold
    , w.weekly_sales_value
    , m.monthly_orders
    , m.monthly_units_sold
    , m.monthly_sales_value
    , y.yearly_orders
    , y.yearly_units_sold
    , y.yearly_sales_value
FROM daily_sales d
LEFT JOIN weekly_sales w ON DATE_TRUNC('week', d.sale_date) = w.sale_week
LEFT JOIN monthly_sales m ON DATE_TRUNC('month', d.sale_date) = m.sale_month
LEFT JOIN yearly_sales y ON DATE_TRUNC('year', d.sale_date) = y.sale_year
        );
[0m18:54:54.733017 [debug] [Thread-10 ]: Using snowflake connection "model.billy_bulky.sales"
[0m18:54:54.733340 [debug] [Thread-6  ]: On model.billy_bulky.int_customers_segmentation: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.int_customers_segmentation"} */
create or replace transient table E_COMMERCE.intermediate.int_customers_segmentation
         as
        (WITH  __dbt__cte__staging_shopify__customers as (
WITH customers AS (
    SELECT * FROM SHOPIFY.PUBLIC.customers
)

SELECT
    CUSTOMER_ID
    , FIRST_NAME
    , LAST_NAME
    , EMAIL
    , JOIN_DATE
    , COUNTRY
FROM customers
),  __dbt__cte__staging_shopify__orders as (
WITH orders AS (
    SELECT * FROM SHOPIFY.PUBLIC.orders
)

SELECT
    ORDER_ID
    , CUSTOMER_ID
    , PRODUCT_ID
    , QUANTITY
    , ORDER_DATE
    , STATUS
FROM orders
),  __dbt__cte__staging_shopify__products as (
WITH products AS (
    SELECT * FROM SHOPIFY.PUBLIC.products
)

SELECT
    PRODUCT_ID
    , NAME
    , CATEGORY
    , PRICE
    , STOCK_LEVEL
FROM products
), customers AS (
    SELECT * FROM __dbt__cte__staging_shopify__customers
)

, orders AS (
    SELECT * FROM __dbt__cte__staging_shopify__orders
)

, products AS (
    SELECT * FROM __dbt__cte__staging_shopify__products
)

, order_aggregates AS (
    SELECT
        o.CUSTOMER_ID
        , COUNT(DISTINCT o.ORDER_ID) AS frequency
        , SUM(o.QUANTITY * p.PRICE) AS monetary
        , AVG(o.QUANTITY * p.PRICE) AS average_order_value
        , MAX(o.ORDER_DATE) AS last_purchase_date
        , COUNT(CASE WHEN o.STATUS = 'cancelled' THEN 1 END) AS cancelled_orders
        , COUNT(*) AS total_orders
    FROM orders o
    JOIN products p ON o.PRODUCT_ID = p.PRODUCT_ID
    GROUP BY o.CUSTOMER_ID
)

, customer_tenure AS (
    SELECT
        CUSTOMER_ID
        , JOIN_DATE
        , CURRENT_DATE - JOIN_DATE AS tenure
    FROM customers
)

, customer_recency AS (
    SELECT
        CUSTOMER_ID
        , CURRENT_DATE - last_purchase_date AS recency
    FROM order_aggregates
)

, final AS (
    SELECT
        c.CUSTOMER_ID
        , c.FIRST_NAME
        , c.LAST_NAME
        , c.EMAIL
        , c.JOIN_DATE
        , c.COUNTRY
        , o.frequency
        , o.monetary
        , o.average_order_value
        , o.cancelled_orders
        , o.total_orders
        , CASE 
            WHEN o.total_orders > 0 THEN ROUND((o.cancelled_orders::FLOAT / o.total_orders) * 100, 2) 
            ELSE 0 
          END AS cancellation_rate
        , r.recency
        , t.tenure
    FROM customer_tenure t
    JOIN customers c ON t.CUSTOMER_ID = c.CUSTOMER_ID
    JOIN order_aggregates o ON c.CUSTOMER_ID = o.CUSTOMER_ID
    JOIN customer_recency r ON c.CUSTOMER_ID = r.CUSTOMER_ID
)

SELECT * FROM final
        );
[0m18:54:54.733706 [debug] [Thread-9  ]: On model.billy_bulky.products: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.products"} */
create or replace transient table E_COMMERCE.marts.products
         as
        (WITH  __dbt__cte__staging_shopify__orders as (
WITH orders AS (
    SELECT * FROM SHOPIFY.PUBLIC.orders
)

SELECT
    ORDER_ID
    , CUSTOMER_ID
    , PRODUCT_ID
    , QUANTITY
    , ORDER_DATE
    , STATUS
FROM orders
),  __dbt__cte__staging_shopify__products as (
WITH products AS (
    SELECT * FROM SHOPIFY.PUBLIC.products
)

SELECT
    PRODUCT_ID
    , NAME
    , CATEGORY
    , PRICE
    , STOCK_LEVEL
FROM products
), orders AS (
    SELECT * FROM __dbt__cte__staging_shopify__orders
)

, products AS (
    SELECT * FROM __dbt__cte__staging_shopify__products
)


, product_sales AS (
    SELECT
        o.PRODUCT_ID
        , SUM(o.QUANTITY) AS total_units_sold
        , SUM(o.QUANTITY * p.PRICE) AS total_sales_value
    FROM orders o
    JOIN products p ON o.PRODUCT_ID = p.PRODUCT_ID
    WHERE o.STATUS NOT IN ('cancelled')
    GROUP BY o.PRODUCT_ID
)

, final AS (
    SELECT
    p.PRODUCT_ID
    , p.NAME
    , p.CATEGORY
    , p.PRICE
    , COALESCE(ps.total_units_sold, 0) AS total_units_sold
    , COALESCE(ps.total_sales_value, 0) AS total_sales_value
FROM products p
LEFT JOIN product_sales ps ON p.PRODUCT_ID = ps.PRODUCT_ID)

SELECT * FROM final
        );
[0m18:54:54.734235 [debug] [Thread-7  ]: On model.billy_bulky.int_products_performance: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.int_products_performance"} */
create or replace transient table E_COMMERCE.intermediate.int_products_performance
         as
        (WITH  __dbt__cte__staging_shopify__orders as (
WITH orders AS (
    SELECT * FROM SHOPIFY.PUBLIC.orders
)

SELECT
    ORDER_ID
    , CUSTOMER_ID
    , PRODUCT_ID
    , QUANTITY
    , ORDER_DATE
    , STATUS
FROM orders
),  __dbt__cte__staging_shopify__products as (
WITH products AS (
    SELECT * FROM SHOPIFY.PUBLIC.products
)

SELECT
    PRODUCT_ID
    , NAME
    , CATEGORY
    , PRICE
    , STOCK_LEVEL
FROM products
), orders AS (
    SELECT * FROM __dbt__cte__staging_shopify__orders
)

, products AS (
    SELECT * FROM __dbt__cte__staging_shopify__products
)

, product_sales AS (
    SELECT
        o.PRODUCT_ID
        , COUNT(DISTINCT o.ORDER_ID) AS total_sales
        , SUM(o.QUANTITY) AS total_units_sold
        , SUM(o.QUANTITY * p.PRICE) AS total_sales_value
    FROM orders o
    INNER JOIN products p ON o.PRODUCT_ID = p.PRODUCT_ID
    WHERE o.STATUS NOT IN ('cancelled') 
    GROUP BY o.PRODUCT_ID
)

, product_averages AS (
    SELECT
        PRODUCT_ID
        , (total_sales_value / NULLIF(total_units_sold, 0)) AS average_sale_price
    FROM product_sales
)

, product_stock_turnover AS (
    SELECT
        p.PRODUCT_ID
        , p.STOCK_LEVEL
        , (total_units_sold / NULLIF(p.STOCK_LEVEL, 0)) AS turnover_rate
    FROM product_sales ps
    INNER JOIN products p ON ps.PRODUCT_ID = p.PRODUCT_ID
)

, final AS (
    SELECT
    p.PRODUCT_ID
    , p.NAME
    , p.CATEGORY
    , p.PRICE
    , pa.average_sale_price
    , ps.total_sales
    , ps.total_units_sold
    , ps.total_sales_value
    , pst.turnover_rate
    , p.STOCK_LEVEL
FROM products p
LEFT JOIN product_sales ps ON p.PRODUCT_ID = ps.PRODUCT_ID
LEFT JOIN product_averages pa ON p.PRODUCT_ID = pa.PRODUCT_ID
LEFT JOIN product_stock_turnover pst ON p.PRODUCT_ID = pst.PRODUCT_ID
)

SELECT * FROM final
        );
[0m18:54:54.734536 [debug] [Thread-8  ]: Opening a new connection, currently in state init
[0m18:54:54.735072 [debug] [Thread-10 ]: On model.billy_bulky.sales: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.sales"} */
create or replace transient table E_COMMERCE.marts.sales
         as
        (WITH  __dbt__cte__staging_shopify__customers as (
WITH customers AS (
    SELECT * FROM SHOPIFY.PUBLIC.customers
)

SELECT
    CUSTOMER_ID
    , FIRST_NAME
    , LAST_NAME
    , EMAIL
    , JOIN_DATE
    , COUNTRY
FROM customers
),  __dbt__cte__staging_shopify__orders as (
WITH orders AS (
    SELECT * FROM SHOPIFY.PUBLIC.orders
)

SELECT
    ORDER_ID
    , CUSTOMER_ID
    , PRODUCT_ID
    , QUANTITY
    , ORDER_DATE
    , STATUS
FROM orders
),  __dbt__cte__staging_shopify__products as (
WITH products AS (
    SELECT * FROM SHOPIFY.PUBLIC.products
)

SELECT
    PRODUCT_ID
    , NAME
    , CATEGORY
    , PRICE
    , STOCK_LEVEL
FROM products
), customers AS (
    SELECT * FROM __dbt__cte__staging_shopify__customers
)

, orders AS (
    SELECT * FROM __dbt__cte__staging_shopify__orders
)

, products AS (
    SELECT * FROM __dbt__cte__staging_shopify__products
)



, enriched_orders AS (
    SELECT
        o.ORDER_ID
        , o.CUSTOMER_ID
        , o.PRODUCT_ID
        , o.QUANTITY
        , o.ORDER_DATE
        , o.STATUS
        , p.CATEGORY
        , p.PRICE AS unit_price
        , (o.QUANTITY * p.PRICE) AS total_price
        , c.COUNTRY
    FROM orders o
    JOIN products p ON o.PRODUCT_ID = p.PRODUCT_ID
    JOIN customers c ON o.CUSTOMER_ID = c.CUSTOMER_ID
    WHERE o.STATUS NOT IN ('cancelled') 
)

, final AS (
SELECT
    e.ORDER_ID
    , e.CUSTOMER_ID
    , e.PRODUCT_ID
    , e.QUANTITY
    , e.ORDER_DATE
    , e.STATUS
    , e.CATEGORY
    , e.unit_price
    , e.total_price
    , e.COUNTRY
FROM enriched_orders e
)

SELECT * FROM final
        );
[0m18:54:54.735365 [debug] [Thread-6  ]: Opening a new connection, currently in state init
[0m18:54:54.735815 [debug] [Thread-9  ]: Opening a new connection, currently in state init
[0m18:54:54.736059 [debug] [Thread-7  ]: Opening a new connection, currently in state init
[0m18:54:54.736566 [debug] [Thread-10 ]: Opening a new connection, currently in state init
[0m18:54:57.404219 [debug] [Thread-9  ]: SQL status: SUCCESS 1 in 3.0 seconds
[0m18:54:57.427396 [debug] [Thread-9  ]: Timing info for model.billy_bulky.products (execute): 18:54:54.718583 => 18:54:57.427166
[0m18:54:57.427816 [debug] [Thread-9  ]: On model.billy_bulky.products: Close
[0m18:54:57.610349 [debug] [Thread-8  ]: SQL status: SUCCESS 1 in 3.0 seconds
[0m18:54:57.612362 [debug] [Thread-8  ]: Timing info for model.billy_bulky.int_sales_trends (execute): 18:54:54.712478 => 18:54:57.612209
[0m18:54:57.612813 [debug] [Thread-5  ]: SQL status: SUCCESS 1 in 3.0 seconds
[0m18:54:57.613211 [debug] [Thread-8  ]: On model.billy_bulky.int_sales_trends: Close
[0m18:54:57.615034 [debug] [Thread-5  ]: Timing info for model.billy_bulky.customers (execute): 18:54:54.692918 => 18:54:57.614850
[0m18:54:57.616292 [debug] [Thread-5  ]: On model.billy_bulky.customers: Close
[0m18:54:57.621109 [debug] [Thread-6  ]: SQL status: SUCCESS 1 in 3.0 seconds
[0m18:54:57.622983 [debug] [Thread-6  ]: Timing info for model.billy_bulky.int_customers_segmentation (execute): 18:54:54.714586 => 18:54:57.622814
[0m18:54:57.623325 [debug] [Thread-6  ]: On model.billy_bulky.int_customers_segmentation: Close
[0m18:54:57.627929 [debug] [Thread-7  ]: SQL status: SUCCESS 1 in 3.0 seconds
[0m18:54:57.629741 [debug] [Thread-7  ]: Timing info for model.billy_bulky.int_products_performance (execute): 18:54:54.716841 => 18:54:57.629583
[0m18:54:57.630034 [debug] [Thread-7  ]: On model.billy_bulky.int_products_performance: Close
[0m18:54:57.832293 [debug] [Thread-9  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e456e668-1282-468f-9173-6757e27e7c40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12da831f0>]}
[0m18:54:57.836244 [info ] [Thread-9  ]: 5 of 6 OK created sql table model marts.products ............................... [[32mSUCCESS 1[0m in 3.21s]
[0m18:54:57.838372 [debug] [Thread-9  ]: Finished running node model.billy_bulky.products
[0m18:54:58.032243 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e456e668-1282-468f-9173-6757e27e7c40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12da424f0>]}
[0m18:54:58.034799 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e456e668-1282-468f-9173-6757e27e7c40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12d8369d0>]}
[0m18:54:58.036535 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e456e668-1282-468f-9173-6757e27e7c40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12dad9490>]}
[0m18:54:58.038126 [debug] [Thread-7  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e456e668-1282-468f-9173-6757e27e7c40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12dab3b20>]}
[0m18:54:58.039853 [info ] [Thread-8  ]: 4 of 6 OK created sql table model intermediate.int_sales_trends ................ [[32mSUCCESS 1[0m in 3.41s]
[0m18:54:58.040913 [info ] [Thread-6  ]: 2 of 6 OK created sql table model intermediate.int_customers_segmentation ...... [[32mSUCCESS 1[0m in 3.42s]
[0m18:54:58.045846 [debug] [Thread-8  ]: Finished running node model.billy_bulky.int_sales_trends
[0m18:54:58.042629 [info ] [Thread-5  ]: 1 of 6 OK created sql table model marts.customers .............................. [[32mSUCCESS 1[0m in 3.42s]
[0m18:54:58.044295 [info ] [Thread-7  ]: 3 of 6 OK created sql table model intermediate.int_products_performance ........ [[32mSUCCESS 1[0m in 3.42s]
[0m18:54:58.047479 [debug] [Thread-6  ]: Finished running node model.billy_bulky.int_customers_segmentation
[0m18:54:58.048682 [debug] [Thread-5  ]: Finished running node model.billy_bulky.customers
[0m18:54:58.049619 [debug] [Thread-7  ]: Finished running node model.billy_bulky.int_products_performance
[0m18:54:58.532869 [debug] [Thread-10 ]: SQL status: SUCCESS 1 in 4.0 seconds
[0m18:54:58.540533 [debug] [Thread-10 ]: Timing info for model.billy_bulky.sales (execute): 18:54:54.721733 => 18:54:58.540165
[0m18:54:58.541255 [debug] [Thread-10 ]: On model.billy_bulky.sales: Close
[0m18:54:59.050280 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e456e668-1282-468f-9173-6757e27e7c40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12db11cd0>]}
[0m18:54:59.052811 [info ] [Thread-10 ]: 6 of 6 OK created sql table model marts.sales .................................. [[32mSUCCESS 1[0m in 4.43s]
[0m18:54:59.054428 [debug] [Thread-10 ]: Finished running node model.billy_bulky.sales
[0m18:54:59.059388 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:54:59.060252 [debug] [MainThread]: Connection 'model.billy_bulky.staging_shopify__customers' was properly closed.
[0m18:54:59.060877 [debug] [MainThread]: Connection 'model.billy_bulky.staging_shopify__orders' was properly closed.
[0m18:54:59.061487 [debug] [MainThread]: Connection 'model.billy_bulky.staging_shopify__products' was properly closed.
[0m18:54:59.061995 [debug] [MainThread]: Connection 'model.billy_bulky.customers' was properly closed.
[0m18:54:59.062492 [debug] [MainThread]: Connection 'model.billy_bulky.int_customers_segmentation' was properly closed.
[0m18:54:59.062975 [debug] [MainThread]: Connection 'model.billy_bulky.int_products_performance' was properly closed.
[0m18:54:59.063492 [debug] [MainThread]: Connection 'model.billy_bulky.int_sales_trends' was properly closed.
[0m18:54:59.063993 [debug] [MainThread]: Connection 'model.billy_bulky.products' was properly closed.
[0m18:54:59.064724 [debug] [MainThread]: Connection 'model.billy_bulky.sales' was properly closed.
[0m18:54:59.065675 [info ] [MainThread]: 
[0m18:54:59.066829 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 7.86 seconds (7.86s).
[0m18:54:59.069630 [debug] [MainThread]: Command end result
[0m18:54:59.091114 [info ] [MainThread]: 
[0m18:54:59.091728 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:54:59.092168 [info ] [MainThread]: 
[0m18:54:59.092833 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m18:54:59.095632 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.599146, "process_user_time": 5.094814, "process_kernel_time": 0.266222, "process_mem_max_rss": "220102656", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:54:59.096396 [debug] [MainThread]: Command `dbt run` succeeded at 18:54:59.096245 after 8.60 seconds
[0m18:54:59.096845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107069eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12d81f8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x129ba4a30>]}
[0m18:54:59.097324 [debug] [MainThread]: Flushing usage events
[0m11:32:09.392444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10288deb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050dc7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050dca90>]}


============================== 11:32:09.395337 | 28c86d24-efe9-4138-bb27-12169544e054 ==============================
[0m11:32:09.395337 [info ] [MainThread]: Running with dbt=1.7.1
[0m11:32:09.395763 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/bitlevi/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/bitlevi/Documents/billy_bulky_ecommerce/billy_bulky_ecommerce/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:32:10.266977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '28c86d24-efe9-4138-bb27-12169544e054', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10237e940>]}
[0m11:32:10.314780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '28c86d24-efe9-4138-bb27-12169544e054', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105108f40>]}
[0m11:32:10.315383 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m11:32:10.329433 [debug] [MainThread]: checksum: ad428e6dc3b353dcb23d0c4ebea8b20b180e94b873271ac2a054a8e446dac0e2, vars: {}, profile: , target: , version: 1.7.1
[0m11:32:10.367043 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:32:10.367590 [debug] [MainThread]: Partial parsing: updated file: billy_bulky://models/marts/products.sql
[0m11:32:10.444947 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.billy_bulky.products' (models/marts/products.sql) depends on a node named 'int_product_performance' which was not found
[0m11:32:10.446937 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.0901139, "process_user_time": 3.767972, "process_kernel_time": 0.314632, "process_mem_max_rss": "195870720", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:32:10.447375 [debug] [MainThread]: Command `dbt run` failed at 11:32:10.447281 after 1.09 seconds
[0m11:32:10.447657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10288deb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12744ff40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12744fa60>]}
[0m11:32:10.447920 [debug] [MainThread]: Flushing usage events
[0m11:32:59.541035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107251250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109abd460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109abd850>]}


============================== 11:32:59.543838 | c578a061-7e9c-4e71-9b7a-dcebc8adb1a8 ==============================
[0m11:32:59.543838 [info ] [MainThread]: Running with dbt=1.7.1
[0m11:32:59.544194 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/bitlevi/Documents/billy_bulky_ecommerce/billy_bulky_ecommerce/logs', 'profiles_dir': '/Users/bitlevi/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:33:00.360185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c578a061-7e9c-4e71-9b7a-dcebc8adb1a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109aa0fa0>]}
[0m11:33:00.407759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c578a061-7e9c-4e71-9b7a-dcebc8adb1a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108200070>]}
[0m11:33:00.408242 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m11:33:00.421259 [debug] [MainThread]: checksum: ad428e6dc3b353dcb23d0c4ebea8b20b180e94b873271ac2a054a8e446dac0e2, vars: {}, profile: , target: , version: 1.7.1
[0m11:33:00.457196 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m11:33:00.457767 [debug] [MainThread]: Partial parsing: updated file: billy_bulky://models/intermediate/products/_int_products__models.yml
[0m11:33:00.458052 [debug] [MainThread]: Partial parsing: updated file: billy_bulky://models/marts/products.sql
[0m11:33:00.561159 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'int_products__performance' in the 'models' section of file 'models/intermediate/products/_int_products__models.yml'
[0m11:33:00.665974 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.billy_bulky.products' (models/marts/products.sql) depends on a node named 'int_products__performance' which was not found
[0m11:33:00.667628 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.1601356, "process_user_time": 3.878293, "process_kernel_time": 0.288438, "process_mem_max_rss": "198770688", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:33:00.667990 [debug] [MainThread]: Command `dbt run` failed at 11:33:00.667906 after 1.16 seconds
[0m11:33:00.668246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107251250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1391aba60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1391abe80>]}
[0m11:33:00.668548 [debug] [MainThread]: Flushing usage events
[0m11:35:26.358640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f696d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10591e9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093b8400>]}


============================== 11:35:26.361391 | c2b0f103-0ad8-42da-a6bb-a7ad79bf25e8 ==============================
[0m11:35:26.361391 [info ] [MainThread]: Running with dbt=1.7.1
[0m11:35:26.361748 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/bitlevi/Documents/billy_bulky_ecommerce/billy_bulky_ecommerce/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/bitlevi/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:35:27.182357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c2b0f103-0ad8-42da-a6bb-a7ad79bf25e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10591e9d0>]}
[0m11:35:27.230271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c2b0f103-0ad8-42da-a6bb-a7ad79bf25e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f93cc10>]}
[0m11:35:27.230791 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m11:35:27.244622 [debug] [MainThread]: checksum: ad428e6dc3b353dcb23d0c4ebea8b20b180e94b873271ac2a054a8e446dac0e2, vars: {}, profile: , target: , version: 1.7.1
[0m11:35:27.279689 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:35:27.280232 [debug] [MainThread]: Partial parsing: updated file: billy_bulky://models/marts/products.sql
[0m11:35:27.356785 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.billy_bulky.products' (models/marts/products.sql) depends on a node named 'int_product_performance' in package or project 'intermediate' which was not found
[0m11:35:27.358335 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.0317984, "process_user_time": 3.764512, "process_kernel_time": 0.297254, "process_mem_max_rss": "196411392", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:35:27.358726 [debug] [MainThread]: Command `dbt run` failed at 11:35:27.358635 after 1.03 seconds
[0m11:35:27.358982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f696d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1448b8f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1448b8b20>]}
[0m11:35:27.359246 [debug] [MainThread]: Flushing usage events
[0m11:40:44.657082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b590d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093a8af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093c5ee0>]}


============================== 11:40:44.659944 | 20a1d498-bd1e-4145-b609-eb9e2a4a9ee6 ==============================
[0m11:40:44.659944 [info ] [MainThread]: Running with dbt=1.7.1
[0m11:40:44.660314 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/bitlevi/Documents/billy_bulky_ecommerce/billy_bulky_ecommerce/logs', 'debug': 'False', 'profiles_dir': '/Users/bitlevi/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:40:45.580084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '20a1d498-bd1e-4145-b609-eb9e2a4a9ee6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f5a0e20>]}
[0m11:40:45.630409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '20a1d498-bd1e-4145-b609-eb9e2a4a9ee6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f718700>]}
[0m11:40:45.631118 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m11:40:45.644175 [debug] [MainThread]: checksum: ad428e6dc3b353dcb23d0c4ebea8b20b180e94b873271ac2a054a8e446dac0e2, vars: {}, profile: , target: , version: 1.7.1
[0m11:40:45.654651 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m11:40:45.654987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '20a1d498-bd1e-4145-b609-eb9e2a4a9ee6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f59e6d0>]}
[0m11:40:46.263979 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'orders' in the 'models' section of file 'models/staging/shopify/_shopify__schema.yml'
[0m11:40:46.373988 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'marts_sales' in the 'models' section of file 'models/marts/_marts__models.yml'
[0m11:40:46.375516 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'marts_customers' in the 'models' section of file 'models/marts/_marts__models.yml'
[0m11:40:46.376729 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'marts_products' in the 'models' section of file 'models/marts/_marts__models.yml'
[0m11:40:46.410895 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'int_customer_segmentation' in the 'models' section of file 'models/intermediate/customers/_int_customers__models.yml'
[0m11:40:46.453428 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.unique_orders_order_id.fed79b3a6e' (models/staging/shopify/_shopify__schema.yml) depends on a node named 'orders' in package '' which was not found
[0m11:40:46.453760 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_orders_order_id.cf6c17daed' (models/staging/shopify/_shopify__schema.yml) depends on a node named 'orders' in package '' which was not found
[0m11:40:46.453993 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_orders_customer_id.c5f02694af' (models/staging/shopify/_shopify__schema.yml) depends on a node named 'orders' in package '' which was not found
[0m11:40:46.454230 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_orders_product_id.3523c78a66' (models/staging/shopify/_shopify__schema.yml) depends on a node named 'orders' in package '' which was not found
[0m11:40:46.454508 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_orders_quantity.0e6bb23b03' (models/staging/shopify/_shopify__schema.yml) depends on a node named 'orders' in package '' which was not found
[0m11:40:46.454740 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_orders_order_date.6910a855fe' (models/staging/shopify/_shopify__schema.yml) depends on a node named 'orders' in package '' which was not found
[0m11:40:46.454959 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_orders_status.8a27272c0a' (models/staging/shopify/_shopify__schema.yml) depends on a node named 'orders' in package '' which was not found
[0m11:40:46.455176 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.accepted_values_orders_status__cancelled__processing__delivered__shipped.fbff2d9925' (models/staging/shopify/_shopify__schema.yml) depends on a node named 'orders' in package '' which was not found
[0m11:40:46.455421 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.unique_marts_sales_order_id.825e23650b' (models/marts/_marts__models.yml) depends on a node named 'marts_sales' in package '' which was not found
[0m11:40:46.455638 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_sales_order_id.842b56ef2f' (models/marts/_marts__models.yml) depends on a node named 'marts_sales' in package '' which was not found
[0m11:40:46.455847 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_sales_customer_id.189ac71c42' (models/marts/_marts__models.yml) depends on a node named 'marts_sales' in package '' which was not found
[0m11:40:46.456063 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.relationships_marts_sales_customer_id__customer_id__ref_customers_.74e21c3398' (models/marts/_marts__models.yml) depends on a node named 'marts_sales' in package '' which was not found
[0m11:40:46.456277 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_sales_product_id.12beecf4f2' (models/marts/_marts__models.yml) depends on a node named 'marts_sales' in package '' which was not found
[0m11:40:46.456493 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.relationships_marts_sales_product_id__product_id__ref_products_.77e7665182' (models/marts/_marts__models.yml) depends on a node named 'marts_sales' in package '' which was not found
[0m11:40:46.456704 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_sales_quantity.ea8c580869' (models/marts/_marts__models.yml) depends on a node named 'marts_sales' in package '' which was not found
[0m11:40:46.456912 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_sales_order_date.90eaa9e7fe' (models/marts/_marts__models.yml) depends on a node named 'marts_sales' in package '' which was not found
[0m11:40:46.457117 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_sales_status.e9b4b90247' (models/marts/_marts__models.yml) depends on a node named 'marts_sales' in package '' which was not found
[0m11:40:46.457321 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_sales_category.a98218f68d' (models/marts/_marts__models.yml) depends on a node named 'marts_sales' in package '' which was not found
[0m11:40:46.457526 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_sales_unit_price.321f152a2a' (models/marts/_marts__models.yml) depends on a node named 'marts_sales' in package '' which was not found
[0m11:40:46.457729 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_sales_total_price.015724a7e6' (models/marts/_marts__models.yml) depends on a node named 'marts_sales' in package '' which was not found
[0m11:40:46.457934 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_sales_country.5f628b732c' (models/marts/_marts__models.yml) depends on a node named 'marts_sales' in package '' which was not found
[0m11:40:46.458141 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.unique_marts_customers_customer_id.9c72620f57' (models/marts/_marts__models.yml) depends on a node named 'marts_customers' in package '' which was not found
[0m11:40:46.458352 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_customers_customer_id.fc7763eff9' (models/marts/_marts__models.yml) depends on a node named 'marts_customers' in package '' which was not found
[0m11:40:46.458560 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.unique_marts_customers_email.6210d26820' (models/marts/_marts__models.yml) depends on a node named 'marts_customers' in package '' which was not found
[0m11:40:46.458765 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_customers_email.637d2131e6' (models/marts/_marts__models.yml) depends on a node named 'marts_customers' in package '' which was not found
[0m11:40:46.458973 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_customers_join_date.6378efd424' (models/marts/_marts__models.yml) depends on a node named 'marts_customers' in package '' which was not found
[0m11:40:46.459181 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_customers_total_orders.7cdc5122e5' (models/marts/_marts__models.yml) depends on a node named 'marts_customers' in package '' which was not found
[0m11:40:46.459386 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_customers_total_spent.d5343aecc7' (models/marts/_marts__models.yml) depends on a node named 'marts_customers' in package '' which was not found
[0m11:40:46.459594 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.unique_marts_products_product_id.e96f554683' (models/marts/_marts__models.yml) depends on a node named 'marts_products' in package '' which was not found
[0m11:40:46.459803 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_products_product_id.9b354ae761' (models/marts/_marts__models.yml) depends on a node named 'marts_products' in package '' which was not found
[0m11:40:46.460350 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_products_name.f0d9c8d191' (models/marts/_marts__models.yml) depends on a node named 'marts_products' in package '' which was not found
[0m11:40:46.460616 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_products_category.1212ed3683' (models/marts/_marts__models.yml) depends on a node named 'marts_products' in package '' which was not found
[0m11:40:46.460845 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_products_price.d6207a2896' (models/marts/_marts__models.yml) depends on a node named 'marts_products' in package '' which was not found
[0m11:40:46.461065 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_products_total_units_sold.6822a804df' (models/marts/_marts__models.yml) depends on a node named 'marts_products' in package '' which was not found
[0m11:40:46.461288 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_products_total_sales_value.b0a2a654b3' (models/marts/_marts__models.yml) depends on a node named 'marts_products' in package '' which was not found
[0m11:40:46.461514 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.unique_int_customer_segmentation_customer_id.93378a6f29' (models/intermediate/customers/_int_customers__models.yml) depends on a node named 'int_customer_segmentation' in package '' which was not found
[0m11:40:46.461736 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_int_customer_segmentation_customer_id.b278231c99' (models/intermediate/customers/_int_customers__models.yml) depends on a node named 'int_customer_segmentation' in package '' which was not found
[0m11:40:46.461957 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_int_customer_segmentation_email.e4880b86d9' (models/intermediate/customers/_int_customers__models.yml) depends on a node named 'int_customer_segmentation' in package '' which was not found
[0m11:40:46.462175 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.unique_int_customer_segmentation_email.525579524b' (models/intermediate/customers/_int_customers__models.yml) depends on a node named 'int_customer_segmentation' in package '' which was not found
[0m11:40:46.462396 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_int_customer_segmentation_frequency.f45b5cc0b0' (models/intermediate/customers/_int_customers__models.yml) depends on a node named 'int_customer_segmentation' in package '' which was not found
[0m11:40:46.462612 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_int_customer_segmentation_monetary.97dee85c9d' (models/intermediate/customers/_int_customers__models.yml) depends on a node named 'int_customer_segmentation' in package '' which was not found
[0m11:40:46.462831 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_int_customer_segmentation_average_order_value.15c482d127' (models/intermediate/customers/_int_customers__models.yml) depends on a node named 'int_customer_segmentation' in package '' which was not found
[0m11:40:46.463044 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_int_customer_segmentation_cancellation_rate.49f1f06ae7' (models/intermediate/customers/_int_customers__models.yml) depends on a node named 'int_customer_segmentation' in package '' which was not found
[0m11:40:46.463257 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_int_customer_segmentation_recency.b3e8e1b730' (models/intermediate/customers/_int_customers__models.yml) depends on a node named 'int_customer_segmentation' in package '' which was not found
[0m11:40:46.463468 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_int_customer_segmentation_tenure.9a1e5d8cf9' (models/intermediate/customers/_int_customers__models.yml) depends on a node named 'int_customer_segmentation' in package '' which was not found
[0m11:40:46.463694 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.relationships_int_customer_segmentation_customer_id__ref_staging_shopify__customers_.03801bedb5' (models/intermediate/customers/_int_customers__models.yml) depends on a node named 'int_customer_segmentation' in package '' which was not found
[0m11:40:46.490941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '20a1d498-bd1e-4145-b609-eb9e2a4a9ee6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1205720d0>]}
[0m11:40:46.504791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '20a1d498-bd1e-4145-b609-eb9e2a4a9ee6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f7fb130>]}
[0m11:40:46.505129 [info ] [MainThread]: Found 9 models, 36 tests, 3 sources, 0 exposures, 0 metrics, 431 macros, 0 groups, 0 semantic models
[0m11:40:46.505347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '20a1d498-bd1e-4145-b609-eb9e2a4a9ee6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f845ac0>]}
[0m11:40:46.506753 [info ] [MainThread]: 
[0m11:40:46.507247 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:40:46.507995 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE'
[0m11:40:46.516449 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE"
[0m11:40:46.516969 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE'
[0m11:40:46.517220 [debug] [ThreadPool]: On list_E_COMMERCE: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE"} */
show terse schemas in database E_COMMERCE
    limit 10000
[0m11:40:46.518641 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE"
[0m11:40:46.518841 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:40:46.519034 [debug] [ThreadPool]: On list_E_COMMERCE: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE"} */
show terse schemas in database E_COMMERCE
    limit 10000
[0m11:40:46.519771 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:40:47.852310 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m11:40:47.853312 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m11:40:47.855090 [debug] [ThreadPool]: On list_E_COMMERCE: Close
[0m11:40:47.856683 [debug] [ThreadPool]: On list_E_COMMERCE: Close
[0m11:40:48.246232 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_E_COMMERCE, now list_E_COMMERCE_staging)
[0m11:40:48.247094 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_E_COMMERCE, now list_E_COMMERCE_marts)
[0m11:40:48.263666 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_marts"
[0m11:40:48.264914 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_staging"
[0m11:40:48.265426 [debug] [ThreadPool]: On list_E_COMMERCE_marts: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE_marts"} */
show terse objects in E_COMMERCE.marts limit 10000
[0m11:40:48.265954 [debug] [ThreadPool]: On list_E_COMMERCE_staging: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE_staging"} */
show terse objects in E_COMMERCE.staging limit 10000
[0m11:40:48.266416 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:40:48.266866 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:40:49.408336 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m11:40:49.413703 [debug] [ThreadPool]: On list_E_COMMERCE_marts: Close
[0m11:40:49.437490 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m11:40:49.441259 [debug] [ThreadPool]: On list_E_COMMERCE_staging: Close
[0m11:40:49.850956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '20a1d498-bd1e-4145-b609-eb9e2a4a9ee6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f09a970>]}
[0m11:40:49.853041 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m11:40:49.853688 [info ] [MainThread]: 
[0m11:40:49.857654 [debug] [Thread-1  ]: Began running node model.billy_bulky.staging_shopify__customers
[0m11:40:49.858468 [debug] [Thread-2  ]: Began running node model.billy_bulky.staging_shopify__orders
[0m11:40:49.860892 [info ] [Thread-1  ]: 1 of 6 START sql view model staging.staging_shopify__customers ................. [RUN]
[0m11:40:49.863722 [debug] [Thread-3  ]: Began running node model.billy_bulky.staging_shopify__products
[0m11:40:49.862200 [info ] [Thread-2  ]: 2 of 6 START sql view model staging.staging_shopify__orders .................... [RUN]
[0m11:40:49.864976 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_E_COMMERCE_staging, now model.billy_bulky.staging_shopify__customers)
[0m11:40:49.865783 [info ] [Thread-3  ]: 3 of 6 START sql view model staging.staging_shopify__products .................. [RUN]
[0m11:40:49.866883 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_E_COMMERCE_marts, now model.billy_bulky.staging_shopify__orders)
[0m11:40:49.867498 [debug] [Thread-1  ]: Began compiling node model.billy_bulky.staging_shopify__customers
[0m11:40:49.868530 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.billy_bulky.staging_shopify__products'
[0m11:40:49.869076 [debug] [Thread-2  ]: Began compiling node model.billy_bulky.staging_shopify__orders
[0m11:40:49.880198 [debug] [Thread-1  ]: Writing injected SQL for node "model.billy_bulky.staging_shopify__customers"
[0m11:40:49.880792 [debug] [Thread-3  ]: Began compiling node model.billy_bulky.staging_shopify__products
[0m11:40:49.884814 [debug] [Thread-2  ]: Writing injected SQL for node "model.billy_bulky.staging_shopify__orders"
[0m11:40:49.888044 [debug] [Thread-3  ]: Writing injected SQL for node "model.billy_bulky.staging_shopify__products"
[0m11:40:49.888803 [debug] [Thread-1  ]: Timing info for model.billy_bulky.staging_shopify__customers (compile): 11:40:49.869414 => 11:40:49.888550
[0m11:40:49.889263 [debug] [Thread-1  ]: Began executing node model.billy_bulky.staging_shopify__customers
[0m11:40:49.895164 [debug] [Thread-2  ]: Timing info for model.billy_bulky.staging_shopify__orders (compile): 11:40:49.881187 => 11:40:49.894847
[0m11:40:49.901373 [debug] [Thread-2  ]: Began executing node model.billy_bulky.staging_shopify__orders
[0m11:40:49.901961 [debug] [Thread-3  ]: Timing info for model.billy_bulky.staging_shopify__products (compile): 11:40:49.885197 => 11:40:49.901702
[0m11:40:49.917137 [debug] [Thread-1  ]: Writing runtime sql for node "model.billy_bulky.staging_shopify__customers"
[0m11:40:49.919969 [debug] [Thread-2  ]: Writing runtime sql for node "model.billy_bulky.staging_shopify__orders"
[0m11:40:49.920329 [debug] [Thread-3  ]: Began executing node model.billy_bulky.staging_shopify__products
[0m11:40:49.922902 [debug] [Thread-3  ]: Writing runtime sql for node "model.billy_bulky.staging_shopify__products"
[0m11:40:49.924627 [debug] [Thread-1  ]: Using snowflake connection "model.billy_bulky.staging_shopify__customers"
[0m11:40:49.925227 [debug] [Thread-2  ]: Using snowflake connection "model.billy_bulky.staging_shopify__orders"
[0m11:40:49.925542 [debug] [Thread-1  ]: On model.billy_bulky.staging_shopify__customers: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.staging_shopify__customers"} */
create or replace   view E_COMMERCE.staging.staging_shopify__customers
  
   as (
    WITH customers AS (
    SELECT * FROM SHOPIFY.PUBLIC.customers
)

SELECT
    CUSTOMER_ID
    , FIRST_NAME
    , LAST_NAME
    , EMAIL
    , JOIN_DATE
    , COUNTRY
FROM customers
  );
[0m11:40:49.925887 [debug] [Thread-2  ]: On model.billy_bulky.staging_shopify__orders: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.staging_shopify__orders"} */
create or replace   view E_COMMERCE.staging.staging_shopify__orders
  
   as (
    WITH orders AS (
    SELECT * FROM SHOPIFY.PUBLIC.orders
)

SELECT
    ORDER_ID
    , CUSTOMER_ID
    , PRODUCT_ID
    , QUANTITY
    , ORDER_DATE
    , STATUS
FROM orders
  );
[0m11:40:49.926202 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:40:49.926738 [debug] [Thread-3  ]: Using snowflake connection "model.billy_bulky.staging_shopify__products"
[0m11:40:49.926999 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m11:40:49.927523 [debug] [Thread-3  ]: On model.billy_bulky.staging_shopify__products: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.staging_shopify__products"} */
create or replace   view E_COMMERCE.staging.staging_shopify__products
  
   as (
    WITH products AS (
    SELECT * FROM SHOPIFY.PUBLIC.products
)

SELECT
    PRODUCT_ID
    , NAME
    , CATEGORY
    , PRICE
    , STOCK_LEVEL
FROM products
  );
[0m11:40:49.928333 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m11:40:51.177468 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m11:40:51.202545 [debug] [Thread-1  ]: Timing info for model.billy_bulky.staging_shopify__customers (execute): 11:40:49.889526 => 11:40:51.202326
[0m11:40:51.202951 [debug] [Thread-1  ]: On model.billy_bulky.staging_shopify__customers: Close
[0m11:40:51.559947 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m11:40:51.567001 [debug] [Thread-3  ]: Timing info for model.billy_bulky.staging_shopify__products (execute): 11:40:49.920675 => 11:40:51.566600
[0m11:40:51.567768 [debug] [Thread-3  ]: On model.billy_bulky.staging_shopify__products: Close
[0m11:40:51.660116 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20a1d498-bd1e-4145-b609-eb9e2a4a9ee6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120a5c7c0>]}
[0m11:40:51.661577 [info ] [Thread-1  ]: 1 of 6 OK created sql view model staging.staging_shopify__customers ............ [[32mSUCCESS 1[0m in 1.80s]
[0m11:40:51.662691 [debug] [Thread-1  ]: Finished running node model.billy_bulky.staging_shopify__customers
[0m11:40:51.729959 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m11:40:51.736035 [debug] [Thread-2  ]: Timing info for model.billy_bulky.staging_shopify__orders (execute): 11:40:49.917450 => 11:40:51.735623
[0m11:40:51.736809 [debug] [Thread-2  ]: On model.billy_bulky.staging_shopify__orders: Close
[0m11:40:51.927183 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20a1d498-bd1e-4145-b609-eb9e2a4a9ee6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120a610a0>]}
[0m11:40:51.928744 [info ] [Thread-3  ]: 3 of 6 OK created sql view model staging.staging_shopify__products ............. [[32mSUCCESS 1[0m in 2.06s]
[0m11:40:51.930592 [debug] [Thread-3  ]: Finished running node model.billy_bulky.staging_shopify__products
[0m11:40:52.195434 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20a1d498-bd1e-4145-b609-eb9e2a4a9ee6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120b65e80>]}
[0m11:40:52.196868 [info ] [Thread-2  ]: 2 of 6 OK created sql view model staging.staging_shopify__orders ............... [[32mSUCCESS 1[0m in 2.33s]
[0m11:40:52.197749 [debug] [Thread-2  ]: Finished running node model.billy_bulky.staging_shopify__orders
[0m11:40:52.198705 [debug] [Thread-5  ]: Began running node model.billy_bulky.customers
[0m11:40:52.199308 [debug] [Thread-6  ]: Began running node model.billy_bulky.int_customers_segmentation
[0m11:40:52.200296 [debug] [Thread-7  ]: Began running node model.billy_bulky.int_products_performance
[0m11:40:52.200782 [debug] [Thread-8  ]: Began running node model.billy_bulky.int_sales_trends
[0m11:40:52.199873 [info ] [Thread-5  ]: 4 of 6 START sql table model marts.customers ................................... [RUN]
[0m11:40:52.201231 [debug] [Thread-9  ]: Began running node model.billy_bulky.sales
[0m11:40:52.202008 [debug] [Thread-6  ]: Acquiring new snowflake connection 'model.billy_bulky.int_customers_segmentation'
[0m11:40:52.202718 [debug] [Thread-7  ]: Acquiring new snowflake connection 'model.billy_bulky.int_products_performance'
[0m11:40:52.203453 [debug] [Thread-8  ]: Acquiring new snowflake connection 'model.billy_bulky.int_sales_trends'
[0m11:40:52.204213 [debug] [Thread-5  ]: Acquiring new snowflake connection 'model.billy_bulky.customers'
[0m11:40:52.204789 [info ] [Thread-9  ]: 5 of 6 START sql table model marts.sales ....................................... [RUN]
[0m11:40:52.205219 [debug] [Thread-6  ]: Began compiling node model.billy_bulky.int_customers_segmentation
[0m11:40:52.205560 [debug] [Thread-7  ]: Began compiling node model.billy_bulky.int_products_performance
[0m11:40:52.205890 [debug] [Thread-8  ]: Began compiling node model.billy_bulky.int_sales_trends
[0m11:40:52.206212 [debug] [Thread-5  ]: Began compiling node model.billy_bulky.customers
[0m11:40:52.206893 [debug] [Thread-9  ]: Acquiring new snowflake connection 'model.billy_bulky.sales'
[0m11:40:52.211041 [debug] [Thread-6  ]: Writing injected SQL for node "model.billy_bulky.int_customers_segmentation"
[0m11:40:52.214251 [debug] [Thread-7  ]: Writing injected SQL for node "model.billy_bulky.int_products_performance"
[0m11:40:52.217164 [debug] [Thread-8  ]: Writing injected SQL for node "model.billy_bulky.int_sales_trends"
[0m11:40:52.219799 [debug] [Thread-5  ]: Writing injected SQL for node "model.billy_bulky.customers"
[0m11:40:52.220124 [debug] [Thread-9  ]: Began compiling node model.billy_bulky.sales
[0m11:40:52.224095 [debug] [Thread-9  ]: Writing injected SQL for node "model.billy_bulky.sales"
[0m11:40:52.224741 [debug] [Thread-8  ]: Timing info for model.billy_bulky.int_sales_trends (compile): 11:40:52.214532 => 11:40:52.224419
[0m11:40:52.225962 [debug] [Thread-8  ]: Finished running node model.billy_bulky.int_sales_trends
[0m11:40:52.226541 [debug] [Thread-6  ]: Timing info for model.billy_bulky.int_customers_segmentation (compile): 11:40:52.207117 => 11:40:52.226269
[0m11:40:52.227076 [debug] [Thread-7  ]: Timing info for model.billy_bulky.int_products_performance (compile): 11:40:52.211409 => 11:40:52.226824
[0m11:40:52.227787 [debug] [Thread-9  ]: Timing info for model.billy_bulky.sales (compile): 11:40:52.220771 => 11:40:52.227510
[0m11:40:52.228935 [debug] [Thread-6  ]: Finished running node model.billy_bulky.int_customers_segmentation
[0m11:40:52.230026 [debug] [Thread-7  ]: Finished running node model.billy_bulky.int_products_performance
[0m11:40:52.230526 [debug] [Thread-5  ]: Timing info for model.billy_bulky.customers (compile): 11:40:52.217405 => 11:40:52.230309
[0m11:40:52.230926 [debug] [Thread-9  ]: Began executing node model.billy_bulky.sales
[0m11:40:52.231558 [debug] [Thread-5  ]: Began executing node model.billy_bulky.customers
[0m11:40:52.231953 [debug] [Thread-4  ]: Began running node model.billy_bulky.products
[0m11:40:52.262049 [debug] [Thread-5  ]: Writing runtime sql for node "model.billy_bulky.customers"
[0m11:40:52.262467 [info ] [Thread-4  ]: 6 of 6 START sql table model marts.products .................................... [RUN]
[0m11:40:52.264665 [debug] [Thread-9  ]: Writing runtime sql for node "model.billy_bulky.sales"
[0m11:40:52.265344 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.billy_bulky.products'
[0m11:40:52.265787 [debug] [Thread-4  ]: Began compiling node model.billy_bulky.products
[0m11:40:52.271037 [debug] [Thread-4  ]: Writing injected SQL for node "model.billy_bulky.products"
[0m11:40:52.272480 [debug] [Thread-5  ]: Using snowflake connection "model.billy_bulky.customers"
[0m11:40:52.273618 [debug] [Thread-9  ]: Using snowflake connection "model.billy_bulky.sales"
[0m11:40:52.273946 [debug] [Thread-5  ]: On model.billy_bulky.customers: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.customers"} */
create or replace transient table E_COMMERCE.marts.customers
         as
        (WITH customers AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__customers
)

, orders AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__orders
)

, products AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__products
)

, source AS (
    SELECT
        c.CUSTOMER_ID
        , c.FIRST_NAME
        , c.LAST_NAME
        , c.EMAIL
        , c.JOIN_DATE
        , c.COUNTRY
        , COUNT(o.ORDER_ID) AS total_orders
        , SUM(o.QUANTITY * p.PRICE) AS total_spent
    FROM customers c
    LEFT JOIN orders o ON c.CUSTOMER_ID = o.CUSTOMER_ID
    LEFT JOIN products p ON o.PRODUCT_ID = p.PRODUCT_ID
    WHERE o.STATUS NOT IN ('cancelled')
    GROUP BY c.CUSTOMER_ID, c.FIRST_NAME, c.LAST_NAME, c.EMAIL, c.JOIN_DATE, c.COUNTRY
)

, final AS (
SELECT
    s.CUSTOMER_ID
    , s.FIRST_NAME
    , s.LAST_NAME
    , s.EMAIL
    , s.JOIN_DATE
    , s.COUNTRY
    , s.total_orders
    , s.total_spent
    , CASE WHEN s.total_spent > 1000 THEN 'VIP' ELSE 'Regular' END AS customer_segment 
FROM source s
)

SELECT * FROM final
        );
[0m11:40:52.274331 [debug] [Thread-9  ]: On model.billy_bulky.sales: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.sales"} */
create or replace transient table E_COMMERCE.marts.sales
         as
        (WITH customers AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__customers
)

, orders AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__orders
)

, products AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__products
)



, enriched_orders AS (
    SELECT
        o.ORDER_ID
        , o.CUSTOMER_ID
        , o.PRODUCT_ID
        , o.QUANTITY
        , o.ORDER_DATE
        , o.STATUS
        , p.CATEGORY
        , p.PRICE AS unit_price
        , (o.QUANTITY * p.PRICE) AS total_price
        , c.COUNTRY
    FROM orders o
    JOIN products p ON o.PRODUCT_ID = p.PRODUCT_ID
    JOIN customers c ON o.CUSTOMER_ID = c.CUSTOMER_ID
    WHERE o.STATUS NOT IN ('cancelled') 
)

, final AS (
SELECT
    e.ORDER_ID
    , e.CUSTOMER_ID
    , e.PRODUCT_ID
    , e.QUANTITY
    , e.ORDER_DATE
    , e.STATUS
    , e.CATEGORY
    , e.unit_price
    , e.total_price
    , e.COUNTRY
FROM enriched_orders e
)

SELECT * FROM final
        );
[0m11:40:52.274651 [debug] [Thread-5  ]: Opening a new connection, currently in state init
[0m11:40:52.274955 [debug] [Thread-4  ]: Timing info for model.billy_bulky.products (compile): 11:40:52.266043 => 11:40:52.274813
[0m11:40:52.275190 [debug] [Thread-9  ]: Opening a new connection, currently in state init
[0m11:40:52.275998 [debug] [Thread-4  ]: Began executing node model.billy_bulky.products
[0m11:40:52.278802 [debug] [Thread-4  ]: Writing runtime sql for node "model.billy_bulky.products"
[0m11:40:52.281439 [debug] [Thread-4  ]: Using snowflake connection "model.billy_bulky.products"
[0m11:40:52.281796 [debug] [Thread-4  ]: On model.billy_bulky.products: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.products"} */
create or replace transient table E_COMMERCE.marts.products
         as
        (WITH  __dbt__cte__int_products_performance as (
WITH orders AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__orders
)

, products AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__products
)

, product_sales AS (
    SELECT
        o.PRODUCT_ID
        , COUNT(DISTINCT o.ORDER_ID) AS total_sales
        , SUM(o.QUANTITY) AS total_units_sold
        , SUM(o.QUANTITY * p.PRICE) AS total_sales_value
    FROM orders o
    INNER JOIN products p ON o.PRODUCT_ID = p.PRODUCT_ID
    WHERE o.STATUS NOT IN ('cancelled') 
    GROUP BY o.PRODUCT_ID
)

, product_averages AS (
    SELECT
        PRODUCT_ID
        , (total_sales_value / NULLIF(total_units_sold, 0)) AS average_sale_price
    FROM product_sales
)

, product_stock_turnover AS (
    SELECT
        p.PRODUCT_ID
        , p.STOCK_LEVEL
        , (total_units_sold / NULLIF(p.STOCK_LEVEL, 0)) AS turnover_rate
    FROM product_sales ps
    INNER JOIN products p ON ps.PRODUCT_ID = p.PRODUCT_ID
)

, final AS (
    SELECT
    p.PRODUCT_ID
    , p.NAME
    , p.CATEGORY
    , p.PRICE
    , pa.average_sale_price
    , ps.total_sales
    , ps.total_units_sold
    , ps.total_sales_value
    , pst.turnover_rate
    , p.STOCK_LEVEL
FROM products p
LEFT JOIN product_sales ps ON p.PRODUCT_ID = ps.PRODUCT_ID
LEFT JOIN product_averages pa ON p.PRODUCT_ID = pa.PRODUCT_ID
LEFT JOIN product_stock_turnover pst ON p.PRODUCT_ID = pst.PRODUCT_ID
)

SELECT * FROM final
), final AS (
    SELECT
        pp.PRODUCT_ID
        , pp.NAME
        , pp.CATEGORY
        , pp.PRICE
        , pp.average_sale_price
        , pp.total_sales
        , pp.total_units_sold
        , pp.total_sales_value
        , pp.turnover_rate
        , pp.STOCK_LEVEL
    FROM __dbt__cte__int_products_performance pp
)

SELECT * FROM final
        );
[0m11:40:52.282122 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m11:40:55.532781 [debug] [Thread-5  ]: SQL status: SUCCESS 1 in 3.0 seconds
[0m11:40:55.534799 [debug] [Thread-9  ]: SQL status: SUCCESS 1 in 3.0 seconds
[0m11:40:55.541276 [debug] [Thread-5  ]: Timing info for model.billy_bulky.customers (execute): 11:40:52.244769 => 11:40:55.540827
[0m11:40:55.546000 [debug] [Thread-9  ]: Timing info for model.billy_bulky.sales (execute): 11:40:52.232230 => 11:40:55.545603
[0m11:40:55.546773 [debug] [Thread-5  ]: On model.billy_bulky.customers: Close
[0m11:40:55.547441 [debug] [Thread-9  ]: On model.billy_bulky.sales: Close
[0m11:40:55.649405 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 3.0 seconds
[0m11:40:55.654812 [debug] [Thread-4  ]: Timing info for model.billy_bulky.products (execute): 11:40:52.276731 => 11:40:55.654437
[0m11:40:55.655510 [debug] [Thread-4  ]: On model.billy_bulky.products: Close
[0m11:40:55.915519 [debug] [Thread-9  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20a1d498-bd1e-4145-b609-eb9e2a4a9ee6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f87a220>]}
[0m11:40:55.917259 [info ] [Thread-9  ]: 5 of 6 OK created sql table model marts.sales .................................. [[32mSUCCESS 1[0m in 3.71s]
[0m11:40:55.917749 [debug] [Thread-9  ]: Finished running node model.billy_bulky.sales
[0m11:40:55.918849 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20a1d498-bd1e-4145-b609-eb9e2a4a9ee6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fe77970>]}
[0m11:40:55.919269 [info ] [Thread-5  ]: 4 of 6 OK created sql table model marts.customers .............................. [[32mSUCCESS 1[0m in 3.71s]
[0m11:40:55.919650 [debug] [Thread-5  ]: Finished running node model.billy_bulky.customers
[0m11:40:56.013548 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20a1d498-bd1e-4145-b609-eb9e2a4a9ee6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120a52160>]}
[0m11:40:56.015184 [info ] [Thread-4  ]: 6 of 6 OK created sql table model marts.products ............................... [[32mSUCCESS 1[0m in 3.75s]
[0m11:40:56.016513 [debug] [Thread-4  ]: Finished running node model.billy_bulky.products
[0m11:40:56.019508 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:40:56.020175 [debug] [MainThread]: Connection 'model.billy_bulky.staging_shopify__customers' was properly closed.
[0m11:40:56.020721 [debug] [MainThread]: Connection 'model.billy_bulky.staging_shopify__orders' was properly closed.
[0m11:40:56.021218 [debug] [MainThread]: Connection 'model.billy_bulky.staging_shopify__products' was properly closed.
[0m11:40:56.021702 [debug] [MainThread]: Connection 'model.billy_bulky.int_customers_segmentation' was properly closed.
[0m11:40:56.022179 [debug] [MainThread]: Connection 'model.billy_bulky.int_products_performance' was properly closed.
[0m11:40:56.022652 [debug] [MainThread]: Connection 'model.billy_bulky.int_sales_trends' was properly closed.
[0m11:40:56.023126 [debug] [MainThread]: Connection 'model.billy_bulky.customers' was properly closed.
[0m11:40:56.023595 [debug] [MainThread]: Connection 'model.billy_bulky.sales' was properly closed.
[0m11:40:56.024070 [debug] [MainThread]: Connection 'model.billy_bulky.products' was properly closed.
[0m11:40:56.024674 [info ] [MainThread]: 
[0m11:40:56.025279 [info ] [MainThread]: Finished running 3 view models, 3 table models in 0 hours 0 minutes and 9.52 seconds (9.52s).
[0m11:40:56.027437 [debug] [MainThread]: Command end result
[0m11:40:56.044529 [info ] [MainThread]: 
[0m11:40:56.045275 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:40:56.045779 [info ] [MainThread]: 
[0m11:40:56.046262 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m11:40:56.050093 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.427523, "process_user_time": 5.782525, "process_kernel_time": 0.549942, "process_mem_max_rss": "223395840", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:40:56.050689 [debug] [MainThread]: Command `dbt run` succeeded at 11:40:56.050555 after 11.43 seconds
[0m11:40:56.051098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b590d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120380220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f76f640>]}
[0m11:40:56.051519 [debug] [MainThread]: Flushing usage events
[0m11:50:33.028105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051d56d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cc69d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a24400>]}


============================== 11:50:33.030881 | 21ec8687-cd8a-41cf-81c7-06dcc83cd466 ==============================
[0m11:50:33.030881 [info ] [MainThread]: Running with dbt=1.7.1
[0m11:50:33.031220 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/bitlevi/Documents/billy_bulky_ecommerce/billy_bulky_ecommerce/logs', 'version_check': 'True', 'profiles_dir': '/Users/bitlevi/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m11:50:33.859578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '21ec8687-cd8a-41cf-81c7-06dcc83cd466', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cc69d0>]}
[0m11:50:33.907133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '21ec8687-cd8a-41cf-81c7-06dcc83cd466', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e8e4550>]}
[0m11:50:33.907754 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m11:50:33.920725 [debug] [MainThread]: checksum: ad428e6dc3b353dcb23d0c4ebea8b20b180e94b873271ac2a054a8e446dac0e2, vars: {}, profile: , target: , version: 1.7.1
[0m11:50:33.956459 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 3 files changed.
[0m11:50:33.957008 [debug] [MainThread]: Partial parsing: added file: billy_bulky://models/intermediate/sales/int_sales_trend.sql
[0m11:50:33.957389 [debug] [MainThread]: Partial parsing: updated file: billy_bulky://models/intermediate/sales/_int_sales__models.yml
[0m11:50:33.957600 [debug] [MainThread]: Partial parsing: deleted file: billy_bulky://models/intermediate/sales/int_sales_trends.sql
[0m11:50:33.957864 [debug] [MainThread]: Partial parsing: updated file: billy_bulky://models/marts/customers.sql
[0m11:50:33.958106 [debug] [MainThread]: Partial parsing: updated file: billy_bulky://models/marts/sales.sql
[0m11:50:34.172502 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.billy_bulky.customers' (models/marts/customers.sql) depends on a node named 'int_customer_segmentation' which was not found
[0m11:50:34.174378 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.1810995, "process_user_time": 3.874343, "process_kernel_time": 0.338725, "process_mem_max_rss": "198639616", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:50:34.174728 [debug] [MainThread]: Command `dbt run` failed at 11:50:34.174650 after 1.18 seconds
[0m11:50:34.174972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051d56d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ab78be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ab78f70>]}
[0m11:50:34.175219 [debug] [MainThread]: Flushing usage events
[0m11:51:30.216336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072d0eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dc3910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112978130>]}


============================== 11:51:30.219005 | 38155433-648d-4f92-825c-bc9b14509bf7 ==============================
[0m11:51:30.219005 [info ] [MainThread]: Running with dbt=1.7.1
[0m11:51:30.219363 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/bitlevi/Documents/billy_bulky_ecommerce/billy_bulky_ecommerce/logs', 'profiles_dir': '/Users/bitlevi/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:51:31.022546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '38155433-648d-4f92-825c-bc9b14509bf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dc3910>]}
[0m11:51:31.069937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '38155433-648d-4f92-825c-bc9b14509bf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13e025040>]}
[0m11:51:31.070773 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m11:51:31.083908 [debug] [MainThread]: checksum: ad428e6dc3b353dcb23d0c4ebea8b20b180e94b873271ac2a054a8e446dac0e2, vars: {}, profile: , target: , version: 1.7.1
[0m11:51:31.118894 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 4 files changed.
[0m11:51:31.119425 [debug] [MainThread]: Partial parsing: added file: billy_bulky://models/intermediate/sales/int_sales_trend.sql
[0m11:51:31.119781 [debug] [MainThread]: Partial parsing: updated file: billy_bulky://models/intermediate/sales/_int_sales__models.yml
[0m11:51:31.120087 [debug] [MainThread]: Partial parsing: updated file: billy_bulky://models/intermediate/customers/_int_customers__models.yml
[0m11:51:31.120277 [debug] [MainThread]: Partial parsing: deleted file: billy_bulky://models/intermediate/sales/int_sales_trends.sql
[0m11:51:31.120528 [debug] [MainThread]: Partial parsing: updated file: billy_bulky://models/marts/customers.sql
[0m11:51:31.120762 [debug] [MainThread]: Partial parsing: updated file: billy_bulky://models/marts/sales.sql
[0m11:51:31.361198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '38155433-648d-4f92-825c-bc9b14509bf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13f2150d0>]}
[0m11:51:31.372228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '38155433-648d-4f92-825c-bc9b14509bf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13e9c8850>]}
[0m11:51:31.372541 [info ] [MainThread]: Found 9 models, 47 tests, 3 sources, 0 exposures, 0 metrics, 431 macros, 0 groups, 0 semantic models
[0m11:51:31.372764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '38155433-648d-4f92-825c-bc9b14509bf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13e9c87f0>]}
[0m11:51:31.374130 [info ] [MainThread]: 
[0m11:51:31.374608 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:51:31.375424 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE'
[0m11:51:31.384059 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE"
[0m11:51:31.384571 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE'
[0m11:51:31.384772 [debug] [ThreadPool]: On list_E_COMMERCE: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE"} */
show terse schemas in database E_COMMERCE
    limit 10000
[0m11:51:31.386203 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE"
[0m11:51:31.386410 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:51:31.386596 [debug] [ThreadPool]: On list_E_COMMERCE: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE"} */
show terse schemas in database E_COMMERCE
    limit 10000
[0m11:51:31.387328 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:51:32.771581 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m11:51:32.775519 [debug] [ThreadPool]: On list_E_COMMERCE: Close
[0m11:51:32.807990 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m11:51:32.810571 [debug] [ThreadPool]: On list_E_COMMERCE: Close
[0m11:51:33.176552 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_E_COMMERCE, now list_E_COMMERCE_marts)
[0m11:51:33.180441 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_E_COMMERCE, now list_E_COMMERCE_staging)
[0m11:51:33.192789 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_staging"
[0m11:51:33.195321 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_marts"
[0m11:51:33.195747 [debug] [ThreadPool]: On list_E_COMMERCE_staging: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE_staging"} */
show terse objects in E_COMMERCE.staging limit 10000
[0m11:51:33.196169 [debug] [ThreadPool]: On list_E_COMMERCE_marts: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE_marts"} */
show terse objects in E_COMMERCE.marts limit 10000
[0m11:51:33.196574 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:51:33.196939 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:51:34.440490 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m11:51:34.441886 [debug] [ThreadPool]: On list_E_COMMERCE_marts: Close
[0m11:51:35.809421 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 3.0 seconds
[0m11:51:35.816359 [debug] [ThreadPool]: On list_E_COMMERCE_staging: Close
[0m11:51:36.198499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '38155433-648d-4f92-825c-bc9b14509bf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13e9c8a00>]}
[0m11:51:36.200308 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m11:51:36.200960 [info ] [MainThread]: 
[0m11:51:36.205997 [debug] [Thread-1  ]: Began running node model.billy_bulky.staging_shopify__customers
[0m11:51:36.206869 [debug] [Thread-2  ]: Began running node model.billy_bulky.staging_shopify__orders
[0m11:51:36.208334 [info ] [Thread-1  ]: 1 of 6 START sql view model staging.staging_shopify__customers ................. [RUN]
[0m11:51:36.209323 [debug] [Thread-3  ]: Began running node model.billy_bulky.staging_shopify__products
[0m11:51:36.210062 [info ] [Thread-2  ]: 2 of 6 START sql view model staging.staging_shopify__orders .................... [RUN]
[0m11:51:36.211411 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_E_COMMERCE_marts, now model.billy_bulky.staging_shopify__customers)
[0m11:51:36.212238 [info ] [Thread-3  ]: 3 of 6 START sql view model staging.staging_shopify__products .................. [RUN]
[0m11:51:36.213410 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_E_COMMERCE_staging, now model.billy_bulky.staging_shopify__orders)
[0m11:51:36.214029 [debug] [Thread-1  ]: Began compiling node model.billy_bulky.staging_shopify__customers
[0m11:51:36.215049 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.billy_bulky.staging_shopify__products'
[0m11:51:36.215610 [debug] [Thread-2  ]: Began compiling node model.billy_bulky.staging_shopify__orders
[0m11:51:36.226427 [debug] [Thread-1  ]: Writing injected SQL for node "model.billy_bulky.staging_shopify__customers"
[0m11:51:36.227024 [debug] [Thread-3  ]: Began compiling node model.billy_bulky.staging_shopify__products
[0m11:51:36.230835 [debug] [Thread-2  ]: Writing injected SQL for node "model.billy_bulky.staging_shopify__orders"
[0m11:51:36.234585 [debug] [Thread-3  ]: Writing injected SQL for node "model.billy_bulky.staging_shopify__products"
[0m11:51:36.235356 [debug] [Thread-1  ]: Timing info for model.billy_bulky.staging_shopify__customers (compile): 11:51:36.215950 => 11:51:36.235109
[0m11:51:36.235788 [debug] [Thread-1  ]: Began executing node model.billy_bulky.staging_shopify__customers
[0m11:51:36.248154 [debug] [Thread-3  ]: Timing info for model.billy_bulky.staging_shopify__products (compile): 11:51:36.231420 => 11:51:36.247839
[0m11:51:36.255206 [debug] [Thread-3  ]: Began executing node model.billy_bulky.staging_shopify__products
[0m11:51:36.255626 [debug] [Thread-2  ]: Timing info for model.billy_bulky.staging_shopify__orders (compile): 11:51:36.227343 => 11:51:36.255417
[0m11:51:36.263739 [debug] [Thread-1  ]: Writing runtime sql for node "model.billy_bulky.staging_shopify__customers"
[0m11:51:36.266338 [debug] [Thread-3  ]: Writing runtime sql for node "model.billy_bulky.staging_shopify__products"
[0m11:51:36.266672 [debug] [Thread-2  ]: Began executing node model.billy_bulky.staging_shopify__orders
[0m11:51:36.268980 [debug] [Thread-2  ]: Writing runtime sql for node "model.billy_bulky.staging_shopify__orders"
[0m11:51:36.269797 [debug] [Thread-1  ]: Using snowflake connection "model.billy_bulky.staging_shopify__customers"
[0m11:51:36.270314 [debug] [Thread-3  ]: Using snowflake connection "model.billy_bulky.staging_shopify__products"
[0m11:51:36.270610 [debug] [Thread-1  ]: On model.billy_bulky.staging_shopify__customers: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.staging_shopify__customers"} */
create or replace   view E_COMMERCE.staging.staging_shopify__customers
  
   as (
    WITH customers AS (
    SELECT * FROM SHOPIFY.PUBLIC.customers
)

SELECT
    CUSTOMER_ID
    , FIRST_NAME
    , LAST_NAME
    , EMAIL
    , JOIN_DATE
    , COUNTRY
FROM customers
  );
[0m11:51:36.271136 [debug] [Thread-2  ]: Using snowflake connection "model.billy_bulky.staging_shopify__orders"
[0m11:51:36.271406 [debug] [Thread-3  ]: On model.billy_bulky.staging_shopify__products: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.staging_shopify__products"} */
create or replace   view E_COMMERCE.staging.staging_shopify__products
  
   as (
    WITH products AS (
    SELECT * FROM SHOPIFY.PUBLIC.products
)

SELECT
    PRODUCT_ID
    , NAME
    , CATEGORY
    , PRICE
    , STOCK_LEVEL
FROM products
  );
[0m11:51:36.271685 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:51:36.271964 [debug] [Thread-2  ]: On model.billy_bulky.staging_shopify__orders: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.staging_shopify__orders"} */
create or replace   view E_COMMERCE.staging.staging_shopify__orders
  
   as (
    WITH orders AS (
    SELECT * FROM SHOPIFY.PUBLIC.orders
)

SELECT
    ORDER_ID
    , CUSTOMER_ID
    , PRODUCT_ID
    , QUANTITY
    , ORDER_DATE
    , STATUS
FROM orders
  );
[0m11:51:36.272234 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m11:51:36.272676 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m11:51:37.404739 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m11:51:37.440878 [debug] [Thread-2  ]: Timing info for model.billy_bulky.staging_shopify__orders (execute): 11:51:36.266975 => 11:51:37.440575
[0m11:51:37.441888 [debug] [Thread-2  ]: On model.billy_bulky.staging_shopify__orders: Close
[0m11:51:37.442708 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m11:51:37.446509 [debug] [Thread-1  ]: Timing info for model.billy_bulky.staging_shopify__customers (execute): 11:51:36.236060 => 11:51:37.446283
[0m11:51:37.446975 [debug] [Thread-1  ]: On model.billy_bulky.staging_shopify__customers: Close
[0m11:51:37.449443 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m11:51:37.452314 [debug] [Thread-3  ]: Timing info for model.billy_bulky.staging_shopify__products (execute): 11:51:36.263984 => 11:51:37.452083
[0m11:51:37.452918 [debug] [Thread-3  ]: On model.billy_bulky.staging_shopify__products: Close
[0m11:51:37.797061 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38155433-648d-4f92-825c-bc9b14509bf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13f949a90>]}
[0m11:51:37.798668 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38155433-648d-4f92-825c-bc9b14509bf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13f8a3d90>]}
[0m11:51:37.800341 [info ] [Thread-1  ]: 1 of 6 OK created sql view model staging.staging_shopify__customers ............ [[32mSUCCESS 1[0m in 1.59s]
[0m11:51:37.802869 [info ] [Thread-2  ]: 2 of 6 OK created sql view model staging.staging_shopify__orders ............... [[32mSUCCESS 1[0m in 1.59s]
[0m11:51:37.804046 [debug] [Thread-1  ]: Finished running node model.billy_bulky.staging_shopify__customers
[0m11:51:37.805007 [debug] [Thread-2  ]: Finished running node model.billy_bulky.staging_shopify__orders
[0m11:51:37.806741 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38155433-648d-4f92-825c-bc9b14509bf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13f8542b0>]}
[0m11:51:37.807939 [info ] [Thread-3  ]: 3 of 6 OK created sql view model staging.staging_shopify__products ............. [[32mSUCCESS 1[0m in 1.59s]
[0m11:51:37.808971 [debug] [Thread-3  ]: Finished running node model.billy_bulky.staging_shopify__products
[0m11:51:37.810195 [debug] [Thread-5  ]: Began running node model.billy_bulky.int_customers_segmentation
[0m11:51:37.810908 [debug] [Thread-6  ]: Began running node model.billy_bulky.int_products_performance
[0m11:51:37.811543 [debug] [Thread-7  ]: Began running node model.billy_bulky.int_sales_trend
[0m11:51:37.812590 [debug] [Thread-5  ]: Acquiring new snowflake connection 'model.billy_bulky.int_customers_segmentation'
[0m11:51:37.813594 [debug] [Thread-6  ]: Acquiring new snowflake connection 'model.billy_bulky.int_products_performance'
[0m11:51:37.814555 [debug] [Thread-7  ]: Acquiring new snowflake connection 'model.billy_bulky.int_sales_trend'
[0m11:51:37.815078 [debug] [Thread-5  ]: Began compiling node model.billy_bulky.int_customers_segmentation
[0m11:51:37.815579 [debug] [Thread-6  ]: Began compiling node model.billy_bulky.int_products_performance
[0m11:51:37.816076 [debug] [Thread-7  ]: Began compiling node model.billy_bulky.int_sales_trend
[0m11:51:37.821963 [debug] [Thread-5  ]: Writing injected SQL for node "model.billy_bulky.int_customers_segmentation"
[0m11:51:37.826021 [debug] [Thread-6  ]: Writing injected SQL for node "model.billy_bulky.int_products_performance"
[0m11:51:37.830006 [debug] [Thread-7  ]: Writing injected SQL for node "model.billy_bulky.int_sales_trend"
[0m11:51:37.831693 [debug] [Thread-7  ]: Timing info for model.billy_bulky.int_sales_trend (compile): 11:51:37.826353 => 11:51:37.831422
[0m11:51:37.832735 [debug] [Thread-7  ]: Finished running node model.billy_bulky.int_sales_trend
[0m11:51:37.833255 [debug] [Thread-5  ]: Timing info for model.billy_bulky.int_customers_segmentation (compile): 11:51:37.816396 => 11:51:37.832999
[0m11:51:37.833713 [debug] [Thread-6  ]: Timing info for model.billy_bulky.int_products_performance (compile): 11:51:37.822360 => 11:51:37.833497
[0m11:51:37.834288 [debug] [Thread-9  ]: Began running node model.billy_bulky.sales
[0m11:51:37.835161 [debug] [Thread-5  ]: Finished running node model.billy_bulky.int_customers_segmentation
[0m11:51:37.836015 [debug] [Thread-6  ]: Finished running node model.billy_bulky.int_products_performance
[0m11:51:37.836504 [info ] [Thread-9  ]: 4 of 6 START sql table model marts.sales ....................................... [RUN]
[0m11:51:37.837162 [debug] [Thread-6  ]: Began running node model.billy_bulky.customers
[0m11:51:37.838009 [debug] [Thread-9  ]: Acquiring new snowflake connection 'model.billy_bulky.sales'
[0m11:51:37.838518 [debug] [Thread-1  ]: Began running node model.billy_bulky.products
[0m11:51:37.838975 [info ] [Thread-6  ]: 5 of 6 START sql table model marts.customers ................................... [RUN]
[0m11:51:37.839400 [debug] [Thread-9  ]: Began compiling node model.billy_bulky.sales
[0m11:51:37.839839 [info ] [Thread-1  ]: 6 of 6 START sql table model marts.products .................................... [RUN]
[0m11:51:37.840545 [debug] [Thread-6  ]: Re-using an available connection from the pool (formerly model.billy_bulky.int_products_performance, now model.billy_bulky.customers)
[0m11:51:37.853512 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.billy_bulky.staging_shopify__customers, now model.billy_bulky.products)
[0m11:51:37.854693 [debug] [Thread-9  ]: Writing injected SQL for node "model.billy_bulky.sales"
[0m11:51:37.855027 [debug] [Thread-6  ]: Began compiling node model.billy_bulky.customers
[0m11:51:37.855325 [debug] [Thread-1  ]: Began compiling node model.billy_bulky.products
[0m11:51:37.864017 [debug] [Thread-6  ]: Writing injected SQL for node "model.billy_bulky.customers"
[0m11:51:37.870086 [debug] [Thread-1  ]: Writing injected SQL for node "model.billy_bulky.products"
[0m11:51:37.870568 [debug] [Thread-9  ]: Timing info for model.billy_bulky.sales (compile): 11:51:37.840817 => 11:51:37.870385
[0m11:51:37.870888 [debug] [Thread-9  ]: Began executing node model.billy_bulky.sales
[0m11:51:37.877678 [debug] [Thread-6  ]: Timing info for model.billy_bulky.customers (compile): 11:51:37.855596 => 11:51:37.877448
[0m11:51:37.884344 [debug] [Thread-1  ]: Timing info for model.billy_bulky.products (compile): 11:51:37.864345 => 11:51:37.884190
[0m11:51:37.884614 [debug] [Thread-6  ]: Began executing node model.billy_bulky.customers
[0m11:51:37.887273 [debug] [Thread-9  ]: Writing runtime sql for node "model.billy_bulky.sales"
[0m11:51:37.887534 [debug] [Thread-1  ]: Began executing node model.billy_bulky.products
[0m11:51:37.889343 [debug] [Thread-6  ]: Writing runtime sql for node "model.billy_bulky.customers"
[0m11:51:37.891200 [debug] [Thread-1  ]: Writing runtime sql for node "model.billy_bulky.products"
[0m11:51:37.894119 [debug] [Thread-9  ]: Using snowflake connection "model.billy_bulky.sales"
[0m11:51:37.896116 [debug] [Thread-6  ]: Using snowflake connection "model.billy_bulky.customers"
[0m11:51:37.896501 [debug] [Thread-9  ]: On model.billy_bulky.sales: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.sales"} */
create or replace transient table E_COMMERCE.marts.sales
         as
        (WITH  __dbt__cte__int_sales_trend as (
WITH orders AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__orders
)

, products AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__products
)

, daily_sales AS (
    SELECT
        DATE(ORDER_DATE) AS sale_date
        , COUNT(DISTINCT ORDER_ID) AS total_orders
        , SUM(QUANTITY) AS total_units_sold
        , SUM(QUANTITY * PRICE) AS total_sales_value
    FROM orders AS o
    JOIN products AS p ON o.PRODUCT_ID = p.PRODUCT_ID
    WHERE o.STATUS NOT IN ('cancelled') 
    GROUP BY sale_date
)

, weekly_sales AS (
    SELECT
        DATE_TRUNC('week', sale_date) AS sale_week
        , SUM(total_orders) AS weekly_orders
        , SUM(total_units_sold) AS weekly_units_sold
        , SUM(total_sales_value) AS weekly_sales_value
    FROM daily_sales
    GROUP BY sale_week
)

, monthly_sales AS (
    SELECT
        DATE_TRUNC('month', sale_date) AS sale_month
        , SUM(total_orders) AS monthly_orders
        , SUM(total_units_sold) AS monthly_units_sold
        , SUM(total_sales_value) AS monthly_sales_value
    FROM daily_sales
    GROUP BY sale_month
)

, yearly_sales AS (
    SELECT
        DATE_TRUNC('year', sale_date) AS sale_year
        , SUM(total_orders) AS yearly_orders
        , SUM(total_units_sold) AS yearly_units_sold
        , SUM(total_sales_value) AS yearly_sales_value
    FROM daily_sales
    GROUP BY sale_year
)

SELECT
    d.sale_date
    , d.total_orders AS daily_orders
    , d.total_units_sold AS daily_units_sold
    , d.total_sales_value AS daily_sales_value
    , w.weekly_orders
    , w.weekly_units_sold
    , w.weekly_sales_value
    , m.monthly_orders
    , m.monthly_units_sold
    , m.monthly_sales_value
    , y.yearly_orders
    , y.yearly_units_sold
    , y.yearly_sales_value
FROM daily_sales d
LEFT JOIN weekly_sales w ON DATE_TRUNC('week', d.sale_date) = w.sale_week
LEFT JOIN monthly_sales m ON DATE_TRUNC('month', d.sale_date) = m.sale_month
LEFT JOIN yearly_sales y ON DATE_TRUNC('year', d.sale_date) = y.sale_year
), enriched_orders AS (
    SELECT
        o.ORDER_ID
        , o.CUSTOMER_ID
        , o.PRODUCT_ID
        , o.QUANTITY
        , o.ORDER_DATE
        , o.STATUS
        , p.CATEGORY
        , p.PRICE AS unit_price
        , (o.QUANTITY * p.PRICE) AS total_price
        , c.COUNTRY
    FROM E_COMMERCE.staging.staging_shopify__orders o
    JOIN E_COMMERCE.staging.staging_shopify__products p ON o.PRODUCT_ID = p.PRODUCT_ID
    JOIN E_COMMERCE.staging.staging_shopify__customers c ON o.CUSTOMER_ID = c.CUSTOMER_ID
    WHERE o.STATUS NOT IN ('cancelled') 
)

SELECT
    eo.ORDER_ID
    , eo.CUSTOMER_ID
    , eo.PRODUCT_ID
    , eo.QUANTITY
    , eo.ORDER_DATE
    , eo.STATUS
    , eo.CATEGORY
    , eo.unit_price
    , eo.total_price
    , eo.COUNTRY
    , sa.daily_orders
    , sa.daily_units_sold
    , sa.daily_sales_value
FROM enriched_orders eo
LEFT JOIN __dbt__cte__int_sales_trend sa ON DATE(eo.ORDER_DATE) = sa.sale_date
        );
[0m11:51:37.896949 [debug] [Thread-6  ]: On model.billy_bulky.customers: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.customers"} */
create or replace transient table E_COMMERCE.marts.customers
         as
        (WITH  __dbt__cte__int_customers_segmentation as (
WITH customers AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__customers
)

, orders AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__orders
)

, products AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__products
)

, order_aggregates AS (
    SELECT
        o.CUSTOMER_ID
        , COUNT(DISTINCT o.ORDER_ID) AS frequency
        , SUM(o.QUANTITY * p.PRICE) AS monetary
        , AVG(o.QUANTITY * p.PRICE) AS average_order_value
        , MAX(o.ORDER_DATE) AS last_purchase_date
        , COUNT(CASE WHEN o.STATUS = 'cancelled' THEN 1 END) AS cancelled_orders
        , COUNT(*) AS total_orders
    FROM orders o
    JOIN products p ON o.PRODUCT_ID = p.PRODUCT_ID
    GROUP BY o.CUSTOMER_ID
)

, customer_tenure AS (
    SELECT
        CUSTOMER_ID
        , JOIN_DATE
        , CURRENT_DATE - JOIN_DATE AS tenure
    FROM customers
)

, customer_recency AS (
    SELECT
        CUSTOMER_ID
        , CURRENT_DATE - last_purchase_date AS recency
    FROM order_aggregates
)

, final AS (
    SELECT
        c.CUSTOMER_ID
        , c.FIRST_NAME
        , c.LAST_NAME
        , c.EMAIL
        , c.JOIN_DATE
        , c.COUNTRY
        , o.frequency
        , o.monetary
        , o.average_order_value
        , o.cancelled_orders
        , o.total_orders
        , CASE 
            WHEN o.total_orders > 0 THEN ROUND((o.cancelled_orders::FLOAT / o.total_orders) * 100, 2) 
            ELSE 0 
          END AS cancellation_rate
        , r.recency
        , t.tenure
    FROM customer_tenure t
    JOIN customers c ON t.CUSTOMER_ID = c.CUSTOMER_ID
    JOIN order_aggregates o ON c.CUSTOMER_ID = o.CUSTOMER_ID
    JOIN customer_recency r ON c.CUSTOMER_ID = r.CUSTOMER_ID
)

SELECT * FROM final
), source AS (
    SELECT
        icp.CUSTOMER_ID
        , icp.FIRST_NAME
        , icp.LAST_NAME
        , icp.EMAIL
        , icp.JOIN_DATE
        , icp.COUNTRY
        , icp.frequency AS total_orders
        , icp.monetary AS total_spent
        , icp.recency
        , icp.tenure
    FROM __dbt__cte__int_customers_segmentation icp
)

, final AS (
SELECT
    s.CUSTOMER_ID
    , s.FIRST_NAME
    , s.LAST_NAME
    , s.EMAIL
    , s.JOIN_DATE
    , s.COUNTRY
    , s.total_orders
    , s.total_spent
    , s.recency
    , s.tenure
    , CASE 
        WHEN s.total_spent > 1000 THEN 'VIP' 
        ELSE 'Regular' 
      END AS customer_segment 
FROM source s
)

SELECT * FROM final
        );
[0m11:51:37.898556 [debug] [Thread-1  ]: Using snowflake connection "model.billy_bulky.products"
[0m11:51:37.898783 [debug] [Thread-9  ]: Opening a new connection, currently in state init
[0m11:51:37.899013 [debug] [Thread-6  ]: Opening a new connection, currently in state init
[0m11:51:37.899310 [debug] [Thread-1  ]: On model.billy_bulky.products: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.products"} */
create or replace transient table E_COMMERCE.marts.products
         as
        (WITH  __dbt__cte__int_products_performance as (
WITH orders AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__orders
)

, products AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__products
)

, product_sales AS (
    SELECT
        o.PRODUCT_ID
        , COUNT(DISTINCT o.ORDER_ID) AS total_sales
        , SUM(o.QUANTITY) AS total_units_sold
        , SUM(o.QUANTITY * p.PRICE) AS total_sales_value
    FROM orders o
    INNER JOIN products p ON o.PRODUCT_ID = p.PRODUCT_ID
    WHERE o.STATUS NOT IN ('cancelled') 
    GROUP BY o.PRODUCT_ID
)

, product_averages AS (
    SELECT
        PRODUCT_ID
        , (total_sales_value / NULLIF(total_units_sold, 0)) AS average_sale_price
    FROM product_sales
)

, product_stock_turnover AS (
    SELECT
        p.PRODUCT_ID
        , p.STOCK_LEVEL
        , (total_units_sold / NULLIF(p.STOCK_LEVEL, 0)) AS turnover_rate
    FROM product_sales ps
    INNER JOIN products p ON ps.PRODUCT_ID = p.PRODUCT_ID
)

, final AS (
    SELECT
    p.PRODUCT_ID
    , p.NAME
    , p.CATEGORY
    , p.PRICE
    , pa.average_sale_price
    , ps.total_sales
    , ps.total_units_sold
    , ps.total_sales_value
    , pst.turnover_rate
    , p.STOCK_LEVEL
FROM products p
LEFT JOIN product_sales ps ON p.PRODUCT_ID = ps.PRODUCT_ID
LEFT JOIN product_averages pa ON p.PRODUCT_ID = pa.PRODUCT_ID
LEFT JOIN product_stock_turnover pst ON p.PRODUCT_ID = pst.PRODUCT_ID
)

SELECT * FROM final
), final AS (
    SELECT
        pp.PRODUCT_ID
        , pp.NAME
        , pp.CATEGORY
        , pp.PRICE
        , pp.average_sale_price
        , pp.total_sales
        , pp.total_units_sold
        , pp.total_sales_value
        , pp.turnover_rate
        , pp.STOCK_LEVEL
    FROM __dbt__cte__int_products_performance pp
)

SELECT * FROM final
        );
[0m11:51:37.900087 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:51:40.972830 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 3.0 seconds
[0m11:51:40.975442 [debug] [Thread-9  ]: SQL status: SUCCESS 1 in 3.0 seconds
[0m11:51:40.977373 [debug] [Thread-6  ]: SQL status: SUCCESS 1 in 3.0 seconds
[0m11:51:40.982525 [debug] [Thread-1  ]: Timing info for model.billy_bulky.products (execute): 11:51:37.889568 => 11:51:40.982130
[0m11:51:40.986312 [debug] [Thread-9  ]: Timing info for model.billy_bulky.sales (execute): 11:51:37.871086 => 11:51:40.985956
[0m11:51:40.989667 [debug] [Thread-6  ]: Timing info for model.billy_bulky.customers (execute): 11:51:37.887692 => 11:51:40.989387
[0m11:51:40.990291 [debug] [Thread-1  ]: On model.billy_bulky.products: Close
[0m11:51:40.990819 [debug] [Thread-9  ]: On model.billy_bulky.sales: Close
[0m11:51:40.991366 [debug] [Thread-6  ]: On model.billy_bulky.customers: Close
[0m11:51:41.386272 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38155433-648d-4f92-825c-bc9b14509bf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13f949d90>]}
[0m11:51:41.388148 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38155433-648d-4f92-825c-bc9b14509bf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13f9c0ca0>]}
[0m11:51:41.389656 [debug] [Thread-9  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38155433-648d-4f92-825c-bc9b14509bf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13f9fda90>]}
[0m11:51:41.390759 [info ] [Thread-6  ]: 5 of 6 OK created sql table model marts.customers .............................. [[32mSUCCESS 1[0m in 3.55s]
[0m11:51:41.391625 [info ] [Thread-1  ]: 6 of 6 OK created sql table model marts.products ............................... [[32mSUCCESS 1[0m in 3.53s]
[0m11:51:41.392613 [info ] [Thread-9  ]: 4 of 6 OK created sql table model marts.sales .................................. [[32mSUCCESS 1[0m in 3.55s]
[0m11:51:41.393908 [debug] [Thread-6  ]: Finished running node model.billy_bulky.customers
[0m11:51:41.394857 [debug] [Thread-1  ]: Finished running node model.billy_bulky.products
[0m11:51:41.395736 [debug] [Thread-9  ]: Finished running node model.billy_bulky.sales
[0m11:51:41.398943 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:51:41.399433 [debug] [MainThread]: Connection 'model.billy_bulky.products' was properly closed.
[0m11:51:41.399861 [debug] [MainThread]: Connection 'model.billy_bulky.staging_shopify__orders' was properly closed.
[0m11:51:41.400262 [debug] [MainThread]: Connection 'model.billy_bulky.staging_shopify__products' was properly closed.
[0m11:51:41.400662 [debug] [MainThread]: Connection 'model.billy_bulky.int_customers_segmentation' was properly closed.
[0m11:51:41.401047 [debug] [MainThread]: Connection 'model.billy_bulky.customers' was properly closed.
[0m11:51:41.401438 [debug] [MainThread]: Connection 'model.billy_bulky.int_sales_trend' was properly closed.
[0m11:51:41.401815 [debug] [MainThread]: Connection 'model.billy_bulky.sales' was properly closed.
[0m11:51:41.402301 [info ] [MainThread]: 
[0m11:51:41.402784 [info ] [MainThread]: Finished running 3 view models, 3 table models in 0 hours 0 minutes and 10.03 seconds (10.03s).
[0m11:51:41.404512 [debug] [MainThread]: Command end result
[0m11:51:41.419855 [info ] [MainThread]: 
[0m11:51:41.420415 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:51:41.420792 [info ] [MainThread]: 
[0m11:51:41.421149 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m11:51:41.423810 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.24246, "process_user_time": 5.167755, "process_kernel_time": 0.370345, "process_mem_max_rss": "222511104", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:51:41.424396 [debug] [MainThread]: Command `dbt run` succeeded at 11:51:41.424267 after 11.24 seconds
[0m11:51:41.424805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072d0eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13f894700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13e025040>]}
[0m11:51:41.425220 [debug] [MainThread]: Flushing usage events
[0m12:01:35.495226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b310d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109038b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109054ee0>]}


============================== 12:01:35.497983 | 70aa88c5-02de-42f4-b481-91811541f01a ==============================
[0m12:01:35.497983 [info ] [MainThread]: Running with dbt=1.7.1
[0m12:01:35.498339 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/bitlevi/Documents/billy_bulky_ecommerce/billy_bulky_ecommerce/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/bitlevi/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'True'}
[0m12:01:36.289136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '70aa88c5-02de-42f4-b481-91811541f01a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14b2eae20>]}
[0m12:01:36.337060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '70aa88c5-02de-42f4-b481-91811541f01a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14b465700>]}
[0m12:01:36.337694 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m12:01:36.350730 [debug] [MainThread]: checksum: ad428e6dc3b353dcb23d0c4ebea8b20b180e94b873271ac2a054a8e446dac0e2, vars: {}, profile: , target: , version: 1.7.1
[0m12:01:36.386176 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m12:01:36.386689 [debug] [MainThread]: Partial parsing: added file: billy_bulky://snapshots/products_snapshot.sql
[0m12:01:36.442326 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot products_snapshot (snapshots/products_snapshot.sql)
  expected token ',', got 'unique_key'
    line 6
      unique_key = 'PRODUCT_ID'
[0m12:01:36.444050 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 0.98327285, "process_user_time": 3.679707, "process_kernel_time": 0.345916, "process_mem_max_rss": "195952640", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:01:36.444452 [debug] [MainThread]: Command `dbt snapshot` failed at 12:01:36.444360 after 0.98 seconds
[0m12:01:36.444721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b310d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c0cc940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c152940>]}
[0m12:01:36.444980 [debug] [MainThread]: Flushing usage events
[0m12:02:08.261661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a65250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072d0460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072d0850>]}


============================== 12:02:08.264600 | ada794f1-1897-48d1-984f-0a3a85373a52 ==============================
[0m12:02:08.264600 [info ] [MainThread]: Running with dbt=1.7.1
[0m12:02:08.264969 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/bitlevi/Documents/billy_bulky_ecommerce/billy_bulky_ecommerce/logs', 'debug': 'False', 'profiles_dir': '/Users/bitlevi/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt snapshot', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:02:09.079648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ada794f1-1897-48d1-984f-0a3a85373a52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072b4fa0>]}
[0m12:02:09.127303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ada794f1-1897-48d1-984f-0a3a85373a52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1386e77c0>]}
[0m12:02:09.128014 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m12:02:09.144317 [debug] [MainThread]: checksum: ad428e6dc3b353dcb23d0c4ebea8b20b180e94b873271ac2a054a8e446dac0e2, vars: {}, profile: , target: , version: 1.7.1
[0m12:02:09.179421 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m12:02:09.179953 [debug] [MainThread]: Partial parsing: added file: billy_bulky://snapshots/products_snapshot.sql
[0m12:02:09.234771 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot products_snapshot (snapshots/products_snapshot.sql)
  expected token ',', got 'unique_key'
    line 6
      unique_key = 'PRODUCT_ID'
[0m12:02:09.236214 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 1.0066516, "process_user_time": 3.695392, "process_kernel_time": 0.294828, "process_mem_max_rss": "195035136", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:02:09.236575 [debug] [MainThread]: Command `dbt snapshot` failed at 12:02:09.236495 after 1.01 seconds
[0m12:02:09.236852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a65250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13b94f970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13b9d6970>]}
[0m12:02:09.237114 [debug] [MainThread]: Flushing usage events
[0m12:02:30.444271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102941eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102432910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105190160>]}


============================== 12:02:30.446953 | a387223f-8f04-4449-813c-ccb3b73989c0 ==============================
[0m12:02:30.446953 [info ] [MainThread]: Running with dbt=1.7.1
[0m12:02:30.447306 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/bitlevi/.dbt', 'log_path': '/Users/bitlevi/Documents/billy_bulky_ecommerce/billy_bulky_ecommerce/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:02:31.302221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a387223f-8f04-4449-813c-ccb3b73989c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102432910>]}
[0m12:02:31.349697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a387223f-8f04-4449-813c-ccb3b73989c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c88a040>]}
[0m12:02:31.350309 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m12:02:31.364121 [debug] [MainThread]: checksum: ad428e6dc3b353dcb23d0c4ebea8b20b180e94b873271ac2a054a8e446dac0e2, vars: {}, profile: , target: , version: 1.7.1
[0m12:02:31.400313 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m12:02:31.400817 [debug] [MainThread]: Partial parsing: added file: billy_bulky://snapshots/products_snapshot.sql
[0m12:02:31.455704 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot products_snapshot (snapshots/products_snapshot.sql)
  expected token ',', got 'strategy'
    line 6
      strategy = 'check'
[0m12:02:31.457201 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 1.0454223, "process_user_time": 3.681921, "process_kernel_time": 0.342339, "process_mem_max_rss": "194805760", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:02:31.457570 [debug] [MainThread]: Command `dbt snapshot` failed at 12:02:31.457483 after 1.05 seconds
[0m12:02:31.457833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102941eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d0e48e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d1678e0>]}
[0m12:02:31.458099 [debug] [MainThread]: Flushing usage events
[0m12:03:04.847200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1030ed0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10593cb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105958ee0>]}


============================== 12:03:04.850062 | 02631560-29bd-406c-87b8-fc61d55467ff ==============================
[0m12:03:04.850062 [info ] [MainThread]: Running with dbt=1.7.1
[0m12:03:04.850417 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/bitlevi/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/bitlevi/Documents/billy_bulky_ecommerce/billy_bulky_ecommerce/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt snapshot', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:03:05.646222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '02631560-29bd-406c-87b8-fc61d55467ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1375e9e20>]}
[0m12:03:05.694095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '02631560-29bd-406c-87b8-fc61d55467ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13787d700>]}
[0m12:03:05.694630 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m12:03:05.705669 [debug] [MainThread]: checksum: ad428e6dc3b353dcb23d0c4ebea8b20b180e94b873271ac2a054a8e446dac0e2, vars: {}, profile: , target: , version: 1.7.1
[0m12:03:05.740195 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m12:03:05.740706 [debug] [MainThread]: Partial parsing: added file: billy_bulky://snapshots/products_snapshot.sql
[0m12:03:05.833584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '02631560-29bd-406c-87b8-fc61d55467ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14a2ad0d0>]}
[0m12:03:05.844284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '02631560-29bd-406c-87b8-fc61d55467ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14a075ee0>]}
[0m12:03:05.844623 [info ] [MainThread]: Found 9 models, 47 tests, 1 snapshot, 3 sources, 0 exposures, 0 metrics, 431 macros, 0 groups, 0 semantic models
[0m12:03:05.844860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02631560-29bd-406c-87b8-fc61d55467ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14a075dc0>]}
[0m12:03:05.846257 [info ] [MainThread]: 
[0m12:03:05.846780 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:03:05.847465 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE'
[0m12:03:05.901030 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE"
[0m12:03:05.901335 [debug] [ThreadPool]: On list_E_COMMERCE: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE"} */
show terse schemas in database E_COMMERCE
    limit 10000
[0m12:03:05.901523 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:03:07.894600 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.0 seconds
[0m12:03:07.896582 [debug] [ThreadPool]: On list_E_COMMERCE: Close
[0m12:03:08.430115 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_E_COMMERCE, now create_E_COMMERCE_snapshots)
[0m12:03:08.432139 [debug] [ThreadPool]: Creating schema "database: "E_COMMERCE"
schema: "snapshots"
"
[0m12:03:08.441032 [debug] [ThreadPool]: Using snowflake connection "create_E_COMMERCE_snapshots"
[0m12:03:08.441681 [debug] [ThreadPool]: On create_E_COMMERCE_snapshots: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "create_E_COMMERCE_snapshots"} */
create schema if not exists E_COMMERCE.snapshots
[0m12:03:08.442154 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:03:10.401554 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 2.0 seconds
[0m12:03:10.406062 [debug] [ThreadPool]: On create_E_COMMERCE_snapshots: Close
[0m12:03:10.918001 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_E_COMMERCE_snapshots, now list_E_COMMERCE_snapshots)
[0m12:03:10.921182 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_staging'
[0m12:03:10.937509 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_snapshots"
[0m12:03:10.939608 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_staging"
[0m12:03:10.940011 [debug] [ThreadPool]: On list_E_COMMERCE_snapshots: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE_snapshots"} */
show terse objects in E_COMMERCE.snapshots limit 10000
[0m12:03:10.940722 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_marts'
[0m12:03:10.941131 [debug] [ThreadPool]: On list_E_COMMERCE_staging: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE_staging"} */
show terse objects in E_COMMERCE.staging limit 10000
[0m12:03:10.941508 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:03:10.943798 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_marts"
[0m12:03:10.944133 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:03:10.945025 [debug] [ThreadPool]: On list_E_COMMERCE_marts: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE_marts"} */
show terse objects in E_COMMERCE.marts limit 10000
[0m12:03:10.946168 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:03:12.202107 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.0 seconds
[0m12:03:12.207550 [debug] [ThreadPool]: On list_E_COMMERCE_snapshots: Close
[0m12:03:12.385381 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m12:03:12.390914 [debug] [ThreadPool]: On list_E_COMMERCE_marts: Close
[0m12:03:12.392519 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m12:03:12.398559 [debug] [ThreadPool]: On list_E_COMMERCE_staging: Close
[0m12:03:12.808774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02631560-29bd-406c-87b8-fc61d55467ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14a0c3a90>]}
[0m12:03:12.810422 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m12:03:12.811109 [info ] [MainThread]: 
[0m12:03:12.815598 [debug] [Thread-1  ]: Began running node snapshot.billy_bulky.products_snapshot
[0m12:03:12.816377 [info ] [Thread-1  ]: 1 of 1 START snapshot snapshots.products_snapshot .............................. [RUN]
[0m12:03:12.817437 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_E_COMMERCE_snapshots, now snapshot.billy_bulky.products_snapshot)
[0m12:03:12.817988 [debug] [Thread-1  ]: Began compiling node snapshot.billy_bulky.products_snapshot
[0m12:03:12.830937 [debug] [Thread-1  ]: Timing info for snapshot.billy_bulky.products_snapshot (compile): 12:03:12.818325 => 12:03:12.830502
[0m12:03:12.831507 [debug] [Thread-1  ]: Began executing node snapshot.billy_bulky.products_snapshot
[0m12:03:12.888704 [debug] [Thread-1  ]: Writing runtime sql for node "snapshot.billy_bulky.products_snapshot"
[0m12:03:12.889935 [debug] [Thread-1  ]: Using snowflake connection "snapshot.billy_bulky.products_snapshot"
[0m12:03:12.890223 [debug] [Thread-1  ]: On snapshot.billy_bulky.products_snapshot: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "snapshot.billy_bulky.products_snapshot"} */
create or replace transient table E_COMMERCE.snapshots.products_snapshot
         as
        (

    select *,
        md5(coalesce(cast(product_id as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
        nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))) as dbt_valid_to
    from (
        




SELECT * FROM SHOPIFY.PUBLIC.products

    ) sbq



        );
[0m12:03:12.890481 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:03:15.646052 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 3.0 seconds
[0m12:03:15.677957 [debug] [Thread-1  ]: Timing info for snapshot.billy_bulky.products_snapshot (execute): 12:03:12.831795 => 12:03:15.677725
[0m12:03:15.678412 [debug] [Thread-1  ]: On snapshot.billy_bulky.products_snapshot: Close
[0m12:03:16.100608 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02631560-29bd-406c-87b8-fc61d55467ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14abe39a0>]}
[0m12:03:16.102118 [info ] [Thread-1  ]: 1 of 1 OK snapshotted snapshots.products_snapshot .............................. [[32mSUCCESS 1[0m in 3.28s]
[0m12:03:16.103201 [debug] [Thread-1  ]: Finished running node snapshot.billy_bulky.products_snapshot
[0m12:03:16.106115 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:03:16.106828 [debug] [MainThread]: Connection 'snapshot.billy_bulky.products_snapshot' was properly closed.
[0m12:03:16.107373 [debug] [MainThread]: Connection 'list_E_COMMERCE_staging' was properly closed.
[0m12:03:16.107818 [debug] [MainThread]: Connection 'list_E_COMMERCE_marts' was properly closed.
[0m12:03:16.108313 [info ] [MainThread]: 
[0m12:03:16.108803 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 10.26 seconds (10.26s).
[0m12:03:16.109686 [debug] [MainThread]: Command end result
[0m12:03:16.128673 [info ] [MainThread]: 
[0m12:03:16.129318 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:03:16.129709 [info ] [MainThread]: 
[0m12:03:16.130093 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:03:16.132892 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 11.317281, "process_user_time": 4.723183, "process_kernel_time": 0.34863, "process_mem_max_rss": "218857472", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:03:16.133529 [debug] [MainThread]: Command `dbt snapshot` succeeded at 12:03:16.133393 after 11.32 seconds
[0m12:03:16.133956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1030ed0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137db42e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14ace9550>]}
[0m12:03:16.134377 [debug] [MainThread]: Flushing usage events
[0m12:05:35.501869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b9d250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10940a460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10940a850>]}


============================== 12:05:35.504571 | 8661ef0d-a392-4b7a-a1d1-84c9a0469a74 ==============================
[0m12:05:35.504571 [info ] [MainThread]: Running with dbt=1.7.1
[0m12:05:35.504938 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/bitlevi/.dbt', 'log_path': '/Users/bitlevi/Documents/billy_bulky_ecommerce/billy_bulky_ecommerce/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt compile', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:05:36.352892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8661ef0d-a392-4b7a-a1d1-84c9a0469a74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093ecfa0>]}
[0m12:05:36.400454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8661ef0d-a392-4b7a-a1d1-84c9a0469a74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ade87c0>]}
[0m12:05:36.401065 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m12:05:36.414359 [debug] [MainThread]: checksum: ad428e6dc3b353dcb23d0c4ebea8b20b180e94b873271ac2a054a8e446dac0e2, vars: {}, profile: , target: , version: 1.7.1
[0m12:05:36.450576 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:05:36.451136 [debug] [MainThread]: Partial parsing: updated file: billy_bulky://models/staging/shopify/_shopify__models.yml
[0m12:05:36.507778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8661ef0d-a392-4b7a-a1d1-84c9a0469a74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12bc390d0>]}
[0m12:05:36.519304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8661ef0d-a392-4b7a-a1d1-84c9a0469a74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b409370>]}
[0m12:05:36.519620 [info ] [MainThread]: Found 9 models, 47 tests, 1 snapshot, 4 sources, 0 exposures, 0 metrics, 431 macros, 0 groups, 0 semantic models
[0m12:05:36.519851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8661ef0d-a392-4b7a-a1d1-84c9a0469a74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ae2d040>]}
[0m12:05:36.521863 [info ] [MainThread]: 
[0m12:05:36.522419 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:05:36.523230 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_staging'
[0m12:05:36.523713 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_snapshots'
[0m12:05:36.524237 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_marts'
[0m12:05:36.578458 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_staging"
[0m12:05:36.579951 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_snapshots"
[0m12:05:36.581290 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_marts"
[0m12:05:36.581505 [debug] [ThreadPool]: On list_E_COMMERCE_staging: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE_staging"} */
show terse objects in E_COMMERCE.staging limit 10000
[0m12:05:36.581701 [debug] [ThreadPool]: On list_E_COMMERCE_snapshots: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE_snapshots"} */
show terse objects in E_COMMERCE.snapshots limit 10000
[0m12:05:36.581890 [debug] [ThreadPool]: On list_E_COMMERCE_marts: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE_marts"} */
show terse objects in E_COMMERCE.marts limit 10000
[0m12:05:36.582070 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:05:36.582248 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:05:36.582412 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:05:38.217038 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 2.0 seconds
[0m12:05:38.218513 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.0 seconds
[0m12:05:38.221218 [debug] [ThreadPool]: On list_E_COMMERCE_snapshots: Close
[0m12:05:38.223718 [debug] [ThreadPool]: On list_E_COMMERCE_marts: Close
[0m12:05:42.432702 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 6.0 seconds
[0m12:05:42.437546 [debug] [ThreadPool]: On list_E_COMMERCE_staging: Close
[0m12:05:42.924702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8661ef0d-a392-4b7a-a1d1-84c9a0469a74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12aea8700>]}
[0m12:05:42.926219 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m12:05:42.926875 [info ] [MainThread]: 
[0m12:05:42.931832 [debug] [Thread-1  ]: Began running node model.billy_bulky.staging_shopify__customers
[0m12:05:42.933605 [debug] [Thread-3  ]: Began running node model.billy_bulky.staging_shopify__products
[0m12:05:42.932687 [debug] [Thread-2  ]: Began running node model.billy_bulky.staging_shopify__orders
[0m12:05:42.935014 [debug] [Thread-4  ]: Began running node snapshot.billy_bulky.products_snapshot
[0m12:05:42.936190 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_E_COMMERCE_staging, now model.billy_bulky.staging_shopify__customers)
[0m12:05:42.937272 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly list_E_COMMERCE_marts, now model.billy_bulky.staging_shopify__products)
[0m12:05:42.938238 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_E_COMMERCE_snapshots, now model.billy_bulky.staging_shopify__orders)
[0m12:05:42.939350 [debug] [Thread-4  ]: Acquiring new snowflake connection 'snapshot.billy_bulky.products_snapshot'
[0m12:05:42.939939 [debug] [Thread-1  ]: Began compiling node model.billy_bulky.staging_shopify__customers
[0m12:05:42.940575 [debug] [Thread-3  ]: Began compiling node model.billy_bulky.staging_shopify__products
[0m12:05:42.941204 [debug] [Thread-2  ]: Began compiling node model.billy_bulky.staging_shopify__orders
[0m12:05:42.941771 [debug] [Thread-4  ]: Began compiling node snapshot.billy_bulky.products_snapshot
[0m12:05:42.952742 [debug] [Thread-1  ]: Writing injected SQL for node "model.billy_bulky.staging_shopify__customers"
[0m12:05:42.956193 [debug] [Thread-3  ]: Writing injected SQL for node "model.billy_bulky.staging_shopify__products"
[0m12:05:42.959293 [debug] [Thread-2  ]: Writing injected SQL for node "model.billy_bulky.staging_shopify__orders"
[0m12:05:42.963203 [debug] [Thread-4  ]: Timing info for snapshot.billy_bulky.products_snapshot (compile): 12:05:42.959619 => 12:05:42.962908
[0m12:05:42.963963 [debug] [Thread-4  ]: Began executing node snapshot.billy_bulky.products_snapshot
[0m12:05:42.964461 [debug] [Thread-4  ]: Timing info for snapshot.billy_bulky.products_snapshot (execute): 12:05:42.964225 => 12:05:42.964236
[0m12:05:42.965513 [debug] [Thread-4  ]: Finished running node snapshot.billy_bulky.products_snapshot
[0m12:05:42.966246 [debug] [Thread-1  ]: Timing info for model.billy_bulky.staging_shopify__customers (compile): 12:05:42.942149 => 12:05:42.965959
[0m12:05:42.966795 [debug] [Thread-2  ]: Timing info for model.billy_bulky.staging_shopify__orders (compile): 12:05:42.956487 => 12:05:42.966525
[0m12:05:42.967249 [debug] [Thread-3  ]: Timing info for model.billy_bulky.staging_shopify__products (compile): 12:05:42.953145 => 12:05:42.967035
[0m12:05:42.967613 [debug] [Thread-1  ]: Began executing node model.billy_bulky.staging_shopify__customers
[0m12:05:42.967988 [debug] [Thread-2  ]: Began executing node model.billy_bulky.staging_shopify__orders
[0m12:05:42.968358 [debug] [Thread-3  ]: Began executing node model.billy_bulky.staging_shopify__products
[0m12:05:42.968777 [debug] [Thread-1  ]: Timing info for model.billy_bulky.staging_shopify__customers (execute): 12:05:42.968576 => 12:05:42.968581
[0m12:05:42.969184 [debug] [Thread-2  ]: Timing info for model.billy_bulky.staging_shopify__orders (execute): 12:05:42.968999 => 12:05:42.969003
[0m12:05:42.969588 [debug] [Thread-3  ]: Timing info for model.billy_bulky.staging_shopify__products (execute): 12:05:42.969402 => 12:05:42.969406
[0m12:05:42.970394 [debug] [Thread-1  ]: Finished running node model.billy_bulky.staging_shopify__customers
[0m12:05:42.971175 [debug] [Thread-2  ]: Finished running node model.billy_bulky.staging_shopify__orders
[0m12:05:42.971948 [debug] [Thread-3  ]: Finished running node model.billy_bulky.staging_shopify__products
[0m12:05:42.972749 [debug] [Thread-6  ]: Began running node model.billy_bulky.int_customers_segmentation
[0m12:05:42.973150 [debug] [Thread-7  ]: Began running node model.billy_bulky.int_products_performance
[0m12:05:42.973554 [debug] [Thread-8  ]: Began running node model.billy_bulky.int_sales_trend
[0m12:05:42.974208 [debug] [Thread-6  ]: Acquiring new snowflake connection 'model.billy_bulky.int_customers_segmentation'
[0m12:05:42.974840 [debug] [Thread-7  ]: Acquiring new snowflake connection 'model.billy_bulky.int_products_performance'
[0m12:05:42.975430 [debug] [Thread-8  ]: Acquiring new snowflake connection 'model.billy_bulky.int_sales_trend'
[0m12:05:42.975736 [debug] [Thread-6  ]: Began compiling node model.billy_bulky.int_customers_segmentation
[0m12:05:42.976028 [debug] [Thread-7  ]: Began compiling node model.billy_bulky.int_products_performance
[0m12:05:42.976314 [debug] [Thread-8  ]: Began compiling node model.billy_bulky.int_sales_trend
[0m12:05:42.979538 [debug] [Thread-6  ]: Writing injected SQL for node "model.billy_bulky.int_customers_segmentation"
[0m12:05:42.983262 [debug] [Thread-7  ]: Writing injected SQL for node "model.billy_bulky.int_products_performance"
[0m12:05:42.985697 [debug] [Thread-8  ]: Writing injected SQL for node "model.billy_bulky.int_sales_trend"
[0m12:05:42.986301 [debug] [Thread-6  ]: Timing info for model.billy_bulky.int_customers_segmentation (compile): 12:05:42.976497 => 12:05:42.986127
[0m12:05:42.986664 [debug] [Thread-7  ]: Timing info for model.billy_bulky.int_products_performance (compile): 12:05:42.979777 => 12:05:42.986483
[0m12:05:42.987313 [debug] [Thread-6  ]: Finished running node model.billy_bulky.int_customers_segmentation
[0m12:05:42.987970 [debug] [Thread-7  ]: Finished running node model.billy_bulky.int_products_performance
[0m12:05:42.988303 [debug] [Thread-8  ]: Timing info for model.billy_bulky.int_sales_trend (compile): 12:05:42.983450 => 12:05:42.988146
[0m12:05:42.988958 [debug] [Thread-10 ]: Began running node model.billy_bulky.customers
[0m12:05:42.989557 [debug] [Thread-8  ]: Finished running node model.billy_bulky.int_sales_trend
[0m12:05:42.989985 [debug] [Thread-5  ]: Began running node test.billy_bulky.not_null_int_customers_segmentation_average_order_value.bc3928d48c
[0m12:05:42.990299 [debug] [Thread-4  ]: Began running node test.billy_bulky.not_null_int_customers_segmentation_cancellation_rate.768fbfc8cf
[0m12:05:42.990951 [debug] [Thread-10 ]: Acquiring new snowflake connection 'model.billy_bulky.customers'
[0m12:05:42.991225 [debug] [Thread-1  ]: Began running node test.billy_bulky.not_null_int_customers_segmentation_customer_id.7bcd6b69a3
[0m12:05:42.991500 [debug] [Thread-2  ]: Began running node test.billy_bulky.not_null_int_customers_segmentation_email.24b3236f34
[0m12:05:42.991777 [debug] [Thread-8  ]: Began running node test.billy_bulky.not_null_int_customers_segmentation_frequency.687f7fb8e3
[0m12:05:42.992032 [debug] [Thread-3  ]: Began running node test.billy_bulky.not_null_int_customers_segmentation_monetary.0620d6d71b
[0m12:05:42.992360 [debug] [Thread-9  ]: Began running node test.billy_bulky.not_null_int_customers_segmentation_recency.d39c8bf889
[0m12:05:42.992829 [debug] [Thread-5  ]: Acquiring new snowflake connection 'test.billy_bulky.not_null_int_customers_segmentation_average_order_value.bc3928d48c'
[0m12:05:42.993236 [debug] [Thread-6  ]: Began running node test.billy_bulky.not_null_int_customers_segmentation_tenure.0be21be79b
[0m12:05:42.993515 [debug] [Thread-7  ]: Began running node test.billy_bulky.relationships_int_customers_segmentation_customer_id__ref_staging_shopify__customers_.631403bf0f
[0m12:05:42.993928 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly snapshot.billy_bulky.products_snapshot, now test.billy_bulky.not_null_int_customers_segmentation_cancellation_rate.768fbfc8cf)
[0m12:05:42.994190 [debug] [Thread-10 ]: Began compiling node model.billy_bulky.customers
[0m12:05:42.994637 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.billy_bulky.staging_shopify__customers, now test.billy_bulky.not_null_int_customers_segmentation_customer_id.7bcd6b69a3)
[0m12:05:42.995077 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.billy_bulky.staging_shopify__orders, now test.billy_bulky.not_null_int_customers_segmentation_email.24b3236f34)
[0m12:05:42.995510 [debug] [Thread-8  ]: Re-using an available connection from the pool (formerly model.billy_bulky.int_sales_trend, now test.billy_bulky.not_null_int_customers_segmentation_frequency.687f7fb8e3)
[0m12:05:42.995944 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.billy_bulky.staging_shopify__products, now test.billy_bulky.not_null_int_customers_segmentation_monetary.0620d6d71b)
[0m12:05:42.996553 [debug] [Thread-9  ]: Acquiring new snowflake connection 'test.billy_bulky.not_null_int_customers_segmentation_recency.d39c8bf889'
[0m12:05:42.996817 [debug] [Thread-5  ]: Began compiling node test.billy_bulky.not_null_int_customers_segmentation_average_order_value.bc3928d48c
[0m12:05:42.997250 [debug] [Thread-6  ]: Re-using an available connection from the pool (formerly model.billy_bulky.int_customers_segmentation, now test.billy_bulky.not_null_int_customers_segmentation_tenure.0be21be79b)
[0m12:05:42.997686 [debug] [Thread-7  ]: Re-using an available connection from the pool (formerly model.billy_bulky.int_products_performance, now test.billy_bulky.relationships_int_customers_segmentation_customer_id__ref_staging_shopify__customers_.631403bf0f)
[0m12:05:42.997946 [debug] [Thread-4  ]: Began compiling node test.billy_bulky.not_null_int_customers_segmentation_cancellation_rate.768fbfc8cf
[0m12:05:43.004919 [debug] [Thread-10 ]: Writing injected SQL for node "model.billy_bulky.customers"
[0m12:05:43.005180 [debug] [Thread-1  ]: Began compiling node test.billy_bulky.not_null_int_customers_segmentation_customer_id.7bcd6b69a3
[0m12:05:43.005428 [debug] [Thread-2  ]: Began compiling node test.billy_bulky.not_null_int_customers_segmentation_email.24b3236f34
[0m12:05:43.005668 [debug] [Thread-8  ]: Began compiling node test.billy_bulky.not_null_int_customers_segmentation_frequency.687f7fb8e3
[0m12:05:43.005903 [debug] [Thread-3  ]: Began compiling node test.billy_bulky.not_null_int_customers_segmentation_monetary.0620d6d71b
[0m12:05:43.006135 [debug] [Thread-9  ]: Began compiling node test.billy_bulky.not_null_int_customers_segmentation_recency.d39c8bf889
[0m12:05:43.014059 [debug] [Thread-5  ]: Writing injected SQL for node "test.billy_bulky.not_null_int_customers_segmentation_average_order_value.bc3928d48c"
[0m12:05:43.014319 [debug] [Thread-6  ]: Began compiling node test.billy_bulky.not_null_int_customers_segmentation_tenure.0be21be79b
[0m12:05:43.014554 [debug] [Thread-7  ]: Began compiling node test.billy_bulky.relationships_int_customers_segmentation_customer_id__ref_staging_shopify__customers_.631403bf0f
[0m12:05:43.017640 [debug] [Thread-4  ]: Writing injected SQL for node "test.billy_bulky.not_null_int_customers_segmentation_cancellation_rate.768fbfc8cf"
[0m12:05:43.020828 [debug] [Thread-1  ]: Writing injected SQL for node "test.billy_bulky.not_null_int_customers_segmentation_customer_id.7bcd6b69a3"
[0m12:05:43.024503 [debug] [Thread-2  ]: Writing injected SQL for node "test.billy_bulky.not_null_int_customers_segmentation_email.24b3236f34"
[0m12:05:43.027485 [debug] [Thread-8  ]: Writing injected SQL for node "test.billy_bulky.not_null_int_customers_segmentation_frequency.687f7fb8e3"
[0m12:05:43.030468 [debug] [Thread-3  ]: Writing injected SQL for node "test.billy_bulky.not_null_int_customers_segmentation_monetary.0620d6d71b"
[0m12:05:43.033428 [debug] [Thread-9  ]: Writing injected SQL for node "test.billy_bulky.not_null_int_customers_segmentation_recency.d39c8bf889"
[0m12:05:43.033718 [debug] [Thread-10 ]: Timing info for model.billy_bulky.customers (compile): 12:05:42.998110 => 12:05:43.033587
[0m12:05:43.036561 [debug] [Thread-6  ]: Writing injected SQL for node "test.billy_bulky.not_null_int_customers_segmentation_tenure.0be21be79b"
[0m12:05:43.043094 [debug] [Thread-7  ]: Writing injected SQL for node "test.billy_bulky.relationships_int_customers_segmentation_customer_id__ref_staging_shopify__customers_.631403bf0f"
[0m12:05:43.043639 [debug] [Thread-5  ]: Timing info for test.billy_bulky.not_null_int_customers_segmentation_average_order_value.bc3928d48c (compile): 12:05:43.006282 => 12:05:43.043501
[0m12:05:43.044075 [debug] [Thread-1  ]: Timing info for test.billy_bulky.not_null_int_customers_segmentation_customer_id.7bcd6b69a3 (compile): 12:05:43.017844 => 12:05:43.043936
[0m12:05:43.044336 [debug] [Thread-4  ]: Timing info for test.billy_bulky.not_null_int_customers_segmentation_cancellation_rate.768fbfc8cf (compile): 12:05:43.014698 => 12:05:43.044218
[0m12:05:43.044707 [debug] [Thread-2  ]: Timing info for test.billy_bulky.not_null_int_customers_segmentation_email.24b3236f34 (compile): 12:05:43.021006 => 12:05:43.044567
[0m12:05:43.044957 [debug] [Thread-8  ]: Timing info for test.billy_bulky.not_null_int_customers_segmentation_frequency.687f7fb8e3 (compile): 12:05:43.024676 => 12:05:43.044839
[0m12:05:43.045213 [debug] [Thread-3  ]: Timing info for test.billy_bulky.not_null_int_customers_segmentation_monetary.0620d6d71b (compile): 12:05:43.027667 => 12:05:43.045095
[0m12:05:43.045437 [debug] [Thread-10 ]: Began executing node model.billy_bulky.customers
[0m12:05:43.045719 [debug] [Thread-9  ]: Timing info for test.billy_bulky.not_null_int_customers_segmentation_recency.d39c8bf889 (compile): 12:05:43.030650 => 12:05:43.045602
[0m12:05:43.046038 [debug] [Thread-5  ]: Began executing node test.billy_bulky.not_null_int_customers_segmentation_average_order_value.bc3928d48c
[0m12:05:43.046319 [debug] [Thread-6  ]: Timing info for test.billy_bulky.not_null_int_customers_segmentation_tenure.0be21be79b (compile): 12:05:43.033883 => 12:05:43.046199
[0m12:05:43.046575 [debug] [Thread-7  ]: Timing info for test.billy_bulky.relationships_int_customers_segmentation_customer_id__ref_staging_shopify__customers_.631403bf0f (compile): 12:05:43.036748 => 12:05:43.046452
[0m12:05:43.046804 [debug] [Thread-1  ]: Began executing node test.billy_bulky.not_null_int_customers_segmentation_customer_id.7bcd6b69a3
[0m12:05:43.047035 [debug] [Thread-4  ]: Began executing node test.billy_bulky.not_null_int_customers_segmentation_cancellation_rate.768fbfc8cf
[0m12:05:43.047270 [debug] [Thread-2  ]: Began executing node test.billy_bulky.not_null_int_customers_segmentation_email.24b3236f34
[0m12:05:43.047505 [debug] [Thread-8  ]: Began executing node test.billy_bulky.not_null_int_customers_segmentation_frequency.687f7fb8e3
[0m12:05:43.047726 [debug] [Thread-3  ]: Began executing node test.billy_bulky.not_null_int_customers_segmentation_monetary.0620d6d71b
[0m12:05:43.048014 [debug] [Thread-10 ]: Timing info for model.billy_bulky.customers (execute): 12:05:43.047875 => 12:05:43.047881
[0m12:05:43.048249 [debug] [Thread-9  ]: Began executing node test.billy_bulky.not_null_int_customers_segmentation_recency.d39c8bf889
[0m12:05:43.048533 [debug] [Thread-5  ]: Timing info for test.billy_bulky.not_null_int_customers_segmentation_average_order_value.bc3928d48c (execute): 12:05:43.048404 => 12:05:43.048408
[0m12:05:43.048758 [debug] [Thread-6  ]: Began executing node test.billy_bulky.not_null_int_customers_segmentation_tenure.0be21be79b
[0m12:05:43.048990 [debug] [Thread-7  ]: Began executing node test.billy_bulky.relationships_int_customers_segmentation_customer_id__ref_staging_shopify__customers_.631403bf0f
[0m12:05:43.049264 [debug] [Thread-1  ]: Timing info for test.billy_bulky.not_null_int_customers_segmentation_customer_id.7bcd6b69a3 (execute): 12:05:43.049137 => 12:05:43.049140
[0m12:05:43.049534 [debug] [Thread-4  ]: Timing info for test.billy_bulky.not_null_int_customers_segmentation_cancellation_rate.768fbfc8cf (execute): 12:05:43.049407 => 12:05:43.049410
[0m12:05:43.049791 [debug] [Thread-2  ]: Timing info for test.billy_bulky.not_null_int_customers_segmentation_email.24b3236f34 (execute): 12:05:43.049672 => 12:05:43.049675
[0m12:05:43.050058 [debug] [Thread-8  ]: Timing info for test.billy_bulky.not_null_int_customers_segmentation_frequency.687f7fb8e3 (execute): 12:05:43.049935 => 12:05:43.049938
[0m12:05:43.050336 [debug] [Thread-3  ]: Timing info for test.billy_bulky.not_null_int_customers_segmentation_monetary.0620d6d71b (execute): 12:05:43.050202 => 12:05:43.050206
[0m12:05:43.050965 [debug] [Thread-10 ]: Finished running node model.billy_bulky.customers
[0m12:05:43.051229 [debug] [Thread-9  ]: Timing info for test.billy_bulky.not_null_int_customers_segmentation_recency.d39c8bf889 (execute): 12:05:43.051104 => 12:05:43.051107
[0m12:05:43.051742 [debug] [Thread-5  ]: Finished running node test.billy_bulky.not_null_int_customers_segmentation_average_order_value.bc3928d48c
[0m12:05:43.052006 [debug] [Thread-6  ]: Timing info for test.billy_bulky.not_null_int_customers_segmentation_tenure.0be21be79b (execute): 12:05:43.051887 => 12:05:43.051890
[0m12:05:43.052261 [debug] [Thread-7  ]: Timing info for test.billy_bulky.relationships_int_customers_segmentation_customer_id__ref_staging_shopify__customers_.631403bf0f (execute): 12:05:43.052139 => 12:05:43.052142
[0m12:05:43.052772 [debug] [Thread-1  ]: Finished running node test.billy_bulky.not_null_int_customers_segmentation_customer_id.7bcd6b69a3
[0m12:05:43.053263 [debug] [Thread-4  ]: Finished running node test.billy_bulky.not_null_int_customers_segmentation_cancellation_rate.768fbfc8cf
[0m12:05:43.053748 [debug] [Thread-2  ]: Finished running node test.billy_bulky.not_null_int_customers_segmentation_email.24b3236f34
[0m12:05:43.054231 [debug] [Thread-8  ]: Finished running node test.billy_bulky.not_null_int_customers_segmentation_frequency.687f7fb8e3
[0m12:05:43.054713 [debug] [Thread-3  ]: Finished running node test.billy_bulky.not_null_int_customers_segmentation_monetary.0620d6d71b
[0m12:05:43.054958 [debug] [Thread-10 ]: Began running node test.billy_bulky.unique_int_customers_segmentation_customer_id.737b0a111e
[0m12:05:43.055450 [debug] [Thread-9  ]: Finished running node test.billy_bulky.not_null_int_customers_segmentation_recency.d39c8bf889
[0m12:05:43.055799 [debug] [Thread-5  ]: Began running node test.billy_bulky.unique_int_customers_segmentation_email.7a1780ed71
[0m12:05:43.056302 [debug] [Thread-6  ]: Finished running node test.billy_bulky.not_null_int_customers_segmentation_tenure.0be21be79b
[0m12:05:43.056834 [debug] [Thread-7  ]: Finished running node test.billy_bulky.relationships_int_customers_segmentation_customer_id__ref_staging_shopify__customers_.631403bf0f
[0m12:05:43.057113 [debug] [Thread-1  ]: Began running node model.billy_bulky.products
[0m12:05:43.057405 [debug] [Thread-4  ]: Began running node test.billy_bulky.not_null_int_products_performance_average_sale_price.49f9659270
[0m12:05:43.057694 [debug] [Thread-2  ]: Began running node test.billy_bulky.not_null_int_products_performance_category.b0997fd4c0
[0m12:05:43.057957 [debug] [Thread-8  ]: Began running node test.billy_bulky.not_null_int_products_performance_name.cb211db76b
[0m12:05:43.058237 [debug] [Thread-3  ]: Began running node test.billy_bulky.not_null_int_products_performance_price.e722eef2f1
[0m12:05:43.058647 [debug] [Thread-10 ]: Re-using an available connection from the pool (formerly model.billy_bulky.customers, now test.billy_bulky.unique_int_customers_segmentation_customer_id.737b0a111e)
[0m12:05:43.058898 [debug] [Thread-9  ]: Began running node test.billy_bulky.not_null_int_products_performance_product_id.6eddc31245
[0m12:05:43.059282 [debug] [Thread-5  ]: Re-using an available connection from the pool (formerly test.billy_bulky.not_null_int_customers_segmentation_average_order_value.bc3928d48c, now test.billy_bulky.unique_int_customers_segmentation_email.7a1780ed71)
[0m12:05:43.059547 [debug] [Thread-6  ]: Began running node test.billy_bulky.not_null_int_products_performance_stock_level.5bdf7a0ca0
[0m12:05:43.059805 [debug] [Thread-7  ]: Began running node test.billy_bulky.not_null_int_products_performance_total_sales.f381626ec4
[0m12:05:43.060191 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.billy_bulky.not_null_int_customers_segmentation_customer_id.7bcd6b69a3, now model.billy_bulky.products)
[0m12:05:43.060561 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.billy_bulky.not_null_int_customers_segmentation_cancellation_rate.768fbfc8cf, now test.billy_bulky.not_null_int_products_performance_average_sale_price.49f9659270)
[0m12:05:43.060931 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.billy_bulky.not_null_int_customers_segmentation_email.24b3236f34, now test.billy_bulky.not_null_int_products_performance_category.b0997fd4c0)
[0m12:05:43.061296 [debug] [Thread-8  ]: Re-using an available connection from the pool (formerly test.billy_bulky.not_null_int_customers_segmentation_frequency.687f7fb8e3, now test.billy_bulky.not_null_int_products_performance_name.cb211db76b)
[0m12:05:43.061662 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.billy_bulky.not_null_int_customers_segmentation_monetary.0620d6d71b, now test.billy_bulky.not_null_int_products_performance_price.e722eef2f1)
[0m12:05:43.061889 [debug] [Thread-10 ]: Began compiling node test.billy_bulky.unique_int_customers_segmentation_customer_id.737b0a111e
[0m12:05:43.062262 [debug] [Thread-9  ]: Re-using an available connection from the pool (formerly test.billy_bulky.not_null_int_customers_segmentation_recency.d39c8bf889, now test.billy_bulky.not_null_int_products_performance_product_id.6eddc31245)
[0m12:05:43.062482 [debug] [Thread-5  ]: Began compiling node test.billy_bulky.unique_int_customers_segmentation_email.7a1780ed71
[0m12:05:43.062834 [debug] [Thread-6  ]: Re-using an available connection from the pool (formerly test.billy_bulky.not_null_int_customers_segmentation_tenure.0be21be79b, now test.billy_bulky.not_null_int_products_performance_stock_level.5bdf7a0ca0)
[0m12:05:43.063189 [debug] [Thread-7  ]: Re-using an available connection from the pool (formerly test.billy_bulky.relationships_int_customers_segmentation_customer_id__ref_staging_shopify__customers_.631403bf0f, now test.billy_bulky.not_null_int_products_performance_total_sales.f381626ec4)
[0m12:05:43.063401 [debug] [Thread-1  ]: Began compiling node model.billy_bulky.products
[0m12:05:43.063606 [debug] [Thread-4  ]: Began compiling node test.billy_bulky.not_null_int_products_performance_average_sale_price.49f9659270
[0m12:05:43.063810 [debug] [Thread-2  ]: Began compiling node test.billy_bulky.not_null_int_products_performance_category.b0997fd4c0
[0m12:05:43.064010 [debug] [Thread-8  ]: Began compiling node test.billy_bulky.not_null_int_products_performance_name.cb211db76b
[0m12:05:43.064212 [debug] [Thread-3  ]: Began compiling node test.billy_bulky.not_null_int_products_performance_price.e722eef2f1
[0m12:05:43.070177 [debug] [Thread-10 ]: Writing injected SQL for node "test.billy_bulky.unique_int_customers_segmentation_customer_id.737b0a111e"
[0m12:05:43.070435 [debug] [Thread-9  ]: Began compiling node test.billy_bulky.not_null_int_products_performance_product_id.6eddc31245
[0m12:05:43.073855 [debug] [Thread-5  ]: Writing injected SQL for node "test.billy_bulky.unique_int_customers_segmentation_email.7a1780ed71"
[0m12:05:43.074095 [debug] [Thread-6  ]: Began compiling node test.billy_bulky.not_null_int_products_performance_stock_level.5bdf7a0ca0
[0m12:05:43.074313 [debug] [Thread-7  ]: Began compiling node test.billy_bulky.not_null_int_products_performance_total_sales.f381626ec4
[0m12:05:43.077810 [debug] [Thread-1  ]: Writing injected SQL for node "model.billy_bulky.products"
[0m12:05:43.080651 [debug] [Thread-4  ]: Writing injected SQL for node "test.billy_bulky.not_null_int_products_performance_average_sale_price.49f9659270"
[0m12:05:43.083514 [debug] [Thread-2  ]: Writing injected SQL for node "test.billy_bulky.not_null_int_products_performance_category.b0997fd4c0"
[0m12:05:43.086393 [debug] [Thread-8  ]: Writing injected SQL for node "test.billy_bulky.not_null_int_products_performance_name.cb211db76b"
[0m12:05:43.089163 [debug] [Thread-3  ]: Writing injected SQL for node "test.billy_bulky.not_null_int_products_performance_price.e722eef2f1"
[0m12:05:43.092831 [debug] [Thread-9  ]: Writing injected SQL for node "test.billy_bulky.not_null_int_products_performance_product_id.6eddc31245"
[0m12:05:43.095835 [debug] [Thread-6  ]: Writing injected SQL for node "test.billy_bulky.not_null_int_products_performance_stock_level.5bdf7a0ca0"
[0m12:05:43.098630 [debug] [Thread-7  ]: Writing injected SQL for node "test.billy_bulky.not_null_int_products_performance_total_sales.f381626ec4"
[0m12:05:43.098994 [debug] [Thread-10 ]: Timing info for test.billy_bulky.unique_int_customers_segmentation_customer_id.737b0a111e (compile): 12:05:43.064339 => 12:05:43.098862
[0m12:05:43.099408 [debug] [Thread-5  ]: Timing info for test.billy_bulky.unique_int_customers_segmentation_email.7a1780ed71 (compile): 12:05:43.070575 => 12:05:43.099263
[0m12:05:43.099800 [debug] [Thread-1  ]: Timing info for model.billy_bulky.products (compile): 12:05:43.074447 => 12:05:43.099683
[0m12:05:43.100216 [debug] [Thread-2  ]: Timing info for test.billy_bulky.not_null_int_products_performance_category.b0997fd4c0 (compile): 12:05:43.080811 => 12:05:43.100091
[0m12:05:43.100558 [debug] [Thread-4  ]: Timing info for test.billy_bulky.not_null_int_products_performance_average_sale_price.49f9659270 (compile): 12:05:43.077965 => 12:05:43.100421
[0m12:05:43.100798 [debug] [Thread-10 ]: Began executing node test.billy_bulky.unique_int_customers_segmentation_customer_id.737b0a111e
[0m12:05:43.101066 [debug] [Thread-3  ]: Timing info for test.billy_bulky.not_null_int_products_performance_price.e722eef2f1 (compile): 12:05:43.086551 => 12:05:43.100945
[0m12:05:43.101397 [debug] [Thread-8  ]: Timing info for test.billy_bulky.not_null_int_products_performance_name.cb211db76b (compile): 12:05:43.083672 => 12:05:43.101282
[0m12:05:43.101632 [debug] [Thread-5  ]: Began executing node test.billy_bulky.unique_int_customers_segmentation_email.7a1780ed71
[0m12:05:43.101888 [debug] [Thread-7  ]: Timing info for test.billy_bulky.not_null_int_products_performance_total_sales.f381626ec4 (compile): 12:05:43.095999 => 12:05:43.101766
[0m12:05:43.102140 [debug] [Thread-1  ]: Began executing node model.billy_bulky.products
[0m12:05:43.102411 [debug] [Thread-6  ]: Timing info for test.billy_bulky.not_null_int_products_performance_stock_level.5bdf7a0ca0 (compile): 12:05:43.093078 => 12:05:43.102292
[0m12:05:43.102647 [debug] [Thread-9  ]: Timing info for test.billy_bulky.not_null_int_products_performance_product_id.6eddc31245 (compile): 12:05:43.089365 => 12:05:43.102530
[0m12:05:43.102866 [debug] [Thread-2  ]: Began executing node test.billy_bulky.not_null_int_products_performance_category.b0997fd4c0
[0m12:05:43.103102 [debug] [Thread-4  ]: Began executing node test.billy_bulky.not_null_int_products_performance_average_sale_price.49f9659270
[0m12:05:43.103376 [debug] [Thread-10 ]: Timing info for test.billy_bulky.unique_int_customers_segmentation_customer_id.737b0a111e (execute): 12:05:43.103246 => 12:05:43.103251
[0m12:05:43.103602 [debug] [Thread-3  ]: Began executing node test.billy_bulky.not_null_int_products_performance_price.e722eef2f1
[0m12:05:43.103828 [debug] [Thread-8  ]: Began executing node test.billy_bulky.not_null_int_products_performance_name.cb211db76b
[0m12:05:43.104092 [debug] [Thread-5  ]: Timing info for test.billy_bulky.unique_int_customers_segmentation_email.7a1780ed71 (execute): 12:05:43.103972 => 12:05:43.103975
[0m12:05:43.104319 [debug] [Thread-7  ]: Began executing node test.billy_bulky.not_null_int_products_performance_total_sales.f381626ec4
[0m12:05:43.104579 [debug] [Thread-1  ]: Timing info for model.billy_bulky.products (execute): 12:05:43.104462 => 12:05:43.104465
[0m12:05:43.104797 [debug] [Thread-6  ]: Began executing node test.billy_bulky.not_null_int_products_performance_stock_level.5bdf7a0ca0
[0m12:05:43.105018 [debug] [Thread-9  ]: Began executing node test.billy_bulky.not_null_int_products_performance_product_id.6eddc31245
[0m12:05:43.105281 [debug] [Thread-2  ]: Timing info for test.billy_bulky.not_null_int_products_performance_category.b0997fd4c0 (execute): 12:05:43.105154 => 12:05:43.105158
[0m12:05:43.105539 [debug] [Thread-4  ]: Timing info for test.billy_bulky.not_null_int_products_performance_average_sale_price.49f9659270 (execute): 12:05:43.105420 => 12:05:43.105423
[0m12:05:43.106210 [debug] [Thread-10 ]: Finished running node test.billy_bulky.unique_int_customers_segmentation_customer_id.737b0a111e
[0m12:05:43.106485 [debug] [Thread-3  ]: Timing info for test.billy_bulky.not_null_int_products_performance_price.e722eef2f1 (execute): 12:05:43.106356 => 12:05:43.106359
[0m12:05:43.106762 [debug] [Thread-8  ]: Timing info for test.billy_bulky.not_null_int_products_performance_name.cb211db76b (execute): 12:05:43.106638 => 12:05:43.106641
[0m12:05:43.107272 [debug] [Thread-5  ]: Finished running node test.billy_bulky.unique_int_customers_segmentation_email.7a1780ed71
[0m12:05:43.107537 [debug] [Thread-7  ]: Timing info for test.billy_bulky.not_null_int_products_performance_total_sales.f381626ec4 (execute): 12:05:43.107411 => 12:05:43.107414
[0m12:05:43.108055 [debug] [Thread-1  ]: Finished running node model.billy_bulky.products
[0m12:05:43.108308 [debug] [Thread-6  ]: Timing info for test.billy_bulky.not_null_int_products_performance_stock_level.5bdf7a0ca0 (execute): 12:05:43.108187 => 12:05:43.108190
[0m12:05:43.108578 [debug] [Thread-9  ]: Timing info for test.billy_bulky.not_null_int_products_performance_product_id.6eddc31245 (execute): 12:05:43.108451 => 12:05:43.108455
[0m12:05:43.109075 [debug] [Thread-2  ]: Finished running node test.billy_bulky.not_null_int_products_performance_category.b0997fd4c0
[0m12:05:43.109574 [debug] [Thread-4  ]: Finished running node test.billy_bulky.not_null_int_products_performance_average_sale_price.49f9659270
[0m12:05:43.109825 [debug] [Thread-10 ]: Began running node test.billy_bulky.not_null_int_products_performance_total_sales_value.9cc2571319
[0m12:05:43.110366 [debug] [Thread-3  ]: Finished running node test.billy_bulky.not_null_int_products_performance_price.e722eef2f1
[0m12:05:43.110862 [debug] [Thread-8  ]: Finished running node test.billy_bulky.not_null_int_products_performance_name.cb211db76b
[0m12:05:43.111109 [debug] [Thread-5  ]: Began running node test.billy_bulky.not_null_int_products_performance_total_units_sold.a0138ef512
[0m12:05:43.111627 [debug] [Thread-7  ]: Finished running node test.billy_bulky.not_null_int_products_performance_total_sales.f381626ec4
[0m12:05:43.111872 [debug] [Thread-1  ]: Began running node test.billy_bulky.not_null_int_products_performance_turnover_rate.4555c72552
[0m12:05:43.112406 [debug] [Thread-6  ]: Finished running node test.billy_bulky.not_null_int_products_performance_stock_level.5bdf7a0ca0
[0m12:05:43.112975 [debug] [Thread-9  ]: Finished running node test.billy_bulky.not_null_int_products_performance_product_id.6eddc31245
[0m12:05:43.113216 [debug] [Thread-2  ]: Began running node test.billy_bulky.unique_int_products_performance_product_id.a543360079
[0m12:05:43.113489 [debug] [Thread-4  ]: Began running node model.billy_bulky.sales
[0m12:05:43.113879 [debug] [Thread-10 ]: Re-using an available connection from the pool (formerly test.billy_bulky.unique_int_customers_segmentation_customer_id.737b0a111e, now test.billy_bulky.not_null_int_products_performance_total_sales_value.9cc2571319)
[0m12:05:43.114132 [debug] [Thread-3  ]: Began running node test.billy_bulky.not_null_int_sales_trend_daily_orders.c6aeac9a9e
[0m12:05:43.114400 [debug] [Thread-8  ]: Began running node test.billy_bulky.not_null_int_sales_trend_daily_sales_value.af10ec1765
[0m12:05:43.114779 [debug] [Thread-5  ]: Re-using an available connection from the pool (formerly test.billy_bulky.unique_int_customers_segmentation_email.7a1780ed71, now test.billy_bulky.not_null_int_products_performance_total_units_sold.a0138ef512)
[0m12:05:43.115028 [debug] [Thread-7  ]: Began running node test.billy_bulky.not_null_int_sales_trend_daily_units_sold.9ee9311418
[0m12:05:43.115419 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.billy_bulky.products, now test.billy_bulky.not_null_int_products_performance_turnover_rate.4555c72552)
[0m12:05:43.115668 [debug] [Thread-6  ]: Began running node test.billy_bulky.not_null_int_sales_trend_monthly_orders.a635cd192a
[0m12:05:43.115937 [debug] [Thread-9  ]: Began running node test.billy_bulky.not_null_int_sales_trend_monthly_sales_value.2acff1fdef
[0m12:05:43.116314 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.billy_bulky.not_null_int_products_performance_category.b0997fd4c0, now test.billy_bulky.unique_int_products_performance_product_id.a543360079)
[0m12:05:43.116682 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.billy_bulky.not_null_int_products_performance_average_sale_price.49f9659270, now model.billy_bulky.sales)
[0m12:05:43.116917 [debug] [Thread-10 ]: Began compiling node test.billy_bulky.not_null_int_products_performance_total_sales_value.9cc2571319
[0m12:05:43.117281 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.billy_bulky.not_null_int_products_performance_price.e722eef2f1, now test.billy_bulky.not_null_int_sales_trend_daily_orders.c6aeac9a9e)
[0m12:05:43.117628 [debug] [Thread-8  ]: Re-using an available connection from the pool (formerly test.billy_bulky.not_null_int_products_performance_name.cb211db76b, now test.billy_bulky.not_null_int_sales_trend_daily_sales_value.af10ec1765)
[0m12:05:43.117842 [debug] [Thread-5  ]: Began compiling node test.billy_bulky.not_null_int_products_performance_total_units_sold.a0138ef512
[0m12:05:43.118184 [debug] [Thread-7  ]: Re-using an available connection from the pool (formerly test.billy_bulky.not_null_int_products_performance_total_sales.f381626ec4, now test.billy_bulky.not_null_int_sales_trend_daily_units_sold.9ee9311418)
[0m12:05:43.118399 [debug] [Thread-1  ]: Began compiling node test.billy_bulky.not_null_int_products_performance_turnover_rate.4555c72552
[0m12:05:43.118747 [debug] [Thread-6  ]: Re-using an available connection from the pool (formerly test.billy_bulky.not_null_int_products_performance_stock_level.5bdf7a0ca0, now test.billy_bulky.not_null_int_sales_trend_monthly_orders.a635cd192a)
[0m12:05:43.119099 [debug] [Thread-9  ]: Re-using an available connection from the pool (formerly test.billy_bulky.not_null_int_products_performance_product_id.6eddc31245, now test.billy_bulky.not_null_int_sales_trend_monthly_sales_value.2acff1fdef)
[0m12:05:43.119313 [debug] [Thread-2  ]: Began compiling node test.billy_bulky.unique_int_products_performance_product_id.a543360079
[0m12:05:43.119515 [debug] [Thread-4  ]: Began compiling node model.billy_bulky.sales
[0m12:05:43.122735 [debug] [Thread-10 ]: Writing injected SQL for node "test.billy_bulky.not_null_int_products_performance_total_sales_value.9cc2571319"
[0m12:05:43.122979 [debug] [Thread-3  ]: Began compiling node test.billy_bulky.not_null_int_sales_trend_daily_orders.c6aeac9a9e
[0m12:05:43.123196 [debug] [Thread-8  ]: Began compiling node test.billy_bulky.not_null_int_sales_trend_daily_sales_value.af10ec1765
[0m12:05:43.125981 [debug] [Thread-5  ]: Writing injected SQL for node "test.billy_bulky.not_null_int_products_performance_total_units_sold.a0138ef512"
[0m12:05:43.126217 [debug] [Thread-7  ]: Began compiling node test.billy_bulky.not_null_int_sales_trend_daily_units_sold.9ee9311418
[0m12:05:43.129042 [debug] [Thread-1  ]: Writing injected SQL for node "test.billy_bulky.not_null_int_products_performance_turnover_rate.4555c72552"
[0m12:05:43.129279 [debug] [Thread-6  ]: Began compiling node test.billy_bulky.not_null_int_sales_trend_monthly_orders.a635cd192a
[0m12:05:43.129493 [debug] [Thread-9  ]: Began compiling node test.billy_bulky.not_null_int_sales_trend_monthly_sales_value.2acff1fdef
[0m12:05:43.132861 [debug] [Thread-2  ]: Writing injected SQL for node "test.billy_bulky.unique_int_products_performance_product_id.a543360079"
[0m12:05:43.140914 [debug] [Thread-4  ]: Writing injected SQL for node "model.billy_bulky.sales"
[0m12:05:43.143759 [debug] [Thread-3  ]: Writing injected SQL for node "test.billy_bulky.not_null_int_sales_trend_daily_orders.c6aeac9a9e"
[0m12:05:43.146715 [debug] [Thread-8  ]: Writing injected SQL for node "test.billy_bulky.not_null_int_sales_trend_daily_sales_value.af10ec1765"
[0m12:05:43.149552 [debug] [Thread-7  ]: Writing injected SQL for node "test.billy_bulky.not_null_int_sales_trend_daily_units_sold.9ee9311418"
[0m12:05:43.152617 [debug] [Thread-6  ]: Writing injected SQL for node "test.billy_bulky.not_null_int_sales_trend_monthly_orders.a635cd192a"
[0m12:05:43.152918 [debug] [Thread-10 ]: Timing info for test.billy_bulky.not_null_int_products_performance_total_sales_value.9cc2571319 (compile): 12:05:43.119643 => 12:05:43.152783
[0m12:05:43.153179 [debug] [Thread-1  ]: Timing info for test.billy_bulky.not_null_int_products_performance_turnover_rate.4555c72552 (compile): 12:05:43.126353 => 12:05:43.153058
[0m12:05:43.153442 [debug] [Thread-5  ]: Timing info for test.billy_bulky.not_null_int_products_performance_total_units_sold.a0138ef512 (compile): 12:05:43.123330 => 12:05:43.153304
[0m12:05:43.156343 [debug] [Thread-9  ]: Writing injected SQL for node "test.billy_bulky.not_null_int_sales_trend_monthly_sales_value.2acff1fdef"
[0m12:05:43.156831 [debug] [Thread-2  ]: Timing info for test.billy_bulky.unique_int_products_performance_product_id.a543360079 (compile): 12:05:43.129629 => 12:05:43.156695
[0m12:05:43.157141 [debug] [Thread-4  ]: Timing info for model.billy_bulky.sales (compile): 12:05:43.133018 => 12:05:43.157014
[0m12:05:43.157417 [debug] [Thread-3  ]: Timing info for test.billy_bulky.not_null_int_sales_trend_daily_orders.c6aeac9a9e (compile): 12:05:43.141074 => 12:05:43.157285
[0m12:05:43.157746 [debug] [Thread-7  ]: Timing info for test.billy_bulky.not_null_int_sales_trend_daily_units_sold.9ee9311418 (compile): 12:05:43.146926 => 12:05:43.157618
[0m12:05:43.158036 [debug] [Thread-8  ]: Timing info for test.billy_bulky.not_null_int_sales_trend_daily_sales_value.af10ec1765 (compile): 12:05:43.143940 => 12:05:43.157894
[0m12:05:43.158298 [debug] [Thread-10 ]: Began executing node test.billy_bulky.not_null_int_products_performance_total_sales_value.9cc2571319
[0m12:05:43.158547 [debug] [Thread-1  ]: Began executing node test.billy_bulky.not_null_int_products_performance_turnover_rate.4555c72552
[0m12:05:43.158807 [debug] [Thread-6  ]: Timing info for test.billy_bulky.not_null_int_sales_trend_monthly_orders.a635cd192a (compile): 12:05:43.149811 => 12:05:43.158686
[0m12:05:43.159026 [debug] [Thread-5  ]: Began executing node test.billy_bulky.not_null_int_products_performance_total_units_sold.a0138ef512
[0m12:05:43.159285 [debug] [Thread-2  ]: Began executing node test.billy_bulky.unique_int_products_performance_product_id.a543360079
[0m12:05:43.159519 [debug] [Thread-4  ]: Began executing node model.billy_bulky.sales
[0m12:05:43.159789 [debug] [Thread-9  ]: Timing info for test.billy_bulky.not_null_int_sales_trend_monthly_sales_value.2acff1fdef (compile): 12:05:43.153595 => 12:05:43.159663
[0m12:05:43.159997 [debug] [Thread-3  ]: Began executing node test.billy_bulky.not_null_int_sales_trend_daily_orders.c6aeac9a9e
[0m12:05:43.160215 [debug] [Thread-7  ]: Began executing node test.billy_bulky.not_null_int_sales_trend_daily_units_sold.9ee9311418
[0m12:05:43.160427 [debug] [Thread-8  ]: Began executing node test.billy_bulky.not_null_int_sales_trend_daily_sales_value.af10ec1765
[0m12:05:43.160682 [debug] [Thread-10 ]: Timing info for test.billy_bulky.not_null_int_products_performance_total_sales_value.9cc2571319 (execute): 12:05:43.160561 => 12:05:43.160567
[0m12:05:43.160938 [debug] [Thread-1  ]: Timing info for test.billy_bulky.not_null_int_products_performance_turnover_rate.4555c72552 (execute): 12:05:43.160817 => 12:05:43.160820
[0m12:05:43.161152 [debug] [Thread-6  ]: Began executing node test.billy_bulky.not_null_int_sales_trend_monthly_orders.a635cd192a
[0m12:05:43.161403 [debug] [Thread-5  ]: Timing info for test.billy_bulky.not_null_int_products_performance_total_units_sold.a0138ef512 (execute): 12:05:43.161287 => 12:05:43.161289
[0m12:05:43.161653 [debug] [Thread-2  ]: Timing info for test.billy_bulky.unique_int_products_performance_product_id.a543360079 (execute): 12:05:43.161538 => 12:05:43.161541
[0m12:05:43.161899 [debug] [Thread-4  ]: Timing info for model.billy_bulky.sales (execute): 12:05:43.161786 => 12:05:43.161789
[0m12:05:43.162108 [debug] [Thread-9  ]: Began executing node test.billy_bulky.not_null_int_sales_trend_monthly_sales_value.2acff1fdef
[0m12:05:43.162355 [debug] [Thread-3  ]: Timing info for test.billy_bulky.not_null_int_sales_trend_daily_orders.c6aeac9a9e (execute): 12:05:43.162242 => 12:05:43.162245
[0m12:05:43.162599 [debug] [Thread-7  ]: Timing info for test.billy_bulky.not_null_int_sales_trend_daily_units_sold.9ee9311418 (execute): 12:05:43.162485 => 12:05:43.162488
[0m12:05:43.162843 [debug] [Thread-8  ]: Timing info for test.billy_bulky.not_null_int_sales_trend_daily_sales_value.af10ec1765 (execute): 12:05:43.162730 => 12:05:43.162732
[0m12:05:43.163376 [debug] [Thread-10 ]: Finished running node test.billy_bulky.not_null_int_products_performance_total_sales_value.9cc2571319
[0m12:05:43.163870 [debug] [Thread-1  ]: Finished running node test.billy_bulky.not_null_int_products_performance_turnover_rate.4555c72552
[0m12:05:43.164131 [debug] [Thread-6  ]: Timing info for test.billy_bulky.not_null_int_sales_trend_monthly_orders.a635cd192a (execute): 12:05:43.164009 => 12:05:43.164012
[0m12:05:43.164637 [debug] [Thread-5  ]: Finished running node test.billy_bulky.not_null_int_products_performance_total_units_sold.a0138ef512
[0m12:05:43.165131 [debug] [Thread-2  ]: Finished running node test.billy_bulky.unique_int_products_performance_product_id.a543360079
[0m12:05:43.165615 [debug] [Thread-4  ]: Finished running node model.billy_bulky.sales
[0m12:05:43.165872 [debug] [Thread-9  ]: Timing info for test.billy_bulky.not_null_int_sales_trend_monthly_sales_value.2acff1fdef (execute): 12:05:43.165753 => 12:05:43.165756
[0m12:05:43.166345 [debug] [Thread-3  ]: Finished running node test.billy_bulky.not_null_int_sales_trend_daily_orders.c6aeac9a9e
[0m12:05:43.166824 [debug] [Thread-7  ]: Finished running node test.billy_bulky.not_null_int_sales_trend_daily_units_sold.9ee9311418
[0m12:05:43.167304 [debug] [Thread-8  ]: Finished running node test.billy_bulky.not_null_int_sales_trend_daily_sales_value.af10ec1765
[0m12:05:43.167552 [debug] [Thread-10 ]: Began running node test.billy_bulky.not_null_int_sales_trend_monthly_units_sold.8d1c11ea44
[0m12:05:43.167838 [debug] [Thread-1  ]: Began running node test.billy_bulky.not_null_int_sales_trend_sale_date.0f60e5e777
[0m12:05:43.168341 [debug] [Thread-6  ]: Finished running node test.billy_bulky.not_null_int_sales_trend_monthly_orders.a635cd192a
[0m12:05:43.168580 [debug] [Thread-5  ]: Began running node test.billy_bulky.not_null_int_sales_trend_weekly_orders.834a57e639
[0m12:05:43.168851 [debug] [Thread-2  ]: Began running node test.billy_bulky.not_null_int_sales_trend_weekly_sales_value.d34f1e8e72
[0m12:05:43.169113 [debug] [Thread-4  ]: Began running node test.billy_bulky.not_null_int_sales_trend_weekly_units_sold.b9e8aebabb
[0m12:05:43.169611 [debug] [Thread-9  ]: Finished running node test.billy_bulky.not_null_int_sales_trend_monthly_sales_value.2acff1fdef
[0m12:05:43.169868 [debug] [Thread-3  ]: Began running node test.billy_bulky.not_null_int_sales_trend_yearly_orders.5d0eed9779
[0m12:05:43.170141 [debug] [Thread-7  ]: Began running node test.billy_bulky.not_null_int_sales_trend_yearly_sales_value.2aa87b5604
[0m12:05:43.170407 [debug] [Thread-8  ]: Began running node test.billy_bulky.not_null_int_sales_trend_yearly_units_sold.de70849c7a
[0m12:05:43.170815 [debug] [Thread-10 ]: Re-using an available connection from the pool (formerly test.billy_bulky.not_null_int_products_performance_total_sales_value.9cc2571319, now test.billy_bulky.not_null_int_sales_trend_monthly_units_sold.8d1c11ea44)
[0m12:05:43.171198 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.billy_bulky.not_null_int_products_performance_turnover_rate.4555c72552, now test.billy_bulky.not_null_int_sales_trend_sale_date.0f60e5e777)
[0m12:05:43.171452 [debug] [Thread-6  ]: Began running node test.billy_bulky.unique_int_sales_trend_sale_date.6cc21ad30e
[0m12:05:43.171850 [debug] [Thread-5  ]: Re-using an available connection from the pool (formerly test.billy_bulky.not_null_int_products_performance_total_units_sold.a0138ef512, now test.billy_bulky.not_null_int_sales_trend_weekly_orders.834a57e639)
[0m12:05:43.172226 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.billy_bulky.unique_int_products_performance_product_id.a543360079, now test.billy_bulky.not_null_int_sales_trend_weekly_sales_value.d34f1e8e72)
[0m12:05:43.172600 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.billy_bulky.sales, now test.billy_bulky.not_null_int_sales_trend_weekly_units_sold.b9e8aebabb)
[0m12:05:43.172844 [debug] [Thread-9  ]: Began running node test.billy_bulky.not_null_customers_customer_id.5c9bf9911d
[0m12:05:43.173191 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.billy_bulky.not_null_int_sales_trend_daily_orders.c6aeac9a9e, now test.billy_bulky.not_null_int_sales_trend_yearly_orders.5d0eed9779)
[0m12:05:43.173555 [debug] [Thread-7  ]: Re-using an available connection from the pool (formerly test.billy_bulky.not_null_int_sales_trend_daily_units_sold.9ee9311418, now test.billy_bulky.not_null_int_sales_trend_yearly_sales_value.2aa87b5604)
[0m12:05:43.173900 [debug] [Thread-8  ]: Re-using an available connection from the pool (formerly test.billy_bulky.not_null_int_sales_trend_daily_sales_value.af10ec1765, now test.billy_bulky.not_null_int_sales_trend_yearly_units_sold.de70849c7a)
[0m12:05:43.174120 [debug] [Thread-10 ]: Began compiling node test.billy_bulky.not_null_int_sales_trend_monthly_units_sold.8d1c11ea44
[0m12:05:43.174326 [debug] [Thread-1  ]: Began compiling node test.billy_bulky.not_null_int_sales_trend_sale_date.0f60e5e777
[0m12:05:43.174667 [debug] [Thread-6  ]: Re-using an available connection from the pool (formerly test.billy_bulky.not_null_int_sales_trend_monthly_orders.a635cd192a, now test.billy_bulky.unique_int_sales_trend_sale_date.6cc21ad30e)
[0m12:05:43.174880 [debug] [Thread-5  ]: Began compiling node test.billy_bulky.not_null_int_sales_trend_weekly_orders.834a57e639
[0m12:05:43.175084 [debug] [Thread-2  ]: Began compiling node test.billy_bulky.not_null_int_sales_trend_weekly_sales_value.d34f1e8e72
[0m12:05:43.175285 [debug] [Thread-4  ]: Began compiling node test.billy_bulky.not_null_int_sales_trend_weekly_units_sold.b9e8aebabb
[0m12:05:43.175630 [debug] [Thread-9  ]: Re-using an available connection from the pool (formerly test.billy_bulky.not_null_int_sales_trend_monthly_sales_value.2acff1fdef, now test.billy_bulky.not_null_customers_customer_id.5c9bf9911d)
[0m12:05:43.175838 [debug] [Thread-3  ]: Began compiling node test.billy_bulky.not_null_int_sales_trend_yearly_orders.5d0eed9779
[0m12:05:43.176039 [debug] [Thread-7  ]: Began compiling node test.billy_bulky.not_null_int_sales_trend_yearly_sales_value.2aa87b5604
[0m12:05:43.176247 [debug] [Thread-8  ]: Began compiling node test.billy_bulky.not_null_int_sales_trend_yearly_units_sold.de70849c7a
[0m12:05:43.180293 [debug] [Thread-10 ]: Writing injected SQL for node "test.billy_bulky.not_null_int_sales_trend_monthly_units_sold.8d1c11ea44"
[0m12:05:43.183121 [debug] [Thread-1  ]: Writing injected SQL for node "test.billy_bulky.not_null_int_sales_trend_sale_date.0f60e5e777"
[0m12:05:43.183358 [debug] [Thread-6  ]: Began compiling node test.billy_bulky.unique_int_sales_trend_sale_date.6cc21ad30e
[0m12:05:43.186382 [debug] [Thread-5  ]: Writing injected SQL for node "test.billy_bulky.not_null_int_sales_trend_weekly_orders.834a57e639"
[0m12:05:43.189448 [debug] [Thread-2  ]: Writing injected SQL for node "test.billy_bulky.not_null_int_sales_trend_weekly_sales_value.d34f1e8e72"
[0m12:05:43.192342 [debug] [Thread-4  ]: Writing injected SQL for node "test.billy_bulky.not_null_int_sales_trend_weekly_units_sold.b9e8aebabb"
[0m12:05:43.192580 [debug] [Thread-9  ]: Began compiling node test.billy_bulky.not_null_customers_customer_id.5c9bf9911d
[0m12:05:43.195336 [debug] [Thread-3  ]: Writing injected SQL for node "test.billy_bulky.not_null_int_sales_trend_yearly_orders.5d0eed9779"
[0m12:05:43.198164 [debug] [Thread-7  ]: Writing injected SQL for node "test.billy_bulky.not_null_int_sales_trend_yearly_sales_value.2aa87b5604"
[0m12:05:43.201675 [debug] [Thread-8  ]: Writing injected SQL for node "test.billy_bulky.not_null_int_sales_trend_yearly_units_sold.de70849c7a"
[0m12:05:43.205174 [debug] [Thread-6  ]: Writing injected SQL for node "test.billy_bulky.unique_int_sales_trend_sale_date.6cc21ad30e"
[0m12:05:43.205721 [debug] [Thread-1  ]: Timing info for test.billy_bulky.not_null_int_sales_trend_sale_date.0f60e5e777 (compile): 12:05:43.180460 => 12:05:43.205584
[0m12:05:43.208104 [debug] [Thread-9  ]: Writing injected SQL for node "test.billy_bulky.not_null_customers_customer_id.5c9bf9911d"
[0m12:05:43.208408 [debug] [Thread-10 ]: Timing info for test.billy_bulky.not_null_int_sales_trend_monthly_units_sold.8d1c11ea44 (compile): 12:05:43.176372 => 12:05:43.208267
[0m12:05:43.208698 [debug] [Thread-5  ]: Timing info for test.billy_bulky.not_null_int_sales_trend_weekly_orders.834a57e639 (compile): 12:05:43.183492 => 12:05:43.208542
[0m12:05:43.209056 [debug] [Thread-4  ]: Timing info for test.billy_bulky.not_null_int_sales_trend_weekly_units_sold.b9e8aebabb (compile): 12:05:43.189615 => 12:05:43.208918
[0m12:05:43.209340 [debug] [Thread-2  ]: Timing info for test.billy_bulky.not_null_int_sales_trend_weekly_sales_value.d34f1e8e72 (compile): 12:05:43.186579 => 12:05:43.209214
[0m12:05:43.209673 [debug] [Thread-3  ]: Timing info for test.billy_bulky.not_null_int_sales_trend_yearly_orders.5d0eed9779 (compile): 12:05:43.192717 => 12:05:43.209540
[0m12:05:43.209964 [debug] [Thread-1  ]: Began executing node test.billy_bulky.not_null_int_sales_trend_sale_date.0f60e5e777
[0m12:05:43.210256 [debug] [Thread-7  ]: Timing info for test.billy_bulky.not_null_int_sales_trend_yearly_sales_value.2aa87b5604 (compile): 12:05:43.195487 => 12:05:43.210128
[0m12:05:43.210548 [debug] [Thread-10 ]: Began executing node test.billy_bulky.not_null_int_sales_trend_monthly_units_sold.8d1c11ea44
[0m12:05:43.210803 [debug] [Thread-6  ]: Timing info for test.billy_bulky.unique_int_sales_trend_sale_date.6cc21ad30e (compile): 12:05:43.201972 => 12:05:43.210680
[0m12:05:43.211086 [debug] [Thread-8  ]: Timing info for test.billy_bulky.not_null_int_sales_trend_yearly_units_sold.de70849c7a (compile): 12:05:43.198315 => 12:05:43.210954
[0m12:05:43.211309 [debug] [Thread-5  ]: Began executing node test.billy_bulky.not_null_int_sales_trend_weekly_orders.834a57e639
[0m12:05:43.211545 [debug] [Thread-4  ]: Began executing node test.billy_bulky.not_null_int_sales_trend_weekly_units_sold.b9e8aebabb
[0m12:05:43.211796 [debug] [Thread-9  ]: Timing info for test.billy_bulky.not_null_customers_customer_id.5c9bf9911d (compile): 12:05:43.205865 => 12:05:43.211676
[0m12:05:43.212015 [debug] [Thread-2  ]: Began executing node test.billy_bulky.not_null_int_sales_trend_weekly_sales_value.d34f1e8e72
[0m12:05:43.212237 [debug] [Thread-3  ]: Began executing node test.billy_bulky.not_null_int_sales_trend_yearly_orders.5d0eed9779
[0m12:05:43.212513 [debug] [Thread-1  ]: Timing info for test.billy_bulky.not_null_int_sales_trend_sale_date.0f60e5e777 (execute): 12:05:43.212381 => 12:05:43.212387
[0m12:05:43.212739 [debug] [Thread-7  ]: Began executing node test.billy_bulky.not_null_int_sales_trend_yearly_sales_value.2aa87b5604
[0m12:05:43.213003 [debug] [Thread-10 ]: Timing info for test.billy_bulky.not_null_int_sales_trend_monthly_units_sold.8d1c11ea44 (execute): 12:05:43.212882 => 12:05:43.212885
[0m12:05:43.213226 [debug] [Thread-6  ]: Began executing node test.billy_bulky.unique_int_sales_trend_sale_date.6cc21ad30e
[0m12:05:43.213456 [debug] [Thread-8  ]: Began executing node test.billy_bulky.not_null_int_sales_trend_yearly_units_sold.de70849c7a
[0m12:05:43.213727 [debug] [Thread-5  ]: Timing info for test.billy_bulky.not_null_int_sales_trend_weekly_orders.834a57e639 (execute): 12:05:43.213601 => 12:05:43.213605
[0m12:05:43.213992 [debug] [Thread-4  ]: Timing info for test.billy_bulky.not_null_int_sales_trend_weekly_units_sold.b9e8aebabb (execute): 12:05:43.213869 => 12:05:43.213872
[0m12:05:43.214215 [debug] [Thread-9  ]: Began executing node test.billy_bulky.not_null_customers_customer_id.5c9bf9911d
[0m12:05:43.214487 [debug] [Thread-2  ]: Timing info for test.billy_bulky.not_null_int_sales_trend_weekly_sales_value.d34f1e8e72 (execute): 12:05:43.214358 => 12:05:43.214362
[0m12:05:43.214749 [debug] [Thread-3  ]: Timing info for test.billy_bulky.not_null_int_sales_trend_yearly_orders.5d0eed9779 (execute): 12:05:43.214631 => 12:05:43.214634
[0m12:05:43.215301 [debug] [Thread-1  ]: Finished running node test.billy_bulky.not_null_int_sales_trend_sale_date.0f60e5e777
[0m12:05:43.215560 [debug] [Thread-7  ]: Timing info for test.billy_bulky.not_null_int_sales_trend_yearly_sales_value.2aa87b5604 (execute): 12:05:43.215441 => 12:05:43.215445
[0m12:05:43.216080 [debug] [Thread-10 ]: Finished running node test.billy_bulky.not_null_int_sales_trend_monthly_units_sold.8d1c11ea44
[0m12:05:43.216331 [debug] [Thread-6  ]: Timing info for test.billy_bulky.unique_int_sales_trend_sale_date.6cc21ad30e (execute): 12:05:43.216214 => 12:05:43.216217
[0m12:05:43.216595 [debug] [Thread-8  ]: Timing info for test.billy_bulky.not_null_int_sales_trend_yearly_units_sold.de70849c7a (execute): 12:05:43.216471 => 12:05:43.216474
[0m12:05:43.217105 [debug] [Thread-5  ]: Finished running node test.billy_bulky.not_null_int_sales_trend_weekly_orders.834a57e639
[0m12:05:43.217599 [debug] [Thread-4  ]: Finished running node test.billy_bulky.not_null_int_sales_trend_weekly_units_sold.b9e8aebabb
[0m12:05:43.217854 [debug] [Thread-9  ]: Timing info for test.billy_bulky.not_null_customers_customer_id.5c9bf9911d (execute): 12:05:43.217737 => 12:05:43.217740
[0m12:05:43.218334 [debug] [Thread-2  ]: Finished running node test.billy_bulky.not_null_int_sales_trend_weekly_sales_value.d34f1e8e72
[0m12:05:43.218817 [debug] [Thread-3  ]: Finished running node test.billy_bulky.not_null_int_sales_trend_yearly_orders.5d0eed9779
[0m12:05:43.219065 [debug] [Thread-1  ]: Began running node test.billy_bulky.not_null_customers_email.da3cfcd534
[0m12:05:43.219583 [debug] [Thread-7  ]: Finished running node test.billy_bulky.not_null_int_sales_trend_yearly_sales_value.2aa87b5604
[0m12:05:43.219851 [debug] [Thread-10 ]: Began running node test.billy_bulky.not_null_customers_join_date.faf8f07bc9
[0m12:05:43.220358 [debug] [Thread-6  ]: Finished running node test.billy_bulky.unique_int_sales_trend_sale_date.6cc21ad30e
[0m12:05:43.220855 [debug] [Thread-8  ]: Finished running node test.billy_bulky.not_null_int_sales_trend_yearly_units_sold.de70849c7a
[0m12:05:43.221099 [debug] [Thread-5  ]: Began running node test.billy_bulky.unique_customers_customer_id.c5af1ff4b1
[0m12:05:43.221370 [debug] [Thread-4  ]: Began running node test.billy_bulky.unique_customers_email.e77c92eb54
[0m12:05:43.221873 [debug] [Thread-9  ]: Finished running node test.billy_bulky.not_null_customers_customer_id.5c9bf9911d
[0m12:05:43.222119 [debug] [Thread-2  ]: Began running node test.billy_bulky.accepted_values_products_category__books__electronics__home__toys__garden__clothing.e85e5b5f7b
[0m12:05:43.222382 [debug] [Thread-3  ]: Began running node test.billy_bulky.not_null_products_name.d755fc2381
[0m12:05:43.222770 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.billy_bulky.not_null_int_sales_trend_sale_date.0f60e5e777, now test.billy_bulky.not_null_customers_email.da3cfcd534)
[0m12:05:43.223017 [debug] [Thread-7  ]: Began running node test.billy_bulky.not_null_products_price.3b5b0a69be
[0m12:05:43.223413 [debug] [Thread-10 ]: Re-using an available connection from the pool (formerly test.billy_bulky.not_null_int_sales_trend_monthly_units_sold.8d1c11ea44, now test.billy_bulky.not_null_customers_join_date.faf8f07bc9)
[0m12:05:43.223663 [debug] [Thread-6  ]: Began running node test.billy_bulky.not_null_products_product_id.33741cf88e
[0m12:05:43.223928 [debug] [Thread-8  ]: Began running node test.billy_bulky.not_null_products_stock_level.ee79d71f38
[0m12:05:43.224285 [debug] [Thread-5  ]: Re-using an available connection from the pool (formerly test.billy_bulky.not_null_int_sales_trend_weekly_orders.834a57e639, now test.billy_bulky.unique_customers_customer_id.c5af1ff4b1)
[0m12:05:43.224652 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.billy_bulky.not_null_int_sales_trend_weekly_units_sold.b9e8aebabb, now test.billy_bulky.unique_customers_email.e77c92eb54)
[0m12:05:43.224886 [debug] [Thread-9  ]: Began running node test.billy_bulky.unique_products_product_id.68edffb83d
[0m12:05:43.225235 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.billy_bulky.not_null_int_sales_trend_weekly_sales_value.d34f1e8e72, now test.billy_bulky.accepted_values_products_category__books__electronics__home__toys__garden__clothing.e85e5b5f7b)
[0m12:05:43.225601 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.billy_bulky.not_null_int_sales_trend_yearly_orders.5d0eed9779, now test.billy_bulky.not_null_products_name.d755fc2381)
[0m12:05:43.225811 [debug] [Thread-1  ]: Began compiling node test.billy_bulky.not_null_customers_email.da3cfcd534
[0m12:05:43.226158 [debug] [Thread-7  ]: Re-using an available connection from the pool (formerly test.billy_bulky.not_null_int_sales_trend_yearly_sales_value.2aa87b5604, now test.billy_bulky.not_null_products_price.3b5b0a69be)
[0m12:05:43.226367 [debug] [Thread-10 ]: Began compiling node test.billy_bulky.not_null_customers_join_date.faf8f07bc9
[0m12:05:43.226708 [debug] [Thread-6  ]: Re-using an available connection from the pool (formerly test.billy_bulky.unique_int_sales_trend_sale_date.6cc21ad30e, now test.billy_bulky.not_null_products_product_id.33741cf88e)
[0m12:05:43.227053 [debug] [Thread-8  ]: Re-using an available connection from the pool (formerly test.billy_bulky.not_null_int_sales_trend_yearly_units_sold.de70849c7a, now test.billy_bulky.not_null_products_stock_level.ee79d71f38)
[0m12:05:43.227264 [debug] [Thread-5  ]: Began compiling node test.billy_bulky.unique_customers_customer_id.c5af1ff4b1
[0m12:05:43.227464 [debug] [Thread-4  ]: Began compiling node test.billy_bulky.unique_customers_email.e77c92eb54
[0m12:05:43.228086 [debug] [Thread-9  ]: Re-using an available connection from the pool (formerly test.billy_bulky.not_null_customers_customer_id.5c9bf9911d, now test.billy_bulky.unique_products_product_id.68edffb83d)
[0m12:05:43.228309 [debug] [Thread-2  ]: Began compiling node test.billy_bulky.accepted_values_products_category__books__electronics__home__toys__garden__clothing.e85e5b5f7b
[0m12:05:43.228513 [debug] [Thread-3  ]: Began compiling node test.billy_bulky.not_null_products_name.d755fc2381
[0m12:05:43.230958 [debug] [Thread-1  ]: Writing injected SQL for node "test.billy_bulky.not_null_customers_email.da3cfcd534"
[0m12:05:43.231191 [debug] [Thread-7  ]: Began compiling node test.billy_bulky.not_null_products_price.3b5b0a69be
[0m12:05:43.233551 [debug] [Thread-10 ]: Writing injected SQL for node "test.billy_bulky.not_null_customers_join_date.faf8f07bc9"
[0m12:05:43.233779 [debug] [Thread-6  ]: Began compiling node test.billy_bulky.not_null_products_product_id.33741cf88e
[0m12:05:43.233991 [debug] [Thread-8  ]: Began compiling node test.billy_bulky.not_null_products_stock_level.ee79d71f38
[0m12:05:43.236241 [debug] [Thread-5  ]: Writing injected SQL for node "test.billy_bulky.unique_customers_customer_id.c5af1ff4b1"
[0m12:05:43.238534 [debug] [Thread-4  ]: Writing injected SQL for node "test.billy_bulky.unique_customers_email.e77c92eb54"
[0m12:05:43.238764 [debug] [Thread-9  ]: Began compiling node test.billy_bulky.unique_products_product_id.68edffb83d
[0m12:05:43.246842 [debug] [Thread-3  ]: Writing injected SQL for node "test.billy_bulky.not_null_products_name.d755fc2381"
[0m12:05:43.248352 [debug] [Thread-2  ]: Writing injected SQL for node "test.billy_bulky.accepted_values_products_category__books__electronics__home__toys__garden__clothing.e85e5b5f7b"
[0m12:05:43.250853 [debug] [Thread-7  ]: Writing injected SQL for node "test.billy_bulky.not_null_products_price.3b5b0a69be"
[0m12:05:43.253310 [debug] [Thread-6  ]: Writing injected SQL for node "test.billy_bulky.not_null_products_product_id.33741cf88e"
[0m12:05:43.255809 [debug] [Thread-8  ]: Writing injected SQL for node "test.billy_bulky.not_null_products_stock_level.ee79d71f38"
[0m12:05:43.256076 [debug] [Thread-1  ]: Timing info for test.billy_bulky.not_null_customers_email.da3cfcd534 (compile): 12:05:43.228640 => 12:05:43.255947
[0m12:05:43.256331 [debug] [Thread-10 ]: Timing info for test.billy_bulky.not_null_customers_join_date.faf8f07bc9 (compile): 12:05:43.231327 => 12:05:43.256201
[0m12:05:43.258735 [debug] [Thread-9  ]: Writing injected SQL for node "test.billy_bulky.unique_products_product_id.68edffb83d"
[0m12:05:43.259170 [debug] [Thread-4  ]: Timing info for test.billy_bulky.unique_customers_email.e77c92eb54 (compile): 12:05:43.236394 => 12:05:43.259035
[0m12:05:43.259461 [debug] [Thread-5  ]: Timing info for test.billy_bulky.unique_customers_customer_id.c5af1ff4b1 (compile): 12:05:43.234124 => 12:05:43.259330
[0m12:05:43.259764 [debug] [Thread-3  ]: Timing info for test.billy_bulky.not_null_products_name.d755fc2381 (compile): 12:05:43.244468 => 12:05:43.259628
[0m12:05:43.260033 [debug] [Thread-2  ]: Timing info for test.billy_bulky.accepted_values_products_category__books__electronics__home__toys__garden__clothing.e85e5b5f7b (compile): 12:05:43.238901 => 12:05:43.259898
[0m12:05:43.260371 [debug] [Thread-1  ]: Began executing node test.billy_bulky.not_null_customers_email.da3cfcd534
[0m12:05:43.260649 [debug] [Thread-10 ]: Began executing node test.billy_bulky.not_null_customers_join_date.faf8f07bc9
[0m12:05:43.260903 [debug] [Thread-6  ]: Timing info for test.billy_bulky.not_null_products_product_id.33741cf88e (compile): 12:05:43.251064 => 12:05:43.260781
[0m12:05:43.261146 [debug] [Thread-8  ]: Timing info for test.billy_bulky.not_null_products_stock_level.ee79d71f38 (compile): 12:05:43.253542 => 12:05:43.261029
[0m12:05:43.261381 [debug] [Thread-7  ]: Timing info for test.billy_bulky.not_null_products_price.3b5b0a69be (compile): 12:05:43.248577 => 12:05:43.261265
[0m12:05:43.261639 [debug] [Thread-4  ]: Began executing node test.billy_bulky.unique_customers_email.e77c92eb54
[0m12:05:43.261877 [debug] [Thread-5  ]: Began executing node test.billy_bulky.unique_customers_customer_id.c5af1ff4b1
[0m12:05:43.262107 [debug] [Thread-3  ]: Began executing node test.billy_bulky.not_null_products_name.d755fc2381
[0m12:05:43.262371 [debug] [Thread-9  ]: Timing info for test.billy_bulky.unique_products_product_id.68edffb83d (compile): 12:05:43.256559 => 12:05:43.262250
[0m12:05:43.262588 [debug] [Thread-2  ]: Began executing node test.billy_bulky.accepted_values_products_category__books__electronics__home__toys__garden__clothing.e85e5b5f7b
[0m12:05:43.262870 [debug] [Thread-1  ]: Timing info for test.billy_bulky.not_null_customers_email.da3cfcd534 (execute): 12:05:43.262735 => 12:05:43.262741
[0m12:05:43.263128 [debug] [Thread-10 ]: Timing info for test.billy_bulky.not_null_customers_join_date.faf8f07bc9 (execute): 12:05:43.263009 => 12:05:43.263013
[0m12:05:43.263349 [debug] [Thread-6  ]: Began executing node test.billy_bulky.not_null_products_product_id.33741cf88e
[0m12:05:43.263567 [debug] [Thread-8  ]: Began executing node test.billy_bulky.not_null_products_stock_level.ee79d71f38
[0m12:05:43.263778 [debug] [Thread-7  ]: Began executing node test.billy_bulky.not_null_products_price.3b5b0a69be
[0m12:05:43.264033 [debug] [Thread-4  ]: Timing info for test.billy_bulky.unique_customers_email.e77c92eb54 (execute): 12:05:43.263915 => 12:05:43.263918
[0m12:05:43.264286 [debug] [Thread-5  ]: Timing info for test.billy_bulky.unique_customers_customer_id.c5af1ff4b1 (execute): 12:05:43.264168 => 12:05:43.264171
[0m12:05:43.264532 [debug] [Thread-3  ]: Timing info for test.billy_bulky.not_null_products_name.d755fc2381 (execute): 12:05:43.264420 => 12:05:43.264423
[0m12:05:43.264744 [debug] [Thread-9  ]: Began executing node test.billy_bulky.unique_products_product_id.68edffb83d
[0m12:05:43.264999 [debug] [Thread-2  ]: Timing info for test.billy_bulky.accepted_values_products_category__books__electronics__home__toys__garden__clothing.e85e5b5f7b (execute): 12:05:43.264881 => 12:05:43.264883
[0m12:05:43.265542 [debug] [Thread-1  ]: Finished running node test.billy_bulky.not_null_customers_email.da3cfcd534
[0m12:05:43.266039 [debug] [Thread-10 ]: Finished running node test.billy_bulky.not_null_customers_join_date.faf8f07bc9
[0m12:05:43.266294 [debug] [Thread-6  ]: Timing info for test.billy_bulky.not_null_products_product_id.33741cf88e (execute): 12:05:43.266172 => 12:05:43.266175
[0m12:05:43.266558 [debug] [Thread-8  ]: Timing info for test.billy_bulky.not_null_products_stock_level.ee79d71f38 (execute): 12:05:43.266436 => 12:05:43.266439
[0m12:05:43.266803 [debug] [Thread-7  ]: Timing info for test.billy_bulky.not_null_products_price.3b5b0a69be (execute): 12:05:43.266691 => 12:05:43.266694
[0m12:05:43.267303 [debug] [Thread-4  ]: Finished running node test.billy_bulky.unique_customers_email.e77c92eb54
[0m12:05:43.267802 [debug] [Thread-5  ]: Finished running node test.billy_bulky.unique_customers_customer_id.c5af1ff4b1
[0m12:05:43.268303 [debug] [Thread-3  ]: Finished running node test.billy_bulky.not_null_products_name.d755fc2381
[0m12:05:43.268558 [debug] [Thread-9  ]: Timing info for test.billy_bulky.unique_products_product_id.68edffb83d (execute): 12:05:43.268436 => 12:05:43.268439
[0m12:05:43.269218 [debug] [Thread-2  ]: Finished running node test.billy_bulky.accepted_values_products_category__books__electronics__home__toys__garden__clothing.e85e5b5f7b
[0m12:05:43.269828 [debug] [Thread-6  ]: Finished running node test.billy_bulky.not_null_products_product_id.33741cf88e
[0m12:05:43.270327 [debug] [Thread-8  ]: Finished running node test.billy_bulky.not_null_products_stock_level.ee79d71f38
[0m12:05:43.270816 [debug] [Thread-7  ]: Finished running node test.billy_bulky.not_null_products_price.3b5b0a69be
[0m12:05:43.271437 [debug] [Thread-9  ]: Finished running node test.billy_bulky.unique_products_product_id.68edffb83d
[0m12:05:43.272169 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:05:43.272356 [debug] [MainThread]: Connection 'test.billy_bulky.not_null_customers_email.da3cfcd534' was properly closed.
[0m12:05:43.272525 [debug] [MainThread]: Connection 'test.billy_bulky.accepted_values_products_category__books__electronics__home__toys__garden__clothing.e85e5b5f7b' was properly closed.
[0m12:05:43.272687 [debug] [MainThread]: Connection 'test.billy_bulky.not_null_products_name.d755fc2381' was properly closed.
[0m12:05:43.272845 [debug] [MainThread]: Connection 'test.billy_bulky.unique_customers_email.e77c92eb54' was properly closed.
[0m12:05:43.273004 [debug] [MainThread]: Connection 'test.billy_bulky.not_null_products_product_id.33741cf88e' was properly closed.
[0m12:05:43.273163 [debug] [MainThread]: Connection 'test.billy_bulky.not_null_products_price.3b5b0a69be' was properly closed.
[0m12:05:43.273322 [debug] [MainThread]: Connection 'test.billy_bulky.not_null_products_stock_level.ee79d71f38' was properly closed.
[0m12:05:43.273483 [debug] [MainThread]: Connection 'test.billy_bulky.not_null_customers_join_date.faf8f07bc9' was properly closed.
[0m12:05:43.273649 [debug] [MainThread]: Connection 'test.billy_bulky.unique_customers_customer_id.c5af1ff4b1' was properly closed.
[0m12:05:43.273813 [debug] [MainThread]: Connection 'test.billy_bulky.unique_products_product_id.68edffb83d' was properly closed.
[0m12:05:43.277342 [debug] [MainThread]: Command end result
[0m12:05:43.288396 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 7.819821, "process_user_time": 4.502105, "process_kernel_time": 0.413669, "process_mem_max_rss": "218759168", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:05:43.288773 [debug] [MainThread]: Command `dbt compile` succeeded at 12:05:43.288699 after 7.82 seconds
[0m12:05:43.289002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b9d250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ade87c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12af15790>]}
[0m12:05:43.289233 [debug] [MainThread]: Flushing usage events
[0m12:07:03.571406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1032110d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a60af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a7dee0>]}


============================== 12:07:03.574208 | 35d1fbc6-8b73-4bf7-b8b9-3e7bda50ca76 ==============================
[0m12:07:03.574208 [info ] [MainThread]: Running with dbt=1.7.1
[0m12:07:03.574576 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/bitlevi/.dbt', 'log_path': '/Users/bitlevi/Documents/billy_bulky_ecommerce/billy_bulky_ecommerce/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:07:04.388060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '35d1fbc6-8b73-4bf7-b8b9-3e7bda50ca76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f2abe20>]}
[0m12:07:04.435781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '35d1fbc6-8b73-4bf7-b8b9-3e7bda50ca76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f425700>]}
[0m12:07:04.436265 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m12:07:04.448894 [debug] [MainThread]: checksum: ad428e6dc3b353dcb23d0c4ebea8b20b180e94b873271ac2a054a8e446dac0e2, vars: {}, profile: , target: , version: 1.7.1
[0m12:07:04.483157 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m12:07:04.483673 [debug] [MainThread]: Partial parsing: added file: billy_bulky://models/staging/shopify/staging__shopify__products_history.sql
[0m12:07:04.565523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '35d1fbc6-8b73-4bf7-b8b9-3e7bda50ca76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fd690d0>]}
[0m12:07:04.576023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '35d1fbc6-8b73-4bf7-b8b9-3e7bda50ca76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fbcfe20>]}
[0m12:07:04.576354 [info ] [MainThread]: Found 10 models, 47 tests, 1 snapshot, 4 sources, 0 exposures, 0 metrics, 431 macros, 0 groups, 0 semantic models
[0m12:07:04.576589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '35d1fbc6-8b73-4bf7-b8b9-3e7bda50ca76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f4f03d0>]}
[0m12:07:04.578091 [info ] [MainThread]: 
[0m12:07:04.578626 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:07:04.579559 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE'
[0m12:07:04.580094 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE'
[0m12:07:04.636809 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE"
[0m12:07:04.637079 [debug] [ThreadPool]: On list_E_COMMERCE: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE"} */
show terse schemas in database E_COMMERCE
    limit 10000
[0m12:07:04.637269 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:07:04.638830 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE"
[0m12:07:04.639057 [debug] [ThreadPool]: On list_E_COMMERCE: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE"} */
show terse schemas in database E_COMMERCE
    limit 10000
[0m12:07:04.639243 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:07:06.103938 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m12:07:06.107204 [debug] [ThreadPool]: On list_E_COMMERCE: Close
[0m12:07:06.120363 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m12:07:06.122752 [debug] [ThreadPool]: On list_E_COMMERCE: Close
[0m12:07:06.474650 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_E_COMMERCE, now list_E_COMMERCE_staging)
[0m12:07:06.475713 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_E_COMMERCE, now list_E_COMMERCE_snapshots)
[0m12:07:06.477711 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_marts'
[0m12:07:06.488875 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_staging"
[0m12:07:06.491465 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_snapshots"
[0m12:07:06.493914 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_marts"
[0m12:07:06.494300 [debug] [ThreadPool]: On list_E_COMMERCE_staging: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE_staging"} */
show terse objects in E_COMMERCE.staging limit 10000
[0m12:07:06.494627 [debug] [ThreadPool]: On list_E_COMMERCE_snapshots: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE_snapshots"} */
show terse objects in E_COMMERCE.snapshots limit 10000
[0m12:07:06.494940 [debug] [ThreadPool]: On list_E_COMMERCE_marts: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE_marts"} */
show terse objects in E_COMMERCE.marts limit 10000
[0m12:07:06.495242 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:07:06.495556 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:07:06.495831 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:07:07.735053 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:07:07.741986 [debug] [ThreadPool]: On list_E_COMMERCE_snapshots: Close
[0m12:07:07.746992 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m12:07:07.749035 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m12:07:07.751696 [debug] [ThreadPool]: On list_E_COMMERCE_staging: Close
[0m12:07:07.754915 [debug] [ThreadPool]: On list_E_COMMERCE_marts: Close
[0m12:07:08.229844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '35d1fbc6-8b73-4bf7-b8b9-3e7bda50ca76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fc031c0>]}
[0m12:07:08.231254 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m12:07:08.231898 [info ] [MainThread]: 
[0m12:07:08.236368 [debug] [Thread-1  ]: Began running node model.billy_bulky.staging__shopify__products_history
[0m12:07:08.237239 [debug] [Thread-2  ]: Began running node model.billy_bulky.staging_shopify__customers
[0m12:07:08.237906 [debug] [Thread-3  ]: Began running node model.billy_bulky.staging_shopify__orders
[0m12:07:08.238609 [info ] [Thread-1  ]: 1 of 7 START sql view model staging.staging__shopify__products_history ......... [RUN]
[0m12:07:08.240652 [debug] [Thread-4  ]: Began running node model.billy_bulky.staging_shopify__products
[0m12:07:08.239336 [info ] [Thread-2  ]: 2 of 7 START sql view model staging.staging_shopify__customers ................. [RUN]
[0m12:07:08.241566 [info ] [Thread-3  ]: 3 of 7 START sql view model staging.staging_shopify__orders .................... [RUN]
[0m12:07:08.243096 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_E_COMMERCE_staging, now model.billy_bulky.staging__shopify__products_history)
[0m12:07:08.243904 [info ] [Thread-4  ]: 4 of 7 START sql view model staging.staging_shopify__products .................. [RUN]
[0m12:07:08.244929 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_E_COMMERCE_snapshots, now model.billy_bulky.staging_shopify__customers)
[0m12:07:08.245912 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly list_E_COMMERCE_marts, now model.billy_bulky.staging_shopify__orders)
[0m12:07:08.246552 [debug] [Thread-1  ]: Began compiling node model.billy_bulky.staging__shopify__products_history
[0m12:07:08.247570 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.billy_bulky.staging_shopify__products'
[0m12:07:08.248041 [debug] [Thread-2  ]: Began compiling node model.billy_bulky.staging_shopify__customers
[0m12:07:08.248496 [debug] [Thread-3  ]: Began compiling node model.billy_bulky.staging_shopify__orders
[0m12:07:08.258528 [debug] [Thread-1  ]: Writing injected SQL for node "model.billy_bulky.staging__shopify__products_history"
[0m12:07:08.259042 [debug] [Thread-4  ]: Began compiling node model.billy_bulky.staging_shopify__products
[0m12:07:08.263525 [debug] [Thread-2  ]: Writing injected SQL for node "model.billy_bulky.staging_shopify__customers"
[0m12:07:08.266849 [debug] [Thread-3  ]: Writing injected SQL for node "model.billy_bulky.staging_shopify__orders"
[0m12:07:08.270116 [debug] [Thread-4  ]: Writing injected SQL for node "model.billy_bulky.staging_shopify__products"
[0m12:07:08.270780 [debug] [Thread-1  ]: Timing info for model.billy_bulky.staging__shopify__products_history (compile): 12:07:08.248787 => 12:07:08.270539
[0m12:07:08.271300 [debug] [Thread-1  ]: Began executing node model.billy_bulky.staging__shopify__products_history
[0m12:07:08.290715 [debug] [Thread-2  ]: Timing info for model.billy_bulky.staging_shopify__customers (compile): 12:07:08.259321 => 12:07:08.290469
[0m12:07:08.291146 [debug] [Thread-3  ]: Timing info for model.billy_bulky.staging_shopify__orders (compile): 12:07:08.263908 => 12:07:08.290940
[0m12:07:08.295609 [debug] [Thread-1  ]: Writing runtime sql for node "model.billy_bulky.staging__shopify__products_history"
[0m12:07:08.295953 [debug] [Thread-2  ]: Began executing node model.billy_bulky.staging_shopify__customers
[0m12:07:08.296305 [debug] [Thread-3  ]: Began executing node model.billy_bulky.staging_shopify__orders
[0m12:07:08.296686 [debug] [Thread-4  ]: Timing info for model.billy_bulky.staging_shopify__products (compile): 12:07:08.267276 => 12:07:08.296510
[0m12:07:08.299219 [debug] [Thread-2  ]: Writing runtime sql for node "model.billy_bulky.staging_shopify__customers"
[0m12:07:08.301536 [debug] [Thread-3  ]: Writing runtime sql for node "model.billy_bulky.staging_shopify__orders"
[0m12:07:08.301816 [debug] [Thread-4  ]: Began executing node model.billy_bulky.staging_shopify__products
[0m12:07:08.302391 [debug] [Thread-1  ]: Using snowflake connection "model.billy_bulky.staging__shopify__products_history"
[0m12:07:08.305293 [debug] [Thread-4  ]: Writing runtime sql for node "model.billy_bulky.staging_shopify__products"
[0m12:07:08.305638 [debug] [Thread-1  ]: On model.billy_bulky.staging__shopify__products_history: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.staging__shopify__products_history"} */
create or replace   view E_COMMERCE.staging.staging__shopify__products_history
  
   as (
    WITH products AS (
    SELECT * FROM E_COMMERCE.SNAPSHOT.products_snapshot
)

SELECT
    PRODUCT_ID
    , NAME
    , CATEGORY
    , PRICE
    , STOCK_LEVEL
    , DBT_SCD_ID
    , DBT_UPDATED_AT
    , DBT_VALID_FROM
    , DBT_VALID_TO
FROM products
  );
[0m12:07:08.306217 [debug] [Thread-2  ]: Using snowflake connection "model.billy_bulky.staging_shopify__customers"
[0m12:07:08.306680 [debug] [Thread-3  ]: Using snowflake connection "model.billy_bulky.staging_shopify__orders"
[0m12:07:08.306931 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:07:08.307219 [debug] [Thread-2  ]: On model.billy_bulky.staging_shopify__customers: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.staging_shopify__customers"} */
create or replace   view E_COMMERCE.staging.staging_shopify__customers
  
   as (
    WITH customers AS (
    SELECT * FROM SHOPIFY.PUBLIC.customers
)

SELECT
    CUSTOMER_ID
    , FIRST_NAME
    , LAST_NAME
    , EMAIL
    , JOIN_DATE
    , COUNTRY
FROM customers
  );
[0m12:07:08.307516 [debug] [Thread-3  ]: On model.billy_bulky.staging_shopify__orders: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.staging_shopify__orders"} */
create or replace   view E_COMMERCE.staging.staging_shopify__orders
  
   as (
    WITH orders AS (
    SELECT * FROM SHOPIFY.PUBLIC.orders
)

SELECT
    ORDER_ID
    , CUSTOMER_ID
    , PRODUCT_ID
    , QUANTITY
    , ORDER_DATE
    , STATUS
FROM orders
  );
[0m12:07:08.308004 [debug] [Thread-4  ]: Using snowflake connection "model.billy_bulky.staging_shopify__products"
[0m12:07:08.308450 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m12:07:08.308956 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m12:07:08.309216 [debug] [Thread-4  ]: On model.billy_bulky.staging_shopify__products: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.staging_shopify__products"} */
create or replace   view E_COMMERCE.staging.staging_shopify__products
  
   as (
    WITH products AS (
    SELECT * FROM SHOPIFY.PUBLIC.products
)

SELECT
    PRODUCT_ID
    , NAME
    , CATEGORY
    , PRICE
    , STOCK_LEVEL
FROM products
  );
[0m12:07:08.310420 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m12:07:09.651943 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:07:09.688480 [debug] [Thread-2  ]: Timing info for model.billy_bulky.staging_shopify__customers (execute): 12:07:08.296919 => 12:07:09.688160
[0m12:07:09.689110 [debug] [Thread-2  ]: On model.billy_bulky.staging_shopify__customers: Close
[0m12:07:09.770026 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01b079da-0001-82f5-0004-d8be00019052
[0m12:07:09.770405 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Schema 'E_COMMERCE.SNAPSHOT' does not exist or not authorized.
[0m12:07:09.770839 [debug] [Thread-1  ]: Timing info for model.billy_bulky.staging__shopify__products_history (execute): 12:07:08.271547 => 12:07:09.770668
[0m12:07:09.771149 [debug] [Thread-1  ]: On model.billy_bulky.staging__shopify__products_history: Close
[0m12:07:10.191202 [debug] [Thread-1  ]: Database Error in model staging__shopify__products_history (models/staging/shopify/staging__shopify__products_history.sql)
  002003 (02000): SQL compilation error:
  Schema 'E_COMMERCE.SNAPSHOT' does not exist or not authorized.
  compiled Code at target/run/billy_bulky/models/staging/shopify/staging__shopify__products_history.sql
[0m12:07:10.191960 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35d1fbc6-8b73-4bf7-b8b9-3e7bda50ca76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128825a60>]}
[0m12:07:10.192777 [error] [Thread-1  ]: 1 of 7 ERROR creating sql view model staging.staging__shopify__products_history  [[31mERROR[0m in 1.95s]
[0m12:07:10.193548 [debug] [Thread-1  ]: Finished running node model.billy_bulky.staging__shopify__products_history
[0m12:07:10.248050 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m12:07:10.251335 [debug] [Thread-4  ]: Timing info for model.billy_bulky.staging_shopify__products (execute): 12:07:08.302656 => 12:07:10.251057
[0m12:07:10.251863 [debug] [Thread-4  ]: On model.billy_bulky.staging_shopify__products: Close
[0m12:07:10.258447 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m12:07:10.261398 [debug] [Thread-3  ]: Timing info for model.billy_bulky.staging_shopify__orders (execute): 12:07:08.299447 => 12:07:10.261129
[0m12:07:10.261898 [debug] [Thread-3  ]: On model.billy_bulky.staging_shopify__orders: Close
[0m12:07:10.604992 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35d1fbc6-8b73-4bf7-b8b9-3e7bda50ca76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fc031c0>]}
[0m12:07:10.606161 [info ] [Thread-2  ]: 2 of 7 OK created sql view model staging.staging_shopify__customers ............ [[32mSUCCESS 1[0m in 2.36s]
[0m12:07:10.607065 [debug] [Thread-2  ]: Finished running node model.billy_bulky.staging_shopify__customers
[0m12:07:10.736244 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35d1fbc6-8b73-4bf7-b8b9-3e7bda50ca76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fbe7850>]}
[0m12:07:10.737529 [info ] [Thread-3  ]: 3 of 7 OK created sql view model staging.staging_shopify__orders ............... [[32mSUCCESS 1[0m in 2.49s]
[0m12:07:10.738554 [debug] [Thread-3  ]: Finished running node model.billy_bulky.staging_shopify__orders
[0m12:07:10.760424 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35d1fbc6-8b73-4bf7-b8b9-3e7bda50ca76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f47b700>]}
[0m12:07:10.761297 [info ] [Thread-4  ]: 4 of 7 OK created sql view model staging.staging_shopify__products ............. [[32mSUCCESS 1[0m in 2.51s]
[0m12:07:10.761960 [debug] [Thread-4  ]: Finished running node model.billy_bulky.staging_shopify__products
[0m12:07:10.762828 [debug] [Thread-6  ]: Began running node model.billy_bulky.int_customers_segmentation
[0m12:07:10.763388 [debug] [Thread-7  ]: Began running node model.billy_bulky.int_products_performance
[0m12:07:10.764295 [debug] [Thread-6  ]: Acquiring new snowflake connection 'model.billy_bulky.int_customers_segmentation'
[0m12:07:10.764725 [debug] [Thread-8  ]: Began running node model.billy_bulky.int_sales_trend
[0m12:07:10.765463 [debug] [Thread-7  ]: Acquiring new snowflake connection 'model.billy_bulky.int_products_performance'
[0m12:07:10.765849 [debug] [Thread-6  ]: Began compiling node model.billy_bulky.int_customers_segmentation
[0m12:07:10.766522 [debug] [Thread-8  ]: Acquiring new snowflake connection 'model.billy_bulky.int_sales_trend'
[0m12:07:10.766888 [debug] [Thread-7  ]: Began compiling node model.billy_bulky.int_products_performance
[0m12:07:10.771217 [debug] [Thread-6  ]: Writing injected SQL for node "model.billy_bulky.int_customers_segmentation"
[0m12:07:10.771685 [debug] [Thread-8  ]: Began compiling node model.billy_bulky.int_sales_trend
[0m12:07:10.775935 [debug] [Thread-7  ]: Writing injected SQL for node "model.billy_bulky.int_products_performance"
[0m12:07:10.779638 [debug] [Thread-8  ]: Writing injected SQL for node "model.billy_bulky.int_sales_trend"
[0m12:07:10.780463 [debug] [Thread-6  ]: Timing info for model.billy_bulky.int_customers_segmentation (compile): 12:07:10.767130 => 12:07:10.780253
[0m12:07:10.780905 [debug] [Thread-7  ]: Timing info for model.billy_bulky.int_products_performance (compile): 12:07:10.771922 => 12:07:10.780681
[0m12:07:10.781698 [debug] [Thread-6  ]: Finished running node model.billy_bulky.int_customers_segmentation
[0m12:07:10.782399 [debug] [Thread-7  ]: Finished running node model.billy_bulky.int_products_performance
[0m12:07:10.782751 [debug] [Thread-8  ]: Timing info for model.billy_bulky.int_sales_trend (compile): 12:07:10.776228 => 12:07:10.782586
[0m12:07:10.783663 [debug] [Thread-8  ]: Finished running node model.billy_bulky.int_sales_trend
[0m12:07:10.783995 [debug] [Thread-10 ]: Began running node model.billy_bulky.customers
[0m12:07:10.784417 [debug] [Thread-1  ]: Began running node model.billy_bulky.products
[0m12:07:10.784764 [info ] [Thread-10 ]: 5 of 7 START sql table model marts.customers ................................... [RUN]
[0m12:07:10.785127 [debug] [Thread-3  ]: Began running node model.billy_bulky.sales
[0m12:07:10.785460 [info ] [Thread-1  ]: 6 of 7 START sql table model marts.products .................................... [RUN]
[0m12:07:10.786042 [debug] [Thread-10 ]: Acquiring new snowflake connection 'model.billy_bulky.customers'
[0m12:07:10.786372 [info ] [Thread-3  ]: 7 of 7 START sql table model marts.sales ....................................... [RUN]
[0m12:07:10.786927 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.billy_bulky.staging__shopify__products_history, now model.billy_bulky.products)
[0m12:07:10.787250 [debug] [Thread-10 ]: Began compiling node model.billy_bulky.customers
[0m12:07:10.788095 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.billy_bulky.staging_shopify__orders, now model.billy_bulky.sales)
[0m12:07:10.788399 [debug] [Thread-1  ]: Began compiling node model.billy_bulky.products
[0m12:07:10.796371 [debug] [Thread-10 ]: Writing injected SQL for node "model.billy_bulky.customers"
[0m12:07:10.796746 [debug] [Thread-3  ]: Began compiling node model.billy_bulky.sales
[0m12:07:10.801292 [debug] [Thread-1  ]: Writing injected SQL for node "model.billy_bulky.products"
[0m12:07:10.810156 [debug] [Thread-3  ]: Writing injected SQL for node "model.billy_bulky.sales"
[0m12:07:10.810722 [debug] [Thread-1  ]: Timing info for model.billy_bulky.products (compile): 12:07:10.796927 => 12:07:10.810557
[0m12:07:10.811026 [debug] [Thread-10 ]: Timing info for model.billy_bulky.customers (compile): 12:07:10.788591 => 12:07:10.810891
[0m12:07:10.811262 [debug] [Thread-1  ]: Began executing node model.billy_bulky.products
[0m12:07:10.811522 [debug] [Thread-3  ]: Timing info for model.billy_bulky.sales (compile): 12:07:10.801546 => 12:07:10.811394
[0m12:07:10.811749 [debug] [Thread-10 ]: Began executing node model.billy_bulky.customers
[0m12:07:10.824287 [debug] [Thread-3  ]: Began executing node model.billy_bulky.sales
[0m12:07:10.825809 [debug] [Thread-1  ]: Writing runtime sql for node "model.billy_bulky.products"
[0m12:07:10.828818 [debug] [Thread-10 ]: Writing runtime sql for node "model.billy_bulky.customers"
[0m12:07:10.830571 [debug] [Thread-3  ]: Writing runtime sql for node "model.billy_bulky.sales"
[0m12:07:10.832814 [debug] [Thread-10 ]: Using snowflake connection "model.billy_bulky.customers"
[0m12:07:10.833153 [debug] [Thread-10 ]: On model.billy_bulky.customers: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.customers"} */
create or replace transient table E_COMMERCE.marts.customers
         as
        (WITH  __dbt__cte__int_customers_segmentation as (
WITH customers AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__customers
)

, orders AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__orders
)

, products AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__products
)

, order_aggregates AS (
    SELECT
        o.CUSTOMER_ID
        , COUNT(DISTINCT o.ORDER_ID) AS frequency
        , SUM(o.QUANTITY * p.PRICE) AS monetary
        , AVG(o.QUANTITY * p.PRICE) AS average_order_value
        , MAX(o.ORDER_DATE) AS last_purchase_date
        , COUNT(CASE WHEN o.STATUS = 'cancelled' THEN 1 END) AS cancelled_orders
        , COUNT(*) AS total_orders
    FROM orders o
    JOIN products p ON o.PRODUCT_ID = p.PRODUCT_ID
    GROUP BY o.CUSTOMER_ID
)

, customer_tenure AS (
    SELECT
        CUSTOMER_ID
        , JOIN_DATE
        , CURRENT_DATE - JOIN_DATE AS tenure
    FROM customers
)

, customer_recency AS (
    SELECT
        CUSTOMER_ID
        , CURRENT_DATE - last_purchase_date AS recency
    FROM order_aggregates
)

, final AS (
    SELECT
        c.CUSTOMER_ID
        , c.FIRST_NAME
        , c.LAST_NAME
        , c.EMAIL
        , c.JOIN_DATE
        , c.COUNTRY
        , o.frequency
        , o.monetary
        , o.average_order_value
        , o.cancelled_orders
        , o.total_orders
        , CASE 
            WHEN o.total_orders > 0 THEN ROUND((o.cancelled_orders::FLOAT / o.total_orders) * 100, 2) 
            ELSE 0 
          END AS cancellation_rate
        , r.recency
        , t.tenure
    FROM customer_tenure t
    JOIN customers c ON t.CUSTOMER_ID = c.CUSTOMER_ID
    JOIN order_aggregates o ON c.CUSTOMER_ID = o.CUSTOMER_ID
    JOIN customer_recency r ON c.CUSTOMER_ID = r.CUSTOMER_ID
)

SELECT * FROM final
), source AS (
    SELECT
        icp.CUSTOMER_ID
        , icp.FIRST_NAME
        , icp.LAST_NAME
        , icp.EMAIL
        , icp.JOIN_DATE
        , icp.COUNTRY
        , icp.frequency AS total_orders
        , icp.monetary AS total_spent
        , icp.recency
        , icp.tenure
    FROM __dbt__cte__int_customers_segmentation icp
)

, final AS (
SELECT
    s.CUSTOMER_ID
    , s.FIRST_NAME
    , s.LAST_NAME
    , s.EMAIL
    , s.JOIN_DATE
    , s.COUNTRY
    , s.total_orders
    , s.total_spent
    , s.recency
    , s.tenure
    , CASE 
        WHEN s.total_spent > 1000 THEN 'VIP' 
        ELSE 'Regular' 
      END AS customer_segment 
FROM source s
)

SELECT * FROM final
        );
[0m12:07:10.834691 [debug] [Thread-1  ]: Using snowflake connection "model.billy_bulky.products"
[0m12:07:10.834910 [debug] [Thread-10 ]: Opening a new connection, currently in state init
[0m12:07:10.837039 [debug] [Thread-3  ]: Using snowflake connection "model.billy_bulky.sales"
[0m12:07:10.837376 [debug] [Thread-1  ]: On model.billy_bulky.products: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.products"} */
create or replace transient table E_COMMERCE.marts.products
         as
        (WITH  __dbt__cte__int_products_performance as (
WITH orders AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__orders
)

, products AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__products
)

, product_sales AS (
    SELECT
        o.PRODUCT_ID
        , COUNT(DISTINCT o.ORDER_ID) AS total_sales
        , SUM(o.QUANTITY) AS total_units_sold
        , SUM(o.QUANTITY * p.PRICE) AS total_sales_value
    FROM orders o
    INNER JOIN products p ON o.PRODUCT_ID = p.PRODUCT_ID
    WHERE o.STATUS NOT IN ('cancelled') 
    GROUP BY o.PRODUCT_ID
)

, product_averages AS (
    SELECT
        PRODUCT_ID
        , (total_sales_value / NULLIF(total_units_sold, 0)) AS average_sale_price
    FROM product_sales
)

, product_stock_turnover AS (
    SELECT
        p.PRODUCT_ID
        , p.STOCK_LEVEL
        , (total_units_sold / NULLIF(p.STOCK_LEVEL, 0)) AS turnover_rate
    FROM product_sales ps
    INNER JOIN products p ON ps.PRODUCT_ID = p.PRODUCT_ID
)

, final AS (
    SELECT
    p.PRODUCT_ID
    , p.NAME
    , p.CATEGORY
    , p.PRICE
    , pa.average_sale_price
    , ps.total_sales
    , ps.total_units_sold
    , ps.total_sales_value
    , pst.turnover_rate
    , p.STOCK_LEVEL
FROM products p
LEFT JOIN product_sales ps ON p.PRODUCT_ID = ps.PRODUCT_ID
LEFT JOIN product_averages pa ON p.PRODUCT_ID = pa.PRODUCT_ID
LEFT JOIN product_stock_turnover pst ON p.PRODUCT_ID = pst.PRODUCT_ID
)

SELECT * FROM final
), final AS (
    SELECT
        pp.PRODUCT_ID
        , pp.NAME
        , pp.CATEGORY
        , pp.PRICE
        , pp.average_sale_price
        , pp.total_sales
        , pp.total_units_sold
        , pp.total_sales_value
        , pp.turnover_rate
        , pp.STOCK_LEVEL
    FROM __dbt__cte__int_products_performance pp
)

SELECT * FROM final
        );
[0m12:07:10.838192 [debug] [Thread-3  ]: On model.billy_bulky.sales: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.sales"} */
create or replace transient table E_COMMERCE.marts.sales
         as
        (WITH  __dbt__cte__int_sales_trend as (
WITH orders AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__orders
)

, products AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__products
)

, daily_sales AS (
    SELECT
        DATE(ORDER_DATE) AS sale_date
        , COUNT(DISTINCT ORDER_ID) AS total_orders
        , SUM(QUANTITY) AS total_units_sold
        , SUM(QUANTITY * PRICE) AS total_sales_value
    FROM orders AS o
    JOIN products AS p ON o.PRODUCT_ID = p.PRODUCT_ID
    WHERE o.STATUS NOT IN ('cancelled') 
    GROUP BY sale_date
)

, weekly_sales AS (
    SELECT
        DATE_TRUNC('week', sale_date) AS sale_week
        , SUM(total_orders) AS weekly_orders
        , SUM(total_units_sold) AS weekly_units_sold
        , SUM(total_sales_value) AS weekly_sales_value
    FROM daily_sales
    GROUP BY sale_week
)

, monthly_sales AS (
    SELECT
        DATE_TRUNC('month', sale_date) AS sale_month
        , SUM(total_orders) AS monthly_orders
        , SUM(total_units_sold) AS monthly_units_sold
        , SUM(total_sales_value) AS monthly_sales_value
    FROM daily_sales
    GROUP BY sale_month
)

, yearly_sales AS (
    SELECT
        DATE_TRUNC('year', sale_date) AS sale_year
        , SUM(total_orders) AS yearly_orders
        , SUM(total_units_sold) AS yearly_units_sold
        , SUM(total_sales_value) AS yearly_sales_value
    FROM daily_sales
    GROUP BY sale_year
)

SELECT
    d.sale_date
    , d.total_orders AS daily_orders
    , d.total_units_sold AS daily_units_sold
    , d.total_sales_value AS daily_sales_value
    , w.weekly_orders
    , w.weekly_units_sold
    , w.weekly_sales_value
    , m.monthly_orders
    , m.monthly_units_sold
    , m.monthly_sales_value
    , y.yearly_orders
    , y.yearly_units_sold
    , y.yearly_sales_value
FROM daily_sales d
LEFT JOIN weekly_sales w ON DATE_TRUNC('week', d.sale_date) = w.sale_week
LEFT JOIN monthly_sales m ON DATE_TRUNC('month', d.sale_date) = m.sale_month
LEFT JOIN yearly_sales y ON DATE_TRUNC('year', d.sale_date) = y.sale_year
), enriched_orders AS (
    SELECT
        o.ORDER_ID
        , o.CUSTOMER_ID
        , o.PRODUCT_ID
        , o.QUANTITY
        , o.ORDER_DATE
        , o.STATUS
        , p.CATEGORY
        , p.PRICE AS unit_price
        , (o.QUANTITY * p.PRICE) AS total_price
        , c.COUNTRY
    FROM E_COMMERCE.staging.staging_shopify__orders o
    JOIN E_COMMERCE.staging.staging_shopify__products p ON o.PRODUCT_ID = p.PRODUCT_ID
    JOIN E_COMMERCE.staging.staging_shopify__customers c ON o.CUSTOMER_ID = c.CUSTOMER_ID
    WHERE o.STATUS NOT IN ('cancelled') 
)

SELECT
    eo.ORDER_ID
    , eo.CUSTOMER_ID
    , eo.PRODUCT_ID
    , eo.QUANTITY
    , eo.ORDER_DATE
    , eo.STATUS
    , eo.CATEGORY
    , eo.unit_price
    , eo.total_price
    , eo.COUNTRY
    , sa.daily_orders
    , sa.daily_units_sold
    , sa.daily_sales_value
FROM enriched_orders eo
LEFT JOIN __dbt__cte__int_sales_trend sa ON DATE(eo.ORDER_DATE) = sa.sale_date
        );
[0m12:07:10.838585 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:07:10.839065 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m12:07:13.446960 [debug] [Thread-10 ]: SQL status: SUCCESS 1 in 3.0 seconds
[0m12:07:13.448831 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 3.0 seconds
[0m12:07:13.454564 [debug] [Thread-10 ]: Timing info for model.billy_bulky.customers (execute): 12:07:10.826066 => 12:07:13.454115
[0m12:07:13.458673 [debug] [Thread-3  ]: Timing info for model.billy_bulky.sales (execute): 12:07:10.829015 => 12:07:13.458286
[0m12:07:13.459425 [debug] [Thread-10 ]: On model.billy_bulky.customers: Close
[0m12:07:13.460093 [debug] [Thread-3  ]: On model.billy_bulky.sales: Close
[0m12:07:13.500822 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 3.0 seconds
[0m12:07:13.505932 [debug] [Thread-1  ]: Timing info for model.billy_bulky.products (execute): 12:07:10.811892 => 12:07:13.505457
[0m12:07:13.506846 [debug] [Thread-1  ]: On model.billy_bulky.products: Close
[0m12:07:13.838036 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35d1fbc6-8b73-4bf7-b8b9-3e7bda50ca76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1287abb50>]}
[0m12:07:13.839281 [info ] [Thread-10 ]: 5 of 7 OK created sql table model marts.customers .............................. [[32mSUCCESS 1[0m in 3.05s]
[0m12:07:13.840377 [debug] [Thread-10 ]: Finished running node model.billy_bulky.customers
[0m12:07:15.135131 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35d1fbc6-8b73-4bf7-b8b9-3e7bda50ca76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1289e8910>]}
[0m12:07:15.136784 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35d1fbc6-8b73-4bf7-b8b9-3e7bda50ca76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128c07280>]}
[0m12:07:15.137947 [info ] [Thread-3  ]: 7 of 7 OK created sql table model marts.sales .................................. [[32mSUCCESS 1[0m in 4.35s]
[0m12:07:15.139908 [debug] [Thread-3  ]: Finished running node model.billy_bulky.sales
[0m12:07:15.138844 [info ] [Thread-1  ]: 6 of 7 OK created sql table model marts.products ............................... [[32mSUCCESS 1[0m in 4.35s]
[0m12:07:15.141238 [debug] [Thread-1  ]: Finished running node model.billy_bulky.products
[0m12:07:15.144451 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:07:15.145167 [debug] [MainThread]: Connection 'model.billy_bulky.products' was properly closed.
[0m12:07:15.145678 [debug] [MainThread]: Connection 'model.billy_bulky.staging_shopify__customers' was properly closed.
[0m12:07:15.146090 [debug] [MainThread]: Connection 'model.billy_bulky.sales' was properly closed.
[0m12:07:15.146490 [debug] [MainThread]: Connection 'model.billy_bulky.staging_shopify__products' was properly closed.
[0m12:07:15.146888 [debug] [MainThread]: Connection 'model.billy_bulky.int_customers_segmentation' was properly closed.
[0m12:07:15.147285 [debug] [MainThread]: Connection 'model.billy_bulky.int_products_performance' was properly closed.
[0m12:07:15.147680 [debug] [MainThread]: Connection 'model.billy_bulky.int_sales_trend' was properly closed.
[0m12:07:15.148078 [debug] [MainThread]: Connection 'model.billy_bulky.customers' was properly closed.
[0m12:07:15.148632 [info ] [MainThread]: 
[0m12:07:15.149138 [info ] [MainThread]: Finished running 4 view models, 3 table models in 0 hours 0 minutes and 10.57 seconds (10.57s).
[0m12:07:15.151087 [debug] [MainThread]: Command end result
[0m12:07:15.170971 [info ] [MainThread]: 
[0m12:07:15.171472 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:07:15.171829 [info ] [MainThread]: 
[0m12:07:15.172186 [error] [MainThread]:   Database Error in model staging__shopify__products_history (models/staging/shopify/staging__shopify__products_history.sql)
  002003 (02000): SQL compilation error:
  Schema 'E_COMMERCE.SNAPSHOT' does not exist or not authorized.
  compiled Code at target/run/billy_bulky/models/staging/shopify/staging__shopify__products_history.sql
[0m12:07:15.172553 [info ] [MainThread]: 
[0m12:07:15.172926 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m12:07:15.175433 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 11.637083, "process_user_time": 5.256957, "process_kernel_time": 0.392621, "process_mem_max_rss": "222347264", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:07:15.176046 [debug] [MainThread]: Command `dbt run` failed at 12:07:15.175910 after 11.64 seconds
[0m12:07:15.176466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1032110d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fbed340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fc16b50>]}
[0m12:07:15.176903 [debug] [MainThread]: Flushing usage events
[0m12:07:38.901765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072dd6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a6787f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a678a90>]}


============================== 12:07:38.904522 | 40549615-4727-46dd-8579-9262b3a22532 ==============================
[0m12:07:38.904522 [info ] [MainThread]: Running with dbt=1.7.1
[0m12:07:38.904885 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/bitlevi/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/bitlevi/Documents/billy_bulky_ecommerce/billy_bulky_ecommerce/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m12:07:39.735945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '40549615-4727-46dd-8579-9262b3a22532', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dcf9d0>]}
[0m12:07:39.783444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '40549615-4727-46dd-8579-9262b3a22532', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b180280>]}
[0m12:07:39.784048 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m12:07:39.797319 [debug] [MainThread]: checksum: ad428e6dc3b353dcb23d0c4ebea8b20b180e94b873271ac2a054a8e446dac0e2, vars: {}, profile: , target: , version: 1.7.1
[0m12:07:39.833781 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:07:39.834413 [debug] [MainThread]: Partial parsing: updated file: billy_bulky://models/staging/shopify/_shopify__models.yml
[0m12:07:40.003411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '40549615-4727-46dd-8579-9262b3a22532', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1468c0fa0>]}
[0m12:07:40.015421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '40549615-4727-46dd-8579-9262b3a22532', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b70c970>]}
[0m12:07:40.015728 [info ] [MainThread]: Found 10 models, 47 tests, 1 snapshot, 4 sources, 0 exposures, 0 metrics, 431 macros, 0 groups, 0 semantic models
[0m12:07:40.015951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '40549615-4727-46dd-8579-9262b3a22532', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b70c9a0>]}
[0m12:07:40.017359 [info ] [MainThread]: 
[0m12:07:40.017829 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:07:40.018664 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE'
[0m12:07:40.027573 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE"
[0m12:07:40.028225 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE'
[0m12:07:40.028511 [debug] [ThreadPool]: On list_E_COMMERCE: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE"} */
show terse schemas in database E_COMMERCE
    limit 10000
[0m12:07:40.030029 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE"
[0m12:07:40.030246 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:07:40.030459 [debug] [ThreadPool]: On list_E_COMMERCE: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE"} */
show terse schemas in database E_COMMERCE
    limit 10000
[0m12:07:40.031225 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:07:41.410701 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m12:07:41.415947 [debug] [ThreadPool]: On list_E_COMMERCE: Close
[0m12:07:41.534528 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.0 seconds
[0m12:07:41.535968 [debug] [ThreadPool]: On list_E_COMMERCE: Close
[0m12:07:41.895944 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_E_COMMERCE, now list_E_COMMERCE_snapshots)
[0m12:07:41.898768 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_E_COMMERCE, now list_E_COMMERCE_marts)
[0m12:07:41.912599 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_staging'
[0m12:07:41.919096 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_marts"
[0m12:07:41.922072 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_snapshots"
[0m12:07:41.924900 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_staging"
[0m12:07:41.925371 [debug] [ThreadPool]: On list_E_COMMERCE_marts: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE_marts"} */
show terse objects in E_COMMERCE.marts limit 10000
[0m12:07:41.925922 [debug] [ThreadPool]: On list_E_COMMERCE_snapshots: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE_snapshots"} */
show terse objects in E_COMMERCE.snapshots limit 10000
[0m12:07:41.926304 [debug] [ThreadPool]: On list_E_COMMERCE_staging: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE_staging"} */
show terse objects in E_COMMERCE.staging limit 10000
[0m12:07:41.926652 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:07:41.926973 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:07:41.927282 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:07:43.052246 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m12:07:43.058728 [debug] [ThreadPool]: On list_E_COMMERCE_marts: Close
[0m12:07:43.062913 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m12:07:43.065228 [debug] [ThreadPool]: On list_E_COMMERCE_staging: Close
[0m12:07:43.097014 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:07:43.098937 [debug] [ThreadPool]: On list_E_COMMERCE_snapshots: Close
[0m12:07:43.494183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '40549615-4727-46dd-8579-9262b3a22532', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b1f5f10>]}
[0m12:07:43.496293 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m12:07:43.497272 [info ] [MainThread]: 
[0m12:07:43.502384 [debug] [Thread-1  ]: Began running node model.billy_bulky.staging__shopify__products_history
[0m12:07:43.503256 [debug] [Thread-2  ]: Began running node model.billy_bulky.staging_shopify__customers
[0m12:07:43.503983 [debug] [Thread-3  ]: Began running node model.billy_bulky.staging_shopify__orders
[0m12:07:43.504829 [info ] [Thread-1  ]: 1 of 7 START sql view model staging.staging__shopify__products_history ......... [RUN]
[0m12:07:43.507391 [info ] [Thread-2  ]: 2 of 7 START sql view model staging.staging_shopify__customers ................. [RUN]
[0m12:07:43.508593 [info ] [Thread-3  ]: 3 of 7 START sql view model staging.staging_shopify__orders .................... [RUN]
[0m12:07:43.510725 [debug] [Thread-4  ]: Began running node model.billy_bulky.staging_shopify__products
[0m12:07:43.511942 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_E_COMMERCE_snapshots, now model.billy_bulky.staging__shopify__products_history)
[0m12:07:43.512888 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_E_COMMERCE_marts, now model.billy_bulky.staging_shopify__customers)
[0m12:07:43.513787 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly list_E_COMMERCE_staging, now model.billy_bulky.staging_shopify__orders)
[0m12:07:43.514465 [info ] [Thread-4  ]: 4 of 7 START sql view model staging.staging_shopify__products .................. [RUN]
[0m12:07:43.515078 [debug] [Thread-1  ]: Began compiling node model.billy_bulky.staging__shopify__products_history
[0m12:07:43.515593 [debug] [Thread-2  ]: Began compiling node model.billy_bulky.staging_shopify__customers
[0m12:07:43.516105 [debug] [Thread-3  ]: Began compiling node model.billy_bulky.staging_shopify__orders
[0m12:07:43.517092 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.billy_bulky.staging_shopify__products'
[0m12:07:43.527466 [debug] [Thread-2  ]: Writing injected SQL for node "model.billy_bulky.staging_shopify__customers"
[0m12:07:43.531210 [debug] [Thread-1  ]: Writing injected SQL for node "model.billy_bulky.staging__shopify__products_history"
[0m12:07:43.534498 [debug] [Thread-3  ]: Writing injected SQL for node "model.billy_bulky.staging_shopify__orders"
[0m12:07:43.534966 [debug] [Thread-4  ]: Began compiling node model.billy_bulky.staging_shopify__products
[0m12:07:43.538353 [debug] [Thread-4  ]: Writing injected SQL for node "model.billy_bulky.staging_shopify__products"
[0m12:07:43.538978 [debug] [Thread-2  ]: Timing info for model.billy_bulky.staging_shopify__customers (compile): 12:07:43.523667 => 12:07:43.538718
[0m12:07:43.539429 [debug] [Thread-1  ]: Timing info for model.billy_bulky.staging__shopify__products_history (compile): 12:07:43.517432 => 12:07:43.539222
[0m12:07:43.539796 [debug] [Thread-2  ]: Began executing node model.billy_bulky.staging_shopify__customers
[0m12:07:43.540224 [debug] [Thread-1  ]: Began executing node model.billy_bulky.staging__shopify__products_history
[0m12:07:43.540712 [debug] [Thread-3  ]: Timing info for model.billy_bulky.staging_shopify__orders (compile): 12:07:43.531646 => 12:07:43.540492
[0m12:07:43.541115 [debug] [Thread-4  ]: Timing info for model.billy_bulky.staging_shopify__products (compile): 12:07:43.535569 => 12:07:43.540914
[0m12:07:43.571851 [debug] [Thread-2  ]: Writing runtime sql for node "model.billy_bulky.staging_shopify__customers"
[0m12:07:43.572337 [debug] [Thread-1  ]: Writing runtime sql for node "model.billy_bulky.staging__shopify__products_history"
[0m12:07:43.572615 [debug] [Thread-3  ]: Began executing node model.billy_bulky.staging_shopify__orders
[0m12:07:43.572872 [debug] [Thread-4  ]: Began executing node model.billy_bulky.staging_shopify__products
[0m12:07:43.575203 [debug] [Thread-3  ]: Writing runtime sql for node "model.billy_bulky.staging_shopify__orders"
[0m12:07:43.575808 [debug] [Thread-2  ]: Using snowflake connection "model.billy_bulky.staging_shopify__customers"
[0m12:07:43.577920 [debug] [Thread-4  ]: Writing runtime sql for node "model.billy_bulky.staging_shopify__products"
[0m12:07:43.578478 [debug] [Thread-1  ]: Using snowflake connection "model.billy_bulky.staging__shopify__products_history"
[0m12:07:43.578802 [debug] [Thread-2  ]: On model.billy_bulky.staging_shopify__customers: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.staging_shopify__customers"} */
create or replace   view E_COMMERCE.staging.staging_shopify__customers
  
   as (
    WITH customers AS (
    SELECT * FROM SHOPIFY.PUBLIC.customers
)

SELECT
    CUSTOMER_ID
    , FIRST_NAME
    , LAST_NAME
    , EMAIL
    , JOIN_DATE
    , COUNTRY
FROM customers
  );
[0m12:07:43.579173 [debug] [Thread-1  ]: On model.billy_bulky.staging__shopify__products_history: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.staging__shopify__products_history"} */
create or replace   view E_COMMERCE.staging.staging__shopify__products_history
  
   as (
    WITH products AS (
    SELECT * FROM E_COMMERCE.SNAPSHOTS.products_snapshot
)

SELECT
    PRODUCT_ID
    , NAME
    , CATEGORY
    , PRICE
    , STOCK_LEVEL
    , DBT_SCD_ID
    , DBT_UPDATED_AT
    , DBT_VALID_FROM
    , DBT_VALID_TO
FROM products
  );
[0m12:07:43.579698 [debug] [Thread-3  ]: Using snowflake connection "model.billy_bulky.staging_shopify__orders"
[0m12:07:43.579960 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m12:07:43.580214 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:07:43.580669 [debug] [Thread-4  ]: Using snowflake connection "model.billy_bulky.staging_shopify__products"
[0m12:07:43.580924 [debug] [Thread-3  ]: On model.billy_bulky.staging_shopify__orders: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.staging_shopify__orders"} */
create or replace   view E_COMMERCE.staging.staging_shopify__orders
  
   as (
    WITH orders AS (
    SELECT * FROM SHOPIFY.PUBLIC.orders
)

SELECT
    ORDER_ID
    , CUSTOMER_ID
    , PRODUCT_ID
    , QUANTITY
    , ORDER_DATE
    , STATUS
FROM orders
  );
[0m12:07:43.581965 [debug] [Thread-4  ]: On model.billy_bulky.staging_shopify__products: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.staging_shopify__products"} */
create or replace   view E_COMMERCE.staging.staging_shopify__products
  
   as (
    WITH products AS (
    SELECT * FROM SHOPIFY.PUBLIC.products
)

SELECT
    PRODUCT_ID
    , NAME
    , CATEGORY
    , PRICE
    , STOCK_LEVEL
FROM products
  );
[0m12:07:43.582481 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m12:07:43.582952 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m12:07:44.937317 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:07:44.965292 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:07:44.980029 [debug] [Thread-4  ]: Timing info for model.billy_bulky.staging_shopify__products (execute): 12:07:43.575965 => 12:07:44.979774
[0m12:07:44.980744 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:07:44.982887 [debug] [Thread-1  ]: Timing info for model.billy_bulky.staging__shopify__products_history (execute): 12:07:43.560417 => 12:07:44.982653
[0m12:07:44.983544 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:07:44.983994 [debug] [Thread-4  ]: On model.billy_bulky.staging_shopify__products: Close
[0m12:07:44.986188 [debug] [Thread-3  ]: Timing info for model.billy_bulky.staging_shopify__orders (execute): 12:07:43.573240 => 12:07:44.985992
[0m12:07:44.986572 [debug] [Thread-1  ]: On model.billy_bulky.staging__shopify__products_history: Close
[0m12:07:44.988721 [debug] [Thread-2  ]: Timing info for model.billy_bulky.staging_shopify__customers (execute): 12:07:43.541321 => 12:07:44.988525
[0m12:07:44.990101 [debug] [Thread-3  ]: On model.billy_bulky.staging_shopify__orders: Close
[0m12:07:44.991793 [debug] [Thread-2  ]: On model.billy_bulky.staging_shopify__customers: Close
[0m12:07:45.398447 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40549615-4727-46dd-8579-9262b3a22532', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146255670>]}
[0m12:07:45.401085 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40549615-4727-46dd-8579-9262b3a22532', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b1f5f10>]}
[0m12:07:45.399829 [info ] [Thread-1  ]: 1 of 7 OK created sql view model staging.staging__shopify__products_history .... [[32mSUCCESS 1[0m in 1.89s]
[0m12:07:45.402653 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40549615-4727-46dd-8579-9262b3a22532', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147b3c640>]}
[0m12:07:45.403948 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40549615-4727-46dd-8579-9262b3a22532', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146f204f0>]}
[0m12:07:45.404975 [info ] [Thread-4  ]: 4 of 7 OK created sql view model staging.staging_shopify__products ............. [[32mSUCCESS 1[0m in 1.88s]
[0m12:07:45.406053 [debug] [Thread-1  ]: Finished running node model.billy_bulky.staging__shopify__products_history
[0m12:07:45.407043 [info ] [Thread-2  ]: 2 of 7 OK created sql view model staging.staging_shopify__customers ............ [[32mSUCCESS 1[0m in 1.89s]
[0m12:07:45.408086 [info ] [Thread-3  ]: 3 of 7 OK created sql view model staging.staging_shopify__orders ............... [[32mSUCCESS 1[0m in 1.89s]
[0m12:07:45.409161 [debug] [Thread-4  ]: Finished running node model.billy_bulky.staging_shopify__products
[0m12:07:45.410252 [debug] [Thread-2  ]: Finished running node model.billy_bulky.staging_shopify__customers
[0m12:07:45.411057 [debug] [Thread-3  ]: Finished running node model.billy_bulky.staging_shopify__orders
[0m12:07:45.412393 [debug] [Thread-6  ]: Began running node model.billy_bulky.int_customers_segmentation
[0m12:07:45.413006 [debug] [Thread-7  ]: Began running node model.billy_bulky.int_products_performance
[0m12:07:45.414184 [debug] [Thread-6  ]: Acquiring new snowflake connection 'model.billy_bulky.int_customers_segmentation'
[0m12:07:45.414742 [debug] [Thread-8  ]: Began running node model.billy_bulky.int_sales_trend
[0m12:07:45.415754 [debug] [Thread-7  ]: Acquiring new snowflake connection 'model.billy_bulky.int_products_performance'
[0m12:07:45.416299 [debug] [Thread-6  ]: Began compiling node model.billy_bulky.int_customers_segmentation
[0m12:07:45.417259 [debug] [Thread-8  ]: Acquiring new snowflake connection 'model.billy_bulky.int_sales_trend'
[0m12:07:45.417783 [debug] [Thread-7  ]: Began compiling node model.billy_bulky.int_products_performance
[0m12:07:45.422993 [debug] [Thread-6  ]: Writing injected SQL for node "model.billy_bulky.int_customers_segmentation"
[0m12:07:45.423496 [debug] [Thread-8  ]: Began compiling node model.billy_bulky.int_sales_trend
[0m12:07:45.427627 [debug] [Thread-7  ]: Writing injected SQL for node "model.billy_bulky.int_products_performance"
[0m12:07:45.432199 [debug] [Thread-8  ]: Writing injected SQL for node "model.billy_bulky.int_sales_trend"
[0m12:07:45.433175 [debug] [Thread-7  ]: Timing info for model.billy_bulky.int_products_performance (compile): 12:07:45.423783 => 12:07:45.432910
[0m12:07:45.433714 [debug] [Thread-6  ]: Timing info for model.billy_bulky.int_customers_segmentation (compile): 12:07:45.418106 => 12:07:45.433443
[0m12:07:45.434785 [debug] [Thread-7  ]: Finished running node model.billy_bulky.int_products_performance
[0m12:07:45.435701 [debug] [Thread-6  ]: Finished running node model.billy_bulky.int_customers_segmentation
[0m12:07:45.436318 [debug] [Thread-10 ]: Began running node model.billy_bulky.products
[0m12:07:45.436771 [debug] [Thread-8  ]: Timing info for model.billy_bulky.int_sales_trend (compile): 12:07:45.428169 => 12:07:45.436559
[0m12:07:45.437808 [debug] [Thread-1  ]: Began running node model.billy_bulky.customers
[0m12:07:45.438690 [debug] [Thread-8  ]: Finished running node model.billy_bulky.int_sales_trend
[0m12:07:45.437333 [info ] [Thread-10 ]: 5 of 7 START sql table model marts.products .................................... [RUN]
[0m12:07:45.439255 [info ] [Thread-1  ]: 6 of 7 START sql table model marts.customers ................................... [RUN]
[0m12:07:45.440162 [debug] [Thread-10 ]: Acquiring new snowflake connection 'model.billy_bulky.products'
[0m12:07:45.440686 [debug] [Thread-2  ]: Began running node model.billy_bulky.sales
[0m12:07:45.441317 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.billy_bulky.staging__shopify__products_history, now model.billy_bulky.customers)
[0m12:07:45.441695 [debug] [Thread-10 ]: Began compiling node model.billy_bulky.products
[0m12:07:45.442125 [info ] [Thread-2  ]: 7 of 7 START sql table model marts.sales ....................................... [RUN]
[0m12:07:45.442502 [debug] [Thread-1  ]: Began compiling node model.billy_bulky.customers
[0m12:07:45.449521 [debug] [Thread-10 ]: Writing injected SQL for node "model.billy_bulky.products"
[0m12:07:45.450231 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.billy_bulky.staging_shopify__customers, now model.billy_bulky.sales)
[0m12:07:45.458835 [debug] [Thread-1  ]: Writing injected SQL for node "model.billy_bulky.customers"
[0m12:07:45.459281 [debug] [Thread-2  ]: Began compiling node model.billy_bulky.sales
[0m12:07:45.469368 [debug] [Thread-2  ]: Writing injected SQL for node "model.billy_bulky.sales"
[0m12:07:45.469785 [debug] [Thread-10 ]: Timing info for model.billy_bulky.products (compile): 12:07:45.442717 => 12:07:45.469621
[0m12:07:45.470150 [debug] [Thread-1  ]: Timing info for model.billy_bulky.customers (compile): 12:07:45.450486 => 12:07:45.470009
[0m12:07:45.470405 [debug] [Thread-10 ]: Began executing node model.billy_bulky.products
[0m12:07:45.470696 [debug] [Thread-1  ]: Began executing node model.billy_bulky.customers
[0m12:07:45.471016 [debug] [Thread-2  ]: Timing info for model.billy_bulky.sales (compile): 12:07:45.459587 => 12:07:45.470877
[0m12:07:45.487092 [debug] [Thread-10 ]: Writing runtime sql for node "model.billy_bulky.products"
[0m12:07:45.488956 [debug] [Thread-1  ]: Writing runtime sql for node "model.billy_bulky.customers"
[0m12:07:45.489226 [debug] [Thread-2  ]: Began executing node model.billy_bulky.sales
[0m12:07:45.491264 [debug] [Thread-2  ]: Writing runtime sql for node "model.billy_bulky.sales"
[0m12:07:45.493586 [debug] [Thread-1  ]: Using snowflake connection "model.billy_bulky.customers"
[0m12:07:45.495184 [debug] [Thread-10 ]: Using snowflake connection "model.billy_bulky.products"
[0m12:07:45.495550 [debug] [Thread-1  ]: On model.billy_bulky.customers: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.customers"} */
create or replace transient table E_COMMERCE.marts.customers
         as
        (WITH  __dbt__cte__int_customers_segmentation as (
WITH customers AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__customers
)

, orders AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__orders
)

, products AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__products
)

, order_aggregates AS (
    SELECT
        o.CUSTOMER_ID
        , COUNT(DISTINCT o.ORDER_ID) AS frequency
        , SUM(o.QUANTITY * p.PRICE) AS monetary
        , AVG(o.QUANTITY * p.PRICE) AS average_order_value
        , MAX(o.ORDER_DATE) AS last_purchase_date
        , COUNT(CASE WHEN o.STATUS = 'cancelled' THEN 1 END) AS cancelled_orders
        , COUNT(*) AS total_orders
    FROM orders o
    JOIN products p ON o.PRODUCT_ID = p.PRODUCT_ID
    GROUP BY o.CUSTOMER_ID
)

, customer_tenure AS (
    SELECT
        CUSTOMER_ID
        , JOIN_DATE
        , CURRENT_DATE - JOIN_DATE AS tenure
    FROM customers
)

, customer_recency AS (
    SELECT
        CUSTOMER_ID
        , CURRENT_DATE - last_purchase_date AS recency
    FROM order_aggregates
)

, final AS (
    SELECT
        c.CUSTOMER_ID
        , c.FIRST_NAME
        , c.LAST_NAME
        , c.EMAIL
        , c.JOIN_DATE
        , c.COUNTRY
        , o.frequency
        , o.monetary
        , o.average_order_value
        , o.cancelled_orders
        , o.total_orders
        , CASE 
            WHEN o.total_orders > 0 THEN ROUND((o.cancelled_orders::FLOAT / o.total_orders) * 100, 2) 
            ELSE 0 
          END AS cancellation_rate
        , r.recency
        , t.tenure
    FROM customer_tenure t
    JOIN customers c ON t.CUSTOMER_ID = c.CUSTOMER_ID
    JOIN order_aggregates o ON c.CUSTOMER_ID = o.CUSTOMER_ID
    JOIN customer_recency r ON c.CUSTOMER_ID = r.CUSTOMER_ID
)

SELECT * FROM final
), source AS (
    SELECT
        icp.CUSTOMER_ID
        , icp.FIRST_NAME
        , icp.LAST_NAME
        , icp.EMAIL
        , icp.JOIN_DATE
        , icp.COUNTRY
        , icp.frequency AS total_orders
        , icp.monetary AS total_spent
        , icp.recency
        , icp.tenure
    FROM __dbt__cte__int_customers_segmentation icp
)

, final AS (
SELECT
    s.CUSTOMER_ID
    , s.FIRST_NAME
    , s.LAST_NAME
    , s.EMAIL
    , s.JOIN_DATE
    , s.COUNTRY
    , s.total_orders
    , s.total_spent
    , s.recency
    , s.tenure
    , CASE 
        WHEN s.total_spent > 1000 THEN 'VIP' 
        ELSE 'Regular' 
      END AS customer_segment 
FROM source s
)

SELECT * FROM final
        );
[0m12:07:45.495980 [debug] [Thread-10 ]: On model.billy_bulky.products: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.products"} */
create or replace transient table E_COMMERCE.marts.products
         as
        (WITH  __dbt__cte__int_products_performance as (
WITH orders AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__orders
)

, products AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__products
)

, product_sales AS (
    SELECT
        o.PRODUCT_ID
        , COUNT(DISTINCT o.ORDER_ID) AS total_sales
        , SUM(o.QUANTITY) AS total_units_sold
        , SUM(o.QUANTITY * p.PRICE) AS total_sales_value
    FROM orders o
    INNER JOIN products p ON o.PRODUCT_ID = p.PRODUCT_ID
    WHERE o.STATUS NOT IN ('cancelled') 
    GROUP BY o.PRODUCT_ID
)

, product_averages AS (
    SELECT
        PRODUCT_ID
        , (total_sales_value / NULLIF(total_units_sold, 0)) AS average_sale_price
    FROM product_sales
)

, product_stock_turnover AS (
    SELECT
        p.PRODUCT_ID
        , p.STOCK_LEVEL
        , (total_units_sold / NULLIF(p.STOCK_LEVEL, 0)) AS turnover_rate
    FROM product_sales ps
    INNER JOIN products p ON ps.PRODUCT_ID = p.PRODUCT_ID
)

, final AS (
    SELECT
    p.PRODUCT_ID
    , p.NAME
    , p.CATEGORY
    , p.PRICE
    , pa.average_sale_price
    , ps.total_sales
    , ps.total_units_sold
    , ps.total_sales_value
    , pst.turnover_rate
    , p.STOCK_LEVEL
FROM products p
LEFT JOIN product_sales ps ON p.PRODUCT_ID = ps.PRODUCT_ID
LEFT JOIN product_averages pa ON p.PRODUCT_ID = pa.PRODUCT_ID
LEFT JOIN product_stock_turnover pst ON p.PRODUCT_ID = pst.PRODUCT_ID
)

SELECT * FROM final
), final AS (
    SELECT
        pp.PRODUCT_ID
        , pp.NAME
        , pp.CATEGORY
        , pp.PRICE
        , pp.average_sale_price
        , pp.total_sales
        , pp.total_units_sold
        , pp.total_sales_value
        , pp.turnover_rate
        , pp.STOCK_LEVEL
    FROM __dbt__cte__int_products_performance pp
)

SELECT * FROM final
        );
[0m12:07:45.498247 [debug] [Thread-2  ]: Using snowflake connection "model.billy_bulky.sales"
[0m12:07:45.498462 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:07:45.498686 [debug] [Thread-10 ]: Opening a new connection, currently in state init
[0m12:07:45.499034 [debug] [Thread-2  ]: On model.billy_bulky.sales: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.sales"} */
create or replace transient table E_COMMERCE.marts.sales
         as
        (WITH  __dbt__cte__int_sales_trend as (
WITH orders AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__orders
)

, products AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__products
)

, daily_sales AS (
    SELECT
        DATE(ORDER_DATE) AS sale_date
        , COUNT(DISTINCT ORDER_ID) AS total_orders
        , SUM(QUANTITY) AS total_units_sold
        , SUM(QUANTITY * PRICE) AS total_sales_value
    FROM orders AS o
    JOIN products AS p ON o.PRODUCT_ID = p.PRODUCT_ID
    WHERE o.STATUS NOT IN ('cancelled') 
    GROUP BY sale_date
)

, weekly_sales AS (
    SELECT
        DATE_TRUNC('week', sale_date) AS sale_week
        , SUM(total_orders) AS weekly_orders
        , SUM(total_units_sold) AS weekly_units_sold
        , SUM(total_sales_value) AS weekly_sales_value
    FROM daily_sales
    GROUP BY sale_week
)

, monthly_sales AS (
    SELECT
        DATE_TRUNC('month', sale_date) AS sale_month
        , SUM(total_orders) AS monthly_orders
        , SUM(total_units_sold) AS monthly_units_sold
        , SUM(total_sales_value) AS monthly_sales_value
    FROM daily_sales
    GROUP BY sale_month
)

, yearly_sales AS (
    SELECT
        DATE_TRUNC('year', sale_date) AS sale_year
        , SUM(total_orders) AS yearly_orders
        , SUM(total_units_sold) AS yearly_units_sold
        , SUM(total_sales_value) AS yearly_sales_value
    FROM daily_sales
    GROUP BY sale_year
)

SELECT
    d.sale_date
    , d.total_orders AS daily_orders
    , d.total_units_sold AS daily_units_sold
    , d.total_sales_value AS daily_sales_value
    , w.weekly_orders
    , w.weekly_units_sold
    , w.weekly_sales_value
    , m.monthly_orders
    , m.monthly_units_sold
    , m.monthly_sales_value
    , y.yearly_orders
    , y.yearly_units_sold
    , y.yearly_sales_value
FROM daily_sales d
LEFT JOIN weekly_sales w ON DATE_TRUNC('week', d.sale_date) = w.sale_week
LEFT JOIN monthly_sales m ON DATE_TRUNC('month', d.sale_date) = m.sale_month
LEFT JOIN yearly_sales y ON DATE_TRUNC('year', d.sale_date) = y.sale_year
), enriched_orders AS (
    SELECT
        o.ORDER_ID
        , o.CUSTOMER_ID
        , o.PRODUCT_ID
        , o.QUANTITY
        , o.ORDER_DATE
        , o.STATUS
        , p.CATEGORY
        , p.PRICE AS unit_price
        , (o.QUANTITY * p.PRICE) AS total_price
        , c.COUNTRY
    FROM E_COMMERCE.staging.staging_shopify__orders o
    JOIN E_COMMERCE.staging.staging_shopify__products p ON o.PRODUCT_ID = p.PRODUCT_ID
    JOIN E_COMMERCE.staging.staging_shopify__customers c ON o.CUSTOMER_ID = c.CUSTOMER_ID
    WHERE o.STATUS NOT IN ('cancelled') 
)

SELECT
    eo.ORDER_ID
    , eo.CUSTOMER_ID
    , eo.PRODUCT_ID
    , eo.QUANTITY
    , eo.ORDER_DATE
    , eo.STATUS
    , eo.CATEGORY
    , eo.unit_price
    , eo.total_price
    , eo.COUNTRY
    , sa.daily_orders
    , sa.daily_units_sold
    , sa.daily_sales_value
FROM enriched_orders eo
LEFT JOIN __dbt__cte__int_sales_trend sa ON DATE(eo.ORDER_DATE) = sa.sale_date
        );
[0m12:07:45.499831 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m12:07:48.158390 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 3.0 seconds
[0m12:07:48.160284 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 3.0 seconds
[0m12:07:48.161911 [debug] [Thread-10 ]: SQL status: SUCCESS 1 in 3.0 seconds
[0m12:07:48.167410 [debug] [Thread-1  ]: Timing info for model.billy_bulky.customers (execute): 12:07:45.487293 => 12:07:48.166970
[0m12:07:48.171357 [debug] [Thread-2  ]: Timing info for model.billy_bulky.sales (execute): 12:07:45.489508 => 12:07:48.170996
[0m12:07:48.174948 [debug] [Thread-10 ]: Timing info for model.billy_bulky.products (execute): 12:07:45.471163 => 12:07:48.174659
[0m12:07:48.175583 [debug] [Thread-1  ]: On model.billy_bulky.customers: Close
[0m12:07:48.176128 [debug] [Thread-2  ]: On model.billy_bulky.sales: Close
[0m12:07:48.176663 [debug] [Thread-10 ]: On model.billy_bulky.products: Close
[0m12:07:48.673543 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40549615-4727-46dd-8579-9262b3a22532', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146255940>]}
[0m12:07:48.675072 [info ] [Thread-10 ]: 5 of 7 OK created sql table model marts.products ............................... [[32mSUCCESS 1[0m in 3.23s]
[0m12:07:48.676370 [debug] [Thread-10 ]: Finished running node model.billy_bulky.products
[0m12:07:48.688171 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40549615-4727-46dd-8579-9262b3a22532', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147b31430>]}
[0m12:07:48.689632 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40549615-4727-46dd-8579-9262b3a22532', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147b2cd90>]}
[0m12:07:48.690581 [info ] [Thread-1  ]: 6 of 7 OK created sql table model marts.customers .............................. [[32mSUCCESS 1[0m in 3.25s]
[0m12:07:48.691508 [info ] [Thread-2  ]: 7 of 7 OK created sql table model marts.sales .................................. [[32mSUCCESS 1[0m in 3.24s]
[0m12:07:48.692437 [debug] [Thread-1  ]: Finished running node model.billy_bulky.customers
[0m12:07:48.693377 [debug] [Thread-2  ]: Finished running node model.billy_bulky.sales
[0m12:07:48.696005 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:07:48.696499 [debug] [MainThread]: Connection 'model.billy_bulky.customers' was properly closed.
[0m12:07:48.696927 [debug] [MainThread]: Connection 'model.billy_bulky.sales' was properly closed.
[0m12:07:48.697327 [debug] [MainThread]: Connection 'model.billy_bulky.staging_shopify__orders' was properly closed.
[0m12:07:48.697725 [debug] [MainThread]: Connection 'model.billy_bulky.staging_shopify__products' was properly closed.
[0m12:07:48.698136 [debug] [MainThread]: Connection 'model.billy_bulky.int_customers_segmentation' was properly closed.
[0m12:07:48.698538 [debug] [MainThread]: Connection 'model.billy_bulky.int_products_performance' was properly closed.
[0m12:07:48.698952 [debug] [MainThread]: Connection 'model.billy_bulky.int_sales_trend' was properly closed.
[0m12:07:48.699334 [debug] [MainThread]: Connection 'model.billy_bulky.products' was properly closed.
[0m12:07:48.699813 [info ] [MainThread]: 
[0m12:07:48.700268 [info ] [MainThread]: Finished running 4 view models, 3 table models in 0 hours 0 minutes and 8.68 seconds (8.68s).
[0m12:07:48.701899 [debug] [MainThread]: Command end result
[0m12:07:48.716352 [info ] [MainThread]: 
[0m12:07:48.716836 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:07:48.717233 [info ] [MainThread]: 
[0m12:07:48.717690 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m12:07:48.720527 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.854497, "process_user_time": 5.270267, "process_kernel_time": 0.399144, "process_mem_max_rss": "221675520", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:07:48.721056 [debug] [MainThread]: Command `dbt run` succeeded at 12:07:48.720936 after 9.86 seconds
[0m12:07:48.721435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072dd6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147871850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dcf9d0>]}
[0m12:07:48.721813 [debug] [MainThread]: Flushing usage events
[0m12:13:50.170791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d564f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048468e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075a44f0>]}


============================== 12:13:50.173882 | 588fe211-f944-4520-ba29-c9ef28bb2262 ==============================
[0m12:13:50.173882 [info ] [MainThread]: Running with dbt=1.7.1
[0m12:13:50.174230 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/bitlevi/Documents/billy_bulky_ecommerce/billy_bulky_ecommerce/logs', 'profiles_dir': '/Users/bitlevi/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:13:51.032777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '588fe211-f944-4520-ba29-c9ef28bb2262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048468e0>]}
[0m12:13:51.080351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '588fe211-f944-4520-ba29-c9ef28bb2262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d88ec10>]}
[0m12:13:51.080982 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m12:13:51.094380 [debug] [MainThread]: checksum: ad428e6dc3b353dcb23d0c4ebea8b20b180e94b873271ac2a054a8e446dac0e2, vars: {}, profile: , target: , version: 1.7.1
[0m12:13:51.131494 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m12:13:51.131999 [debug] [MainThread]: Partial parsing: added file: billy_bulky://seeds/employees.csv
[0m12:13:51.202880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '588fe211-f944-4520-ba29-c9ef28bb2262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e5870d0>]}
[0m12:13:51.215267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '588fe211-f944-4520-ba29-c9ef28bb2262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e0df730>]}
[0m12:13:51.215602 [info ] [MainThread]: Found 10 models, 47 tests, 1 snapshot, 1 seed, 4 sources, 0 exposures, 0 metrics, 431 macros, 0 groups, 0 semantic models
[0m12:13:51.215828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '588fe211-f944-4520-ba29-c9ef28bb2262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d97aa30>]}
[0m12:13:51.217328 [info ] [MainThread]: 
[0m12:13:51.217839 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:13:51.218651 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE'
[0m12:13:51.227816 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE"
[0m12:13:51.228482 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE'
[0m12:13:51.228714 [debug] [ThreadPool]: On list_E_COMMERCE: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE"} */
show terse schemas in database E_COMMERCE
    limit 10000
[0m12:13:51.273905 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE"
[0m12:13:51.274235 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:13:51.274437 [debug] [ThreadPool]: On list_E_COMMERCE: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE"} */
show terse schemas in database E_COMMERCE
    limit 10000
[0m12:13:51.275144 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:13:52.929613 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.0 seconds
[0m12:13:52.933502 [debug] [ThreadPool]: On list_E_COMMERCE: Close
[0m12:13:53.161872 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.0 seconds
[0m12:13:53.166352 [debug] [ThreadPool]: On list_E_COMMERCE: Close
[0m12:13:53.521914 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_E_COMMERCE, now list_E_COMMERCE_PUBLIC)
[0m12:13:53.522485 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_E_COMMERCE, now list_E_COMMERCE_marts)
[0m12:13:53.523783 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_staging'
[0m12:13:53.536526 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_marts"
[0m12:13:53.537007 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_snapshots'
[0m12:13:53.538914 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PUBLIC"
[0m12:13:53.540864 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_staging"
[0m12:13:53.541136 [debug] [ThreadPool]: On list_E_COMMERCE_marts: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE_marts"} */
show terse objects in E_COMMERCE.marts limit 10000
[0m12:13:53.542796 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_snapshots"
[0m12:13:53.543073 [debug] [ThreadPool]: On list_E_COMMERCE_PUBLIC: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE_PUBLIC"} */
show terse objects in E_COMMERCE.PUBLIC limit 10000
[0m12:13:53.543310 [debug] [ThreadPool]: On list_E_COMMERCE_staging: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE_staging"} */
show terse objects in E_COMMERCE.staging limit 10000
[0m12:13:53.543532 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:13:53.543755 [debug] [ThreadPool]: On list_E_COMMERCE_snapshots: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE_snapshots"} */
show terse objects in E_COMMERCE.snapshots limit 10000
[0m12:13:53.544017 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:13:53.544279 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:13:53.545123 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:13:54.663648 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:13:54.668360 [debug] [ThreadPool]: On list_E_COMMERCE_snapshots: Close
[0m12:13:54.691721 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m12:13:54.697820 [debug] [ThreadPool]: On list_E_COMMERCE_marts: Close
[0m12:13:54.727977 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b079e1-0001-8184-0004-d8be00010506
[0m12:13:54.728592 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m12:13:54.728869 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m12:13:54.729986 [debug] [ThreadPool]: On list_E_COMMERCE_staging: Close
[0m12:13:54.730338 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m12:13:54.731413 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m12:13:54.731707 [debug] [ThreadPool]: On list_E_COMMERCE_PUBLIC: Close
[0m12:13:55.901017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '588fe211-f944-4520-ba29-c9ef28bb2262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11da50640>]}
[0m12:13:55.902574 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m12:13:55.903237 [info ] [MainThread]: 
[0m12:13:55.908040 [debug] [Thread-1  ]: Began running node model.billy_bulky.staging__shopify__products_history
[0m12:13:55.908927 [debug] [Thread-2  ]: Began running node model.billy_bulky.staging_shopify__customers
[0m12:13:55.909620 [debug] [Thread-3  ]: Began running node model.billy_bulky.staging_shopify__orders
[0m12:13:55.910442 [info ] [Thread-1  ]: 1 of 7 START sql view model staging.staging__shopify__products_history ......... [RUN]
[0m12:13:55.912137 [info ] [Thread-2  ]: 2 of 7 START sql view model staging.staging_shopify__customers ................. [RUN]
[0m12:13:55.912929 [info ] [Thread-3  ]: 3 of 7 START sql view model staging.staging_shopify__orders .................... [RUN]
[0m12:13:55.914254 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_E_COMMERCE_PUBLIC, now model.billy_bulky.staging__shopify__products_history)
[0m12:13:55.915345 [debug] [Thread-4  ]: Began running node model.billy_bulky.staging_shopify__products
[0m12:13:55.916340 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_E_COMMERCE_marts, now model.billy_bulky.staging_shopify__customers)
[0m12:13:55.917257 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly list_E_COMMERCE_staging, now model.billy_bulky.staging_shopify__orders)
[0m12:13:55.917839 [debug] [Thread-1  ]: Began compiling node model.billy_bulky.staging__shopify__products_history
[0m12:13:55.918510 [info ] [Thread-4  ]: 4 of 7 START sql view model staging.staging_shopify__products .................. [RUN]
[0m12:13:55.919092 [debug] [Thread-2  ]: Began compiling node model.billy_bulky.staging_shopify__customers
[0m12:13:55.919604 [debug] [Thread-3  ]: Began compiling node model.billy_bulky.staging_shopify__orders
[0m12:13:55.930241 [debug] [Thread-1  ]: Writing injected SQL for node "model.billy_bulky.staging__shopify__products_history"
[0m12:13:55.931165 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly list_E_COMMERCE_snapshots, now model.billy_bulky.staging_shopify__products)
[0m12:13:55.934804 [debug] [Thread-2  ]: Writing injected SQL for node "model.billy_bulky.staging_shopify__customers"
[0m12:13:55.938435 [debug] [Thread-3  ]: Writing injected SQL for node "model.billy_bulky.staging_shopify__orders"
[0m12:13:55.939091 [debug] [Thread-4  ]: Began compiling node model.billy_bulky.staging_shopify__products
[0m12:13:55.939887 [debug] [Thread-1  ]: Timing info for model.billy_bulky.staging__shopify__products_history (compile): 12:13:55.919969 => 12:13:55.939619
[0m12:13:55.943197 [debug] [Thread-4  ]: Writing injected SQL for node "model.billy_bulky.staging_shopify__products"
[0m12:13:55.943811 [debug] [Thread-1  ]: Began executing node model.billy_bulky.staging__shopify__products_history
[0m12:13:55.944296 [debug] [Thread-3  ]: Timing info for model.billy_bulky.staging_shopify__orders (compile): 12:13:55.935207 => 12:13:55.944082
[0m12:13:55.944688 [debug] [Thread-2  ]: Timing info for model.billy_bulky.staging_shopify__customers (compile): 12:13:55.931551 => 12:13:55.944500
[0m12:13:55.956929 [debug] [Thread-3  ]: Began executing node model.billy_bulky.staging_shopify__orders
[0m12:13:55.970078 [debug] [Thread-4  ]: Timing info for model.billy_bulky.staging_shopify__products (compile): 12:13:55.940137 => 12:13:55.969878
[0m12:13:55.970414 [debug] [Thread-2  ]: Began executing node model.billy_bulky.staging_shopify__customers
[0m12:13:55.969675 [debug] [Thread-1  ]: Writing runtime sql for node "model.billy_bulky.staging__shopify__products_history"
[0m12:13:55.973726 [debug] [Thread-3  ]: Writing runtime sql for node "model.billy_bulky.staging_shopify__orders"
[0m12:13:55.974048 [debug] [Thread-4  ]: Began executing node model.billy_bulky.staging_shopify__products
[0m12:13:55.976363 [debug] [Thread-2  ]: Writing runtime sql for node "model.billy_bulky.staging_shopify__customers"
[0m12:13:55.979126 [debug] [Thread-4  ]: Writing runtime sql for node "model.billy_bulky.staging_shopify__products"
[0m12:13:55.980122 [debug] [Thread-1  ]: Using snowflake connection "model.billy_bulky.staging__shopify__products_history"
[0m12:13:55.980638 [debug] [Thread-3  ]: Using snowflake connection "model.billy_bulky.staging_shopify__orders"
[0m12:13:55.980930 [debug] [Thread-1  ]: On model.billy_bulky.staging__shopify__products_history: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.staging__shopify__products_history"} */
create or replace   view E_COMMERCE.staging.staging__shopify__products_history
  
   as (
    WITH products AS (
    SELECT * FROM E_COMMERCE.SNAPSHOTS.products_snapshot
)

SELECT
    PRODUCT_ID
    , NAME
    , CATEGORY
    , PRICE
    , STOCK_LEVEL
    , DBT_SCD_ID
    , DBT_UPDATED_AT
    , DBT_VALID_FROM
    , DBT_VALID_TO
FROM products
  );
[0m12:13:55.981478 [debug] [Thread-2  ]: Using snowflake connection "model.billy_bulky.staging_shopify__customers"
[0m12:13:55.981747 [debug] [Thread-3  ]: On model.billy_bulky.staging_shopify__orders: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.staging_shopify__orders"} */
create or replace   view E_COMMERCE.staging.staging_shopify__orders
  
   as (
    WITH orders AS (
    SELECT * FROM SHOPIFY.PUBLIC.orders
)

SELECT
    ORDER_ID
    , CUSTOMER_ID
    , PRODUCT_ID
    , QUANTITY
    , ORDER_DATE
    , STATUS
FROM orders
  );
[0m12:13:55.982037 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:13:55.982496 [debug] [Thread-4  ]: Using snowflake connection "model.billy_bulky.staging_shopify__products"
[0m12:13:55.982765 [debug] [Thread-2  ]: On model.billy_bulky.staging_shopify__customers: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.staging_shopify__customers"} */
create or replace   view E_COMMERCE.staging.staging_shopify__customers
  
   as (
    WITH customers AS (
    SELECT * FROM SHOPIFY.PUBLIC.customers
)

SELECT
    CUSTOMER_ID
    , FIRST_NAME
    , LAST_NAME
    , EMAIL
    , JOIN_DATE
    , COUNTRY
FROM customers
  );
[0m12:13:55.983018 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m12:13:55.983477 [debug] [Thread-4  ]: On model.billy_bulky.staging_shopify__products: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.staging_shopify__products"} */
create or replace   view E_COMMERCE.staging.staging_shopify__products
  
   as (
    WITH products AS (
    SELECT * FROM SHOPIFY.PUBLIC.products
)

SELECT
    PRODUCT_ID
    , NAME
    , CATEGORY
    , PRICE
    , STOCK_LEVEL
FROM products
  );
[0m12:13:55.983981 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m12:13:55.984887 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m12:13:57.212389 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:13:57.214365 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:13:57.216640 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:13:57.218227 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:13:57.261385 [debug] [Thread-3  ]: Timing info for model.billy_bulky.staging_shopify__orders (execute): 12:13:55.970676 => 12:13:57.261153
[0m12:13:57.262290 [debug] [Thread-4  ]: Timing info for model.billy_bulky.staging_shopify__products (execute): 12:13:55.976768 => 12:13:57.262101
[0m12:13:57.264349 [debug] [Thread-1  ]: Timing info for model.billy_bulky.staging__shopify__products_history (execute): 12:13:55.944969 => 12:13:57.264155
[0m12:13:57.266712 [debug] [Thread-2  ]: Timing info for model.billy_bulky.staging_shopify__customers (execute): 12:13:55.974236 => 12:13:57.266519
[0m12:13:57.267116 [debug] [Thread-3  ]: On model.billy_bulky.staging_shopify__orders: Close
[0m12:13:57.267488 [debug] [Thread-4  ]: On model.billy_bulky.staging_shopify__products: Close
[0m12:13:57.267844 [debug] [Thread-1  ]: On model.billy_bulky.staging__shopify__products_history: Close
[0m12:13:57.268187 [debug] [Thread-2  ]: On model.billy_bulky.staging_shopify__customers: Close
[0m12:13:57.781887 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '588fe211-f944-4520-ba29-c9ef28bb2262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ead7f10>]}
[0m12:13:57.783800 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '588fe211-f944-4520-ba29-c9ef28bb2262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e0cdd90>]}
[0m12:13:57.784956 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '588fe211-f944-4520-ba29-c9ef28bb2262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e9cff40>]}
[0m12:13:57.785447 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '588fe211-f944-4520-ba29-c9ef28bb2262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d2988e0>]}
[0m12:13:57.785883 [info ] [Thread-2  ]: 2 of 7 OK created sql view model staging.staging_shopify__customers ............ [[32mSUCCESS 1[0m in 1.87s]
[0m12:13:57.787281 [debug] [Thread-2  ]: Finished running node model.billy_bulky.staging_shopify__customers
[0m12:13:57.786199 [info ] [Thread-1  ]: 1 of 7 OK created sql view model staging.staging__shopify__products_history .... [[32mSUCCESS 1[0m in 1.87s]
[0m12:13:57.786595 [info ] [Thread-4  ]: 4 of 7 OK created sql view model staging.staging_shopify__products ............. [[32mSUCCESS 1[0m in 1.85s]
[0m12:13:57.787837 [debug] [Thread-1  ]: Finished running node model.billy_bulky.staging__shopify__products_history
[0m12:13:57.786958 [info ] [Thread-3  ]: 3 of 7 OK created sql view model staging.staging_shopify__orders ............... [[32mSUCCESS 1[0m in 1.87s]
[0m12:13:57.788265 [debug] [Thread-4  ]: Finished running node model.billy_bulky.staging_shopify__products
[0m12:13:57.788661 [debug] [Thread-3  ]: Finished running node model.billy_bulky.staging_shopify__orders
[0m12:13:57.789201 [debug] [Thread-6  ]: Began running node model.billy_bulky.int_customers_segmentation
[0m12:13:57.789718 [debug] [Thread-6  ]: Acquiring new snowflake connection 'model.billy_bulky.int_customers_segmentation'
[0m12:13:57.789960 [debug] [Thread-6  ]: Began compiling node model.billy_bulky.int_customers_segmentation
[0m12:13:57.792953 [debug] [Thread-6  ]: Writing injected SQL for node "model.billy_bulky.int_customers_segmentation"
[0m12:13:57.793525 [debug] [Thread-7  ]: Began running node model.billy_bulky.int_products_performance
[0m12:13:57.794250 [debug] [Thread-8  ]: Began running node model.billy_bulky.int_sales_trend
[0m12:13:57.795512 [debug] [Thread-7  ]: Acquiring new snowflake connection 'model.billy_bulky.int_products_performance'
[0m12:13:57.796056 [debug] [Thread-8  ]: Acquiring new snowflake connection 'model.billy_bulky.int_sales_trend'
[0m12:13:57.796347 [debug] [Thread-7  ]: Began compiling node model.billy_bulky.int_products_performance
[0m12:13:57.796642 [debug] [Thread-8  ]: Began compiling node model.billy_bulky.int_sales_trend
[0m12:13:57.796965 [debug] [Thread-6  ]: Timing info for model.billy_bulky.int_customers_segmentation (compile): 12:13:57.790109 => 12:13:57.796818
[0m12:13:57.801063 [debug] [Thread-7  ]: Writing injected SQL for node "model.billy_bulky.int_products_performance"
[0m12:13:57.803285 [debug] [Thread-8  ]: Writing injected SQL for node "model.billy_bulky.int_sales_trend"
[0m12:13:57.803894 [debug] [Thread-6  ]: Finished running node model.billy_bulky.int_customers_segmentation
[0m12:13:57.804441 [debug] [Thread-10 ]: Began running node model.billy_bulky.customers
[0m12:13:57.804836 [debug] [Thread-7  ]: Timing info for model.billy_bulky.int_products_performance (compile): 12:13:57.797112 => 12:13:57.804688
[0m12:13:57.805131 [info ] [Thread-10 ]: 5 of 7 START sql table model marts.customers ................................... [RUN]
[0m12:13:57.805451 [debug] [Thread-8  ]: Timing info for model.billy_bulky.int_sales_trend (compile): 12:13:57.801262 => 12:13:57.805304
[0m12:13:57.806123 [debug] [Thread-7  ]: Finished running node model.billy_bulky.int_products_performance
[0m12:13:57.806620 [debug] [Thread-10 ]: Acquiring new snowflake connection 'model.billy_bulky.customers'
[0m12:13:57.807168 [debug] [Thread-8  ]: Finished running node model.billy_bulky.int_sales_trend
[0m12:13:57.807516 [debug] [Thread-10 ]: Began compiling node model.billy_bulky.customers
[0m12:13:57.807831 [debug] [Thread-2  ]: Began running node model.billy_bulky.products
[0m12:13:57.808171 [debug] [Thread-4  ]: Began running node model.billy_bulky.sales
[0m12:13:57.817489 [debug] [Thread-10 ]: Writing injected SQL for node "model.billy_bulky.customers"
[0m12:13:57.817895 [info ] [Thread-2  ]: 6 of 7 START sql table model marts.products .................................... [RUN]
[0m12:13:57.818251 [info ] [Thread-4  ]: 7 of 7 START sql table model marts.sales ....................................... [RUN]
[0m12:13:57.818867 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.billy_bulky.staging_shopify__customers, now model.billy_bulky.products)
[0m12:13:57.819369 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.billy_bulky.staging_shopify__products, now model.billy_bulky.sales)
[0m12:13:57.819652 [debug] [Thread-2  ]: Began compiling node model.billy_bulky.products
[0m12:13:57.819952 [debug] [Thread-4  ]: Began compiling node model.billy_bulky.sales
[0m12:13:57.825612 [debug] [Thread-10 ]: Timing info for model.billy_bulky.customers (compile): 12:13:57.808314 => 12:13:57.825335
[0m12:13:57.826970 [debug] [Thread-2  ]: Writing injected SQL for node "model.billy_bulky.products"
[0m12:13:57.839054 [debug] [Thread-4  ]: Writing injected SQL for node "model.billy_bulky.sales"
[0m12:13:57.839434 [debug] [Thread-10 ]: Began executing node model.billy_bulky.customers
[0m12:13:57.856569 [debug] [Thread-10 ]: Writing runtime sql for node "model.billy_bulky.customers"
[0m12:13:57.857169 [debug] [Thread-2  ]: Timing info for model.billy_bulky.products (compile): 12:13:57.820141 => 12:13:57.857003
[0m12:13:57.857516 [debug] [Thread-4  ]: Timing info for model.billy_bulky.sales (compile): 12:13:57.827228 => 12:13:57.857345
[0m12:13:57.857801 [debug] [Thread-2  ]: Began executing node model.billy_bulky.products
[0m12:13:57.858065 [debug] [Thread-4  ]: Began executing node model.billy_bulky.sales
[0m12:13:57.860217 [debug] [Thread-10 ]: Using snowflake connection "model.billy_bulky.customers"
[0m12:13:57.862471 [debug] [Thread-2  ]: Writing runtime sql for node "model.billy_bulky.products"
[0m12:13:57.864422 [debug] [Thread-4  ]: Writing runtime sql for node "model.billy_bulky.sales"
[0m12:13:57.864794 [debug] [Thread-10 ]: On model.billy_bulky.customers: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.customers"} */
create or replace transient table E_COMMERCE.marts.customers
         as
        (WITH  __dbt__cte__int_customers_segmentation as (
WITH customers AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__customers
)

, orders AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__orders
)

, products AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__products
)

, order_aggregates AS (
    SELECT
        o.CUSTOMER_ID
        , COUNT(DISTINCT o.ORDER_ID) AS frequency
        , SUM(o.QUANTITY * p.PRICE) AS monetary
        , AVG(o.QUANTITY * p.PRICE) AS average_order_value
        , MAX(o.ORDER_DATE) AS last_purchase_date
        , COUNT(CASE WHEN o.STATUS = 'cancelled' THEN 1 END) AS cancelled_orders
        , COUNT(*) AS total_orders
    FROM orders o
    JOIN products p ON o.PRODUCT_ID = p.PRODUCT_ID
    GROUP BY o.CUSTOMER_ID
)

, customer_tenure AS (
    SELECT
        CUSTOMER_ID
        , JOIN_DATE
        , CURRENT_DATE - JOIN_DATE AS tenure
    FROM customers
)

, customer_recency AS (
    SELECT
        CUSTOMER_ID
        , CURRENT_DATE - last_purchase_date AS recency
    FROM order_aggregates
)

, final AS (
    SELECT
        c.CUSTOMER_ID
        , c.FIRST_NAME
        , c.LAST_NAME
        , c.EMAIL
        , c.JOIN_DATE
        , c.COUNTRY
        , o.frequency
        , o.monetary
        , o.average_order_value
        , o.cancelled_orders
        , o.total_orders
        , CASE 
            WHEN o.total_orders > 0 THEN ROUND((o.cancelled_orders::FLOAT / o.total_orders) * 100, 2) 
            ELSE 0 
          END AS cancellation_rate
        , r.recency
        , t.tenure
    FROM customer_tenure t
    JOIN customers c ON t.CUSTOMER_ID = c.CUSTOMER_ID
    JOIN order_aggregates o ON c.CUSTOMER_ID = o.CUSTOMER_ID
    JOIN customer_recency r ON c.CUSTOMER_ID = r.CUSTOMER_ID
)

SELECT * FROM final
), source AS (
    SELECT
        icp.CUSTOMER_ID
        , icp.FIRST_NAME
        , icp.LAST_NAME
        , icp.EMAIL
        , icp.JOIN_DATE
        , icp.COUNTRY
        , icp.frequency AS total_orders
        , icp.monetary AS total_spent
        , icp.recency
        , icp.tenure
    FROM __dbt__cte__int_customers_segmentation icp
)

, final AS (
SELECT
    s.CUSTOMER_ID
    , s.FIRST_NAME
    , s.LAST_NAME
    , s.EMAIL
    , s.JOIN_DATE
    , s.COUNTRY
    , s.total_orders
    , s.total_spent
    , s.recency
    , s.tenure
    , CASE 
        WHEN s.total_spent > 1000 THEN 'VIP' 
        ELSE 'Regular' 
      END AS customer_segment 
FROM source s
)

SELECT * FROM final
        );
[0m12:13:57.865244 [debug] [Thread-10 ]: Opening a new connection, currently in state init
[0m12:13:57.868104 [debug] [Thread-4  ]: Using snowflake connection "model.billy_bulky.sales"
[0m12:13:57.868447 [debug] [Thread-4  ]: On model.billy_bulky.sales: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.sales"} */
create or replace transient table E_COMMERCE.marts.sales
         as
        (WITH  __dbt__cte__int_sales_trend as (
WITH orders AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__orders
)

, products AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__products
)

, daily_sales AS (
    SELECT
        DATE(ORDER_DATE) AS sale_date
        , COUNT(DISTINCT ORDER_ID) AS total_orders
        , SUM(QUANTITY) AS total_units_sold
        , SUM(QUANTITY * PRICE) AS total_sales_value
    FROM orders AS o
    JOIN products AS p ON o.PRODUCT_ID = p.PRODUCT_ID
    WHERE o.STATUS NOT IN ('cancelled') 
    GROUP BY sale_date
)

, weekly_sales AS (
    SELECT
        DATE_TRUNC('week', sale_date) AS sale_week
        , SUM(total_orders) AS weekly_orders
        , SUM(total_units_sold) AS weekly_units_sold
        , SUM(total_sales_value) AS weekly_sales_value
    FROM daily_sales
    GROUP BY sale_week
)

, monthly_sales AS (
    SELECT
        DATE_TRUNC('month', sale_date) AS sale_month
        , SUM(total_orders) AS monthly_orders
        , SUM(total_units_sold) AS monthly_units_sold
        , SUM(total_sales_value) AS monthly_sales_value
    FROM daily_sales
    GROUP BY sale_month
)

, yearly_sales AS (
    SELECT
        DATE_TRUNC('year', sale_date) AS sale_year
        , SUM(total_orders) AS yearly_orders
        , SUM(total_units_sold) AS yearly_units_sold
        , SUM(total_sales_value) AS yearly_sales_value
    FROM daily_sales
    GROUP BY sale_year
)

SELECT
    d.sale_date
    , d.total_orders AS daily_orders
    , d.total_units_sold AS daily_units_sold
    , d.total_sales_value AS daily_sales_value
    , w.weekly_orders
    , w.weekly_units_sold
    , w.weekly_sales_value
    , m.monthly_orders
    , m.monthly_units_sold
    , m.monthly_sales_value
    , y.yearly_orders
    , y.yearly_units_sold
    , y.yearly_sales_value
FROM daily_sales d
LEFT JOIN weekly_sales w ON DATE_TRUNC('week', d.sale_date) = w.sale_week
LEFT JOIN monthly_sales m ON DATE_TRUNC('month', d.sale_date) = m.sale_month
LEFT JOIN yearly_sales y ON DATE_TRUNC('year', d.sale_date) = y.sale_year
), enriched_orders AS (
    SELECT
        o.ORDER_ID
        , o.CUSTOMER_ID
        , o.PRODUCT_ID
        , o.QUANTITY
        , o.ORDER_DATE
        , o.STATUS
        , p.CATEGORY
        , p.PRICE AS unit_price
        , (o.QUANTITY * p.PRICE) AS total_price
        , c.COUNTRY
    FROM E_COMMERCE.staging.staging_shopify__orders o
    JOIN E_COMMERCE.staging.staging_shopify__products p ON o.PRODUCT_ID = p.PRODUCT_ID
    JOIN E_COMMERCE.staging.staging_shopify__customers c ON o.CUSTOMER_ID = c.CUSTOMER_ID
    WHERE o.STATUS NOT IN ('cancelled') 
)

SELECT
    eo.ORDER_ID
    , eo.CUSTOMER_ID
    , eo.PRODUCT_ID
    , eo.QUANTITY
    , eo.ORDER_DATE
    , eo.STATUS
    , eo.CATEGORY
    , eo.unit_price
    , eo.total_price
    , eo.COUNTRY
    , sa.daily_orders
    , sa.daily_units_sold
    , sa.daily_sales_value
FROM enriched_orders eo
LEFT JOIN __dbt__cte__int_sales_trend sa ON DATE(eo.ORDER_DATE) = sa.sale_date
        );
[0m12:13:57.868812 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m12:13:57.870298 [debug] [Thread-2  ]: Using snowflake connection "model.billy_bulky.products"
[0m12:13:57.871160 [debug] [Thread-2  ]: On model.billy_bulky.products: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.products"} */
create or replace transient table E_COMMERCE.marts.products
         as
        (WITH  __dbt__cte__int_products_performance as (
WITH orders AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__orders
)

, products AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__products
)

, product_sales AS (
    SELECT
        o.PRODUCT_ID
        , COUNT(DISTINCT o.ORDER_ID) AS total_sales
        , SUM(o.QUANTITY) AS total_units_sold
        , SUM(o.QUANTITY * p.PRICE) AS total_sales_value
    FROM orders o
    INNER JOIN products p ON o.PRODUCT_ID = p.PRODUCT_ID
    WHERE o.STATUS NOT IN ('cancelled') 
    GROUP BY o.PRODUCT_ID
)

, product_averages AS (
    SELECT
        PRODUCT_ID
        , (total_sales_value / NULLIF(total_units_sold, 0)) AS average_sale_price
    FROM product_sales
)

, product_stock_turnover AS (
    SELECT
        p.PRODUCT_ID
        , p.STOCK_LEVEL
        , (total_units_sold / NULLIF(p.STOCK_LEVEL, 0)) AS turnover_rate
    FROM product_sales ps
    INNER JOIN products p ON ps.PRODUCT_ID = p.PRODUCT_ID
)

, final AS (
    SELECT
    p.PRODUCT_ID
    , p.NAME
    , p.CATEGORY
    , p.PRICE
    , pa.average_sale_price
    , ps.total_sales
    , ps.total_units_sold
    , ps.total_sales_value
    , pst.turnover_rate
    , p.STOCK_LEVEL
FROM products p
LEFT JOIN product_sales ps ON p.PRODUCT_ID = ps.PRODUCT_ID
LEFT JOIN product_averages pa ON p.PRODUCT_ID = pa.PRODUCT_ID
LEFT JOIN product_stock_turnover pst ON p.PRODUCT_ID = pst.PRODUCT_ID
)

SELECT * FROM final
), final AS (
    SELECT
        pp.PRODUCT_ID
        , pp.NAME
        , pp.CATEGORY
        , pp.PRICE
        , pp.average_sale_price
        , pp.total_sales
        , pp.total_units_sold
        , pp.total_sales_value
        , pp.turnover_rate
        , pp.STOCK_LEVEL
    FROM __dbt__cte__int_products_performance pp
)

SELECT * FROM final
        );
[0m12:13:57.871482 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m12:14:00.489030 [debug] [Thread-10 ]: SQL status: SUCCESS 1 in 3.0 seconds
[0m12:14:00.495811 [debug] [Thread-10 ]: Timing info for model.billy_bulky.customers (execute): 12:13:57.839775 => 12:14:00.495384
[0m12:14:00.496665 [debug] [Thread-10 ]: On model.billy_bulky.customers: Close
[0m12:14:00.626381 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 3.0 seconds
[0m12:14:00.630260 [debug] [Thread-4  ]: Timing info for model.billy_bulky.sales (execute): 12:13:57.862712 => 12:14:00.629941
[0m12:14:00.630861 [debug] [Thread-4  ]: On model.billy_bulky.sales: Close
[0m12:14:03.564060 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 6.0 seconds
[0m12:14:03.570483 [debug] [Thread-2  ]: Timing info for model.billy_bulky.products (execute): 12:13:57.860435 => 12:14:03.570005
[0m12:14:03.572101 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '588fe211-f944-4520-ba29-c9ef28bb2262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11edb9130>]}
[0m12:14:03.573439 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '588fe211-f944-4520-ba29-c9ef28bb2262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11eabe3d0>]}
[0m12:14:03.574126 [debug] [Thread-2  ]: On model.billy_bulky.products: Close
[0m12:14:03.575261 [info ] [Thread-4  ]: 7 of 7 OK created sql table model marts.sales .................................. [[32mSUCCESS 1[0m in 5.75s]
[0m12:14:03.576330 [info ] [Thread-10 ]: 5 of 7 OK created sql table model marts.customers .............................. [[32mSUCCESS 1[0m in 5.77s]
[0m12:14:03.579201 [debug] [Thread-4  ]: Finished running node model.billy_bulky.sales
[0m12:14:03.580025 [debug] [Thread-10 ]: Finished running node model.billy_bulky.customers
[0m12:14:03.945655 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '588fe211-f944-4520-ba29-c9ef28bb2262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ed95df0>]}
[0m12:14:03.947761 [info ] [Thread-2  ]: 6 of 7 OK created sql table model marts.products ............................... [[32mSUCCESS 1[0m in 6.13s]
[0m12:14:03.948933 [debug] [Thread-2  ]: Finished running node model.billy_bulky.products
[0m12:14:03.952028 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:14:03.952633 [debug] [MainThread]: Connection 'model.billy_bulky.staging__shopify__products_history' was properly closed.
[0m12:14:03.953149 [debug] [MainThread]: Connection 'model.billy_bulky.products' was properly closed.
[0m12:14:03.953638 [debug] [MainThread]: Connection 'model.billy_bulky.staging_shopify__orders' was properly closed.
[0m12:14:03.954119 [debug] [MainThread]: Connection 'model.billy_bulky.sales' was properly closed.
[0m12:14:03.954604 [debug] [MainThread]: Connection 'model.billy_bulky.int_customers_segmentation' was properly closed.
[0m12:14:03.955131 [debug] [MainThread]: Connection 'model.billy_bulky.int_products_performance' was properly closed.
[0m12:14:03.955604 [debug] [MainThread]: Connection 'model.billy_bulky.int_sales_trend' was properly closed.
[0m12:14:03.956071 [debug] [MainThread]: Connection 'model.billy_bulky.customers' was properly closed.
[0m12:14:03.956744 [info ] [MainThread]: 
[0m12:14:03.957418 [info ] [MainThread]: Finished running 4 view models, 3 table models in 0 hours 0 minutes and 12.74 seconds (12.74s).
[0m12:14:03.959464 [debug] [MainThread]: Command end result
[0m12:14:03.978287 [info ] [MainThread]: 
[0m12:14:03.978860 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:14:03.979275 [info ] [MainThread]: 
[0m12:14:03.979678 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m12:14:03.982994 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.848959, "process_user_time": 5.294464, "process_kernel_time": 0.48849, "process_mem_max_rss": "215007232", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:14:03.983660 [debug] [MainThread]: Command `dbt run` succeeded at 12:14:03.983517 after 13.85 seconds
[0m12:14:03.984085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d564f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e9afdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e9af610>]}
[0m12:14:03.984536 [debug] [MainThread]: Flushing usage events
[0m12:20:27.200161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bfa0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109465850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109465a60>]}


============================== 12:20:27.203007 | 09def3bd-13ad-49b1-9933-c3d18c2519c5 ==============================
[0m12:20:27.203007 [info ] [MainThread]: Running with dbt=1.7.1
[0m12:20:27.203409 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/bitlevi/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/bitlevi/Documents/billy_bulky_ecommerce/billy_bulky_ecommerce/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:20:28.049378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '09def3bd-13ad-49b1-9933-c3d18c2519c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094483d0>]}
[0m12:20:28.097047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '09def3bd-13ad-49b1-9933-c3d18c2519c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fa6a130>]}
[0m12:20:28.097771 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m12:20:28.111478 [debug] [MainThread]: checksum: ad428e6dc3b353dcb23d0c4ebea8b20b180e94b873271ac2a054a8e446dac0e2, vars: {}, profile: , target: , version: 1.7.1
[0m12:20:28.122606 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m12:20:28.122960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '09def3bd-13ad-49b1-9933-c3d18c2519c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11faadb20>]}
[0m12:20:28.843461 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'orders' in the 'models' section of file 'models/staging/shopify/_shopify__schema.yml'
[0m12:20:28.953865 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'marts_sales' in the 'models' section of file 'models/marts/_marts__models.yml'
[0m12:20:28.955393 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'marts_customers' in the 'models' section of file 'models/marts/_marts__models.yml'
[0m12:20:28.956525 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'marts_products' in the 'models' section of file 'models/marts/_marts__models.yml'
[0m12:20:29.036716 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.unique_orders_order_id.fed79b3a6e' (models/staging/shopify/_shopify__schema.yml) depends on a node named 'orders' in package '' which was not found
[0m12:20:29.037075 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_orders_order_id.cf6c17daed' (models/staging/shopify/_shopify__schema.yml) depends on a node named 'orders' in package '' which was not found
[0m12:20:29.037312 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_orders_customer_id.c5f02694af' (models/staging/shopify/_shopify__schema.yml) depends on a node named 'orders' in package '' which was not found
[0m12:20:29.037545 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_orders_product_id.3523c78a66' (models/staging/shopify/_shopify__schema.yml) depends on a node named 'orders' in package '' which was not found
[0m12:20:29.037757 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_orders_quantity.0e6bb23b03' (models/staging/shopify/_shopify__schema.yml) depends on a node named 'orders' in package '' which was not found
[0m12:20:29.037969 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_orders_order_date.6910a855fe' (models/staging/shopify/_shopify__schema.yml) depends on a node named 'orders' in package '' which was not found
[0m12:20:29.038177 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_orders_status.8a27272c0a' (models/staging/shopify/_shopify__schema.yml) depends on a node named 'orders' in package '' which was not found
[0m12:20:29.038389 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.accepted_values_orders_status__cancelled__processing__delivered__shipped.fbff2d9925' (models/staging/shopify/_shopify__schema.yml) depends on a node named 'orders' in package '' which was not found
[0m12:20:29.038629 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.unique_marts_sales_order_id.825e23650b' (models/marts/_marts__models.yml) depends on a node named 'marts_sales' in package '' which was not found
[0m12:20:29.038842 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_sales_order_id.842b56ef2f' (models/marts/_marts__models.yml) depends on a node named 'marts_sales' in package '' which was not found
[0m12:20:29.039054 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_sales_customer_id.189ac71c42' (models/marts/_marts__models.yml) depends on a node named 'marts_sales' in package '' which was not found
[0m12:20:29.039270 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.relationships_marts_sales_customer_id__customer_id__ref_customers_.74e21c3398' (models/marts/_marts__models.yml) depends on a node named 'marts_sales' in package '' which was not found
[0m12:20:29.039480 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_sales_product_id.12beecf4f2' (models/marts/_marts__models.yml) depends on a node named 'marts_sales' in package '' which was not found
[0m12:20:29.039692 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.relationships_marts_sales_product_id__product_id__ref_products_.77e7665182' (models/marts/_marts__models.yml) depends on a node named 'marts_sales' in package '' which was not found
[0m12:20:29.039902 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_sales_quantity.ea8c580869' (models/marts/_marts__models.yml) depends on a node named 'marts_sales' in package '' which was not found
[0m12:20:29.040107 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_sales_order_date.90eaa9e7fe' (models/marts/_marts__models.yml) depends on a node named 'marts_sales' in package '' which was not found
[0m12:20:29.040312 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_sales_status.e9b4b90247' (models/marts/_marts__models.yml) depends on a node named 'marts_sales' in package '' which was not found
[0m12:20:29.040517 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_sales_category.a98218f68d' (models/marts/_marts__models.yml) depends on a node named 'marts_sales' in package '' which was not found
[0m12:20:29.040724 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_sales_unit_price.321f152a2a' (models/marts/_marts__models.yml) depends on a node named 'marts_sales' in package '' which was not found
[0m12:20:29.040947 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_sales_total_price.015724a7e6' (models/marts/_marts__models.yml) depends on a node named 'marts_sales' in package '' which was not found
[0m12:20:29.041153 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_sales_country.5f628b732c' (models/marts/_marts__models.yml) depends on a node named 'marts_sales' in package '' which was not found
[0m12:20:29.041359 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.unique_marts_customers_customer_id.9c72620f57' (models/marts/_marts__models.yml) depends on a node named 'marts_customers' in package '' which was not found
[0m12:20:29.041566 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_customers_customer_id.fc7763eff9' (models/marts/_marts__models.yml) depends on a node named 'marts_customers' in package '' which was not found
[0m12:20:29.041772 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.unique_marts_customers_email.6210d26820' (models/marts/_marts__models.yml) depends on a node named 'marts_customers' in package '' which was not found
[0m12:20:29.041978 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_customers_email.637d2131e6' (models/marts/_marts__models.yml) depends on a node named 'marts_customers' in package '' which was not found
[0m12:20:29.042183 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_customers_join_date.6378efd424' (models/marts/_marts__models.yml) depends on a node named 'marts_customers' in package '' which was not found
[0m12:20:29.042391 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_customers_total_orders.7cdc5122e5' (models/marts/_marts__models.yml) depends on a node named 'marts_customers' in package '' which was not found
[0m12:20:29.042595 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_customers_total_spent.d5343aecc7' (models/marts/_marts__models.yml) depends on a node named 'marts_customers' in package '' which was not found
[0m12:20:29.042805 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.unique_marts_products_product_id.e96f554683' (models/marts/_marts__models.yml) depends on a node named 'marts_products' in package '' which was not found
[0m12:20:29.043015 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_products_product_id.9b354ae761' (models/marts/_marts__models.yml) depends on a node named 'marts_products' in package '' which was not found
[0m12:20:29.043226 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_products_name.f0d9c8d191' (models/marts/_marts__models.yml) depends on a node named 'marts_products' in package '' which was not found
[0m12:20:29.043433 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_products_category.1212ed3683' (models/marts/_marts__models.yml) depends on a node named 'marts_products' in package '' which was not found
[0m12:20:29.043640 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_products_price.d6207a2896' (models/marts/_marts__models.yml) depends on a node named 'marts_products' in package '' which was not found
[0m12:20:29.043851 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_products_total_units_sold.6822a804df' (models/marts/_marts__models.yml) depends on a node named 'marts_products' in package '' which was not found
[0m12:20:29.044063 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_products_total_sales_value.b0a2a654b3' (models/marts/_marts__models.yml) depends on a node named 'marts_products' in package '' which was not found
[0m12:20:29.074355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '09def3bd-13ad-49b1-9933-c3d18c2519c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x140ebdfd0>]}
[0m12:20:29.087779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '09def3bd-13ad-49b1-9933-c3d18c2519c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x140363880>]}
[0m12:20:29.088124 [info ] [MainThread]: Found 10 models, 1 snapshot, 1 seed, 47 tests, 4 sources, 0 exposures, 0 metrics, 431 macros, 0 groups, 0 semantic models
[0m12:20:29.088348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09def3bd-13ad-49b1-9933-c3d18c2519c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fba2550>]}
[0m12:20:29.089884 [info ] [MainThread]: 
[0m12:20:29.090364 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:20:29.091135 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE'
[0m12:20:29.099677 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE"
[0m12:20:29.100179 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE'
[0m12:20:29.100385 [debug] [ThreadPool]: On list_E_COMMERCE: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE"} */
show terse schemas in database E_COMMERCE
    limit 10000
[0m12:20:29.101858 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE"
[0m12:20:29.102062 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:20:29.102250 [debug] [ThreadPool]: On list_E_COMMERCE: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE"} */
show terse schemas in database E_COMMERCE
    limit 10000
[0m12:20:29.103278 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:20:30.676450 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.0 seconds
[0m12:20:30.680468 [debug] [ThreadPool]: On list_E_COMMERCE: Close
[0m12:20:30.688051 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.0 seconds
[0m12:20:30.690511 [debug] [ThreadPool]: On list_E_COMMERCE: Close
[0m12:20:31.059973 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_E_COMMERCE, now list_E_COMMERCE_marts)
[0m12:20:31.064043 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_E_COMMERCE, now list_E_COMMERCE_snapshots)
[0m12:20:31.137121 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_snapshots"
[0m12:20:31.137717 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PUBLIC'
[0m12:20:31.140938 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_marts"
[0m12:20:31.141191 [debug] [ThreadPool]: On list_E_COMMERCE_snapshots: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE_snapshots"} */
show terse objects in E_COMMERCE.snapshots limit 10000
[0m12:20:31.141703 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_staging'
[0m12:20:31.143363 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PUBLIC"
[0m12:20:31.143601 [debug] [ThreadPool]: On list_E_COMMERCE_marts: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE_marts"} */
show terse objects in E_COMMERCE.marts limit 10000
[0m12:20:31.143807 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:20:31.145169 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_staging"
[0m12:20:31.145392 [debug] [ThreadPool]: On list_E_COMMERCE_PUBLIC: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE_PUBLIC"} */
show terse objects in E_COMMERCE.PUBLIC limit 10000
[0m12:20:31.145586 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:20:31.146562 [debug] [ThreadPool]: On list_E_COMMERCE_staging: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE_staging"} */
show terse objects in E_COMMERCE.staging limit 10000
[0m12:20:31.146811 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:20:31.147573 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:20:32.432290 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m12:20:32.439335 [debug] [ThreadPool]: On list_E_COMMERCE_staging: Close
[0m12:20:32.446075 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:20:32.448873 [debug] [ThreadPool]: On list_E_COMMERCE_snapshots: Close
[0m12:20:35.053107 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 4.0 seconds
[0m12:20:35.058100 [debug] [ThreadPool]: On list_E_COMMERCE_marts: Close
[0m12:20:35.104447 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b079e8-0001-8184-0004-d8be00010566
[0m12:20:35.104792 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m12:20:35.105147 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m12:20:35.105411 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m12:20:35.105711 [debug] [ThreadPool]: On list_E_COMMERCE_PUBLIC: Close
[0m12:20:35.460643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09def3bd-13ad-49b1-9933-c3d18c2519c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x140ebd250>]}
[0m12:20:35.462448 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m12:20:35.463070 [info ] [MainThread]: 
[0m12:20:35.467921 [debug] [Thread-1  ]: Began running node model.billy_bulky.staging__shopify__products_history
[0m12:20:35.468768 [debug] [Thread-2  ]: Began running node model.billy_bulky.staging_shopify__customers
[0m12:20:35.471397 [debug] [Thread-4  ]: Began running node model.billy_bulky.staging_shopify__products
[0m12:20:35.469515 [debug] [Thread-3  ]: Began running node model.billy_bulky.staging_shopify__orders
[0m12:20:35.470663 [info ] [Thread-1  ]: 1 of 7 START sql view model staging.staging__shopify__products_history ......... [RUN]
[0m12:20:35.473273 [info ] [Thread-2  ]: 2 of 7 START sql view model staging.staging_shopify__customers ................. [RUN]
[0m12:20:35.474090 [info ] [Thread-4  ]: 4 of 7 START sql view model staging.staging_shopify__products .................. [RUN]
[0m12:20:35.474810 [info ] [Thread-3  ]: 3 of 7 START sql view model staging.staging_shopify__orders .................... [RUN]
[0m12:20:35.475962 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_E_COMMERCE_marts, now model.billy_bulky.staging__shopify__products_history)
[0m12:20:35.476965 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_E_COMMERCE_snapshots, now model.billy_bulky.staging_shopify__customers)
[0m12:20:35.477997 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.billy_bulky.staging_shopify__products'
[0m12:20:35.478998 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.billy_bulky.staging_shopify__orders'
[0m12:20:35.479545 [debug] [Thread-1  ]: Began compiling node model.billy_bulky.staging__shopify__products_history
[0m12:20:35.480067 [debug] [Thread-2  ]: Began compiling node model.billy_bulky.staging_shopify__customers
[0m12:20:35.480583 [debug] [Thread-4  ]: Began compiling node model.billy_bulky.staging_shopify__products
[0m12:20:35.481098 [debug] [Thread-3  ]: Began compiling node model.billy_bulky.staging_shopify__orders
[0m12:20:35.491925 [debug] [Thread-1  ]: Writing injected SQL for node "model.billy_bulky.staging__shopify__products_history"
[0m12:20:35.495393 [debug] [Thread-2  ]: Writing injected SQL for node "model.billy_bulky.staging_shopify__customers"
[0m12:20:35.499060 [debug] [Thread-4  ]: Writing injected SQL for node "model.billy_bulky.staging_shopify__products"
[0m12:20:35.502297 [debug] [Thread-3  ]: Writing injected SQL for node "model.billy_bulky.staging_shopify__orders"
[0m12:20:35.503258 [debug] [Thread-2  ]: Timing info for model.billy_bulky.staging_shopify__customers (compile): 12:20:35.492280 => 12:20:35.502973
[0m12:20:35.503769 [debug] [Thread-2  ]: Began executing node model.billy_bulky.staging_shopify__customers
[0m12:20:35.504333 [debug] [Thread-4  ]: Timing info for model.billy_bulky.staging_shopify__products (compile): 12:20:35.495779 => 12:20:35.504099
[0m12:20:35.510847 [debug] [Thread-1  ]: Timing info for model.billy_bulky.staging__shopify__products_history (compile): 12:20:35.481443 => 12:20:35.510500
[0m12:20:35.522775 [debug] [Thread-3  ]: Timing info for model.billy_bulky.staging_shopify__orders (compile): 12:20:35.499402 => 12:20:35.522576
[0m12:20:35.529554 [debug] [Thread-4  ]: Began executing node model.billy_bulky.staging_shopify__products
[0m12:20:35.530042 [debug] [Thread-2  ]: Writing runtime sql for node "model.billy_bulky.staging_shopify__customers"
[0m12:20:35.530366 [debug] [Thread-1  ]: Began executing node model.billy_bulky.staging__shopify__products_history
[0m12:20:35.530635 [debug] [Thread-3  ]: Began executing node model.billy_bulky.staging_shopify__orders
[0m12:20:35.534141 [debug] [Thread-4  ]: Writing runtime sql for node "model.billy_bulky.staging_shopify__products"
[0m12:20:35.536586 [debug] [Thread-1  ]: Writing runtime sql for node "model.billy_bulky.staging__shopify__products_history"
[0m12:20:35.538758 [debug] [Thread-3  ]: Writing runtime sql for node "model.billy_bulky.staging_shopify__orders"
[0m12:20:35.539744 [debug] [Thread-1  ]: Using snowflake connection "model.billy_bulky.staging__shopify__products_history"
[0m12:20:35.540038 [debug] [Thread-1  ]: On model.billy_bulky.staging__shopify__products_history: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.staging__shopify__products_history"} */
create or replace   view E_COMMERCE.staging.staging__shopify__products_history
  
   as (
    WITH products AS (
    SELECT * FROM E_COMMERCE.SNAPSHOTS.products_snapshot
)

SELECT
    PRODUCT_ID
    , NAME
    , CATEGORY
    , PRICE
    , STOCK_LEVEL
    , DBT_SCD_ID
    , DBT_UPDATED_AT
    , DBT_VALID_FROM
    , DBT_VALID_TO
FROM products
  );
[0m12:20:35.540550 [debug] [Thread-2  ]: Using snowflake connection "model.billy_bulky.staging_shopify__customers"
[0m12:20:35.540796 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:20:35.541243 [debug] [Thread-4  ]: Using snowflake connection "model.billy_bulky.staging_shopify__products"
[0m12:20:35.541690 [debug] [Thread-3  ]: Using snowflake connection "model.billy_bulky.staging_shopify__orders"
[0m12:20:35.541946 [debug] [Thread-2  ]: On model.billy_bulky.staging_shopify__customers: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.staging_shopify__customers"} */
create or replace   view E_COMMERCE.staging.staging_shopify__customers
  
   as (
    WITH customers AS (
    SELECT * FROM SHOPIFY.PUBLIC.customers
)

SELECT
    CUSTOMER_ID
    , FIRST_NAME
    , LAST_NAME
    , EMAIL
    , JOIN_DATE
    , COUNTRY
FROM customers
  );
[0m12:20:35.542647 [debug] [Thread-4  ]: On model.billy_bulky.staging_shopify__products: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.staging_shopify__products"} */
create or replace   view E_COMMERCE.staging.staging_shopify__products
  
   as (
    WITH products AS (
    SELECT * FROM SHOPIFY.PUBLIC.products
)

SELECT
    PRODUCT_ID
    , NAME
    , CATEGORY
    , PRICE
    , STOCK_LEVEL
FROM products
  );
[0m12:20:35.543207 [debug] [Thread-3  ]: On model.billy_bulky.staging_shopify__orders: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.staging_shopify__orders"} */
create or replace   view E_COMMERCE.staging.staging_shopify__orders
  
   as (
    WITH orders AS (
    SELECT * FROM SHOPIFY.PUBLIC.orders
)

SELECT
    ORDER_ID
    , CUSTOMER_ID
    , PRODUCT_ID
    , QUANTITY
    , ORDER_DATE
    , STATUS
FROM orders
  );
[0m12:20:35.543508 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m12:20:35.543750 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m12:20:35.543992 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m12:20:36.871156 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:20:36.898232 [debug] [Thread-3  ]: Timing info for model.billy_bulky.staging_shopify__orders (execute): 12:20:35.536797 => 12:20:36.898007
[0m12:20:36.898900 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:20:36.899300 [debug] [Thread-3  ]: On model.billy_bulky.staging_shopify__orders: Close
[0m12:20:36.901666 [debug] [Thread-2  ]: Timing info for model.billy_bulky.staging_shopify__customers (execute): 12:20:35.504563 => 12:20:36.901463
[0m12:20:36.903086 [debug] [Thread-2  ]: On model.billy_bulky.staging_shopify__customers: Close
[0m12:20:36.913599 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:20:36.915890 [debug] [Thread-1  ]: Timing info for model.billy_bulky.staging__shopify__products_history (execute): 12:20:35.534399 => 12:20:36.915684
[0m12:20:36.916250 [debug] [Thread-1  ]: On model.billy_bulky.staging__shopify__products_history: Close
[0m12:20:37.008326 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:20:37.013181 [debug] [Thread-4  ]: Timing info for model.billy_bulky.staging_shopify__products (execute): 12:20:35.530804 => 12:20:37.012922
[0m12:20:37.013645 [debug] [Thread-4  ]: On model.billy_bulky.staging_shopify__products: Close
[0m12:20:37.271730 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09def3bd-13ad-49b1-9933-c3d18c2519c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ff0d7f0>]}
[0m12:20:37.275675 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09def3bd-13ad-49b1-9933-c3d18c2519c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x141813040>]}
[0m12:20:37.274036 [info ] [Thread-2  ]: 2 of 7 OK created sql view model staging.staging_shopify__customers ............ [[32mSUCCESS 1[0m in 1.79s]
[0m12:20:37.276958 [info ] [Thread-1  ]: 1 of 7 OK created sql view model staging.staging__shopify__products_history .... [[32mSUCCESS 1[0m in 1.80s]
[0m12:20:37.277987 [debug] [Thread-2  ]: Finished running node model.billy_bulky.staging_shopify__customers
[0m12:20:37.278930 [debug] [Thread-1  ]: Finished running node model.billy_bulky.staging__shopify__products_history
[0m12:20:37.326493 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09def3bd-13ad-49b1-9933-c3d18c2519c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1403fe760>]}
[0m12:20:37.327421 [info ] [Thread-3  ]: 3 of 7 OK created sql view model staging.staging_shopify__orders ............... [[32mSUCCESS 1[0m in 1.85s]
[0m12:20:37.328207 [debug] [Thread-3  ]: Finished running node model.billy_bulky.staging_shopify__orders
[0m12:20:37.378645 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09def3bd-13ad-49b1-9933-c3d18c2519c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x140396c10>]}
[0m12:20:37.379662 [info ] [Thread-4  ]: 4 of 7 OK created sql view model staging.staging_shopify__products ............. [[32mSUCCESS 1[0m in 1.90s]
[0m12:20:37.380533 [debug] [Thread-4  ]: Finished running node model.billy_bulky.staging_shopify__products
[0m12:20:37.381566 [debug] [Thread-6  ]: Began running node model.billy_bulky.int_customers_segmentation
[0m12:20:37.382225 [debug] [Thread-7  ]: Began running node model.billy_bulky.int_products_performance
[0m12:20:37.382909 [debug] [Thread-8  ]: Began running node model.billy_bulky.int_sales_trend
[0m12:20:37.383942 [debug] [Thread-6  ]: Acquiring new snowflake connection 'model.billy_bulky.int_customers_segmentation'
[0m12:20:37.384866 [debug] [Thread-7  ]: Acquiring new snowflake connection 'model.billy_bulky.int_products_performance'
[0m12:20:37.385722 [debug] [Thread-8  ]: Acquiring new snowflake connection 'model.billy_bulky.int_sales_trend'
[0m12:20:37.386185 [debug] [Thread-6  ]: Began compiling node model.billy_bulky.int_customers_segmentation
[0m12:20:37.386626 [debug] [Thread-7  ]: Began compiling node model.billy_bulky.int_products_performance
[0m12:20:37.387061 [debug] [Thread-8  ]: Began compiling node model.billy_bulky.int_sales_trend
[0m12:20:37.391964 [debug] [Thread-6  ]: Writing injected SQL for node "model.billy_bulky.int_customers_segmentation"
[0m12:20:37.395824 [debug] [Thread-7  ]: Writing injected SQL for node "model.billy_bulky.int_products_performance"
[0m12:20:37.399765 [debug] [Thread-8  ]: Writing injected SQL for node "model.billy_bulky.int_sales_trend"
[0m12:20:37.400829 [debug] [Thread-8  ]: Timing info for model.billy_bulky.int_sales_trend (compile): 12:20:37.396186 => 12:20:37.400549
[0m12:20:37.401329 [debug] [Thread-7  ]: Timing info for model.billy_bulky.int_products_performance (compile): 12:20:37.392301 => 12:20:37.401097
[0m12:20:37.401767 [debug] [Thread-6  ]: Timing info for model.billy_bulky.int_customers_segmentation (compile): 12:20:37.387337 => 12:20:37.401561
[0m12:20:37.402782 [debug] [Thread-8  ]: Finished running node model.billy_bulky.int_sales_trend
[0m12:20:37.403598 [debug] [Thread-7  ]: Finished running node model.billy_bulky.int_products_performance
[0m12:20:37.404351 [debug] [Thread-6  ]: Finished running node model.billy_bulky.int_customers_segmentation
[0m12:20:37.405205 [debug] [Thread-10 ]: Began running node model.billy_bulky.customers
[0m12:20:37.405617 [debug] [Thread-5  ]: Began running node model.billy_bulky.products
[0m12:20:37.406091 [info ] [Thread-10 ]: 5 of 7 START sql table model marts.customers ................................... [RUN]
[0m12:20:37.406520 [debug] [Thread-2  ]: Began running node model.billy_bulky.sales
[0m12:20:37.406915 [info ] [Thread-5  ]: 6 of 7 START sql table model marts.products .................................... [RUN]
[0m12:20:37.407652 [debug] [Thread-10 ]: Acquiring new snowflake connection 'model.billy_bulky.customers'
[0m12:20:37.408092 [info ] [Thread-2  ]: 7 of 7 START sql table model marts.sales ....................................... [RUN]
[0m12:20:37.408841 [debug] [Thread-5  ]: Acquiring new snowflake connection 'model.billy_bulky.products'
[0m12:20:37.409230 [debug] [Thread-10 ]: Began compiling node model.billy_bulky.customers
[0m12:20:37.409895 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.billy_bulky.staging_shopify__customers, now model.billy_bulky.sales)
[0m12:20:37.410278 [debug] [Thread-5  ]: Began compiling node model.billy_bulky.products
[0m12:20:37.419733 [debug] [Thread-10 ]: Writing injected SQL for node "model.billy_bulky.customers"
[0m12:20:37.420053 [debug] [Thread-2  ]: Began compiling node model.billy_bulky.sales
[0m12:20:37.425167 [debug] [Thread-5  ]: Writing injected SQL for node "model.billy_bulky.products"
[0m12:20:37.435100 [debug] [Thread-2  ]: Writing injected SQL for node "model.billy_bulky.sales"
[0m12:20:37.435672 [debug] [Thread-10 ]: Timing info for model.billy_bulky.customers (compile): 12:20:37.410505 => 12:20:37.435508
[0m12:20:37.435972 [debug] [Thread-10 ]: Began executing node model.billy_bulky.customers
[0m12:20:37.448564 [debug] [Thread-2  ]: Timing info for model.billy_bulky.sales (compile): 12:20:37.425462 => 12:20:37.448355
[0m12:20:37.448907 [debug] [Thread-5  ]: Timing info for model.billy_bulky.products (compile): 12:20:37.420254 => 12:20:37.448750
[0m12:20:37.452624 [debug] [Thread-10 ]: Writing runtime sql for node "model.billy_bulky.customers"
[0m12:20:37.452875 [debug] [Thread-2  ]: Began executing node model.billy_bulky.sales
[0m12:20:37.453117 [debug] [Thread-5  ]: Began executing node model.billy_bulky.products
[0m12:20:37.455004 [debug] [Thread-2  ]: Writing runtime sql for node "model.billy_bulky.sales"
[0m12:20:37.456820 [debug] [Thread-5  ]: Writing runtime sql for node "model.billy_bulky.products"
[0m12:20:37.458654 [debug] [Thread-5  ]: Using snowflake connection "model.billy_bulky.products"
[0m12:20:37.458974 [debug] [Thread-5  ]: On model.billy_bulky.products: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.products"} */
create or replace transient table E_COMMERCE.marts.products
         as
        (WITH  __dbt__cte__int_products_performance as (
WITH orders AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__orders
)

, products AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__products
)

, product_sales AS (
    SELECT
        o.PRODUCT_ID
        , COUNT(DISTINCT o.ORDER_ID) AS total_sales
        , SUM(o.QUANTITY) AS total_units_sold
        , SUM(o.QUANTITY * p.PRICE) AS total_sales_value
    FROM orders o
    INNER JOIN products p ON o.PRODUCT_ID = p.PRODUCT_ID
    WHERE o.STATUS NOT IN ('cancelled') 
    GROUP BY o.PRODUCT_ID
)

, product_averages AS (
    SELECT
        PRODUCT_ID
        , (total_sales_value / NULLIF(total_units_sold, 0)) AS average_sale_price
    FROM product_sales
)

, product_stock_turnover AS (
    SELECT
        p.PRODUCT_ID
        , p.STOCK_LEVEL
        , (total_units_sold / NULLIF(p.STOCK_LEVEL, 0)) AS turnover_rate
    FROM product_sales ps
    INNER JOIN products p ON ps.PRODUCT_ID = p.PRODUCT_ID
)

, final AS (
    SELECT
    p.PRODUCT_ID
    , p.NAME
    , p.CATEGORY
    , p.PRICE
    , pa.average_sale_price
    , ps.total_sales
    , ps.total_units_sold
    , ps.total_sales_value
    , pst.turnover_rate
    , p.STOCK_LEVEL
FROM products p
LEFT JOIN product_sales ps ON p.PRODUCT_ID = ps.PRODUCT_ID
LEFT JOIN product_averages pa ON p.PRODUCT_ID = pa.PRODUCT_ID
LEFT JOIN product_stock_turnover pst ON p.PRODUCT_ID = pst.PRODUCT_ID
)

SELECT * FROM final
), final AS (
    SELECT
        pp.PRODUCT_ID
        , pp.NAME
        , pp.CATEGORY
        , pp.PRICE
        , pp.average_sale_price
        , pp.total_sales
        , pp.total_units_sold
        , pp.total_sales_value
        , pp.turnover_rate
        , pp.STOCK_LEVEL
    FROM __dbt__cte__int_products_performance pp
)

SELECT * FROM final
        );
[0m12:20:37.461394 [debug] [Thread-2  ]: Using snowflake connection "model.billy_bulky.sales"
[0m12:20:37.463234 [debug] [Thread-10 ]: Using snowflake connection "model.billy_bulky.customers"
[0m12:20:37.463480 [debug] [Thread-5  ]: Opening a new connection, currently in state init
[0m12:20:37.463827 [debug] [Thread-2  ]: On model.billy_bulky.sales: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.sales"} */
create or replace transient table E_COMMERCE.marts.sales
         as
        (WITH  __dbt__cte__int_sales_trend as (
WITH orders AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__orders
)

, products AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__products
)

, daily_sales AS (
    SELECT
        DATE(ORDER_DATE) AS sale_date
        , COUNT(DISTINCT ORDER_ID) AS total_orders
        , SUM(QUANTITY) AS total_units_sold
        , SUM(QUANTITY * PRICE) AS total_sales_value
    FROM orders AS o
    JOIN products AS p ON o.PRODUCT_ID = p.PRODUCT_ID
    WHERE o.STATUS NOT IN ('cancelled') 
    GROUP BY sale_date
)

, weekly_sales AS (
    SELECT
        DATE_TRUNC('week', sale_date) AS sale_week
        , SUM(total_orders) AS weekly_orders
        , SUM(total_units_sold) AS weekly_units_sold
        , SUM(total_sales_value) AS weekly_sales_value
    FROM daily_sales
    GROUP BY sale_week
)

, monthly_sales AS (
    SELECT
        DATE_TRUNC('month', sale_date) AS sale_month
        , SUM(total_orders) AS monthly_orders
        , SUM(total_units_sold) AS monthly_units_sold
        , SUM(total_sales_value) AS monthly_sales_value
    FROM daily_sales
    GROUP BY sale_month
)

, yearly_sales AS (
    SELECT
        DATE_TRUNC('year', sale_date) AS sale_year
        , SUM(total_orders) AS yearly_orders
        , SUM(total_units_sold) AS yearly_units_sold
        , SUM(total_sales_value) AS yearly_sales_value
    FROM daily_sales
    GROUP BY sale_year
)

SELECT
    d.sale_date
    , d.total_orders AS daily_orders
    , d.total_units_sold AS daily_units_sold
    , d.total_sales_value AS daily_sales_value
    , w.weekly_orders
    , w.weekly_units_sold
    , w.weekly_sales_value
    , m.monthly_orders
    , m.monthly_units_sold
    , m.monthly_sales_value
    , y.yearly_orders
    , y.yearly_units_sold
    , y.yearly_sales_value
FROM daily_sales d
LEFT JOIN weekly_sales w ON DATE_TRUNC('week', d.sale_date) = w.sale_week
LEFT JOIN monthly_sales m ON DATE_TRUNC('month', d.sale_date) = m.sale_month
LEFT JOIN yearly_sales y ON DATE_TRUNC('year', d.sale_date) = y.sale_year
), enriched_orders AS (
    SELECT
        o.ORDER_ID
        , o.CUSTOMER_ID
        , o.PRODUCT_ID
        , o.QUANTITY
        , o.ORDER_DATE
        , o.STATUS
        , p.CATEGORY
        , p.PRICE AS unit_price
        , (o.QUANTITY * p.PRICE) AS total_price
        , c.COUNTRY
    FROM E_COMMERCE.staging.staging_shopify__orders o
    JOIN E_COMMERCE.staging.staging_shopify__products p ON o.PRODUCT_ID = p.PRODUCT_ID
    JOIN E_COMMERCE.staging.staging_shopify__customers c ON o.CUSTOMER_ID = c.CUSTOMER_ID
    WHERE o.STATUS NOT IN ('cancelled') 
)

SELECT
    eo.ORDER_ID
    , eo.CUSTOMER_ID
    , eo.PRODUCT_ID
    , eo.QUANTITY
    , eo.ORDER_DATE
    , eo.STATUS
    , eo.CATEGORY
    , eo.unit_price
    , eo.total_price
    , eo.COUNTRY
    , sa.daily_orders
    , sa.daily_units_sold
    , sa.daily_sales_value
FROM enriched_orders eo
LEFT JOIN __dbt__cte__int_sales_trend sa ON DATE(eo.ORDER_DATE) = sa.sale_date
        );
[0m12:20:37.464256 [debug] [Thread-10 ]: On model.billy_bulky.customers: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.customers"} */
create or replace transient table E_COMMERCE.marts.customers
         as
        (WITH  __dbt__cte__int_customers_segmentation as (
WITH customers AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__customers
)

, orders AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__orders
)

, products AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__products
)

, order_aggregates AS (
    SELECT
        o.CUSTOMER_ID
        , COUNT(DISTINCT o.ORDER_ID) AS frequency
        , SUM(o.QUANTITY * p.PRICE) AS monetary
        , AVG(o.QUANTITY * p.PRICE) AS average_order_value
        , MAX(o.ORDER_DATE) AS last_purchase_date
        , COUNT(CASE WHEN o.STATUS = 'cancelled' THEN 1 END) AS cancelled_orders
        , COUNT(*) AS total_orders
    FROM orders o
    JOIN products p ON o.PRODUCT_ID = p.PRODUCT_ID
    GROUP BY o.CUSTOMER_ID
)

, customer_tenure AS (
    SELECT
        CUSTOMER_ID
        , JOIN_DATE
        , CURRENT_DATE - JOIN_DATE AS tenure
    FROM customers
)

, customer_recency AS (
    SELECT
        CUSTOMER_ID
        , CURRENT_DATE - last_purchase_date AS recency
    FROM order_aggregates
)

, final AS (
    SELECT
        c.CUSTOMER_ID
        , c.FIRST_NAME
        , c.LAST_NAME
        , c.EMAIL
        , c.JOIN_DATE
        , c.COUNTRY
        , o.frequency
        , o.monetary
        , o.average_order_value
        , o.cancelled_orders
        , o.total_orders
        , CASE 
            WHEN o.total_orders > 0 THEN ROUND((o.cancelled_orders::FLOAT / o.total_orders) * 100, 2) 
            ELSE 0 
          END AS cancellation_rate
        , r.recency
        , t.tenure
    FROM customer_tenure t
    JOIN customers c ON t.CUSTOMER_ID = c.CUSTOMER_ID
    JOIN order_aggregates o ON c.CUSTOMER_ID = o.CUSTOMER_ID
    JOIN customer_recency r ON c.CUSTOMER_ID = r.CUSTOMER_ID
)

SELECT * FROM final
), source AS (
    SELECT
        icp.CUSTOMER_ID
        , icp.FIRST_NAME
        , icp.LAST_NAME
        , icp.EMAIL
        , icp.JOIN_DATE
        , icp.COUNTRY
        , icp.frequency AS total_orders
        , icp.monetary AS total_spent
        , icp.recency
        , icp.tenure
    FROM __dbt__cte__int_customers_segmentation icp
)

, final AS (
SELECT
    s.CUSTOMER_ID
    , s.FIRST_NAME
    , s.LAST_NAME
    , s.EMAIL
    , s.JOIN_DATE
    , s.COUNTRY
    , s.total_orders
    , s.total_spent
    , s.recency
    , s.tenure
    CASE
        WHEN total_spent > 1000 THEN 'VIP'
        ELSE 'Regular'
    END AS customer_segment
FROM source s
)

SELECT * FROM final
        );
[0m12:20:37.464754 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m12:20:37.465216 [debug] [Thread-10 ]: Opening a new connection, currently in state init
[0m12:20:38.699063 [debug] [Thread-10 ]: Snowflake adapter: Snowflake query id: 01b079e8-0001-8184-0004-d8be00010576
[0m12:20:38.699682 [debug] [Thread-10 ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 99 at position 8 unexpected 'WHEN'.
syntax error line 105 at position 0 unexpected 'SELECT'.
[0m12:20:38.700361 [debug] [Thread-10 ]: Timing info for model.billy_bulky.customers (execute): 12:20:37.436160 => 12:20:38.700083
[0m12:20:38.700844 [debug] [Thread-10 ]: On model.billy_bulky.customers: Close
[0m12:20:39.073974 [debug] [Thread-10 ]: Database Error in model customers (models/marts/customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 99 at position 8 unexpected 'WHEN'.
  syntax error line 105 at position 0 unexpected 'SELECT'.
  compiled Code at target/run/billy_bulky/models/marts/customers.sql
[0m12:20:39.074836 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09def3bd-13ad-49b1-9933-c3d18c2519c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x140a4c0a0>]}
[0m12:20:39.075748 [error] [Thread-10 ]: 5 of 7 ERROR creating sql table model marts.customers .......................... [[31mERROR[0m in 1.67s]
[0m12:20:39.076626 [debug] [Thread-10 ]: Finished running node model.billy_bulky.customers
[0m12:20:39.856497 [debug] [Thread-5  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m12:20:39.867614 [debug] [Thread-5  ]: Timing info for model.billy_bulky.products (execute): 12:20:37.455180 => 12:20:39.866785
[0m12:20:39.869142 [debug] [Thread-5  ]: On model.billy_bulky.products: Close
[0m12:20:39.977652 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 3.0 seconds
[0m12:20:39.984679 [debug] [Thread-2  ]: Timing info for model.billy_bulky.sales (execute): 12:20:37.453314 => 12:20:39.984250
[0m12:20:39.985506 [debug] [Thread-2  ]: On model.billy_bulky.sales: Close
[0m12:20:40.227741 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09def3bd-13ad-49b1-9933-c3d18c2519c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14098c070>]}
[0m12:20:40.229694 [info ] [Thread-5  ]: 6 of 7 OK created sql table model marts.products ............................... [[32mSUCCESS 1[0m in 2.82s]
[0m12:20:40.231272 [debug] [Thread-5  ]: Finished running node model.billy_bulky.products
[0m12:20:40.367817 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09def3bd-13ad-49b1-9933-c3d18c2519c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x141d46b80>]}
[0m12:20:40.368977 [info ] [Thread-2  ]: 7 of 7 OK created sql table model marts.sales .................................. [[32mSUCCESS 1[0m in 2.96s]
[0m12:20:40.369840 [debug] [Thread-2  ]: Finished running node model.billy_bulky.sales
[0m12:20:40.372478 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:20:40.373053 [debug] [MainThread]: Connection 'model.billy_bulky.staging__shopify__products_history' was properly closed.
[0m12:20:40.373491 [debug] [MainThread]: Connection 'model.billy_bulky.sales' was properly closed.
[0m12:20:40.373899 [debug] [MainThread]: Connection 'list_E_COMMERCE_PUBLIC' was properly closed.
[0m12:20:40.374295 [debug] [MainThread]: Connection 'list_E_COMMERCE_staging' was properly closed.
[0m12:20:40.374688 [debug] [MainThread]: Connection 'model.billy_bulky.staging_shopify__products' was properly closed.
[0m12:20:40.375077 [debug] [MainThread]: Connection 'model.billy_bulky.staging_shopify__orders' was properly closed.
[0m12:20:40.375467 [debug] [MainThread]: Connection 'model.billy_bulky.int_customers_segmentation' was properly closed.
[0m12:20:40.375855 [debug] [MainThread]: Connection 'model.billy_bulky.int_products_performance' was properly closed.
[0m12:20:40.376244 [debug] [MainThread]: Connection 'model.billy_bulky.int_sales_trend' was properly closed.
[0m12:20:40.376635 [debug] [MainThread]: Connection 'model.billy_bulky.customers' was properly closed.
[0m12:20:40.377051 [debug] [MainThread]: Connection 'model.billy_bulky.products' was properly closed.
[0m12:20:40.377569 [info ] [MainThread]: 
[0m12:20:40.378046 [info ] [MainThread]: Finished running 4 view models, 3 table models in 0 hours 0 minutes and 11.29 seconds (11.29s).
[0m12:20:40.379698 [debug] [MainThread]: Command end result
[0m12:20:40.397378 [info ] [MainThread]: 
[0m12:20:40.397811 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:20:40.398116 [info ] [MainThread]: 
[0m12:20:40.398425 [error] [MainThread]:   Database Error in model customers (models/marts/customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 99 at position 8 unexpected 'WHEN'.
  syntax error line 105 at position 0 unexpected 'SELECT'.
  compiled Code at target/run/billy_bulky/models/marts/customers.sql
[0m12:20:40.398757 [info ] [MainThread]: 
[0m12:20:40.399069 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m12:20:40.401707 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 13.235506, "process_user_time": 6.309993, "process_kernel_time": 0.443424, "process_mem_max_rss": "227704832", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:20:40.402208 [debug] [MainThread]: Command `dbt run` failed at 12:20:40.402092 after 13.24 seconds
[0m12:20:40.402577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bfa0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094483d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x141f4a580>]}
[0m12:20:40.402955 [debug] [MainThread]: Flushing usage events
[0m12:21:05.644561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102c2d250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105499460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105499850>]}


============================== 12:21:05.647446 | 9d0b3235-64bd-4fe6-a860-90dea3248c06 ==============================
[0m12:21:05.647446 [info ] [MainThread]: Running with dbt=1.7.1
[0m12:21:05.647816 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/bitlevi/Documents/billy_bulky_ecommerce/billy_bulky_ecommerce/logs', 'debug': 'False', 'profiles_dir': '/Users/bitlevi/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:21:06.441363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9d0b3235-64bd-4fe6-a860-90dea3248c06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10547bfa0>]}
[0m12:21:06.490829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9d0b3235-64bd-4fe6-a860-90dea3248c06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14922a7c0>]}
[0m12:21:06.493966 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m12:21:06.506336 [debug] [MainThread]: checksum: ad428e6dc3b353dcb23d0c4ebea8b20b180e94b873271ac2a054a8e446dac0e2, vars: {}, profile: , target: , version: 1.7.1
[0m12:21:06.541904 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:21:06.542559 [debug] [MainThread]: Partial parsing: updated file: billy_bulky://models/marts/customers.sql
[0m12:21:06.752904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9d0b3235-64bd-4fe6-a860-90dea3248c06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1493e2dc0>]}
[0m12:21:06.763763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9d0b3235-64bd-4fe6-a860-90dea3248c06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x149efff70>]}
[0m12:21:06.764096 [info ] [MainThread]: Found 10 models, 1 snapshot, 1 seed, 47 tests, 4 sources, 0 exposures, 0 metrics, 431 macros, 0 groups, 0 semantic models
[0m12:21:06.764326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d0b3235-64bd-4fe6-a860-90dea3248c06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x149efff10>]}
[0m12:21:06.765774 [info ] [MainThread]: 
[0m12:21:06.766270 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:21:06.767034 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE'
[0m12:21:06.775267 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE"
[0m12:21:06.775788 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE'
[0m12:21:06.776002 [debug] [ThreadPool]: On list_E_COMMERCE: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE"} */
show terse schemas in database E_COMMERCE
    limit 10000
[0m12:21:06.777771 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE"
[0m12:21:06.778158 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:21:06.778352 [debug] [ThreadPool]: On list_E_COMMERCE: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE"} */
show terse schemas in database E_COMMERCE
    limit 10000
[0m12:21:06.779157 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:21:08.065149 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m12:21:08.067180 [debug] [ThreadPool]: On list_E_COMMERCE: Close
[0m12:21:08.094517 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m12:21:08.096557 [debug] [ThreadPool]: On list_E_COMMERCE: Close
[0m12:21:08.455885 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_E_COMMERCE, now list_E_COMMERCE_marts)
[0m12:21:08.457330 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_E_COMMERCE, now list_E_COMMERCE_staging)
[0m12:21:08.459825 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PUBLIC'
[0m12:21:08.473680 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_snapshots'
[0m12:21:08.474408 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_marts"
[0m12:21:08.477648 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_staging"
[0m12:21:08.480476 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PUBLIC"
[0m12:21:08.484285 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_snapshots"
[0m12:21:08.484746 [debug] [ThreadPool]: On list_E_COMMERCE_marts: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE_marts"} */
show terse objects in E_COMMERCE.marts limit 10000
[0m12:21:08.485176 [debug] [ThreadPool]: On list_E_COMMERCE_staging: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE_staging"} */
show terse objects in E_COMMERCE.staging limit 10000
[0m12:21:08.485614 [debug] [ThreadPool]: On list_E_COMMERCE_PUBLIC: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE_PUBLIC"} */
show terse objects in E_COMMERCE.PUBLIC limit 10000
[0m12:21:08.486043 [debug] [ThreadPool]: On list_E_COMMERCE_snapshots: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE_snapshots"} */
show terse objects in E_COMMERCE.snapshots limit 10000
[0m12:21:08.486396 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:21:08.486717 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:21:08.487026 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:21:08.487333 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:21:09.594587 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m12:21:09.596081 [debug] [ThreadPool]: On list_E_COMMERCE_staging: Close
[0m12:21:09.617111 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:21:09.619109 [debug] [ThreadPool]: On list_E_COMMERCE_snapshots: Close
[0m12:21:09.620426 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m12:21:09.621366 [debug] [ThreadPool]: On list_E_COMMERCE_marts: Close
[0m12:21:09.625015 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b079e8-0001-831c-0004-d8be0001354a
[0m12:21:09.625356 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m12:21:09.625706 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m12:21:09.625928 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m12:21:09.626174 [debug] [ThreadPool]: On list_E_COMMERCE_PUBLIC: Close
[0m12:21:09.998540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d0b3235-64bd-4fe6-a860-90dea3248c06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14a27f040>]}
[0m12:21:10.000055 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m12:21:10.000727 [info ] [MainThread]: 
[0m12:21:10.005172 [debug] [Thread-1  ]: Began running node model.billy_bulky.staging__shopify__products_history
[0m12:21:10.006026 [debug] [Thread-2  ]: Began running node model.billy_bulky.staging_shopify__customers
[0m12:21:10.006694 [debug] [Thread-3  ]: Began running node model.billy_bulky.staging_shopify__orders
[0m12:21:10.007379 [info ] [Thread-1  ]: 1 of 7 START sql view model staging.staging__shopify__products_history ......... [RUN]
[0m12:21:10.009838 [debug] [Thread-4  ]: Began running node model.billy_bulky.staging_shopify__products
[0m12:21:10.008913 [info ] [Thread-2  ]: 2 of 7 START sql view model staging.staging_shopify__customers ................. [RUN]
[0m12:21:10.010774 [info ] [Thread-3  ]: 3 of 7 START sql view model staging.staging_shopify__orders .................... [RUN]
[0m12:21:10.012039 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_E_COMMERCE_marts, now model.billy_bulky.staging__shopify__products_history)
[0m12:21:10.012937 [info ] [Thread-4  ]: 4 of 7 START sql view model staging.staging_shopify__products .................. [RUN]
[0m12:21:10.013972 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_E_COMMERCE_staging, now model.billy_bulky.staging_shopify__customers)
[0m12:21:10.014929 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly list_E_COMMERCE_PUBLIC, now model.billy_bulky.staging_shopify__orders)
[0m12:21:10.015523 [debug] [Thread-1  ]: Began compiling node model.billy_bulky.staging__shopify__products_history
[0m12:21:10.016402 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly list_E_COMMERCE_snapshots, now model.billy_bulky.staging_shopify__products)
[0m12:21:10.016873 [debug] [Thread-2  ]: Began compiling node model.billy_bulky.staging_shopify__customers
[0m12:21:10.017315 [debug] [Thread-3  ]: Began compiling node model.billy_bulky.staging_shopify__orders
[0m12:21:10.027332 [debug] [Thread-1  ]: Writing injected SQL for node "model.billy_bulky.staging__shopify__products_history"
[0m12:21:10.027848 [debug] [Thread-4  ]: Began compiling node model.billy_bulky.staging_shopify__products
[0m12:21:10.032430 [debug] [Thread-2  ]: Writing injected SQL for node "model.billy_bulky.staging_shopify__customers"
[0m12:21:10.035677 [debug] [Thread-3  ]: Writing injected SQL for node "model.billy_bulky.staging_shopify__orders"
[0m12:21:10.038923 [debug] [Thread-4  ]: Writing injected SQL for node "model.billy_bulky.staging_shopify__products"
[0m12:21:10.039569 [debug] [Thread-1  ]: Timing info for model.billy_bulky.staging__shopify__products_history (compile): 12:21:10.017604 => 12:21:10.039338
[0m12:21:10.040094 [debug] [Thread-1  ]: Began executing node model.billy_bulky.staging__shopify__products_history
[0m12:21:10.053713 [debug] [Thread-3  ]: Timing info for model.billy_bulky.staging_shopify__orders (compile): 12:21:10.032768 => 12:21:10.053429
[0m12:21:10.060531 [debug] [Thread-2  ]: Timing info for model.billy_bulky.staging_shopify__customers (compile): 12:21:10.028168 => 12:21:10.060261
[0m12:21:10.060959 [debug] [Thread-3  ]: Began executing node model.billy_bulky.staging_shopify__orders
[0m12:21:10.065755 [debug] [Thread-1  ]: Writing runtime sql for node "model.billy_bulky.staging__shopify__products_history"
[0m12:21:10.066088 [debug] [Thread-4  ]: Timing info for model.billy_bulky.staging_shopify__products (compile): 12:21:10.036111 => 12:21:10.065935
[0m12:21:10.066390 [debug] [Thread-2  ]: Began executing node model.billy_bulky.staging_shopify__customers
[0m12:21:10.068819 [debug] [Thread-3  ]: Writing runtime sql for node "model.billy_bulky.staging_shopify__orders"
[0m12:21:10.069168 [debug] [Thread-4  ]: Began executing node model.billy_bulky.staging_shopify__products
[0m12:21:10.071327 [debug] [Thread-2  ]: Writing runtime sql for node "model.billy_bulky.staging_shopify__customers"
[0m12:21:10.074185 [debug] [Thread-4  ]: Writing runtime sql for node "model.billy_bulky.staging_shopify__products"
[0m12:21:10.074835 [debug] [Thread-1  ]: Using snowflake connection "model.billy_bulky.staging__shopify__products_history"
[0m12:21:10.075226 [debug] [Thread-1  ]: On model.billy_bulky.staging__shopify__products_history: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.staging__shopify__products_history"} */
create or replace   view E_COMMERCE.staging.staging__shopify__products_history
  
   as (
    WITH products AS (
    SELECT * FROM E_COMMERCE.SNAPSHOTS.products_snapshot
)

SELECT
    PRODUCT_ID
    , NAME
    , CATEGORY
    , PRICE
    , STOCK_LEVEL
    , DBT_SCD_ID
    , DBT_UPDATED_AT
    , DBT_VALID_FROM
    , DBT_VALID_TO
FROM products
  );
[0m12:21:10.075514 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:21:10.076180 [debug] [Thread-3  ]: Using snowflake connection "model.billy_bulky.staging_shopify__orders"
[0m12:21:10.076832 [debug] [Thread-3  ]: On model.billy_bulky.staging_shopify__orders: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.staging_shopify__orders"} */
create or replace   view E_COMMERCE.staging.staging_shopify__orders
  
   as (
    WITH orders AS (
    SELECT * FROM SHOPIFY.PUBLIC.orders
)

SELECT
    ORDER_ID
    , CUSTOMER_ID
    , PRODUCT_ID
    , QUANTITY
    , ORDER_DATE
    , STATUS
FROM orders
  );
[0m12:21:10.077481 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m12:21:10.077989 [debug] [Thread-2  ]: Using snowflake connection "model.billy_bulky.staging_shopify__customers"
[0m12:21:10.078597 [debug] [Thread-4  ]: Using snowflake connection "model.billy_bulky.staging_shopify__products"
[0m12:21:10.079029 [debug] [Thread-2  ]: On model.billy_bulky.staging_shopify__customers: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.staging_shopify__customers"} */
create or replace   view E_COMMERCE.staging.staging_shopify__customers
  
   as (
    WITH customers AS (
    SELECT * FROM SHOPIFY.PUBLIC.customers
)

SELECT
    CUSTOMER_ID
    , FIRST_NAME
    , LAST_NAME
    , EMAIL
    , JOIN_DATE
    , COUNTRY
FROM customers
  );
[0m12:21:10.079391 [debug] [Thread-4  ]: On model.billy_bulky.staging_shopify__products: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.staging_shopify__products"} */
create or replace   view E_COMMERCE.staging.staging_shopify__products
  
   as (
    WITH products AS (
    SELECT * FROM SHOPIFY.PUBLIC.products
)

SELECT
    PRODUCT_ID
    , NAME
    , CATEGORY
    , PRICE
    , STOCK_LEVEL
FROM products
  );
[0m12:21:10.079900 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m12:21:10.080252 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m12:21:11.414754 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:21:11.443597 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:21:11.456109 [debug] [Thread-4  ]: Timing info for model.billy_bulky.staging_shopify__products (execute): 12:21:10.071591 => 12:21:11.455847
[0m12:21:11.456821 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:21:11.459438 [debug] [Thread-3  ]: Timing info for model.billy_bulky.staging_shopify__orders (execute): 12:21:10.066569 => 12:21:11.459208
[0m12:21:11.459939 [debug] [Thread-4  ]: On model.billy_bulky.staging_shopify__products: Close
[0m12:21:11.462511 [debug] [Thread-2  ]: Timing info for model.billy_bulky.staging_shopify__customers (execute): 12:21:10.069348 => 12:21:11.462283
[0m12:21:11.462939 [debug] [Thread-3  ]: On model.billy_bulky.staging_shopify__orders: Close
[0m12:21:11.464558 [debug] [Thread-2  ]: On model.billy_bulky.staging_shopify__customers: Close
[0m12:21:11.480998 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:21:11.483836 [debug] [Thread-1  ]: Timing info for model.billy_bulky.staging__shopify__products_history (execute): 12:21:10.040396 => 12:21:11.483607
[0m12:21:11.484270 [debug] [Thread-1  ]: On model.billy_bulky.staging__shopify__products_history: Close
[0m12:21:11.830208 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d0b3235-64bd-4fe6-a860-90dea3248c06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14d41c400>]}
[0m12:21:11.831739 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d0b3235-64bd-4fe6-a860-90dea3248c06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14d57ad60>]}
[0m12:21:11.833101 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d0b3235-64bd-4fe6-a860-90dea3248c06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14a127220>]}
[0m12:21:11.834274 [info ] [Thread-3  ]: 3 of 7 OK created sql view model staging.staging_shopify__orders ............... [[32mSUCCESS 1[0m in 1.82s]
[0m12:21:11.835274 [info ] [Thread-2  ]: 2 of 7 OK created sql view model staging.staging_shopify__customers ............ [[32mSUCCESS 1[0m in 1.82s]
[0m12:21:11.836191 [info ] [Thread-4  ]: 4 of 7 OK created sql view model staging.staging_shopify__products ............. [[32mSUCCESS 1[0m in 1.82s]
[0m12:21:11.837030 [debug] [Thread-3  ]: Finished running node model.billy_bulky.staging_shopify__orders
[0m12:21:11.837792 [debug] [Thread-2  ]: Finished running node model.billy_bulky.staging_shopify__customers
[0m12:21:11.838520 [debug] [Thread-4  ]: Finished running node model.billy_bulky.staging_shopify__products
[0m12:21:11.839566 [debug] [Thread-6  ]: Began running node model.billy_bulky.int_customers_segmentation
[0m12:21:11.840220 [debug] [Thread-7  ]: Began running node model.billy_bulky.int_products_performance
[0m12:21:11.841323 [debug] [Thread-6  ]: Acquiring new snowflake connection 'model.billy_bulky.int_customers_segmentation'
[0m12:21:11.841874 [debug] [Thread-8  ]: Began running node model.billy_bulky.int_sales_trend
[0m12:21:11.842899 [debug] [Thread-7  ]: Acquiring new snowflake connection 'model.billy_bulky.int_products_performance'
[0m12:21:11.843448 [debug] [Thread-6  ]: Began compiling node model.billy_bulky.int_customers_segmentation
[0m12:21:11.844428 [debug] [Thread-8  ]: Acquiring new snowflake connection 'model.billy_bulky.int_sales_trend'
[0m12:21:11.844965 [debug] [Thread-7  ]: Began compiling node model.billy_bulky.int_products_performance
[0m12:21:11.849979 [debug] [Thread-6  ]: Writing injected SQL for node "model.billy_bulky.int_customers_segmentation"
[0m12:21:11.850493 [debug] [Thread-8  ]: Began compiling node model.billy_bulky.int_sales_trend
[0m12:21:11.855388 [debug] [Thread-7  ]: Writing injected SQL for node "model.billy_bulky.int_products_performance"
[0m12:21:11.859057 [debug] [Thread-8  ]: Writing injected SQL for node "model.billy_bulky.int_sales_trend"
[0m12:21:11.859825 [debug] [Thread-6  ]: Timing info for model.billy_bulky.int_customers_segmentation (compile): 12:21:11.845299 => 12:21:11.859573
[0m12:21:11.860796 [debug] [Thread-6  ]: Finished running node model.billy_bulky.int_customers_segmentation
[0m12:21:11.861447 [debug] [Thread-7  ]: Timing info for model.billy_bulky.int_products_performance (compile): 12:21:11.850796 => 12:21:11.861221
[0m12:21:11.862301 [debug] [Thread-7  ]: Finished running node model.billy_bulky.int_products_performance
[0m12:21:11.862790 [debug] [Thread-8  ]: Timing info for model.billy_bulky.int_sales_trend (compile): 12:21:11.855746 => 12:21:11.862551
[0m12:21:11.863194 [debug] [Thread-10 ]: Began running node model.billy_bulky.customers
[0m12:21:11.864152 [debug] [Thread-8  ]: Finished running node model.billy_bulky.int_sales_trend
[0m12:21:11.864568 [debug] [Thread-3  ]: Began running node model.billy_bulky.products
[0m12:21:11.865080 [info ] [Thread-10 ]: 5 of 7 START sql table model marts.customers ................................... [RUN]
[0m12:21:11.866130 [debug] [Thread-4  ]: Began running node model.billy_bulky.sales
[0m12:21:11.865770 [info ] [Thread-3  ]: 6 of 7 START sql table model marts.products .................................... [RUN]
[0m12:21:11.867386 [debug] [Thread-10 ]: Acquiring new snowflake connection 'model.billy_bulky.customers'
[0m12:21:11.867825 [info ] [Thread-4  ]: 7 of 7 START sql table model marts.sales ....................................... [RUN]
[0m12:21:11.868538 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.billy_bulky.staging_shopify__orders, now model.billy_bulky.products)
[0m12:21:11.869336 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d0b3235-64bd-4fe6-a860-90dea3248c06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14d5590d0>]}
[0m12:21:11.869736 [debug] [Thread-10 ]: Began compiling node model.billy_bulky.customers
[0m12:21:11.870381 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.billy_bulky.staging_shopify__products, now model.billy_bulky.sales)
[0m12:21:11.870758 [debug] [Thread-3  ]: Began compiling node model.billy_bulky.products
[0m12:21:11.881788 [debug] [Thread-10 ]: Writing injected SQL for node "model.billy_bulky.customers"
[0m12:21:11.877839 [info ] [Thread-1  ]: 1 of 7 OK created sql view model staging.staging__shopify__products_history .... [[32mSUCCESS 1[0m in 1.86s]
[0m12:21:11.882324 [debug] [Thread-4  ]: Began compiling node model.billy_bulky.sales
[0m12:21:11.887820 [debug] [Thread-3  ]: Writing injected SQL for node "model.billy_bulky.products"
[0m12:21:11.888410 [debug] [Thread-1  ]: Finished running node model.billy_bulky.staging__shopify__products_history
[0m12:21:11.898158 [debug] [Thread-4  ]: Writing injected SQL for node "model.billy_bulky.sales"
[0m12:21:11.899046 [debug] [Thread-10 ]: Timing info for model.billy_bulky.customers (compile): 12:21:11.871036 => 12:21:11.898816
[0m12:21:11.899437 [debug] [Thread-10 ]: Began executing node model.billy_bulky.customers
[0m12:21:11.906225 [debug] [Thread-3  ]: Timing info for model.billy_bulky.products (compile): 12:21:11.882632 => 12:21:11.906005
[0m12:21:11.913045 [debug] [Thread-4  ]: Timing info for model.billy_bulky.sales (compile): 12:21:11.888619 => 12:21:11.912737
[0m12:21:11.913353 [debug] [Thread-3  ]: Began executing node model.billy_bulky.products
[0m12:21:11.915931 [debug] [Thread-10 ]: Writing runtime sql for node "model.billy_bulky.customers"
[0m12:21:11.916235 [debug] [Thread-4  ]: Began executing node model.billy_bulky.sales
[0m12:21:11.918128 [debug] [Thread-3  ]: Writing runtime sql for node "model.billy_bulky.products"
[0m12:21:11.920665 [debug] [Thread-4  ]: Writing runtime sql for node "model.billy_bulky.sales"
[0m12:21:11.922443 [debug] [Thread-3  ]: Using snowflake connection "model.billy_bulky.products"
[0m12:21:11.924344 [debug] [Thread-10 ]: Using snowflake connection "model.billy_bulky.customers"
[0m12:21:11.924671 [debug] [Thread-3  ]: On model.billy_bulky.products: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.products"} */
create or replace transient table E_COMMERCE.marts.products
         as
        (WITH  __dbt__cte__int_products_performance as (
WITH orders AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__orders
)

, products AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__products
)

, product_sales AS (
    SELECT
        o.PRODUCT_ID
        , COUNT(DISTINCT o.ORDER_ID) AS total_sales
        , SUM(o.QUANTITY) AS total_units_sold
        , SUM(o.QUANTITY * p.PRICE) AS total_sales_value
    FROM orders o
    INNER JOIN products p ON o.PRODUCT_ID = p.PRODUCT_ID
    WHERE o.STATUS NOT IN ('cancelled') 
    GROUP BY o.PRODUCT_ID
)

, product_averages AS (
    SELECT
        PRODUCT_ID
        , (total_sales_value / NULLIF(total_units_sold, 0)) AS average_sale_price
    FROM product_sales
)

, product_stock_turnover AS (
    SELECT
        p.PRODUCT_ID
        , p.STOCK_LEVEL
        , (total_units_sold / NULLIF(p.STOCK_LEVEL, 0)) AS turnover_rate
    FROM product_sales ps
    INNER JOIN products p ON ps.PRODUCT_ID = p.PRODUCT_ID
)

, final AS (
    SELECT
    p.PRODUCT_ID
    , p.NAME
    , p.CATEGORY
    , p.PRICE
    , pa.average_sale_price
    , ps.total_sales
    , ps.total_units_sold
    , ps.total_sales_value
    , pst.turnover_rate
    , p.STOCK_LEVEL
FROM products p
LEFT JOIN product_sales ps ON p.PRODUCT_ID = ps.PRODUCT_ID
LEFT JOIN product_averages pa ON p.PRODUCT_ID = pa.PRODUCT_ID
LEFT JOIN product_stock_turnover pst ON p.PRODUCT_ID = pst.PRODUCT_ID
)

SELECT * FROM final
), final AS (
    SELECT
        pp.PRODUCT_ID
        , pp.NAME
        , pp.CATEGORY
        , pp.PRICE
        , pp.average_sale_price
        , pp.total_sales
        , pp.total_units_sold
        , pp.total_sales_value
        , pp.turnover_rate
        , pp.STOCK_LEVEL
    FROM __dbt__cte__int_products_performance pp
)

SELECT * FROM final
        );
[0m12:21:11.927102 [debug] [Thread-4  ]: Using snowflake connection "model.billy_bulky.sales"
[0m12:21:11.927501 [debug] [Thread-10 ]: On model.billy_bulky.customers: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.customers"} */
create or replace transient table E_COMMERCE.marts.customers
         as
        (WITH  __dbt__cte__int_customers_segmentation as (
WITH customers AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__customers
)

, orders AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__orders
)

, products AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__products
)

, order_aggregates AS (
    SELECT
        o.CUSTOMER_ID
        , COUNT(DISTINCT o.ORDER_ID) AS frequency
        , SUM(o.QUANTITY * p.PRICE) AS monetary
        , AVG(o.QUANTITY * p.PRICE) AS average_order_value
        , MAX(o.ORDER_DATE) AS last_purchase_date
        , COUNT(CASE WHEN o.STATUS = 'cancelled' THEN 1 END) AS cancelled_orders
        , COUNT(*) AS total_orders
    FROM orders o
    JOIN products p ON o.PRODUCT_ID = p.PRODUCT_ID
    GROUP BY o.CUSTOMER_ID
)

, customer_tenure AS (
    SELECT
        CUSTOMER_ID
        , JOIN_DATE
        , CURRENT_DATE - JOIN_DATE AS tenure
    FROM customers
)

, customer_recency AS (
    SELECT
        CUSTOMER_ID
        , CURRENT_DATE - last_purchase_date AS recency
    FROM order_aggregates
)

, final AS (
    SELECT
        c.CUSTOMER_ID
        , c.FIRST_NAME
        , c.LAST_NAME
        , c.EMAIL
        , c.JOIN_DATE
        , c.COUNTRY
        , o.frequency
        , o.monetary
        , o.average_order_value
        , o.cancelled_orders
        , o.total_orders
        , CASE 
            WHEN o.total_orders > 0 THEN ROUND((o.cancelled_orders::FLOAT / o.total_orders) * 100, 2) 
            ELSE 0 
          END AS cancellation_rate
        , r.recency
        , t.tenure
    FROM customer_tenure t
    JOIN customers c ON t.CUSTOMER_ID = c.CUSTOMER_ID
    JOIN order_aggregates o ON c.CUSTOMER_ID = o.CUSTOMER_ID
    JOIN customer_recency r ON c.CUSTOMER_ID = r.CUSTOMER_ID
)

SELECT * FROM final
), source AS (
    SELECT
        icp.CUSTOMER_ID
        , icp.FIRST_NAME
        , icp.LAST_NAME
        , icp.EMAIL
        , icp.JOIN_DATE
        , icp.COUNTRY
        , icp.frequency AS total_orders
        , icp.monetary AS total_spent
        , icp.recency
        , icp.tenure
    FROM __dbt__cte__int_customers_segmentation icp
)

, final AS (
SELECT
    s.CUSTOMER_ID
    , s.FIRST_NAME
    , s.LAST_NAME
    , s.EMAIL
    , s.JOIN_DATE
    , s.COUNTRY
    , s.total_orders
    , s.total_spent
    , s.recency
    , s.tenure
    , CASE
        WHEN total_spent > 1000 THEN 'VIP'
        ELSE 'Regular'
    END AS customer_segment
FROM source s
)

SELECT * FROM final
        );
[0m12:21:11.927825 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m12:21:11.928184 [debug] [Thread-4  ]: On model.billy_bulky.sales: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.sales"} */
create or replace transient table E_COMMERCE.marts.sales
         as
        (WITH  __dbt__cte__int_sales_trend as (
WITH orders AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__orders
)

, products AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__products
)

, daily_sales AS (
    SELECT
        DATE(ORDER_DATE) AS sale_date
        , COUNT(DISTINCT ORDER_ID) AS total_orders
        , SUM(QUANTITY) AS total_units_sold
        , SUM(QUANTITY * PRICE) AS total_sales_value
    FROM orders AS o
    JOIN products AS p ON o.PRODUCT_ID = p.PRODUCT_ID
    WHERE o.STATUS NOT IN ('cancelled') 
    GROUP BY sale_date
)

, weekly_sales AS (
    SELECT
        DATE_TRUNC('week', sale_date) AS sale_week
        , SUM(total_orders) AS weekly_orders
        , SUM(total_units_sold) AS weekly_units_sold
        , SUM(total_sales_value) AS weekly_sales_value
    FROM daily_sales
    GROUP BY sale_week
)

, monthly_sales AS (
    SELECT
        DATE_TRUNC('month', sale_date) AS sale_month
        , SUM(total_orders) AS monthly_orders
        , SUM(total_units_sold) AS monthly_units_sold
        , SUM(total_sales_value) AS monthly_sales_value
    FROM daily_sales
    GROUP BY sale_month
)

, yearly_sales AS (
    SELECT
        DATE_TRUNC('year', sale_date) AS sale_year
        , SUM(total_orders) AS yearly_orders
        , SUM(total_units_sold) AS yearly_units_sold
        , SUM(total_sales_value) AS yearly_sales_value
    FROM daily_sales
    GROUP BY sale_year
)

SELECT
    d.sale_date
    , d.total_orders AS daily_orders
    , d.total_units_sold AS daily_units_sold
    , d.total_sales_value AS daily_sales_value
    , w.weekly_orders
    , w.weekly_units_sold
    , w.weekly_sales_value
    , m.monthly_orders
    , m.monthly_units_sold
    , m.monthly_sales_value
    , y.yearly_orders
    , y.yearly_units_sold
    , y.yearly_sales_value
FROM daily_sales d
LEFT JOIN weekly_sales w ON DATE_TRUNC('week', d.sale_date) = w.sale_week
LEFT JOIN monthly_sales m ON DATE_TRUNC('month', d.sale_date) = m.sale_month
LEFT JOIN yearly_sales y ON DATE_TRUNC('year', d.sale_date) = y.sale_year
), enriched_orders AS (
    SELECT
        o.ORDER_ID
        , o.CUSTOMER_ID
        , o.PRODUCT_ID
        , o.QUANTITY
        , o.ORDER_DATE
        , o.STATUS
        , p.CATEGORY
        , p.PRICE AS unit_price
        , (o.QUANTITY * p.PRICE) AS total_price
        , c.COUNTRY
    FROM E_COMMERCE.staging.staging_shopify__orders o
    JOIN E_COMMERCE.staging.staging_shopify__products p ON o.PRODUCT_ID = p.PRODUCT_ID
    JOIN E_COMMERCE.staging.staging_shopify__customers c ON o.CUSTOMER_ID = c.CUSTOMER_ID
    WHERE o.STATUS NOT IN ('cancelled') 
)

SELECT
    eo.ORDER_ID
    , eo.CUSTOMER_ID
    , eo.PRODUCT_ID
    , eo.QUANTITY
    , eo.ORDER_DATE
    , eo.STATUS
    , eo.CATEGORY
    , eo.unit_price
    , eo.total_price
    , eo.COUNTRY
    , sa.daily_orders
    , sa.daily_units_sold
    , sa.daily_sales_value
FROM enriched_orders eo
LEFT JOIN __dbt__cte__int_sales_trend sa ON DATE(eo.ORDER_DATE) = sa.sale_date
        );
[0m12:21:11.928540 [debug] [Thread-10 ]: Opening a new connection, currently in state init
[0m12:21:11.929258 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m12:21:14.357321 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m12:21:14.364021 [debug] [Thread-3  ]: Timing info for model.billy_bulky.products (execute): 12:21:11.916396 => 12:21:14.363583
[0m12:21:14.364913 [debug] [Thread-3  ]: On model.billy_bulky.products: Close
[0m12:21:14.375170 [debug] [Thread-10 ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m12:21:14.379307 [debug] [Thread-10 ]: Timing info for model.billy_bulky.customers (execute): 12:21:11.899641 => 12:21:14.378942
[0m12:21:14.379956 [debug] [Thread-10 ]: On model.billy_bulky.customers: Close
[0m12:21:14.496346 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 3.0 seconds
[0m12:21:14.502074 [debug] [Thread-4  ]: Timing info for model.billy_bulky.sales (execute): 12:21:11.918354 => 12:21:14.501683
[0m12:21:14.502807 [debug] [Thread-4  ]: On model.billy_bulky.sales: Close
[0m12:21:14.715869 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d0b3235-64bd-4fe6-a860-90dea3248c06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14d41c250>]}
[0m12:21:14.717219 [info ] [Thread-3  ]: 6 of 7 OK created sql table model marts.products ............................... [[32mSUCCESS 1[0m in 2.85s]
[0m12:21:14.718281 [debug] [Thread-3  ]: Finished running node model.billy_bulky.products
[0m12:21:14.727873 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d0b3235-64bd-4fe6-a860-90dea3248c06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14d30a040>]}
[0m12:21:14.728950 [info ] [Thread-10 ]: 5 of 7 OK created sql table model marts.customers .............................. [[32mSUCCESS 1[0m in 2.86s]
[0m12:21:14.729824 [debug] [Thread-10 ]: Finished running node model.billy_bulky.customers
[0m12:21:14.875598 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d0b3235-64bd-4fe6-a860-90dea3248c06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14d461ca0>]}
[0m12:21:14.876856 [info ] [Thread-4  ]: 7 of 7 OK created sql table model marts.sales .................................. [[32mSUCCESS 1[0m in 3.01s]
[0m12:21:14.877887 [debug] [Thread-4  ]: Finished running node model.billy_bulky.sales
[0m12:21:14.880985 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:21:14.881633 [debug] [MainThread]: Connection 'model.billy_bulky.staging__shopify__products_history' was properly closed.
[0m12:21:14.882160 [debug] [MainThread]: Connection 'model.billy_bulky.staging_shopify__customers' was properly closed.
[0m12:21:14.882654 [debug] [MainThread]: Connection 'model.billy_bulky.products' was properly closed.
[0m12:21:14.883138 [debug] [MainThread]: Connection 'model.billy_bulky.sales' was properly closed.
[0m12:21:14.883613 [debug] [MainThread]: Connection 'model.billy_bulky.int_customers_segmentation' was properly closed.
[0m12:21:14.884021 [debug] [MainThread]: Connection 'model.billy_bulky.int_products_performance' was properly closed.
[0m12:21:14.884411 [debug] [MainThread]: Connection 'model.billy_bulky.int_sales_trend' was properly closed.
[0m12:21:14.884798 [debug] [MainThread]: Connection 'model.billy_bulky.customers' was properly closed.
[0m12:21:14.885361 [info ] [MainThread]: 
[0m12:21:14.885882 [info ] [MainThread]: Finished running 4 view models, 3 table models in 0 hours 0 minutes and 8.12 seconds (8.12s).
[0m12:21:14.887848 [debug] [MainThread]: Command end result
[0m12:21:14.904412 [info ] [MainThread]: 
[0m12:21:14.904987 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:21:14.905468 [info ] [MainThread]: 
[0m12:21:14.905905 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m12:21:14.908409 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.297181, "process_user_time": 5.439028, "process_kernel_time": 0.383537, "process_mem_max_rss": "225624064", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:21:14.908996 [debug] [MainThread]: Command `dbt run` succeeded at 12:21:14.908864 after 9.30 seconds
[0m12:21:14.909401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102c2d250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14a12e190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10547bfa0>]}
[0m12:21:14.909824 [debug] [MainThread]: Flushing usage events
[0m12:23:52.306926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103cb16d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1036669d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107138400>]}


============================== 12:23:52.309731 | 4b1f8cc1-343d-487f-a16d-875a3d3095aa ==============================
[0m12:23:52.309731 [info ] [MainThread]: Running with dbt=1.7.1
[0m12:23:52.310085 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/bitlevi/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/bitlevi/Documents/billy_bulky_ecommerce/billy_bulky_ecommerce/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:23:53.141948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4b1f8cc1-343d-487f-a16d-875a3d3095aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1036669d0>]}
[0m12:23:53.189280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4b1f8cc1-343d-487f-a16d-875a3d3095aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x159625550>]}
[0m12:23:53.189901 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m12:23:53.202656 [debug] [MainThread]: checksum: ad428e6dc3b353dcb23d0c4ebea8b20b180e94b873271ac2a054a8e446dac0e2, vars: {}, profile: , target: , version: 1.7.1
[0m12:23:53.213960 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m12:23:53.214322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4b1f8cc1-343d-487f-a16d-875a3d3095aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15980f2e0>]}
[0m12:23:53.932913 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'orders' in the 'models' section of file 'models/staging/shopify/_shopify__schema.yml'
[0m12:23:54.044673 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'marts_sales' in the 'models' section of file 'models/marts/_marts__models.yml'
[0m12:23:54.046508 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'marts_customers' in the 'models' section of file 'models/marts/_marts__models.yml'
[0m12:23:54.047740 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'marts_products' in the 'models' section of file 'models/marts/_marts__models.yml'
[0m12:23:54.125391 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.unique_orders_order_id.fed79b3a6e' (models/staging/shopify/_shopify__schema.yml) depends on a node named 'orders' in package '' which was not found
[0m12:23:54.125771 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_orders_order_id.cf6c17daed' (models/staging/shopify/_shopify__schema.yml) depends on a node named 'orders' in package '' which was not found
[0m12:23:54.126014 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_orders_customer_id.c5f02694af' (models/staging/shopify/_shopify__schema.yml) depends on a node named 'orders' in package '' which was not found
[0m12:23:54.126242 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_orders_product_id.3523c78a66' (models/staging/shopify/_shopify__schema.yml) depends on a node named 'orders' in package '' which was not found
[0m12:23:54.126462 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_orders_quantity.0e6bb23b03' (models/staging/shopify/_shopify__schema.yml) depends on a node named 'orders' in package '' which was not found
[0m12:23:54.126676 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_orders_order_date.6910a855fe' (models/staging/shopify/_shopify__schema.yml) depends on a node named 'orders' in package '' which was not found
[0m12:23:54.126890 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_orders_status.8a27272c0a' (models/staging/shopify/_shopify__schema.yml) depends on a node named 'orders' in package '' which was not found
[0m12:23:54.127103 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.accepted_values_orders_status__cancelled__processing__delivered__shipped.fbff2d9925' (models/staging/shopify/_shopify__schema.yml) depends on a node named 'orders' in package '' which was not found
[0m12:23:54.127370 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.unique_marts_sales_order_id.825e23650b' (models/marts/_marts__models.yml) depends on a node named 'marts_sales' in package '' which was not found
[0m12:23:54.127732 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_sales_order_id.842b56ef2f' (models/marts/_marts__models.yml) depends on a node named 'marts_sales' in package '' which was not found
[0m12:23:54.128031 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_sales_customer_id.189ac71c42' (models/marts/_marts__models.yml) depends on a node named 'marts_sales' in package '' which was not found
[0m12:23:54.128316 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.relationships_marts_sales_customer_id__customer_id__ref_customers_.74e21c3398' (models/marts/_marts__models.yml) depends on a node named 'marts_sales' in package '' which was not found
[0m12:23:54.128567 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_sales_product_id.12beecf4f2' (models/marts/_marts__models.yml) depends on a node named 'marts_sales' in package '' which was not found
[0m12:23:54.128804 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.relationships_marts_sales_product_id__product_id__ref_products_.77e7665182' (models/marts/_marts__models.yml) depends on a node named 'marts_sales' in package '' which was not found
[0m12:23:54.129027 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_sales_quantity.ea8c580869' (models/marts/_marts__models.yml) depends on a node named 'marts_sales' in package '' which was not found
[0m12:23:54.129245 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_sales_order_date.90eaa9e7fe' (models/marts/_marts__models.yml) depends on a node named 'marts_sales' in package '' which was not found
[0m12:23:54.129464 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_sales_status.e9b4b90247' (models/marts/_marts__models.yml) depends on a node named 'marts_sales' in package '' which was not found
[0m12:23:54.129681 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_sales_category.a98218f68d' (models/marts/_marts__models.yml) depends on a node named 'marts_sales' in package '' which was not found
[0m12:23:54.129895 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_sales_unit_price.321f152a2a' (models/marts/_marts__models.yml) depends on a node named 'marts_sales' in package '' which was not found
[0m12:23:54.130111 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_sales_total_price.015724a7e6' (models/marts/_marts__models.yml) depends on a node named 'marts_sales' in package '' which was not found
[0m12:23:54.130321 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_sales_country.5f628b732c' (models/marts/_marts__models.yml) depends on a node named 'marts_sales' in package '' which was not found
[0m12:23:54.130534 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.unique_marts_customers_customer_id.9c72620f57' (models/marts/_marts__models.yml) depends on a node named 'marts_customers' in package '' which was not found
[0m12:23:54.130745 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_customers_customer_id.fc7763eff9' (models/marts/_marts__models.yml) depends on a node named 'marts_customers' in package '' which was not found
[0m12:23:54.130955 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.unique_marts_customers_email.6210d26820' (models/marts/_marts__models.yml) depends on a node named 'marts_customers' in package '' which was not found
[0m12:23:54.131165 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_customers_email.637d2131e6' (models/marts/_marts__models.yml) depends on a node named 'marts_customers' in package '' which was not found
[0m12:23:54.131372 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_customers_join_date.6378efd424' (models/marts/_marts__models.yml) depends on a node named 'marts_customers' in package '' which was not found
[0m12:23:54.131572 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_customers_total_orders.7cdc5122e5' (models/marts/_marts__models.yml) depends on a node named 'marts_customers' in package '' which was not found
[0m12:23:54.131784 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_customers_total_spent.d5343aecc7' (models/marts/_marts__models.yml) depends on a node named 'marts_customers' in package '' which was not found
[0m12:23:54.131988 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.unique_marts_products_product_id.e96f554683' (models/marts/_marts__models.yml) depends on a node named 'marts_products' in package '' which was not found
[0m12:23:54.132195 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_products_product_id.9b354ae761' (models/marts/_marts__models.yml) depends on a node named 'marts_products' in package '' which was not found
[0m12:23:54.132400 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_products_name.f0d9c8d191' (models/marts/_marts__models.yml) depends on a node named 'marts_products' in package '' which was not found
[0m12:23:54.132601 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_products_category.1212ed3683' (models/marts/_marts__models.yml) depends on a node named 'marts_products' in package '' which was not found
[0m12:23:54.132805 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_products_price.d6207a2896' (models/marts/_marts__models.yml) depends on a node named 'marts_products' in package '' which was not found
[0m12:23:54.133016 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_products_total_units_sold.6822a804df' (models/marts/_marts__models.yml) depends on a node named 'marts_products' in package '' which was not found
[0m12:23:54.133234 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_products_total_sales_value.b0a2a654b3' (models/marts/_marts__models.yml) depends on a node named 'marts_products' in package '' which was not found
[0m12:23:54.164176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4b1f8cc1-343d-487f-a16d-875a3d3095aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15a9ff0d0>]}
[0m12:23:54.178583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4b1f8cc1-343d-487f-a16d-875a3d3095aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x159e4af70>]}
[0m12:23:54.179015 [info ] [MainThread]: Found 10 models, 1 snapshot, 1 seed, 47 tests, 4 sources, 0 exposures, 0 metrics, 431 macros, 0 groups, 0 semantic models
[0m12:23:54.179275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b1f8cc1-343d-487f-a16d-875a3d3095aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1598842b0>]}
[0m12:23:54.181130 [info ] [MainThread]: 
[0m12:23:54.181796 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:23:54.183546 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE'
[0m12:23:54.184743 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE'
[0m12:23:54.193033 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE"
[0m12:23:54.194917 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE"
[0m12:23:54.195420 [debug] [ThreadPool]: On list_E_COMMERCE: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE"} */
show terse schemas in database E_COMMERCE
    limit 10000
[0m12:23:54.195665 [debug] [ThreadPool]: On list_E_COMMERCE: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE"} */
show terse schemas in database E_COMMERCE
    limit 10000
[0m12:23:54.195866 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:23:54.196044 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:23:55.528035 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m12:23:55.529843 [debug] [ThreadPool]: On list_E_COMMERCE: Close
[0m12:23:55.543726 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m12:23:55.545437 [debug] [ThreadPool]: On list_E_COMMERCE: Close
[0m12:23:55.895029 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_E_COMMERCE, now list_E_COMMERCE_snapshots)
[0m12:23:55.898223 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_E_COMMERCE, now list_E_COMMERCE_PUBLIC)
[0m12:23:55.899430 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_marts'
[0m12:23:55.910844 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PUBLIC"
[0m12:23:55.970430 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_marts"
[0m12:23:55.970938 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_staging'
[0m12:23:55.973706 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_snapshots"
[0m12:23:55.974014 [debug] [ThreadPool]: On list_E_COMMERCE_PUBLIC: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE_PUBLIC"} */
show terse objects in E_COMMERCE.PUBLIC limit 10000
[0m12:23:55.974266 [debug] [ThreadPool]: On list_E_COMMERCE_marts: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE_marts"} */
show terse objects in E_COMMERCE.marts limit 10000
[0m12:23:55.975783 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_staging"
[0m12:23:55.976049 [debug] [ThreadPool]: On list_E_COMMERCE_snapshots: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE_snapshots"} */
show terse objects in E_COMMERCE.snapshots limit 10000
[0m12:23:55.976270 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:23:55.976464 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:23:55.976690 [debug] [ThreadPool]: On list_E_COMMERCE_staging: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE_staging"} */
show terse objects in E_COMMERCE.staging limit 10000
[0m12:23:55.976909 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:23:55.978168 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:23:57.107618 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m12:23:57.109504 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m12:23:57.113736 [debug] [ThreadPool]: On list_E_COMMERCE_staging: Close
[0m12:23:57.116534 [debug] [ThreadPool]: On list_E_COMMERCE_marts: Close
[0m12:23:57.176308 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:23:57.179010 [debug] [ThreadPool]: On list_E_COMMERCE_snapshots: Close
[0m12:23:57.224722 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b079eb-0001-834e-0004-d8be000113f2
[0m12:23:57.225095 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m12:23:57.225486 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m12:23:57.225760 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m12:23:57.226089 [debug] [ThreadPool]: On list_E_COMMERCE_PUBLIC: Close
[0m12:23:57.580491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b1f8cc1-343d-487f-a16d-875a3d3095aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15a9ffc10>]}
[0m12:23:57.581999 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m12:23:57.582642 [info ] [MainThread]: 
[0m12:23:57.587411 [debug] [Thread-1  ]: Began running node model.billy_bulky.staging__shopify__products_history
[0m12:23:57.588279 [debug] [Thread-2  ]: Began running node model.billy_bulky.staging_shopify__customers
[0m12:23:57.590895 [debug] [Thread-4  ]: Began running node model.billy_bulky.staging_shopify__products
[0m12:23:57.590109 [info ] [Thread-1  ]: 1 of 7 START sql view model staging.staging__shopify__products_history ......... [RUN]
[0m12:23:57.588960 [debug] [Thread-3  ]: Began running node model.billy_bulky.staging_shopify__orders
[0m12:23:57.591887 [info ] [Thread-2  ]: 2 of 7 START sql view model staging.staging_shopify__customers ................. [RUN]
[0m12:23:57.593767 [info ] [Thread-4  ]: 4 of 7 START sql view model staging.staging_shopify__products .................. [RUN]
[0m12:23:57.594882 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_E_COMMERCE_snapshots, now model.billy_bulky.staging__shopify__products_history)
[0m12:23:57.595569 [info ] [Thread-3  ]: 3 of 7 START sql view model staging.staging_shopify__orders .................... [RUN]
[0m12:23:57.596495 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_E_COMMERCE_PUBLIC, now model.billy_bulky.staging_shopify__customers)
[0m12:23:57.597359 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly list_E_COMMERCE_staging, now model.billy_bulky.staging_shopify__products)
[0m12:23:57.597902 [debug] [Thread-1  ]: Began compiling node model.billy_bulky.staging__shopify__products_history
[0m12:23:57.598747 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly list_E_COMMERCE_marts, now model.billy_bulky.staging_shopify__orders)
[0m12:23:57.599274 [debug] [Thread-2  ]: Began compiling node model.billy_bulky.staging_shopify__customers
[0m12:23:57.599778 [debug] [Thread-4  ]: Began compiling node model.billy_bulky.staging_shopify__products
[0m12:23:57.608078 [debug] [Thread-3  ]: Began compiling node model.billy_bulky.staging_shopify__orders
[0m12:23:57.612100 [debug] [Thread-2  ]: Writing injected SQL for node "model.billy_bulky.staging_shopify__customers"
[0m12:23:57.615754 [debug] [Thread-1  ]: Writing injected SQL for node "model.billy_bulky.staging__shopify__products_history"
[0m12:23:57.619178 [debug] [Thread-4  ]: Writing injected SQL for node "model.billy_bulky.staging_shopify__products"
[0m12:23:57.622121 [debug] [Thread-3  ]: Writing injected SQL for node "model.billy_bulky.staging_shopify__orders"
[0m12:23:57.622989 [debug] [Thread-2  ]: Timing info for model.billy_bulky.staging_shopify__customers (compile): 12:23:57.608467 => 12:23:57.622747
[0m12:23:57.623466 [debug] [Thread-4  ]: Timing info for model.billy_bulky.staging_shopify__products (compile): 12:23:57.616150 => 12:23:57.623220
[0m12:23:57.623859 [debug] [Thread-2  ]: Began executing node model.billy_bulky.staging_shopify__customers
[0m12:23:57.624316 [debug] [Thread-4  ]: Began executing node model.billy_bulky.staging_shopify__products
[0m12:23:57.624742 [debug] [Thread-3  ]: Timing info for model.billy_bulky.staging_shopify__orders (compile): 12:23:57.619481 => 12:23:57.624539
[0m12:23:57.625213 [debug] [Thread-1  ]: Timing info for model.billy_bulky.staging__shopify__products_history (compile): 12:23:57.600103 => 12:23:57.624959
[0m12:23:57.655327 [debug] [Thread-2  ]: Writing runtime sql for node "model.billy_bulky.staging_shopify__customers"
[0m12:23:57.655851 [debug] [Thread-4  ]: Writing runtime sql for node "model.billy_bulky.staging_shopify__products"
[0m12:23:57.656132 [debug] [Thread-3  ]: Began executing node model.billy_bulky.staging_shopify__orders
[0m12:23:57.656402 [debug] [Thread-1  ]: Began executing node model.billy_bulky.staging__shopify__products_history
[0m12:23:57.658673 [debug] [Thread-3  ]: Writing runtime sql for node "model.billy_bulky.staging_shopify__orders"
[0m12:23:57.661956 [debug] [Thread-1  ]: Writing runtime sql for node "model.billy_bulky.staging__shopify__products_history"
[0m12:23:57.662546 [debug] [Thread-2  ]: Using snowflake connection "model.billy_bulky.staging_shopify__customers"
[0m12:23:57.663005 [debug] [Thread-4  ]: Using snowflake connection "model.billy_bulky.staging_shopify__products"
[0m12:23:57.663358 [debug] [Thread-2  ]: On model.billy_bulky.staging_shopify__customers: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.staging_shopify__customers"} */
create or replace   view E_COMMERCE.staging.staging_shopify__customers
  
   as (
    WITH customers AS (
    SELECT * FROM SHOPIFY.PUBLIC.customers
)

SELECT
    CUSTOMER_ID
    , FIRST_NAME
    , LAST_NAME
    , EMAIL
    , JOIN_DATE
    , COUNTRY
FROM customers
  );
[0m12:23:57.663662 [debug] [Thread-4  ]: On model.billy_bulky.staging_shopify__products: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.staging_shopify__products"} */
create or replace   view E_COMMERCE.staging.staging_shopify__products
  
   as (
    WITH products AS (
    SELECT * FROM SHOPIFY.PUBLIC.products
)

SELECT
    PRODUCT_ID
    , NAME
    , CATEGORY
    , PRICE
    , STOCK_LEVEL
FROM products
  );
[0m12:23:57.663966 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m12:23:57.664467 [debug] [Thread-3  ]: Using snowflake connection "model.billy_bulky.staging_shopify__orders"
[0m12:23:57.664720 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m12:23:57.665247 [debug] [Thread-1  ]: Using snowflake connection "model.billy_bulky.staging__shopify__products_history"
[0m12:23:57.665693 [debug] [Thread-3  ]: On model.billy_bulky.staging_shopify__orders: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.staging_shopify__orders"} */
create or replace   view E_COMMERCE.staging.staging_shopify__orders
  
   as (
    WITH orders AS (
    SELECT * FROM SHOPIFY.PUBLIC.orders
)

SELECT
    ORDER_ID
    , CUSTOMER_ID
    , PRODUCT_ID
    , QUANTITY
    , ORDER_DATE
    , STATUS
FROM orders
  );
[0m12:23:57.666583 [debug] [Thread-1  ]: On model.billy_bulky.staging__shopify__products_history: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.staging__shopify__products_history"} */
create or replace   view E_COMMERCE.staging.staging__shopify__products_history
  
   as (
    WITH products AS (
    SELECT * FROM E_COMMERCE.SNAPSHOTS.products_snapshot
)

SELECT
    PRODUCT_ID
    , NAME
    , CATEGORY
    , PRICE
    , STOCK_LEVEL
    , DBT_SCD_ID
    , DBT_UPDATED_AT
    , DBT_VALID_FROM
    , DBT_VALID_TO
FROM products
  );
[0m12:23:57.667124 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m12:23:57.667607 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:23:58.924236 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:23:58.926394 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:23:58.934856 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:23:58.978024 [debug] [Thread-4  ]: Timing info for model.billy_bulky.staging_shopify__products (execute): 12:23:57.644833 => 12:23:58.977797
[0m12:23:58.979115 [debug] [Thread-2  ]: Timing info for model.billy_bulky.staging_shopify__customers (execute): 12:23:57.625442 => 12:23:58.978907
[0m12:23:58.980080 [debug] [Thread-1  ]: Timing info for model.billy_bulky.staging__shopify__products_history (execute): 12:23:57.658938 => 12:23:58.979871
[0m12:23:58.980451 [debug] [Thread-4  ]: On model.billy_bulky.staging_shopify__products: Close
[0m12:23:58.981346 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:23:58.981670 [debug] [Thread-2  ]: On model.billy_bulky.staging_shopify__customers: Close
[0m12:23:58.981997 [debug] [Thread-1  ]: On model.billy_bulky.staging__shopify__products_history: Close
[0m12:23:58.984723 [debug] [Thread-3  ]: Timing info for model.billy_bulky.staging_shopify__orders (execute): 12:23:57.656693 => 12:23:58.984544
[0m12:23:58.987060 [debug] [Thread-3  ]: On model.billy_bulky.staging_shopify__orders: Close
[0m12:23:59.432067 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b1f8cc1-343d-487f-a16d-875a3d3095aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x159ebbfd0>]}
[0m12:23:59.433804 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b1f8cc1-343d-487f-a16d-875a3d3095aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x159df6cd0>]}
[0m12:23:59.436978 [info ] [Thread-3  ]: 3 of 7 OK created sql view model staging.staging_shopify__orders ............... [[32mSUCCESS 1[0m in 1.83s]
[0m12:23:59.439117 [debug] [Thread-3  ]: Finished running node model.billy_bulky.staging_shopify__orders
[0m12:23:59.438032 [info ] [Thread-4  ]: 4 of 7 OK created sql view model staging.staging_shopify__products ............. [[32mSUCCESS 1[0m in 1.84s]
[0m12:23:59.440576 [debug] [Thread-4  ]: Finished running node model.billy_bulky.staging_shopify__products
[0m12:23:59.441732 [debug] [Thread-6  ]: Began running node model.billy_bulky.int_products_performance
[0m12:23:59.443189 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b1f8cc1-343d-487f-a16d-875a3d3095aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15a6b4eb0>]}
[0m12:23:59.444036 [debug] [Thread-7  ]: Began running node model.billy_bulky.int_sales_trend
[0m12:23:59.445433 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b1f8cc1-343d-487f-a16d-875a3d3095aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1597fdf70>]}
[0m12:23:59.446650 [debug] [Thread-6  ]: Acquiring new snowflake connection 'model.billy_bulky.int_products_performance'
[0m12:23:59.447732 [info ] [Thread-1  ]: 1 of 7 OK created sql view model staging.staging__shopify__products_history .... [[32mSUCCESS 1[0m in 1.85s]
[0m12:23:59.448956 [debug] [Thread-7  ]: Acquiring new snowflake connection 'model.billy_bulky.int_sales_trend'
[0m12:23:59.450080 [info ] [Thread-2  ]: 2 of 7 OK created sql view model staging.staging_shopify__customers ............ [[32mSUCCESS 1[0m in 1.85s]
[0m12:23:59.450807 [debug] [Thread-6  ]: Began compiling node model.billy_bulky.int_products_performance
[0m12:23:59.451683 [debug] [Thread-1  ]: Finished running node model.billy_bulky.staging__shopify__products_history
[0m12:23:59.452238 [debug] [Thread-7  ]: Began compiling node model.billy_bulky.int_sales_trend
[0m12:23:59.452978 [debug] [Thread-2  ]: Finished running node model.billy_bulky.staging_shopify__customers
[0m12:23:59.458583 [debug] [Thread-6  ]: Writing injected SQL for node "model.billy_bulky.int_products_performance"
[0m12:23:59.464288 [debug] [Thread-7  ]: Writing injected SQL for node "model.billy_bulky.int_sales_trend"
[0m12:23:59.465395 [debug] [Thread-9  ]: Began running node model.billy_bulky.int_customers_segmentation
[0m12:23:59.466589 [debug] [Thread-9  ]: Acquiring new snowflake connection 'model.billy_bulky.int_customers_segmentation'
[0m12:23:59.467123 [debug] [Thread-9  ]: Began compiling node model.billy_bulky.int_customers_segmentation
[0m12:23:59.471136 [debug] [Thread-9  ]: Writing injected SQL for node "model.billy_bulky.int_customers_segmentation"
[0m12:23:59.471855 [debug] [Thread-6  ]: Timing info for model.billy_bulky.int_products_performance (compile): 12:23:59.453321 => 12:23:59.471618
[0m12:23:59.472387 [debug] [Thread-7  ]: Timing info for model.billy_bulky.int_sales_trend (compile): 12:23:59.459112 => 12:23:59.472104
[0m12:23:59.473301 [debug] [Thread-6  ]: Finished running node model.billy_bulky.int_products_performance
[0m12:23:59.474138 [debug] [Thread-7  ]: Finished running node model.billy_bulky.int_sales_trend
[0m12:23:59.474629 [debug] [Thread-9  ]: Timing info for model.billy_bulky.int_customers_segmentation (compile): 12:23:59.467446 => 12:23:59.474389
[0m12:23:59.475680 [debug] [Thread-9  ]: Finished running node model.billy_bulky.int_customers_segmentation
[0m12:23:59.476264 [debug] [Thread-5  ]: Began running node model.billy_bulky.products
[0m12:23:59.476719 [debug] [Thread-3  ]: Began running node model.billy_bulky.sales
[0m12:23:59.477348 [debug] [Thread-8  ]: Began running node model.billy_bulky.customers
[0m12:23:59.477802 [info ] [Thread-5  ]: 5 of 7 START sql table model marts.products .................................... [RUN]
[0m12:23:59.478291 [info ] [Thread-3  ]: 6 of 7 START sql table model marts.sales ....................................... [RUN]
[0m12:23:59.478790 [info ] [Thread-8  ]: 7 of 7 START sql table model marts.customers ................................... [RUN]
[0m12:23:59.479585 [debug] [Thread-5  ]: Acquiring new snowflake connection 'model.billy_bulky.products'
[0m12:23:59.480244 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.billy_bulky.staging_shopify__orders, now model.billy_bulky.sales)
[0m12:23:59.480907 [debug] [Thread-8  ]: Acquiring new snowflake connection 'model.billy_bulky.customers'
[0m12:23:59.481272 [debug] [Thread-5  ]: Began compiling node model.billy_bulky.products
[0m12:23:59.481616 [debug] [Thread-3  ]: Began compiling node model.billy_bulky.sales
[0m12:23:59.481945 [debug] [Thread-8  ]: Began compiling node model.billy_bulky.customers
[0m12:23:59.488381 [debug] [Thread-5  ]: Writing injected SQL for node "model.billy_bulky.products"
[0m12:23:59.499053 [debug] [Thread-3  ]: Writing injected SQL for node "model.billy_bulky.sales"
[0m12:23:59.507048 [debug] [Thread-8  ]: Writing injected SQL for node "model.billy_bulky.customers"
[0m12:23:59.507891 [debug] [Thread-5  ]: Timing info for model.billy_bulky.products (compile): 12:23:59.482154 => 12:23:59.507718
[0m12:23:59.508243 [debug] [Thread-8  ]: Timing info for model.billy_bulky.customers (compile): 12:23:59.499312 => 12:23:59.508071
[0m12:23:59.508534 [debug] [Thread-5  ]: Began executing node model.billy_bulky.products
[0m12:23:59.508850 [debug] [Thread-3  ]: Timing info for model.billy_bulky.sales (compile): 12:23:59.488638 => 12:23:59.508704
[0m12:23:59.509146 [debug] [Thread-8  ]: Began executing node model.billy_bulky.customers
[0m12:23:59.521700 [debug] [Thread-3  ]: Began executing node model.billy_bulky.sales
[0m12:23:59.524426 [debug] [Thread-5  ]: Writing runtime sql for node "model.billy_bulky.products"
[0m12:23:59.527314 [debug] [Thread-8  ]: Writing runtime sql for node "model.billy_bulky.customers"
[0m12:23:59.529146 [debug] [Thread-3  ]: Writing runtime sql for node "model.billy_bulky.sales"
[0m12:23:59.531445 [debug] [Thread-8  ]: Using snowflake connection "model.billy_bulky.customers"
[0m12:23:59.533761 [debug] [Thread-3  ]: Using snowflake connection "model.billy_bulky.sales"
[0m12:23:59.534110 [debug] [Thread-8  ]: On model.billy_bulky.customers: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.customers"} */
create or replace transient table E_COMMERCE.marts.customers
         as
        (WITH  __dbt__cte__int_customers_segmentation as (
WITH customers AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__customers
)

, orders AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__orders
)

, products AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__products
)

, order_aggregates AS (
    SELECT
        o.CUSTOMER_ID
        , COUNT(DISTINCT o.ORDER_ID) AS frequency
        , SUM(o.QUANTITY * p.PRICE) AS monetary
        , AVG(o.QUANTITY * p.PRICE) AS average_order_value
        , MAX(o.ORDER_DATE) AS last_purchase_date
        , COUNT(CASE WHEN o.STATUS = 'cancelled' THEN 1 END) AS cancelled_orders
        , COUNT(*) AS total_orders
    FROM orders o
    JOIN products p ON o.PRODUCT_ID = p.PRODUCT_ID
    GROUP BY o.CUSTOMER_ID
)

, customer_tenure AS (
    SELECT
        CUSTOMER_ID
        , JOIN_DATE
        , CURRENT_DATE - JOIN_DATE AS tenure
    FROM customers
)

, customer_recency AS (
    SELECT
        CUSTOMER_ID
        , CURRENT_DATE - last_purchase_date AS recency
    FROM order_aggregates
)

, final AS (
    SELECT
        c.CUSTOMER_ID
        , c.FIRST_NAME
        , c.LAST_NAME
        , c.EMAIL
        , c.JOIN_DATE
        , c.COUNTRY
        , o.frequency
        , o.monetary
        , o.average_order_value
        , o.cancelled_orders
        , o.total_orders
        , CASE 
            WHEN o.total_orders > 0 THEN ROUND((o.cancelled_orders::FLOAT / o.total_orders) * 100, 2) 
            ELSE 0 
          END AS cancellation_rate
        , r.recency
        , t.tenure
    FROM customer_tenure t
    JOIN customers c ON t.CUSTOMER_ID = c.CUSTOMER_ID
    JOIN order_aggregates o ON c.CUSTOMER_ID = o.CUSTOMER_ID
    JOIN customer_recency r ON c.CUSTOMER_ID = r.CUSTOMER_ID
)

SELECT * FROM final
), source AS (
    SELECT
        icp.CUSTOMER_ID
        , icp.FIRST_NAME
        , icp.LAST_NAME
        , icp.EMAIL
        , icp.JOIN_DATE
        , icp.COUNTRY
        , icp.frequency AS total_orders
        , icp.monetary AS total_spent
        , icp.recency
        , icp.tenure
    FROM __dbt__cte__int_customers_segmentation icp
)

, final AS (
SELECT
    s.CUSTOMER_ID
    , s.FIRST_NAME
    , s.LAST_NAME
    , s.EMAIL
    , s.JOIN_DATE
    , s.COUNTRY
    , s.total_orders
    , s.total_spent
    , s.recency
    , s.tenure
    , CASE
        WHEN total_spent > 1000 THEN 'VIP'
        ELSE 'Regular'
    END AS customer_segment
FROM source s
)

SELECT * FROM final
        );
[0m12:23:59.535669 [debug] [Thread-5  ]: Using snowflake connection "model.billy_bulky.products"
[0m12:23:59.536022 [debug] [Thread-3  ]: On model.billy_bulky.sales: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.sales"} */
create or replace transient table E_COMMERCE.marts.sales
         as
        (WITH  __dbt__cte__int_sales_trend as (
WITH orders AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__orders
)

, products AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__products
)

, daily_sales AS (
    SELECT
        DATE(ORDER_DATE) AS sale_date
        , COUNT(DISTINCT ORDER_ID) AS total_orders
        , SUM(QUANTITY) AS total_units_sold
        , SUM(QUANTITY * PRICE) AS total_sales_value
    FROM orders AS o
    JOIN products AS p ON o.PRODUCT_ID = p.PRODUCT_ID
    WHERE o.STATUS NOT IN ('cancelled') 
    GROUP BY sale_date
)

, weekly_sales AS (
    SELECT
        DATE_TRUNC('week', sale_date) AS sale_week
        , SUM(total_orders) AS weekly_orders
        , SUM(total_units_sold) AS weekly_units_sold
        , SUM(total_sales_value) AS weekly_sales_value
    FROM daily_sales
    GROUP BY sale_week
)

, monthly_sales AS (
    SELECT
        DATE_TRUNC('month', sale_date) AS sale_month
        , SUM(total_orders) AS monthly_orders
        , SUM(total_units_sold) AS monthly_units_sold
        , SUM(total_sales_value) AS monthly_sales_value
    FROM daily_sales
    GROUP BY sale_month
)

, yearly_sales AS (
    SELECT
        DATE_TRUNC('year', sale_date) AS sale_year
        , SUM(total_orders) AS yearly_orders
        , SUM(total_units_sold) AS yearly_units_sold
        , SUM(total_sales_value) AS yearly_sales_value
    FROM daily_sales
    GROUP BY sale_year
)

SELECT
    d.sale_date
    , d.total_orders AS daily_orders
    , d.total_units_sold AS daily_units_sold
    , d.total_sales_value AS daily_sales_value
    , w.weekly_orders
    , w.weekly_units_sold
    , w.weekly_sales_value
    , m.monthly_orders
    , m.monthly_units_sold
    , m.monthly_sales_value
    , y.yearly_orders
    , y.yearly_units_sold
    , y.yearly_sales_value
FROM daily_sales d
LEFT JOIN weekly_sales w ON DATE_TRUNC('week', d.sale_date) = w.sale_week
LEFT JOIN monthly_sales m ON DATE_TRUNC('month', d.sale_date) = m.sale_month
LEFT JOIN yearly_sales y ON DATE_TRUNC('year', d.sale_date) = y.sale_year
), enriched_orders AS (
    SELECT
        o.ORDER_ID
        , o.CUSTOMER_ID
        , o.PRODUCT_ID
        , o.QUANTITY
        , o.ORDER_DATE
        , o.STATUS
        , p.CATEGORY
        , p.PRICE AS unit_price
        , (o.QUANTITY * p.PRICE) AS total_price
        , c.COUNTRY
    FROM E_COMMERCE.staging.staging_shopify__orders o
    JOIN E_COMMERCE.staging.staging_shopify__products p ON o.PRODUCT_ID = p.PRODUCT_ID
    JOIN E_COMMERCE.staging.staging_shopify__customers c ON o.CUSTOMER_ID = c.CUSTOMER_ID
    WHERE o.STATUS NOT IN ('cancelled') 
)

SELECT
    eo.ORDER_ID
    , eo.CUSTOMER_ID
    , eo.PRODUCT_ID
    , eo.QUANTITY
    , eo.ORDER_DATE
    , eo.STATUS
    , eo.CATEGORY
    , eo.unit_price
    , eo.total_price
    , eo.COUNTRY
    , sa.daily_orders
    , sa.daily_units_sold
    , sa.daily_sales_value
FROM enriched_orders eo
LEFT JOIN __dbt__cte__int_sales_trend sa ON DATE(eo.ORDER_DATE) = sa.sale_date
        );
[0m12:23:59.536354 [debug] [Thread-8  ]: Opening a new connection, currently in state init
[0m12:23:59.536658 [debug] [Thread-5  ]: On model.billy_bulky.products: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.products"} */
create or replace transient table E_COMMERCE.marts.products
         as
        (WITH  __dbt__cte__int_products_performance as (
WITH orders AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__orders
)

, products AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__products
)

, product_sales AS (
    SELECT
        o.PRODUCT_ID
        , COUNT(DISTINCT o.ORDER_ID) AS total_sales
        , SUM(o.QUANTITY) AS total_units_sold
        , SUM(o.QUANTITY * p.PRICE) AS total_sales_value
    FROM orders o
    INNER JOIN products p ON o.PRODUCT_ID = p.PRODUCT_ID
    WHERE o.STATUS NOT IN ('cancelled') 
    GROUP BY o.PRODUCT_ID
)

, product_averages AS (
    SELECT
        PRODUCT_ID
        , (total_sales_value / NULLIF(total_units_sold, 0)) AS average_sale_price
    FROM product_sales
)

, product_stock_turnover AS (
    SELECT
        p.PRODUCT_ID
        , p.STOCK_LEVEL
        , (total_units_sold / NULLIF(p.STOCK_LEVEL, 0)) AS turnover_rate
    FROM product_sales ps
    INNER JOIN products p ON ps.PRODUCT_ID = p.PRODUCT_ID
)

, final AS (
    SELECT
    p.PRODUCT_ID
    , p.NAME
    , p.CATEGORY
    , p.PRICE
    , pa.average_sale_price
    , ps.total_sales
    , ps.total_units_sold
    , ps.total_sales_value
    , pst.turnover_rate
    , p.STOCK_LEVEL
FROM products p
LEFT JOIN product_sales ps ON p.PRODUCT_ID = ps.PRODUCT_ID
LEFT JOIN product_averages pa ON p.PRODUCT_ID = pa.PRODUCT_ID
LEFT JOIN product_stock_turnover pst ON p.PRODUCT_ID = pst.PRODUCT_ID
)

SELECT * FROM final
), final AS (
    SELECT
        pp.PRODUCT_ID
        , pp.NAME
        , pp.CATEGORY
        , pp.PRICE
        , pp.average_sale_price
        , pp.total_sales
        , pp.total_units_sold
        , pp.total_sales_value
        , pp.turnover_rate
        , pp.STOCK_LEVEL
    FROM __dbt__cte__int_products_performance pp
)

SELECT * FROM final
        );
[0m12:23:59.536952 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m12:23:59.537332 [debug] [Thread-5  ]: Opening a new connection, currently in state init
[0m12:24:02.085862 [debug] [Thread-8  ]: SQL status: SUCCESS 1 in 3.0 seconds
[0m12:24:02.088528 [debug] [Thread-8  ]: Timing info for model.billy_bulky.customers (execute): 12:23:59.524601 => 12:24:02.088397
[0m12:24:02.088784 [debug] [Thread-8  ]: On model.billy_bulky.customers: Close
[0m12:24:02.317332 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 3.0 seconds
[0m12:24:02.324511 [debug] [Thread-3  ]: Timing info for model.billy_bulky.sales (execute): 12:23:59.527553 => 12:24:02.324023
[0m12:24:02.325297 [debug] [Thread-3  ]: On model.billy_bulky.sales: Close
[0m12:24:02.377438 [debug] [Thread-5  ]: SQL status: SUCCESS 1 in 3.0 seconds
[0m12:24:02.383848 [debug] [Thread-5  ]: Timing info for model.billy_bulky.products (execute): 12:23:59.509319 => 12:24:02.383405
[0m12:24:02.384573 [debug] [Thread-5  ]: On model.billy_bulky.products: Close
[0m12:24:02.464046 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b1f8cc1-343d-487f-a16d-875a3d3095aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15a68e850>]}
[0m12:24:02.465250 [info ] [Thread-8  ]: 7 of 7 OK created sql table model marts.customers .............................. [[32mSUCCESS 1[0m in 2.98s]
[0m12:24:02.466373 [debug] [Thread-8  ]: Finished running node model.billy_bulky.customers
[0m12:24:02.673977 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b1f8cc1-343d-487f-a16d-875a3d3095aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15a68e850>]}
[0m12:24:02.674991 [info ] [Thread-3  ]: 6 of 7 OK created sql table model marts.sales .................................. [[32mSUCCESS 1[0m in 3.19s]
[0m12:24:02.675513 [debug] [Thread-3  ]: Finished running node model.billy_bulky.sales
[0m12:24:02.749223 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b1f8cc1-343d-487f-a16d-875a3d3095aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15a55e580>]}
[0m12:24:02.749847 [info ] [Thread-5  ]: 5 of 7 OK created sql table model marts.products ............................... [[32mSUCCESS 1[0m in 3.27s]
[0m12:24:02.750368 [debug] [Thread-5  ]: Finished running node model.billy_bulky.products
[0m12:24:02.752019 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:24:02.752404 [debug] [MainThread]: Connection 'model.billy_bulky.staging__shopify__products_history' was properly closed.
[0m12:24:02.752674 [debug] [MainThread]: Connection 'model.billy_bulky.staging_shopify__customers' was properly closed.
[0m12:24:02.752855 [debug] [MainThread]: Connection 'model.billy_bulky.sales' was properly closed.
[0m12:24:02.753035 [debug] [MainThread]: Connection 'model.billy_bulky.staging_shopify__products' was properly closed.
[0m12:24:02.753281 [debug] [MainThread]: Connection 'model.billy_bulky.int_products_performance' was properly closed.
[0m12:24:02.753484 [debug] [MainThread]: Connection 'model.billy_bulky.int_sales_trend' was properly closed.
[0m12:24:02.753670 [debug] [MainThread]: Connection 'model.billy_bulky.int_customers_segmentation' was properly closed.
[0m12:24:02.753849 [debug] [MainThread]: Connection 'model.billy_bulky.products' was properly closed.
[0m12:24:02.754110 [debug] [MainThread]: Connection 'model.billy_bulky.customers' was properly closed.
[0m12:24:02.754425 [info ] [MainThread]: 
[0m12:24:02.754666 [info ] [MainThread]: Finished running 4 view models, 3 table models in 0 hours 0 minutes and 8.57 seconds (8.57s).
[0m12:24:02.755524 [debug] [MainThread]: Command end result
[0m12:24:02.765781 [info ] [MainThread]: 
[0m12:24:02.766218 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:24:02.766504 [info ] [MainThread]: 
[0m12:24:02.766760 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m12:24:02.768858 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.49583, "process_user_time": 6.071379, "process_kernel_time": 0.427296, "process_mem_max_rss": "228065280", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:24:02.769278 [debug] [MainThread]: Command `dbt run` succeeded at 12:24:02.769191 after 10.50 seconds
[0m12:24:02.769551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103cb16d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1598c87f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x159db2e80>]}
[0m12:24:02.769837 [debug] [MainThread]: Flushing usage events
[0m12:56:11.134812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107eb10d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1132f8af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113315ee0>]}


============================== 12:56:11.137564 | ee1ed69a-3f13-4627-a338-a8f581e9a212 ==============================
[0m12:56:11.137564 [info ] [MainThread]: Running with dbt=1.7.1
[0m12:56:11.137920 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/bitlevi/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/bitlevi/Documents/billy_bulky_ecommerce/billy_bulky_ecommerce/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:56:11.994050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ee1ed69a-3f13-4627-a338-a8f581e9a212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13d86de20>]}
[0m12:56:12.041581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ee1ed69a-3f13-4627-a338-a8f581e9a212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13d9e5700>]}
[0m12:56:12.042197 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m12:56:12.055739 [debug] [MainThread]: checksum: ad428e6dc3b353dcb23d0c4ebea8b20b180e94b873271ac2a054a8e446dac0e2, vars: {}, profile: , target: , version: 1.7.1
[0m12:56:12.092028 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m12:56:12.092549 [debug] [MainThread]: Partial parsing: added file: billy_bulky://models/intermediate/products/int_products__inventory.sql
[0m12:56:12.092870 [debug] [MainThread]: Partial parsing: updated file: billy_bulky://models/intermediate/products/_int_products__models.yml
[0m12:56:12.197836 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'int_products_inventory' in the 'models' section of file 'models/intermediate/products/_int_products__models.yml'
[0m12:56:12.303992 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_int_products_inventory_snapshot_date.ea839d8715' (models/intermediate/products/_int_products__models.yml) depends on a node named 'int_products_inventory' in package '' which was not found
[0m12:56:12.304361 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.unique_int_products_inventory_snapshot_date.957e4a3412' (models/intermediate/products/_int_products__models.yml) depends on a node named 'int_products_inventory' in package '' which was not found
[0m12:56:12.304664 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.date_int_products_inventory_snapshot_date.a5f6775670' (models/intermediate/products/_int_products__models.yml) depends on a node named 'int_products_inventory' in package '' which was not found
[0m12:56:12.304912 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_int_products_inventory_product_id.f6ac5935e3' (models/intermediate/products/_int_products__models.yml) depends on a node named 'int_products_inventory' in package '' which was not found
[0m12:56:12.305151 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.relationships_int_products_inventory_product_id__product_id__ref_staging_shopify__products_.74f8c28027' (models/intermediate/products/_int_products__models.yml) depends on a node named 'int_products_inventory' in package '' which was not found
[0m12:56:12.305388 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_int_products_inventory_stock_level.31d0098b4a' (models/intermediate/products/_int_products__models.yml) depends on a node named 'int_products_inventory' in package '' which was not found
[0m12:56:12.305604 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.numeric_int_products_inventory_stock_level.dd2cae1df8' (models/intermediate/products/_int_products__models.yml) depends on a node named 'int_products_inventory' in package '' which was not found
[0m12:56:12.316559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ee1ed69a-3f13-4627-a338-a8f581e9a212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13ea2c0d0>]}
[0m12:56:12.329061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ee1ed69a-3f13-4627-a338-a8f581e9a212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13e640eb0>]}
[0m12:56:12.329403 [info ] [MainThread]: Found 11 models, 1 snapshot, 1 seed, 47 tests, 4 sources, 0 exposures, 0 metrics, 431 macros, 0 groups, 0 semantic models
[0m12:56:12.329624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee1ed69a-3f13-4627-a338-a8f581e9a212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13e6407c0>]}
[0m12:56:12.331139 [info ] [MainThread]: 
[0m12:56:12.331647 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:56:12.332502 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE'
[0m12:56:12.332984 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE'
[0m12:56:12.339787 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE'
[0m12:56:12.342046 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE"
[0m12:56:12.343507 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE"
[0m12:56:12.344816 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE"
[0m12:56:12.345027 [debug] [ThreadPool]: On list_E_COMMERCE: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE"} */
show terse schemas in database E_COMMERCE
    limit 10000
[0m12:56:12.345222 [debug] [ThreadPool]: On list_E_COMMERCE: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE"} */
show terse schemas in database E_COMMERCE
    limit 10000
[0m12:56:12.345408 [debug] [ThreadPool]: On list_E_COMMERCE: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE"} */
show terse schemas in database E_COMMERCE
    limit 10000
[0m12:56:12.345585 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:56:12.345757 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:56:12.345921 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:56:13.870864 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.0 seconds
[0m12:56:13.874949 [debug] [ThreadPool]: On list_E_COMMERCE: Close
[0m12:56:13.878424 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.0 seconds
[0m12:56:13.881018 [debug] [ThreadPool]: On list_E_COMMERCE: Close
[0m12:56:13.882267 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.0 seconds
[0m12:56:13.886433 [debug] [ThreadPool]: On list_E_COMMERCE: Close
[0m12:56:14.434366 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_E_COMMERCE, now list_E_COMMERCE_staging)
[0m12:56:14.435937 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_E_COMMERCE, now list_E_COMMERCE_snapshots)
[0m12:56:14.436637 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_E_COMMERCE, now list_E_COMMERCE_marts)
[0m12:56:14.444228 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_snapshots"
[0m12:56:14.444890 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PUBLIC'
[0m12:56:14.446664 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_staging"
[0m12:56:14.448553 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_marts"
[0m12:56:14.449145 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_intermediate'
[0m12:56:14.449507 [debug] [ThreadPool]: On list_E_COMMERCE_snapshots: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE_snapshots"} */
show terse objects in E_COMMERCE.snapshots limit 10000
[0m12:56:14.451356 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PUBLIC"
[0m12:56:14.451637 [debug] [ThreadPool]: On list_E_COMMERCE_staging: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE_staging"} */
show terse objects in E_COMMERCE.staging limit 10000
[0m12:56:14.451899 [debug] [ThreadPool]: On list_E_COMMERCE_marts: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE_marts"} */
show terse objects in E_COMMERCE.marts limit 10000
[0m12:56:14.453651 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_intermediate"
[0m12:56:14.453906 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:56:14.454158 [debug] [ThreadPool]: On list_E_COMMERCE_PUBLIC: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE_PUBLIC"} */
show terse objects in E_COMMERCE.PUBLIC limit 10000
[0m12:56:14.454391 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:56:14.454612 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:56:14.454847 [debug] [ThreadPool]: On list_E_COMMERCE_intermediate: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE_intermediate"} */
show terse objects in E_COMMERCE.intermediate limit 10000
[0m12:56:14.455577 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:56:14.458200 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:56:15.635141 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:56:15.635998 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m12:56:15.637668 [debug] [ThreadPool]: On list_E_COMMERCE_snapshots: Close
[0m12:56:15.638825 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m12:56:15.640366 [debug] [ThreadPool]: On list_E_COMMERCE_intermediate: Close
[0m12:56:15.643038 [debug] [ThreadPool]: On list_E_COMMERCE_marts: Close
[0m12:56:15.700276 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m12:56:15.701649 [debug] [ThreadPool]: On list_E_COMMERCE_staging: Close
[0m12:56:15.718590 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b07a0c-0001-834e-0004-d8be00011402
[0m12:56:15.718918 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m12:56:15.719240 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m12:56:15.719468 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m12:56:15.719736 [debug] [ThreadPool]: On list_E_COMMERCE_PUBLIC: Close
[0m12:56:16.072617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee1ed69a-3f13-4627-a338-a8f581e9a212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13eaabcd0>]}
[0m12:56:16.074136 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m12:56:16.074788 [info ] [MainThread]: 
[0m12:56:16.079442 [debug] [Thread-1  ]: Began running node model.billy_bulky.staging__shopify__products_history
[0m12:56:16.080119 [debug] [Thread-2  ]: Began running node model.billy_bulky.staging_shopify__customers
[0m12:56:16.080703 [debug] [Thread-3  ]: Began running node model.billy_bulky.staging_shopify__orders
[0m12:56:16.081367 [info ] [Thread-1  ]: 1 of 8 START sql view model staging.staging__shopify__products_history ......... [RUN]
[0m12:56:16.082948 [info ] [Thread-2  ]: 2 of 8 START sql view model staging.staging_shopify__customers ................. [RUN]
[0m12:56:16.083825 [info ] [Thread-3  ]: 3 of 8 START sql view model staging.staging_shopify__orders .................... [RUN]
[0m12:56:16.085028 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_E_COMMERCE_staging, now model.billy_bulky.staging__shopify__products_history)
[0m12:56:16.082031 [debug] [Thread-4  ]: Began running node model.billy_bulky.staging_shopify__products
[0m12:56:16.086708 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_E_COMMERCE_snapshots, now model.billy_bulky.staging_shopify__customers)
[0m12:56:16.087655 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly list_E_COMMERCE_marts, now model.billy_bulky.staging_shopify__orders)
[0m12:56:16.088251 [debug] [Thread-1  ]: Began compiling node model.billy_bulky.staging__shopify__products_history
[0m12:56:16.088933 [info ] [Thread-4  ]: 4 of 8 START sql view model staging.staging_shopify__products .................. [RUN]
[0m12:56:16.089520 [debug] [Thread-2  ]: Began compiling node model.billy_bulky.staging_shopify__customers
[0m12:56:16.090035 [debug] [Thread-3  ]: Began compiling node model.billy_bulky.staging_shopify__orders
[0m12:56:16.097211 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly list_E_COMMERCE_PUBLIC, now model.billy_bulky.staging_shopify__products)
[0m12:56:16.101338 [debug] [Thread-1  ]: Writing injected SQL for node "model.billy_bulky.staging__shopify__products_history"
[0m12:56:16.105195 [debug] [Thread-2  ]: Writing injected SQL for node "model.billy_bulky.staging_shopify__customers"
[0m12:56:16.108218 [debug] [Thread-3  ]: Writing injected SQL for node "model.billy_bulky.staging_shopify__orders"
[0m12:56:16.108690 [debug] [Thread-4  ]: Began compiling node model.billy_bulky.staging_shopify__products
[0m12:56:16.112021 [debug] [Thread-4  ]: Writing injected SQL for node "model.billy_bulky.staging_shopify__products"
[0m12:56:16.112723 [debug] [Thread-3  ]: Timing info for model.billy_bulky.staging_shopify__orders (compile): 12:56:16.105490 => 12:56:16.112503
[0m12:56:16.113168 [debug] [Thread-2  ]: Timing info for model.billy_bulky.staging_shopify__customers (compile): 12:56:16.101689 => 12:56:16.112954
[0m12:56:16.113612 [debug] [Thread-1  ]: Timing info for model.billy_bulky.staging__shopify__products_history (compile): 12:56:16.090377 => 12:56:16.113379
[0m12:56:16.113985 [debug] [Thread-3  ]: Began executing node model.billy_bulky.staging_shopify__orders
[0m12:56:16.114386 [debug] [Thread-4  ]: Timing info for model.billy_bulky.staging_shopify__products (compile): 12:56:16.109229 => 12:56:16.114188
[0m12:56:16.114755 [debug] [Thread-2  ]: Began executing node model.billy_bulky.staging_shopify__customers
[0m12:56:16.115134 [debug] [Thread-1  ]: Began executing node model.billy_bulky.staging__shopify__products_history
[0m12:56:16.143887 [debug] [Thread-4  ]: Began executing node model.billy_bulky.staging_shopify__products
[0m12:56:16.168002 [debug] [Thread-3  ]: Writing runtime sql for node "model.billy_bulky.staging_shopify__orders"
[0m12:56:16.169272 [debug] [Thread-2  ]: Writing runtime sql for node "model.billy_bulky.staging_shopify__customers"
[0m12:56:16.171649 [debug] [Thread-1  ]: Writing runtime sql for node "model.billy_bulky.staging__shopify__products_history"
[0m12:56:16.174959 [debug] [Thread-4  ]: Writing runtime sql for node "model.billy_bulky.staging_shopify__products"
[0m12:56:16.176216 [debug] [Thread-2  ]: Using snowflake connection "model.billy_bulky.staging_shopify__customers"
[0m12:56:16.176759 [debug] [Thread-1  ]: Using snowflake connection "model.billy_bulky.staging__shopify__products_history"
[0m12:56:16.177012 [debug] [Thread-2  ]: On model.billy_bulky.staging_shopify__customers: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.staging_shopify__customers"} */
create or replace   view E_COMMERCE.staging.staging_shopify__customers
  
   as (
    WITH customers AS (
    SELECT * FROM SHOPIFY.PUBLIC.customers
)

SELECT
    CUSTOMER_ID
    , FIRST_NAME
    , LAST_NAME
    , EMAIL
    , JOIN_DATE
    , COUNTRY
FROM customers
  );
[0m12:56:16.177463 [debug] [Thread-3  ]: Using snowflake connection "model.billy_bulky.staging_shopify__orders"
[0m12:56:16.177888 [debug] [Thread-4  ]: Using snowflake connection "model.billy_bulky.staging_shopify__products"
[0m12:56:16.178150 [debug] [Thread-1  ]: On model.billy_bulky.staging__shopify__products_history: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.staging__shopify__products_history"} */
create or replace   view E_COMMERCE.staging.staging__shopify__products_history
  
   as (
    WITH products AS (
    SELECT * FROM E_COMMERCE.SNAPSHOTS.products_snapshot
)

SELECT
    PRODUCT_ID
    , NAME
    , CATEGORY
    , PRICE
    , STOCK_LEVEL
    , DBT_SCD_ID
    , DBT_UPDATED_AT
    , DBT_VALID_FROM
    , DBT_VALID_TO
FROM products
  );
[0m12:56:16.178404 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m12:56:16.178647 [debug] [Thread-3  ]: On model.billy_bulky.staging_shopify__orders: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.staging_shopify__orders"} */
create or replace   view E_COMMERCE.staging.staging_shopify__orders
  
   as (
    WITH orders AS (
    SELECT * FROM SHOPIFY.PUBLIC.orders
)

SELECT
    ORDER_ID
    , CUSTOMER_ID
    , PRODUCT_ID
    , QUANTITY
    , ORDER_DATE
    , STATUS
FROM orders
  );
[0m12:56:16.178900 [debug] [Thread-4  ]: On model.billy_bulky.staging_shopify__products: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.staging_shopify__products"} */
create or replace   view E_COMMERCE.staging.staging_shopify__products
  
   as (
    WITH products AS (
    SELECT * FROM SHOPIFY.PUBLIC.products
)

SELECT
    PRODUCT_ID
    , NAME
    , CATEGORY
    , PRICE
    , STOCK_LEVEL
FROM products
  );
[0m12:56:16.179134 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:56:16.179516 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m12:56:16.179971 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m12:56:17.423028 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:56:17.448347 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:56:17.474705 [debug] [Thread-4  ]: Timing info for model.billy_bulky.staging_shopify__products (execute): 12:56:16.171923 => 12:56:17.474388
[0m12:56:17.478586 [debug] [Thread-3  ]: Timing info for model.billy_bulky.staging_shopify__orders (execute): 12:56:16.115363 => 12:56:17.478351
[0m12:56:17.479357 [debug] [Thread-4  ]: On model.billy_bulky.staging_shopify__products: Close
[0m12:56:17.480034 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:56:17.480624 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:56:17.481047 [debug] [Thread-3  ]: On model.billy_bulky.staging_shopify__orders: Close
[0m12:56:17.484393 [debug] [Thread-1  ]: Timing info for model.billy_bulky.staging__shopify__products_history (execute): 12:56:16.169512 => 12:56:17.484191
[0m12:56:17.486457 [debug] [Thread-2  ]: Timing info for model.billy_bulky.staging_shopify__customers (execute): 12:56:16.156450 => 12:56:17.486262
[0m12:56:17.488161 [debug] [Thread-1  ]: On model.billy_bulky.staging__shopify__products_history: Close
[0m12:56:17.488527 [debug] [Thread-2  ]: On model.billy_bulky.staging_shopify__customers: Close
[0m12:56:17.853234 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee1ed69a-3f13-4627-a338-a8f581e9a212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13eaac160>]}
[0m12:56:17.854834 [info ] [Thread-4  ]: 4 of 8 OK created sql view model staging.staging_shopify__products ............. [[32mSUCCESS 1[0m in 1.76s]
[0m12:56:17.857192 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee1ed69a-3f13-4627-a338-a8f581e9a212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13f652280>]}
[0m12:56:17.858696 [debug] [Thread-4  ]: Finished running node model.billy_bulky.staging_shopify__products
[0m12:56:17.860591 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee1ed69a-3f13-4627-a338-a8f581e9a212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13eaac130>]}
[0m12:56:17.862398 [info ] [Thread-3  ]: 3 of 8 OK created sql view model staging.staging_shopify__orders ............... [[32mSUCCESS 1[0m in 1.77s]
[0m12:56:17.863667 [info ] [Thread-2  ]: 2 of 8 OK created sql view model staging.staging_shopify__customers ............ [[32mSUCCESS 1[0m in 1.77s]
[0m12:56:17.864692 [debug] [Thread-6  ]: Began running node model.billy_bulky.int_products__inventory
[0m12:56:17.865916 [debug] [Thread-3  ]: Finished running node model.billy_bulky.staging_shopify__orders
[0m12:56:17.867090 [debug] [Thread-2  ]: Finished running node model.billy_bulky.staging_shopify__customers
[0m12:56:17.868013 [info ] [Thread-6  ]: 5 of 8 START sql incremental model intermediate.int_products__inventory ........ [RUN]
[0m12:56:17.870387 [debug] [Thread-6  ]: Acquiring new snowflake connection 'model.billy_bulky.int_products__inventory'
[0m12:56:17.871832 [debug] [Thread-8  ]: Began running node model.billy_bulky.int_products_performance
[0m12:56:17.872765 [debug] [Thread-6  ]: Began compiling node model.billy_bulky.int_products__inventory
[0m12:56:17.873613 [debug] [Thread-9  ]: Began running node model.billy_bulky.int_sales_trend
[0m12:56:17.874385 [debug] [Thread-10 ]: Began running node model.billy_bulky.int_customers_segmentation
[0m12:56:17.875705 [debug] [Thread-8  ]: Acquiring new snowflake connection 'model.billy_bulky.int_products_performance'
[0m12:56:17.883369 [debug] [Thread-6  ]: Writing injected SQL for node "model.billy_bulky.int_products__inventory"
[0m12:56:17.884398 [debug] [Thread-9  ]: Acquiring new snowflake connection 'model.billy_bulky.int_sales_trend'
[0m12:56:17.885403 [debug] [Thread-10 ]: Acquiring new snowflake connection 'model.billy_bulky.int_customers_segmentation'
[0m12:56:17.885946 [debug] [Thread-8  ]: Began compiling node model.billy_bulky.int_products_performance
[0m12:56:17.886587 [debug] [Thread-9  ]: Began compiling node model.billy_bulky.int_sales_trend
[0m12:56:17.887161 [debug] [Thread-10 ]: Began compiling node model.billy_bulky.int_customers_segmentation
[0m12:56:17.893032 [debug] [Thread-8  ]: Writing injected SQL for node "model.billy_bulky.int_products_performance"
[0m12:56:17.897229 [debug] [Thread-9  ]: Writing injected SQL for node "model.billy_bulky.int_sales_trend"
[0m12:56:17.901538 [debug] [Thread-10 ]: Writing injected SQL for node "model.billy_bulky.int_customers_segmentation"
[0m12:56:17.902244 [debug] [Thread-6  ]: Timing info for model.billy_bulky.int_products__inventory (compile): 12:56:17.876174 => 12:56:17.901943
[0m12:56:17.903503 [debug] [Thread-8  ]: Timing info for model.billy_bulky.int_products_performance (compile): 12:56:17.887817 => 12:56:17.903227
[0m12:56:17.903945 [debug] [Thread-6  ]: Began executing node model.billy_bulky.int_products__inventory
[0m12:56:17.905044 [debug] [Thread-8  ]: Finished running node model.billy_bulky.int_products_performance
[0m12:56:17.905526 [debug] [Thread-10 ]: Timing info for model.billy_bulky.int_customers_segmentation (compile): 12:56:17.897614 => 12:56:17.905298
[0m12:56:17.905964 [debug] [Thread-9  ]: Timing info for model.billy_bulky.int_sales_trend (compile): 12:56:17.893409 => 12:56:17.905755
[0m12:56:17.906751 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee1ed69a-3f13-4627-a338-a8f581e9a212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13f691e50>]}
[0m12:56:17.919930 [debug] [Thread-4  ]: Began running node model.billy_bulky.products
[0m12:56:17.920778 [debug] [Thread-10 ]: Finished running node model.billy_bulky.int_customers_segmentation
[0m12:56:17.944449 [debug] [Thread-6  ]: Writing runtime sql for node "model.billy_bulky.int_products__inventory"
[0m12:56:17.944991 [debug] [Thread-9  ]: Finished running node model.billy_bulky.int_sales_trend
[0m12:56:17.945314 [info ] [Thread-4  ]: 6 of 8 START sql table model marts.products .................................... [RUN]
[0m12:56:17.945838 [info ] [Thread-1  ]: 1 of 8 OK created sql view model staging.staging__shopify__products_history .... [[32mSUCCESS 1[0m in 1.82s]
[0m12:56:17.946189 [debug] [Thread-3  ]: Began running node model.billy_bulky.customers
[0m12:56:17.946688 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.billy_bulky.staging_shopify__products, now model.billy_bulky.products)
[0m12:56:17.947373 [debug] [Thread-6  ]: Using snowflake connection "model.billy_bulky.int_products__inventory"
[0m12:56:17.947706 [debug] [Thread-1  ]: Finished running node model.billy_bulky.staging__shopify__products_history
[0m12:56:17.947923 [debug] [Thread-5  ]: Began running node model.billy_bulky.sales
[0m12:56:17.948180 [info ] [Thread-3  ]: 7 of 8 START sql table model marts.customers ................................... [RUN]
[0m12:56:17.948423 [debug] [Thread-4  ]: Began compiling node model.billy_bulky.products
[0m12:56:17.948667 [debug] [Thread-6  ]: On model.billy_bulky.int_products__inventory: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.int_products__inventory"} */
create or replace transient table E_COMMERCE.intermediate.int_products__inventory
         as
        (

WITH inventory_data AS (
    SELECT
        DATE_TRUNC('day', CURRENT_TIMESTAMP) AS snapshot_date
        , p.PRODUCT_ID
        , p.STOCK_LEVEL
    FROM E_COMMERCE.staging.staging_shopify__products p
    WHERE NOT EXISTS (
        SELECT 1
        FROM E_COMMERCE.intermediate.int_products__inventory
        WHERE snapshot_date = DATE_TRUNC('day', CURRENT_TIMESTAMP)
          AND PRODUCT_ID = p.PRODUCT_ID
    )
)

SELECT
    snapshot_date
    , PRODUCT_ID
    , STOCK_LEVEL
FROM inventory_data


        );
[0m12:56:17.948985 [info ] [Thread-5  ]: 8 of 8 START sql table model marts.sales ....................................... [RUN]
[0m12:56:17.949411 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.billy_bulky.staging_shopify__orders, now model.billy_bulky.customers)
[0m12:56:17.953368 [debug] [Thread-4  ]: Writing injected SQL for node "model.billy_bulky.products"
[0m12:56:17.953614 [debug] [Thread-6  ]: Opening a new connection, currently in state init
[0m12:56:17.954003 [debug] [Thread-5  ]: Re-using an available connection from the pool (formerly list_E_COMMERCE_intermediate, now model.billy_bulky.sales)
[0m12:56:17.954236 [debug] [Thread-3  ]: Began compiling node model.billy_bulky.customers
[0m12:56:17.954677 [debug] [Thread-5  ]: Began compiling node model.billy_bulky.sales
[0m12:56:17.962014 [debug] [Thread-3  ]: Writing injected SQL for node "model.billy_bulky.customers"
[0m12:56:17.968617 [debug] [Thread-4  ]: Timing info for model.billy_bulky.products (compile): 12:56:17.949577 => 12:56:17.968463
[0m12:56:17.969958 [debug] [Thread-5  ]: Writing injected SQL for node "model.billy_bulky.sales"
[0m12:56:17.970298 [debug] [Thread-4  ]: Began executing node model.billy_bulky.products
[0m12:56:17.976503 [debug] [Thread-4  ]: Writing runtime sql for node "model.billy_bulky.products"
[0m12:56:17.977156 [debug] [Thread-5  ]: Timing info for model.billy_bulky.sales (compile): 12:56:17.962169 => 12:56:17.977023
[0m12:56:17.977381 [debug] [Thread-5  ]: Began executing node model.billy_bulky.sales
[0m12:56:17.977632 [debug] [Thread-3  ]: Timing info for model.billy_bulky.customers (compile): 12:56:17.955181 => 12:56:17.977506
[0m12:56:17.979329 [debug] [Thread-5  ]: Writing runtime sql for node "model.billy_bulky.sales"
[0m12:56:17.980773 [debug] [Thread-4  ]: Using snowflake connection "model.billy_bulky.products"
[0m12:56:17.981045 [debug] [Thread-3  ]: Began executing node model.billy_bulky.customers
[0m12:56:17.981430 [debug] [Thread-4  ]: On model.billy_bulky.products: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.products"} */
create or replace transient table E_COMMERCE.marts.products
         as
        (WITH  __dbt__cte__int_products_performance as (
WITH orders AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__orders
)

, products AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__products
)

, product_sales AS (
    SELECT
        o.PRODUCT_ID
        , COUNT(DISTINCT o.ORDER_ID) AS total_sales
        , SUM(o.QUANTITY) AS total_units_sold
        , SUM(o.QUANTITY * p.PRICE) AS total_sales_value
    FROM orders o
    INNER JOIN products p ON o.PRODUCT_ID = p.PRODUCT_ID
    WHERE o.STATUS NOT IN ('cancelled') 
    GROUP BY o.PRODUCT_ID
)

, product_averages AS (
    SELECT
        PRODUCT_ID
        , (total_sales_value / NULLIF(total_units_sold, 0)) AS average_sale_price
    FROM product_sales
)

, product_stock_turnover AS (
    SELECT
        p.PRODUCT_ID
        , p.STOCK_LEVEL
        , (total_units_sold / NULLIF(p.STOCK_LEVEL, 0)) AS turnover_rate
    FROM product_sales ps
    INNER JOIN products p ON ps.PRODUCT_ID = p.PRODUCT_ID
)

, final AS (
    SELECT
    p.PRODUCT_ID
    , p.NAME
    , p.CATEGORY
    , p.PRICE
    , pa.average_sale_price
    , ps.total_sales
    , ps.total_units_sold
    , ps.total_sales_value
    , pst.turnover_rate
    , p.STOCK_LEVEL
FROM products p
LEFT JOIN product_sales ps ON p.PRODUCT_ID = ps.PRODUCT_ID
LEFT JOIN product_averages pa ON p.PRODUCT_ID = pa.PRODUCT_ID
LEFT JOIN product_stock_turnover pst ON p.PRODUCT_ID = pst.PRODUCT_ID
)

SELECT * FROM final
), final AS (
    SELECT
        pp.PRODUCT_ID
        , pp.NAME
        , pp.CATEGORY
        , pp.PRICE
        , pp.average_sale_price
        , pp.total_sales
        , pp.total_units_sold
        , pp.total_sales_value
        , pp.turnover_rate
        , pp.STOCK_LEVEL
    FROM __dbt__cte__int_products_performance pp
)

SELECT * FROM final
        );
[0m12:56:17.983272 [debug] [Thread-3  ]: Writing runtime sql for node "model.billy_bulky.customers"
[0m12:56:17.983544 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m12:56:17.985811 [debug] [Thread-5  ]: Using snowflake connection "model.billy_bulky.sales"
[0m12:56:17.986353 [debug] [Thread-5  ]: On model.billy_bulky.sales: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.sales"} */
create or replace transient table E_COMMERCE.marts.sales
         as
        (WITH  __dbt__cte__int_sales_trend as (
WITH orders AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__orders
)

, products AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__products
)

, daily_sales AS (
    SELECT
        DATE(ORDER_DATE) AS sale_date
        , COUNT(DISTINCT ORDER_ID) AS total_orders
        , SUM(QUANTITY) AS total_units_sold
        , SUM(QUANTITY * PRICE) AS total_sales_value
    FROM orders AS o
    JOIN products AS p ON o.PRODUCT_ID = p.PRODUCT_ID
    WHERE o.STATUS NOT IN ('cancelled') 
    GROUP BY sale_date
)

, weekly_sales AS (
    SELECT
        DATE_TRUNC('week', sale_date) AS sale_week
        , SUM(total_orders) AS weekly_orders
        , SUM(total_units_sold) AS weekly_units_sold
        , SUM(total_sales_value) AS weekly_sales_value
    FROM daily_sales
    GROUP BY sale_week
)

, monthly_sales AS (
    SELECT
        DATE_TRUNC('month', sale_date) AS sale_month
        , SUM(total_orders) AS monthly_orders
        , SUM(total_units_sold) AS monthly_units_sold
        , SUM(total_sales_value) AS monthly_sales_value
    FROM daily_sales
    GROUP BY sale_month
)

, yearly_sales AS (
    SELECT
        DATE_TRUNC('year', sale_date) AS sale_year
        , SUM(total_orders) AS yearly_orders
        , SUM(total_units_sold) AS yearly_units_sold
        , SUM(total_sales_value) AS yearly_sales_value
    FROM daily_sales
    GROUP BY sale_year
)

SELECT
    d.sale_date
    , d.total_orders AS daily_orders
    , d.total_units_sold AS daily_units_sold
    , d.total_sales_value AS daily_sales_value
    , w.weekly_orders
    , w.weekly_units_sold
    , w.weekly_sales_value
    , m.monthly_orders
    , m.monthly_units_sold
    , m.monthly_sales_value
    , y.yearly_orders
    , y.yearly_units_sold
    , y.yearly_sales_value
FROM daily_sales d
LEFT JOIN weekly_sales w ON DATE_TRUNC('week', d.sale_date) = w.sale_week
LEFT JOIN monthly_sales m ON DATE_TRUNC('month', d.sale_date) = m.sale_month
LEFT JOIN yearly_sales y ON DATE_TRUNC('year', d.sale_date) = y.sale_year
), enriched_orders AS (
    SELECT
        o.ORDER_ID
        , o.CUSTOMER_ID
        , o.PRODUCT_ID
        , o.QUANTITY
        , o.ORDER_DATE
        , o.STATUS
        , p.CATEGORY
        , p.PRICE AS unit_price
        , (o.QUANTITY * p.PRICE) AS total_price
        , c.COUNTRY
    FROM E_COMMERCE.staging.staging_shopify__orders o
    JOIN E_COMMERCE.staging.staging_shopify__products p ON o.PRODUCT_ID = p.PRODUCT_ID
    JOIN E_COMMERCE.staging.staging_shopify__customers c ON o.CUSTOMER_ID = c.CUSTOMER_ID
    WHERE o.STATUS NOT IN ('cancelled') 
)

SELECT
    eo.ORDER_ID
    , eo.CUSTOMER_ID
    , eo.PRODUCT_ID
    , eo.QUANTITY
    , eo.ORDER_DATE
    , eo.STATUS
    , eo.CATEGORY
    , eo.unit_price
    , eo.total_price
    , eo.COUNTRY
    , sa.daily_orders
    , sa.daily_units_sold
    , sa.daily_sales_value
FROM enriched_orders eo
LEFT JOIN __dbt__cte__int_sales_trend sa ON DATE(eo.ORDER_DATE) = sa.sale_date
        );
[0m12:56:17.986678 [debug] [Thread-5  ]: Opening a new connection, currently in state closed
[0m12:56:17.988910 [debug] [Thread-3  ]: Using snowflake connection "model.billy_bulky.customers"
[0m12:56:17.989237 [debug] [Thread-3  ]: On model.billy_bulky.customers: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.customers"} */
create or replace transient table E_COMMERCE.marts.customers
         as
        (WITH  __dbt__cte__int_customers_segmentation as (
WITH customers AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__customers
)

, orders AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__orders
)

, products AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__products
)

, order_aggregates AS (
    SELECT
        o.CUSTOMER_ID
        , COUNT(DISTINCT o.ORDER_ID) AS frequency
        , SUM(o.QUANTITY * p.PRICE) AS monetary
        , AVG(o.QUANTITY * p.PRICE) AS average_order_value
        , MAX(o.ORDER_DATE) AS last_purchase_date
        , COUNT(CASE WHEN o.STATUS = 'cancelled' THEN 1 END) AS cancelled_orders
        , COUNT(*) AS total_orders
    FROM orders o
    JOIN products p ON o.PRODUCT_ID = p.PRODUCT_ID
    GROUP BY o.CUSTOMER_ID
)

, customer_tenure AS (
    SELECT
        CUSTOMER_ID
        , JOIN_DATE
        , CURRENT_DATE - JOIN_DATE AS tenure
    FROM customers
)

, customer_recency AS (
    SELECT
        CUSTOMER_ID
        , CURRENT_DATE - last_purchase_date AS recency
    FROM order_aggregates
)

, final AS (
    SELECT
        c.CUSTOMER_ID
        , c.FIRST_NAME
        , c.LAST_NAME
        , c.EMAIL
        , c.JOIN_DATE
        , c.COUNTRY
        , o.frequency
        , o.monetary
        , o.average_order_value
        , o.cancelled_orders
        , o.total_orders
        , CASE 
            WHEN o.total_orders > 0 THEN ROUND((o.cancelled_orders::FLOAT / o.total_orders) * 100, 2) 
            ELSE 0 
          END AS cancellation_rate
        , r.recency
        , t.tenure
    FROM customer_tenure t
    JOIN customers c ON t.CUSTOMER_ID = c.CUSTOMER_ID
    JOIN order_aggregates o ON c.CUSTOMER_ID = o.CUSTOMER_ID
    JOIN customer_recency r ON c.CUSTOMER_ID = r.CUSTOMER_ID
)

SELECT * FROM final
), source AS (
    SELECT
        icp.CUSTOMER_ID
        , icp.FIRST_NAME
        , icp.LAST_NAME
        , icp.EMAIL
        , icp.JOIN_DATE
        , icp.COUNTRY
        , icp.frequency AS total_orders
        , icp.monetary AS total_spent
        , icp.recency
        , icp.tenure
    FROM __dbt__cte__int_customers_segmentation icp
)

, final AS (
SELECT
    s.CUSTOMER_ID
    , s.FIRST_NAME
    , s.LAST_NAME
    , s.EMAIL
    , s.JOIN_DATE
    , s.COUNTRY
    , s.total_orders
    , s.total_spent
    , s.recency
    , s.tenure
    , CASE
        WHEN total_spent > 1000 THEN 'VIP'
        ELSE 'Regular'
    END AS customer_segment
FROM source s
)

SELECT * FROM final
        );
[0m12:56:17.989548 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m12:56:19.344457 [debug] [Thread-6  ]: Snowflake adapter: Snowflake query id: 01b07a0c-0001-834e-0004-d8be0001140a
[0m12:56:19.345125 [debug] [Thread-6  ]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'E_COMMERCE.INTERMEDIATE.INT_PRODUCTS__INVENTORY' does not exist or not authorized.
[0m12:56:19.345839 [debug] [Thread-6  ]: Timing info for model.billy_bulky.int_products__inventory (execute): 12:56:17.907030 => 12:56:19.345536
[0m12:56:19.346351 [debug] [Thread-6  ]: On model.billy_bulky.int_products__inventory: Close
[0m12:56:19.785024 [debug] [Thread-6  ]: Database Error in model int_products__inventory (models/intermediate/products/int_products__inventory.sql)
  002003 (42S02): SQL compilation error:
  Object 'E_COMMERCE.INTERMEDIATE.INT_PRODUCTS__INVENTORY' does not exist or not authorized.
  compiled Code at target/run/billy_bulky/models/intermediate/products/int_products__inventory.sql
[0m12:56:19.785928 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee1ed69a-3f13-4627-a338-a8f581e9a212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13f634ca0>]}
[0m12:56:19.786944 [error] [Thread-6  ]: 5 of 8 ERROR creating sql incremental model intermediate.int_products__inventory  [[31mERROR[0m in 1.92s]
[0m12:56:19.787896 [debug] [Thread-6  ]: Finished running node model.billy_bulky.int_products__inventory
[0m12:56:20.520976 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 3.0 seconds
[0m12:56:20.523732 [debug] [Thread-4  ]: Timing info for model.billy_bulky.products (execute): 12:56:17.970685 => 12:56:20.523494
[0m12:56:20.524162 [debug] [Thread-4  ]: On model.billy_bulky.products: Close
[0m12:56:20.636212 [debug] [Thread-5  ]: SQL status: SUCCESS 1 in 3.0 seconds
[0m12:56:20.639849 [debug] [Thread-5  ]: Timing info for model.billy_bulky.sales (execute): 12:56:17.977770 => 12:56:20.639544
[0m12:56:20.640434 [debug] [Thread-5  ]: On model.billy_bulky.sales: Close
[0m12:56:20.686501 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 3.0 seconds
[0m12:56:20.689646 [debug] [Thread-3  ]: Timing info for model.billy_bulky.customers (execute): 12:56:17.981689 => 12:56:20.689377
[0m12:56:20.690117 [debug] [Thread-3  ]: On model.billy_bulky.customers: Close
[0m12:56:20.877830 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee1ed69a-3f13-4627-a338-a8f581e9a212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13f632340>]}
[0m12:56:20.879100 [info ] [Thread-4  ]: 6 of 8 OK created sql table model marts.products ............................... [[32mSUCCESS 1[0m in 2.93s]
[0m12:56:20.880138 [debug] [Thread-4  ]: Finished running node model.billy_bulky.products
[0m12:56:21.004343 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee1ed69a-3f13-4627-a338-a8f581e9a212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13f0cafa0>]}
[0m12:56:21.005877 [info ] [Thread-5  ]: 8 of 8 OK created sql table model marts.sales .................................. [[32mSUCCESS 1[0m in 3.05s]
[0m12:56:21.006922 [debug] [Thread-5  ]: Finished running node model.billy_bulky.sales
[0m12:56:21.041226 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee1ed69a-3f13-4627-a338-a8f581e9a212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13f37a250>]}
[0m12:56:21.042406 [info ] [Thread-3  ]: 7 of 8 OK created sql table model marts.customers .............................. [[32mSUCCESS 1[0m in 3.09s]
[0m12:56:21.043420 [debug] [Thread-3  ]: Finished running node model.billy_bulky.customers
[0m12:56:21.045877 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:56:21.046403 [debug] [MainThread]: Connection 'model.billy_bulky.staging__shopify__products_history' was properly closed.
[0m12:56:21.046839 [debug] [MainThread]: Connection 'model.billy_bulky.staging_shopify__customers' was properly closed.
[0m12:56:21.047255 [debug] [MainThread]: Connection 'model.billy_bulky.customers' was properly closed.
[0m12:56:21.047673 [debug] [MainThread]: Connection 'model.billy_bulky.products' was properly closed.
[0m12:56:21.048063 [debug] [MainThread]: Connection 'model.billy_bulky.sales' was properly closed.
[0m12:56:21.048445 [debug] [MainThread]: Connection 'model.billy_bulky.int_products__inventory' was properly closed.
[0m12:56:21.048828 [debug] [MainThread]: Connection 'model.billy_bulky.int_products_performance' was properly closed.
[0m12:56:21.049212 [debug] [MainThread]: Connection 'model.billy_bulky.int_sales_trend' was properly closed.
[0m12:56:21.049593 [debug] [MainThread]: Connection 'model.billy_bulky.int_customers_segmentation' was properly closed.
[0m12:56:21.050114 [info ] [MainThread]: 
[0m12:56:21.050604 [info ] [MainThread]: Finished running 4 view models, 1 incremental model, 3 table models in 0 hours 0 minutes and 8.72 seconds (8.72s).
[0m12:56:21.052675 [debug] [MainThread]: Command end result
[0m12:56:21.070490 [info ] [MainThread]: 
[0m12:56:21.070990 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:56:21.071347 [info ] [MainThread]: 
[0m12:56:21.071722 [error] [MainThread]:   Database Error in model int_products__inventory (models/intermediate/products/int_products__inventory.sql)
  002003 (42S02): SQL compilation error:
  Object 'E_COMMERCE.INTERMEDIATE.INT_PRODUCTS__INVENTORY' does not exist or not authorized.
  compiled Code at target/run/billy_bulky/models/intermediate/products/int_products__inventory.sql
[0m12:56:21.072099 [info ] [MainThread]: 
[0m12:56:21.072455 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m12:56:21.075570 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 9.977903, "process_user_time": 5.783027, "process_kernel_time": 0.454166, "process_mem_max_rss": "226902016", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:56:21.076071 [debug] [MainThread]: Command `dbt run` failed at 12:56:21.075954 after 9.98 seconds
[0m12:56:21.076438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107eb10d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13d975cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13f6948e0>]}
[0m12:56:21.076807 [debug] [MainThread]: Flushing usage events
[0m12:57:40.107857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d316d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10471e9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110238400>]}


============================== 12:57:40.110943 | b396f709-4e16-47a9-89de-d6c0a8e64267 ==============================
[0m12:57:40.110943 [info ] [MainThread]: Running with dbt=1.7.1
[0m12:57:40.111319 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/bitlevi/Documents/billy_bulky_ecommerce/billy_bulky_ecommerce/logs', 'profiles_dir': '/Users/bitlevi/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m12:57:40.944210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b396f709-4e16-47a9-89de-d6c0a8e64267', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10471e9d0>]}
[0m12:57:40.991871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b396f709-4e16-47a9-89de-d6c0a8e64267', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x132765550>]}
[0m12:57:40.992481 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m12:57:41.011578 [debug] [MainThread]: checksum: ad428e6dc3b353dcb23d0c4ebea8b20b180e94b873271ac2a054a8e446dac0e2, vars: {}, profile: , target: , version: 1.7.1
[0m12:57:41.046371 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m12:57:41.046925 [debug] [MainThread]: Partial parsing: added file: billy_bulky://models/intermediate/products/int_products_inventory.sql
[0m12:57:41.047140 [debug] [MainThread]: Partial parsing: deleted file: billy_bulky://models/intermediate/products/int_products__inventory.sql
[0m12:57:41.133740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b396f709-4e16-47a9-89de-d6c0a8e64267', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1331917c0>]}
[0m12:57:41.186029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b396f709-4e16-47a9-89de-d6c0a8e64267', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13326b820>]}
[0m12:57:41.186381 [info ] [MainThread]: Found 11 models, 1 snapshot, 1 seed, 47 tests, 4 sources, 0 exposures, 0 metrics, 431 macros, 0 groups, 0 semantic models
[0m12:57:41.186606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b396f709-4e16-47a9-89de-d6c0a8e64267', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13326baf0>]}
[0m12:57:41.188062 [info ] [MainThread]: 
[0m12:57:41.188561 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:57:41.189403 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE'
[0m12:57:41.189877 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE'
[0m12:57:41.190485 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE'
[0m12:57:41.198900 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE"
[0m12:57:41.200679 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE"
[0m12:57:41.202475 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE"
[0m12:57:41.202711 [debug] [ThreadPool]: On list_E_COMMERCE: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE"} */
show terse schemas in database E_COMMERCE
    limit 10000
[0m12:57:41.202908 [debug] [ThreadPool]: On list_E_COMMERCE: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE"} */
show terse schemas in database E_COMMERCE
    limit 10000
[0m12:57:41.203097 [debug] [ThreadPool]: On list_E_COMMERCE: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE"} */
show terse schemas in database E_COMMERCE
    limit 10000
[0m12:57:41.203280 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:57:41.203447 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:57:41.203611 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:57:42.683432 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m12:57:42.687233 [debug] [ThreadPool]: On list_E_COMMERCE: Close
[0m12:57:42.692180 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m12:57:42.693399 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m12:57:42.696327 [debug] [ThreadPool]: On list_E_COMMERCE: Close
[0m12:57:42.699320 [debug] [ThreadPool]: On list_E_COMMERCE: Close
[0m12:57:43.122280 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_E_COMMERCE, now list_E_COMMERCE_PUBLIC)
[0m12:57:43.125074 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_E_COMMERCE, now list_E_COMMERCE_snapshots)
[0m12:57:43.131546 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_E_COMMERCE, now list_E_COMMERCE_intermediate)
[0m12:57:43.145106 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_staging'
[0m12:57:43.148339 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_intermediate"
[0m12:57:43.149349 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_snapshots"
[0m12:57:43.152079 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PUBLIC"
[0m12:57:43.152781 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_marts'
[0m12:57:43.155319 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_staging"
[0m12:57:43.155788 [debug] [ThreadPool]: On list_E_COMMERCE_intermediate: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE_intermediate"} */
show terse objects in E_COMMERCE.intermediate limit 10000
[0m12:57:43.156165 [debug] [ThreadPool]: On list_E_COMMERCE_snapshots: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE_snapshots"} */
show terse objects in E_COMMERCE.snapshots limit 10000
[0m12:57:43.156531 [debug] [ThreadPool]: On list_E_COMMERCE_PUBLIC: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE_PUBLIC"} */
show terse objects in E_COMMERCE.PUBLIC limit 10000
[0m12:57:43.159081 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_marts"
[0m12:57:43.159466 [debug] [ThreadPool]: On list_E_COMMERCE_staging: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE_staging"} */
show terse objects in E_COMMERCE.staging limit 10000
[0m12:57:43.159804 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:57:43.160132 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:57:43.160440 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:57:43.160762 [debug] [ThreadPool]: On list_E_COMMERCE_marts: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE_marts"} */
show terse objects in E_COMMERCE.marts limit 10000
[0m12:57:43.161076 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:57:43.165257 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:57:44.321488 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m12:57:44.324468 [debug] [ThreadPool]: On list_E_COMMERCE_intermediate: Close
[0m12:57:44.344323 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:57:44.345962 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m12:57:44.348483 [debug] [ThreadPool]: On list_E_COMMERCE_snapshots: Close
[0m12:57:44.350442 [debug] [ThreadPool]: On list_E_COMMERCE_marts: Close
[0m12:57:44.366840 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m12:57:44.369102 [debug] [ThreadPool]: On list_E_COMMERCE_staging: Close
[0m12:57:44.412383 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b07a0d-0001-8184-0004-d8be0001059a
[0m12:57:44.412724 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m12:57:44.413051 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m12:57:44.413293 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m12:57:44.413576 [debug] [ThreadPool]: On list_E_COMMERCE_PUBLIC: Close
[0m12:57:44.775704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b396f709-4e16-47a9-89de-d6c0a8e64267', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13326bf40>]}
[0m12:57:44.776302 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m12:57:44.776537 [info ] [MainThread]: 
[0m12:57:44.778490 [debug] [Thread-1  ]: Began running node model.billy_bulky.staging__shopify__products_history
[0m12:57:44.778820 [debug] [Thread-2  ]: Began running node model.billy_bulky.staging_shopify__customers
[0m12:57:44.779170 [info ] [Thread-1  ]: 1 of 8 START sql view model staging.staging__shopify__products_history ......... [RUN]
[0m12:57:44.779485 [debug] [Thread-3  ]: Began running node model.billy_bulky.staging_shopify__orders
[0m12:57:44.779796 [info ] [Thread-2  ]: 2 of 8 START sql view model staging.staging_shopify__customers ................. [RUN]
[0m12:57:44.780818 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_E_COMMERCE_PUBLIC, now model.billy_bulky.staging__shopify__products_history)
[0m12:57:44.780131 [debug] [Thread-4  ]: Began running node model.billy_bulky.staging_shopify__products
[0m12:57:44.781488 [info ] [Thread-3  ]: 3 of 8 START sql view model staging.staging_shopify__orders .................... [RUN]
[0m12:57:44.781976 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_E_COMMERCE_snapshots, now model.billy_bulky.staging_shopify__customers)
[0m12:57:44.782253 [debug] [Thread-1  ]: Began compiling node model.billy_bulky.staging__shopify__products_history
[0m12:57:44.782562 [info ] [Thread-4  ]: 4 of 8 START sql view model staging.staging_shopify__products .................. [RUN]
[0m12:57:44.783046 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly list_E_COMMERCE_intermediate, now model.billy_bulky.staging_shopify__orders)
[0m12:57:44.783316 [debug] [Thread-2  ]: Began compiling node model.billy_bulky.staging_shopify__customers
[0m12:57:44.791644 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly list_E_COMMERCE_staging, now model.billy_bulky.staging_shopify__products)
[0m12:57:44.795236 [debug] [Thread-1  ]: Writing injected SQL for node "model.billy_bulky.staging__shopify__products_history"
[0m12:57:44.796285 [debug] [Thread-3  ]: Began compiling node model.billy_bulky.staging_shopify__orders
[0m12:57:44.798785 [debug] [Thread-4  ]: Began compiling node model.billy_bulky.staging_shopify__products
[0m12:57:44.801133 [debug] [Thread-2  ]: Writing injected SQL for node "model.billy_bulky.staging_shopify__customers"
[0m12:57:44.803332 [debug] [Thread-3  ]: Writing injected SQL for node "model.billy_bulky.staging_shopify__orders"
[0m12:57:44.805737 [debug] [Thread-4  ]: Writing injected SQL for node "model.billy_bulky.staging_shopify__products"
[0m12:57:44.806537 [debug] [Thread-1  ]: Timing info for model.billy_bulky.staging__shopify__products_history (compile): 12:57:44.783478 => 12:57:44.806286
[0m12:57:44.807292 [debug] [Thread-1  ]: Began executing node model.billy_bulky.staging__shopify__products_history
[0m12:57:44.807739 [debug] [Thread-4  ]: Timing info for model.billy_bulky.staging_shopify__products (compile): 12:57:44.803655 => 12:57:44.807569
[0m12:57:44.814287 [debug] [Thread-3  ]: Timing info for model.billy_bulky.staging_shopify__orders (compile): 12:57:44.801409 => 12:57:44.813904
[0m12:57:44.814786 [debug] [Thread-2  ]: Timing info for model.billy_bulky.staging_shopify__customers (compile): 12:57:44.796607 => 12:57:44.814608
[0m12:57:44.827306 [debug] [Thread-4  ]: Began executing node model.billy_bulky.staging_shopify__products
[0m12:57:44.829060 [debug] [Thread-1  ]: Writing runtime sql for node "model.billy_bulky.staging__shopify__products_history"
[0m12:57:44.829422 [debug] [Thread-3  ]: Began executing node model.billy_bulky.staging_shopify__orders
[0m12:57:44.829680 [debug] [Thread-2  ]: Began executing node model.billy_bulky.staging_shopify__customers
[0m12:57:44.832165 [debug] [Thread-4  ]: Writing runtime sql for node "model.billy_bulky.staging_shopify__products"
[0m12:57:44.835095 [debug] [Thread-3  ]: Writing runtime sql for node "model.billy_bulky.staging_shopify__orders"
[0m12:57:44.838592 [debug] [Thread-2  ]: Writing runtime sql for node "model.billy_bulky.staging_shopify__customers"
[0m12:57:44.840150 [debug] [Thread-1  ]: Using snowflake connection "model.billy_bulky.staging__shopify__products_history"
[0m12:57:44.840718 [debug] [Thread-1  ]: On model.billy_bulky.staging__shopify__products_history: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.staging__shopify__products_history"} */
create or replace   view E_COMMERCE.staging.staging__shopify__products_history
  
   as (
    WITH products AS (
    SELECT * FROM E_COMMERCE.SNAPSHOTS.products_snapshot
)

SELECT
    PRODUCT_ID
    , NAME
    , CATEGORY
    , PRICE
    , STOCK_LEVEL
    , DBT_SCD_ID
    , DBT_UPDATED_AT
    , DBT_VALID_FROM
    , DBT_VALID_TO
FROM products
  );
[0m12:57:44.841005 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:57:44.841756 [debug] [Thread-3  ]: Using snowflake connection "model.billy_bulky.staging_shopify__orders"
[0m12:57:44.842445 [debug] [Thread-4  ]: Using snowflake connection "model.billy_bulky.staging_shopify__products"
[0m12:57:44.843146 [debug] [Thread-3  ]: On model.billy_bulky.staging_shopify__orders: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.staging_shopify__orders"} */
create or replace   view E_COMMERCE.staging.staging_shopify__orders
  
   as (
    WITH orders AS (
    SELECT * FROM SHOPIFY.PUBLIC.orders
)

SELECT
    ORDER_ID
    , CUSTOMER_ID
    , PRODUCT_ID
    , QUANTITY
    , ORDER_DATE
    , STATUS
FROM orders
  );
[0m12:57:44.844047 [debug] [Thread-4  ]: On model.billy_bulky.staging_shopify__products: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.staging_shopify__products"} */
create or replace   view E_COMMERCE.staging.staging_shopify__products
  
   as (
    WITH products AS (
    SELECT * FROM SHOPIFY.PUBLIC.products
)

SELECT
    PRODUCT_ID
    , NAME
    , CATEGORY
    , PRICE
    , STOCK_LEVEL
FROM products
  );
[0m12:57:44.844883 [debug] [Thread-2  ]: Using snowflake connection "model.billy_bulky.staging_shopify__customers"
[0m12:57:44.845297 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m12:57:44.845913 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m12:57:44.846596 [debug] [Thread-2  ]: On model.billy_bulky.staging_shopify__customers: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.staging_shopify__customers"} */
create or replace   view E_COMMERCE.staging.staging_shopify__customers
  
   as (
    WITH customers AS (
    SELECT * FROM SHOPIFY.PUBLIC.customers
)

SELECT
    CUSTOMER_ID
    , FIRST_NAME
    , LAST_NAME
    , EMAIL
    , JOIN_DATE
    , COUNTRY
FROM customers
  );
[0m12:57:44.848638 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m12:57:46.187951 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:57:46.190204 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:57:46.191870 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:57:46.242569 [debug] [Thread-4  ]: Timing info for model.billy_bulky.staging_shopify__products (execute): 12:57:44.829845 => 12:57:46.242300
[0m12:57:46.246193 [debug] [Thread-2  ]: Timing info for model.billy_bulky.staging_shopify__customers (execute): 12:57:44.835366 => 12:57:46.245961
[0m12:57:46.246870 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:57:46.249043 [debug] [Thread-1  ]: Timing info for model.billy_bulky.staging__shopify__products_history (execute): 12:57:44.807921 => 12:57:46.248841
[0m12:57:46.249491 [debug] [Thread-4  ]: On model.billy_bulky.staging_shopify__products: Close
[0m12:57:46.249872 [debug] [Thread-2  ]: On model.billy_bulky.staging_shopify__customers: Close
[0m12:57:46.251983 [debug] [Thread-3  ]: Timing info for model.billy_bulky.staging_shopify__orders (execute): 12:57:44.832528 => 12:57:46.251794
[0m12:57:46.252372 [debug] [Thread-1  ]: On model.billy_bulky.staging__shopify__products_history: Close
[0m12:57:46.254701 [debug] [Thread-3  ]: On model.billy_bulky.staging_shopify__orders: Close
[0m12:57:46.710913 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b396f709-4e16-47a9-89de-d6c0a8e64267', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14544c250>]}
[0m12:57:46.712723 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b396f709-4e16-47a9-89de-d6c0a8e64267', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13326bf40>]}
[0m12:57:46.713986 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b396f709-4e16-47a9-89de-d6c0a8e64267', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14501ad30>]}
[0m12:57:46.715300 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b396f709-4e16-47a9-89de-d6c0a8e64267', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1332659d0>]}
[0m12:57:46.716558 [info ] [Thread-1  ]: 1 of 8 OK created sql view model staging.staging__shopify__products_history .... [[32mSUCCESS 1[0m in 1.93s]
[0m12:57:46.717436 [info ] [Thread-3  ]: 3 of 8 OK created sql view model staging.staging_shopify__orders ............... [[32mSUCCESS 1[0m in 1.93s]
[0m12:57:46.718809 [info ] [Thread-2  ]: 2 of 8 OK created sql view model staging.staging_shopify__customers ............ [[32mSUCCESS 1[0m in 1.93s]
[0m12:57:46.719683 [info ] [Thread-4  ]: 4 of 8 OK created sql view model staging.staging_shopify__products ............. [[32mSUCCESS 1[0m in 1.92s]
[0m12:57:46.720980 [debug] [Thread-1  ]: Finished running node model.billy_bulky.staging__shopify__products_history
[0m12:57:46.721916 [debug] [Thread-3  ]: Finished running node model.billy_bulky.staging_shopify__orders
[0m12:57:46.722795 [debug] [Thread-2  ]: Finished running node model.billy_bulky.staging_shopify__customers
[0m12:57:46.723671 [debug] [Thread-4  ]: Finished running node model.billy_bulky.staging_shopify__products
[0m12:57:46.725804 [debug] [Thread-6  ]: Began running node model.billy_bulky.int_customers_segmentation
[0m12:57:46.726575 [debug] [Thread-7  ]: Began running node model.billy_bulky.int_products_inventory
[0m12:57:46.727764 [debug] [Thread-6  ]: Acquiring new snowflake connection 'model.billy_bulky.int_customers_segmentation'
[0m12:57:46.728278 [debug] [Thread-8  ]: Began running node model.billy_bulky.int_products_performance
[0m12:57:46.728862 [debug] [Thread-9  ]: Began running node model.billy_bulky.int_sales_trend
[0m12:57:46.729526 [info ] [Thread-7  ]: 5 of 8 START sql incremental model intermediate.int_products_inventory ......... [RUN]
[0m12:57:46.730097 [debug] [Thread-6  ]: Began compiling node model.billy_bulky.int_customers_segmentation
[0m12:57:46.731071 [debug] [Thread-8  ]: Acquiring new snowflake connection 'model.billy_bulky.int_products_performance'
[0m12:57:46.731994 [debug] [Thread-9  ]: Acquiring new snowflake connection 'model.billy_bulky.int_sales_trend'
[0m12:57:46.732873 [debug] [Thread-7  ]: Acquiring new snowflake connection 'model.billy_bulky.int_products_inventory'
[0m12:57:46.739568 [debug] [Thread-6  ]: Writing injected SQL for node "model.billy_bulky.int_customers_segmentation"
[0m12:57:46.740248 [debug] [Thread-8  ]: Began compiling node model.billy_bulky.int_products_performance
[0m12:57:46.740868 [debug] [Thread-9  ]: Began compiling node model.billy_bulky.int_sales_trend
[0m12:57:46.741403 [debug] [Thread-7  ]: Began compiling node model.billy_bulky.int_products_inventory
[0m12:57:46.747380 [debug] [Thread-8  ]: Writing injected SQL for node "model.billy_bulky.int_products_performance"
[0m12:57:46.752776 [debug] [Thread-9  ]: Writing injected SQL for node "model.billy_bulky.int_sales_trend"
[0m12:57:46.757445 [debug] [Thread-7  ]: Writing injected SQL for node "model.billy_bulky.int_products_inventory"
[0m12:57:46.758110 [debug] [Thread-6  ]: Timing info for model.billy_bulky.int_customers_segmentation (compile): 12:57:46.733211 => 12:57:46.757818
[0m12:57:46.759466 [debug] [Thread-6  ]: Finished running node model.billy_bulky.int_customers_segmentation
[0m12:57:46.760069 [debug] [Thread-8  ]: Timing info for model.billy_bulky.int_products_performance (compile): 12:57:46.741876 => 12:57:46.759842
[0m12:57:46.760964 [debug] [Thread-8  ]: Finished running node model.billy_bulky.int_products_performance
[0m12:57:46.761615 [debug] [Thread-7  ]: Timing info for model.billy_bulky.int_products_inventory (compile): 12:57:46.753230 => 12:57:46.761386
[0m12:57:46.762083 [debug] [Thread-7  ]: Began executing node model.billy_bulky.int_products_inventory
[0m12:57:46.762530 [debug] [Thread-9  ]: Timing info for model.billy_bulky.int_sales_trend (compile): 12:57:46.748165 => 12:57:46.762333
[0m12:57:46.762893 [debug] [Thread-5  ]: Began running node model.billy_bulky.customers
[0m12:57:46.769610 [debug] [Thread-1  ]: Began running node model.billy_bulky.products
[0m12:57:46.789386 [debug] [Thread-9  ]: Finished running node model.billy_bulky.int_sales_trend
[0m12:57:46.800787 [debug] [Thread-7  ]: Writing runtime sql for node "model.billy_bulky.int_products_inventory"
[0m12:57:46.801288 [info ] [Thread-5  ]: 6 of 8 START sql table model marts.customers ................................... [RUN]
[0m12:57:46.801598 [info ] [Thread-1  ]: 7 of 8 START sql table model marts.products .................................... [RUN]
[0m12:57:46.802131 [debug] [Thread-2  ]: Began running node model.billy_bulky.sales
[0m12:57:46.802638 [debug] [Thread-5  ]: Re-using an available connection from the pool (formerly list_E_COMMERCE_marts, now model.billy_bulky.customers)
[0m12:57:46.803053 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.billy_bulky.staging__shopify__products_history, now model.billy_bulky.products)
[0m12:57:46.803372 [info ] [Thread-2  ]: 8 of 8 START sql table model marts.sales ....................................... [RUN]
[0m12:57:46.803669 [debug] [Thread-5  ]: Began compiling node model.billy_bulky.customers
[0m12:57:46.804352 [debug] [Thread-7  ]: Using snowflake connection "model.billy_bulky.int_products_inventory"
[0m12:57:46.804582 [debug] [Thread-1  ]: Began compiling node model.billy_bulky.products
[0m12:57:46.804969 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.billy_bulky.staging_shopify__customers, now model.billy_bulky.sales)
[0m12:57:46.811298 [debug] [Thread-5  ]: Writing injected SQL for node "model.billy_bulky.customers"
[0m12:57:46.811566 [debug] [Thread-7  ]: On model.billy_bulky.int_products_inventory: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.int_products_inventory"} */
create or replace transient table E_COMMERCE.intermediate.int_products_inventory
         as
        (

WITH inventory_data AS (
    SELECT
        DATE_TRUNC('day', CURRENT_TIMESTAMP) AS snapshot_date
        , p.PRODUCT_ID
        , p.STOCK_LEVEL
    FROM E_COMMERCE.staging.staging_shopify__products p
    WHERE NOT EXISTS (
        SELECT 1
        FROM E_COMMERCE.intermediate.int_products_inventory
        WHERE snapshot_date = DATE_TRUNC('day', CURRENT_TIMESTAMP)
          AND PRODUCT_ID = p.PRODUCT_ID
    )
)

SELECT
    snapshot_date
    , PRODUCT_ID
    , STOCK_LEVEL
FROM inventory_data


        );
[0m12:57:46.816091 [debug] [Thread-1  ]: Writing injected SQL for node "model.billy_bulky.products"
[0m12:57:46.816536 [debug] [Thread-2  ]: Began compiling node model.billy_bulky.sales
[0m12:57:46.816962 [debug] [Thread-7  ]: Opening a new connection, currently in state init
[0m12:57:46.825271 [debug] [Thread-2  ]: Writing injected SQL for node "model.billy_bulky.sales"
[0m12:57:46.826009 [debug] [Thread-5  ]: Timing info for model.billy_bulky.customers (compile): 12:57:46.805133 => 12:57:46.825855
[0m12:57:46.826619 [debug] [Thread-1  ]: Timing info for model.billy_bulky.products (compile): 12:57:46.811754 => 12:57:46.826488
[0m12:57:46.826896 [debug] [Thread-5  ]: Began executing node model.billy_bulky.customers
[0m12:57:46.827152 [debug] [Thread-1  ]: Began executing node model.billy_bulky.products
[0m12:57:46.833817 [debug] [Thread-2  ]: Timing info for model.billy_bulky.sales (compile): 12:57:46.817249 => 12:57:46.833511
[0m12:57:46.834484 [debug] [Thread-5  ]: Writing runtime sql for node "model.billy_bulky.customers"
[0m12:57:46.836650 [debug] [Thread-1  ]: Writing runtime sql for node "model.billy_bulky.products"
[0m12:57:46.837098 [debug] [Thread-2  ]: Began executing node model.billy_bulky.sales
[0m12:57:46.838990 [debug] [Thread-2  ]: Writing runtime sql for node "model.billy_bulky.sales"
[0m12:57:46.841020 [debug] [Thread-5  ]: Using snowflake connection "model.billy_bulky.customers"
[0m12:57:46.841354 [debug] [Thread-5  ]: On model.billy_bulky.customers: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.customers"} */
create or replace transient table E_COMMERCE.marts.customers
         as
        (WITH  __dbt__cte__int_customers_segmentation as (
WITH customers AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__customers
)

, orders AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__orders
)

, products AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__products
)

, order_aggregates AS (
    SELECT
        o.CUSTOMER_ID
        , COUNT(DISTINCT o.ORDER_ID) AS frequency
        , SUM(o.QUANTITY * p.PRICE) AS monetary
        , AVG(o.QUANTITY * p.PRICE) AS average_order_value
        , MAX(o.ORDER_DATE) AS last_purchase_date
        , COUNT(CASE WHEN o.STATUS = 'cancelled' THEN 1 END) AS cancelled_orders
        , COUNT(*) AS total_orders
    FROM orders o
    JOIN products p ON o.PRODUCT_ID = p.PRODUCT_ID
    GROUP BY o.CUSTOMER_ID
)

, customer_tenure AS (
    SELECT
        CUSTOMER_ID
        , JOIN_DATE
        , CURRENT_DATE - JOIN_DATE AS tenure
    FROM customers
)

, customer_recency AS (
    SELECT
        CUSTOMER_ID
        , CURRENT_DATE - last_purchase_date AS recency
    FROM order_aggregates
)

, final AS (
    SELECT
        c.CUSTOMER_ID
        , c.FIRST_NAME
        , c.LAST_NAME
        , c.EMAIL
        , c.JOIN_DATE
        , c.COUNTRY
        , o.frequency
        , o.monetary
        , o.average_order_value
        , o.cancelled_orders
        , o.total_orders
        , CASE 
            WHEN o.total_orders > 0 THEN ROUND((o.cancelled_orders::FLOAT / o.total_orders) * 100, 2) 
            ELSE 0 
          END AS cancellation_rate
        , r.recency
        , t.tenure
    FROM customer_tenure t
    JOIN customers c ON t.CUSTOMER_ID = c.CUSTOMER_ID
    JOIN order_aggregates o ON c.CUSTOMER_ID = o.CUSTOMER_ID
    JOIN customer_recency r ON c.CUSTOMER_ID = r.CUSTOMER_ID
)

SELECT * FROM final
), source AS (
    SELECT
        icp.CUSTOMER_ID
        , icp.FIRST_NAME
        , icp.LAST_NAME
        , icp.EMAIL
        , icp.JOIN_DATE
        , icp.COUNTRY
        , icp.frequency AS total_orders
        , icp.monetary AS total_spent
        , icp.recency
        , icp.tenure
    FROM __dbt__cte__int_customers_segmentation icp
)

, final AS (
SELECT
    s.CUSTOMER_ID
    , s.FIRST_NAME
    , s.LAST_NAME
    , s.EMAIL
    , s.JOIN_DATE
    , s.COUNTRY
    , s.total_orders
    , s.total_spent
    , s.recency
    , s.tenure
    , CASE
        WHEN total_spent > 1000 THEN 'VIP'
        ELSE 'Regular'
    END AS customer_segment
FROM source s
)

SELECT * FROM final
        );
[0m12:57:46.841665 [debug] [Thread-5  ]: Opening a new connection, currently in state closed
[0m12:57:46.843089 [debug] [Thread-1  ]: Using snowflake connection "model.billy_bulky.products"
[0m12:57:46.845372 [debug] [Thread-2  ]: Using snowflake connection "model.billy_bulky.sales"
[0m12:57:46.845673 [debug] [Thread-1  ]: On model.billy_bulky.products: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.products"} */
create or replace transient table E_COMMERCE.marts.products
         as
        (WITH  __dbt__cte__int_products_performance as (
WITH orders AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__orders
)

, products AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__products
)

, product_sales AS (
    SELECT
        o.PRODUCT_ID
        , COUNT(DISTINCT o.ORDER_ID) AS total_sales
        , SUM(o.QUANTITY) AS total_units_sold
        , SUM(o.QUANTITY * p.PRICE) AS total_sales_value
    FROM orders o
    INNER JOIN products p ON o.PRODUCT_ID = p.PRODUCT_ID
    WHERE o.STATUS NOT IN ('cancelled') 
    GROUP BY o.PRODUCT_ID
)

, product_averages AS (
    SELECT
        PRODUCT_ID
        , (total_sales_value / NULLIF(total_units_sold, 0)) AS average_sale_price
    FROM product_sales
)

, product_stock_turnover AS (
    SELECT
        p.PRODUCT_ID
        , p.STOCK_LEVEL
        , (total_units_sold / NULLIF(p.STOCK_LEVEL, 0)) AS turnover_rate
    FROM product_sales ps
    INNER JOIN products p ON ps.PRODUCT_ID = p.PRODUCT_ID
)

, final AS (
    SELECT
    p.PRODUCT_ID
    , p.NAME
    , p.CATEGORY
    , p.PRICE
    , pa.average_sale_price
    , ps.total_sales
    , ps.total_units_sold
    , ps.total_sales_value
    , pst.turnover_rate
    , p.STOCK_LEVEL
FROM products p
LEFT JOIN product_sales ps ON p.PRODUCT_ID = ps.PRODUCT_ID
LEFT JOIN product_averages pa ON p.PRODUCT_ID = pa.PRODUCT_ID
LEFT JOIN product_stock_turnover pst ON p.PRODUCT_ID = pst.PRODUCT_ID
)

SELECT * FROM final
), final AS (
    SELECT
        pp.PRODUCT_ID
        , pp.NAME
        , pp.CATEGORY
        , pp.PRICE
        , pp.average_sale_price
        , pp.total_sales
        , pp.total_units_sold
        , pp.total_sales_value
        , pp.turnover_rate
        , pp.STOCK_LEVEL
    FROM __dbt__cte__int_products_performance pp
)

SELECT * FROM final
        );
[0m12:57:46.846298 [debug] [Thread-2  ]: On model.billy_bulky.sales: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.sales"} */
create or replace transient table E_COMMERCE.marts.sales
         as
        (WITH  __dbt__cte__int_sales_trend as (
WITH orders AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__orders
)

, products AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__products
)

, daily_sales AS (
    SELECT
        DATE(ORDER_DATE) AS sale_date
        , COUNT(DISTINCT ORDER_ID) AS total_orders
        , SUM(QUANTITY) AS total_units_sold
        , SUM(QUANTITY * PRICE) AS total_sales_value
    FROM orders AS o
    JOIN products AS p ON o.PRODUCT_ID = p.PRODUCT_ID
    WHERE o.STATUS NOT IN ('cancelled') 
    GROUP BY sale_date
)

, weekly_sales AS (
    SELECT
        DATE_TRUNC('week', sale_date) AS sale_week
        , SUM(total_orders) AS weekly_orders
        , SUM(total_units_sold) AS weekly_units_sold
        , SUM(total_sales_value) AS weekly_sales_value
    FROM daily_sales
    GROUP BY sale_week
)

, monthly_sales AS (
    SELECT
        DATE_TRUNC('month', sale_date) AS sale_month
        , SUM(total_orders) AS monthly_orders
        , SUM(total_units_sold) AS monthly_units_sold
        , SUM(total_sales_value) AS monthly_sales_value
    FROM daily_sales
    GROUP BY sale_month
)

, yearly_sales AS (
    SELECT
        DATE_TRUNC('year', sale_date) AS sale_year
        , SUM(total_orders) AS yearly_orders
        , SUM(total_units_sold) AS yearly_units_sold
        , SUM(total_sales_value) AS yearly_sales_value
    FROM daily_sales
    GROUP BY sale_year
)

SELECT
    d.sale_date
    , d.total_orders AS daily_orders
    , d.total_units_sold AS daily_units_sold
    , d.total_sales_value AS daily_sales_value
    , w.weekly_orders
    , w.weekly_units_sold
    , w.weekly_sales_value
    , m.monthly_orders
    , m.monthly_units_sold
    , m.monthly_sales_value
    , y.yearly_orders
    , y.yearly_units_sold
    , y.yearly_sales_value
FROM daily_sales d
LEFT JOIN weekly_sales w ON DATE_TRUNC('week', d.sale_date) = w.sale_week
LEFT JOIN monthly_sales m ON DATE_TRUNC('month', d.sale_date) = m.sale_month
LEFT JOIN yearly_sales y ON DATE_TRUNC('year', d.sale_date) = y.sale_year
), enriched_orders AS (
    SELECT
        o.ORDER_ID
        , o.CUSTOMER_ID
        , o.PRODUCT_ID
        , o.QUANTITY
        , o.ORDER_DATE
        , o.STATUS
        , p.CATEGORY
        , p.PRICE AS unit_price
        , (o.QUANTITY * p.PRICE) AS total_price
        , c.COUNTRY
    FROM E_COMMERCE.staging.staging_shopify__orders o
    JOIN E_COMMERCE.staging.staging_shopify__products p ON o.PRODUCT_ID = p.PRODUCT_ID
    JOIN E_COMMERCE.staging.staging_shopify__customers c ON o.CUSTOMER_ID = c.CUSTOMER_ID
    WHERE o.STATUS NOT IN ('cancelled') 
)

SELECT
    eo.ORDER_ID
    , eo.CUSTOMER_ID
    , eo.PRODUCT_ID
    , eo.QUANTITY
    , eo.ORDER_DATE
    , eo.STATUS
    , eo.CATEGORY
    , eo.unit_price
    , eo.total_price
    , eo.COUNTRY
    , sa.daily_orders
    , sa.daily_units_sold
    , sa.daily_sales_value
FROM enriched_orders eo
LEFT JOIN __dbt__cte__int_sales_trend sa ON DATE(eo.ORDER_DATE) = sa.sale_date
        );
[0m12:57:46.846900 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:57:46.847151 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m12:57:47.951938 [debug] [Thread-7  ]: Snowflake adapter: Snowflake query id: 01b07a0d-0001-82f5-0004-d8be000190ee
[0m12:57:47.952313 [debug] [Thread-7  ]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'E_COMMERCE.INTERMEDIATE.INT_PRODUCTS_INVENTORY' does not exist or not authorized.
[0m12:57:47.952706 [debug] [Thread-7  ]: Timing info for model.billy_bulky.int_products_inventory (execute): 12:57:46.763105 => 12:57:47.952548
[0m12:57:47.952994 [debug] [Thread-7  ]: On model.billy_bulky.int_products_inventory: Close
[0m12:57:48.436845 [debug] [Thread-7  ]: Database Error in model int_products_inventory (models/intermediate/products/int_products_inventory.sql)
  002003 (42S02): SQL compilation error:
  Object 'E_COMMERCE.INTERMEDIATE.INT_PRODUCTS_INVENTORY' does not exist or not authorized.
  compiled Code at target/run/billy_bulky/models/intermediate/products/int_products_inventory.sql
[0m12:57:48.437860 [debug] [Thread-7  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b396f709-4e16-47a9-89de-d6c0a8e64267', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14549fc40>]}
[0m12:57:48.438764 [error] [Thread-7  ]: 5 of 8 ERROR creating sql incremental model intermediate.int_products_inventory  [[31mERROR[0m in 1.71s]
[0m12:57:48.439657 [debug] [Thread-7  ]: Finished running node model.billy_bulky.int_products_inventory
[0m12:57:49.175732 [debug] [Thread-5  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m12:57:49.182390 [debug] [Thread-5  ]: Timing info for model.billy_bulky.customers (execute): 12:57:46.827323 => 12:57:49.181921
[0m12:57:49.183230 [debug] [Thread-5  ]: On model.billy_bulky.customers: Close
[0m12:57:49.435502 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 3.0 seconds
[0m12:57:49.441168 [debug] [Thread-1  ]: Timing info for model.billy_bulky.products (execute): 12:57:46.834957 => 12:57:49.440789
[0m12:57:49.441929 [debug] [Thread-1  ]: On model.billy_bulky.products: Close
[0m12:57:49.517095 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 3.0 seconds
[0m12:57:49.524490 [debug] [Thread-2  ]: Timing info for model.billy_bulky.sales (execute): 12:57:46.837390 => 12:57:49.524236
[0m12:57:49.524969 [debug] [Thread-2  ]: On model.billy_bulky.sales: Close
[0m12:57:49.534167 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b396f709-4e16-47a9-89de-d6c0a8e64267', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1454ba490>]}
[0m12:57:49.534954 [info ] [Thread-5  ]: 6 of 8 OK created sql table model marts.customers .............................. [[32mSUCCESS 1[0m in 2.73s]
[0m12:57:49.535686 [debug] [Thread-5  ]: Finished running node model.billy_bulky.customers
[0m12:57:49.797545 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b396f709-4e16-47a9-89de-d6c0a8e64267', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14503b760>]}
[0m12:57:49.799449 [info ] [Thread-1  ]: 7 of 8 OK created sql table model marts.products ............................... [[32mSUCCESS 1[0m in 2.99s]
[0m12:57:49.800949 [debug] [Thread-1  ]: Finished running node model.billy_bulky.products
[0m12:57:49.880748 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b396f709-4e16-47a9-89de-d6c0a8e64267', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145459ca0>]}
[0m12:57:49.882164 [info ] [Thread-2  ]: 8 of 8 OK created sql table model marts.sales .................................. [[32mSUCCESS 1[0m in 3.08s]
[0m12:57:49.883194 [debug] [Thread-2  ]: Finished running node model.billy_bulky.sales
[0m12:57:49.886119 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:57:49.886714 [debug] [MainThread]: Connection 'model.billy_bulky.products' was properly closed.
[0m12:57:49.887215 [debug] [MainThread]: Connection 'model.billy_bulky.sales' was properly closed.
[0m12:57:49.887705 [debug] [MainThread]: Connection 'model.billy_bulky.staging_shopify__orders' was properly closed.
[0m12:57:49.888185 [debug] [MainThread]: Connection 'model.billy_bulky.staging_shopify__products' was properly closed.
[0m12:57:49.888655 [debug] [MainThread]: Connection 'model.billy_bulky.customers' was properly closed.
[0m12:57:49.889117 [debug] [MainThread]: Connection 'model.billy_bulky.int_customers_segmentation' was properly closed.
[0m12:57:49.889583 [debug] [MainThread]: Connection 'model.billy_bulky.int_products_performance' was properly closed.
[0m12:57:49.890045 [debug] [MainThread]: Connection 'model.billy_bulky.int_sales_trend' was properly closed.
[0m12:57:49.890520 [debug] [MainThread]: Connection 'model.billy_bulky.int_products_inventory' was properly closed.
[0m12:57:49.891199 [info ] [MainThread]: 
[0m12:57:49.891749 [info ] [MainThread]: Finished running 4 view models, 1 incremental model, 3 table models in 0 hours 0 minutes and 8.70 seconds (8.70s).
[0m12:57:49.893877 [debug] [MainThread]: Command end result
[0m12:57:49.911082 [info ] [MainThread]: 
[0m12:57:49.911614 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:57:49.912007 [info ] [MainThread]: 
[0m12:57:49.912469 [error] [MainThread]:   Database Error in model int_products_inventory (models/intermediate/products/int_products_inventory.sql)
  002003 (42S02): SQL compilation error:
  Object 'E_COMMERCE.INTERMEDIATE.INT_PRODUCTS_INVENTORY' does not exist or not authorized.
  compiled Code at target/run/billy_bulky/models/intermediate/products/int_products_inventory.sql
[0m12:57:49.912984 [info ] [MainThread]: 
[0m12:57:49.913384 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m12:57:49.915846 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 9.841323, "process_user_time": 5.616867, "process_kernel_time": 0.410715, "process_mem_max_rss": "222052352", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:57:49.916433 [debug] [MainThread]: Command `dbt run` failed at 12:57:49.916303 after 9.84 seconds
[0m12:57:49.916858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d316d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1332bc3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14552cca0>]}
[0m12:57:49.917277 [debug] [MainThread]: Flushing usage events
[0m12:58:41.162540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1032716d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102d629d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ac0400>]}


============================== 12:58:41.165202 | cafa500d-dc40-4088-ba52-da08e5714ef2 ==============================
[0m12:58:41.165202 [info ] [MainThread]: Running with dbt=1.7.1
[0m12:58:41.165550 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/bitlevi/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/bitlevi/Documents/billy_bulky_ecommerce/billy_bulky_ecommerce/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m12:58:41.989000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cafa500d-dc40-4088-ba52-da08e5714ef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102d629d0>]}
[0m12:58:42.036553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cafa500d-dc40-4088-ba52-da08e5714ef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x131594c10>]}
[0m12:58:42.037380 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m12:58:42.049895 [debug] [MainThread]: checksum: ad428e6dc3b353dcb23d0c4ebea8b20b180e94b873271ac2a054a8e446dac0e2, vars: {}, profile: , target: , version: 1.7.1
[0m12:58:42.060925 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m12:58:42.061264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cafa500d-dc40-4088-ba52-da08e5714ef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13790acd0>]}
[0m12:58:42.791385 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'orders' in the 'models' section of file 'models/staging/shopify/_shopify__schema.yml'
[0m12:58:42.900985 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'marts_sales' in the 'models' section of file 'models/marts/_marts__models.yml'
[0m12:58:42.902804 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'marts_customers' in the 'models' section of file 'models/marts/_marts__models.yml'
[0m12:58:42.904046 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'marts_products' in the 'models' section of file 'models/marts/_marts__models.yml'
[0m12:58:42.988530 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.unique_orders_order_id.fed79b3a6e' (models/staging/shopify/_shopify__schema.yml) depends on a node named 'orders' in package '' which was not found
[0m12:58:42.988884 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_orders_order_id.cf6c17daed' (models/staging/shopify/_shopify__schema.yml) depends on a node named 'orders' in package '' which was not found
[0m12:58:42.989164 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_orders_customer_id.c5f02694af' (models/staging/shopify/_shopify__schema.yml) depends on a node named 'orders' in package '' which was not found
[0m12:58:42.989416 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_orders_product_id.3523c78a66' (models/staging/shopify/_shopify__schema.yml) depends on a node named 'orders' in package '' which was not found
[0m12:58:42.989642 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_orders_quantity.0e6bb23b03' (models/staging/shopify/_shopify__schema.yml) depends on a node named 'orders' in package '' which was not found
[0m12:58:42.989861 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_orders_order_date.6910a855fe' (models/staging/shopify/_shopify__schema.yml) depends on a node named 'orders' in package '' which was not found
[0m12:58:42.990077 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_orders_status.8a27272c0a' (models/staging/shopify/_shopify__schema.yml) depends on a node named 'orders' in package '' which was not found
[0m12:58:42.990297 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.accepted_values_orders_status__cancelled__processing__delivered__shipped.fbff2d9925' (models/staging/shopify/_shopify__schema.yml) depends on a node named 'orders' in package '' which was not found
[0m12:58:42.990538 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.unique_marts_sales_order_id.825e23650b' (models/marts/_marts__models.yml) depends on a node named 'marts_sales' in package '' which was not found
[0m12:58:42.990750 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_sales_order_id.842b56ef2f' (models/marts/_marts__models.yml) depends on a node named 'marts_sales' in package '' which was not found
[0m12:58:42.990956 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_sales_customer_id.189ac71c42' (models/marts/_marts__models.yml) depends on a node named 'marts_sales' in package '' which was not found
[0m12:58:42.991169 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.relationships_marts_sales_customer_id__customer_id__ref_customers_.74e21c3398' (models/marts/_marts__models.yml) depends on a node named 'marts_sales' in package '' which was not found
[0m12:58:42.991379 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_sales_product_id.12beecf4f2' (models/marts/_marts__models.yml) depends on a node named 'marts_sales' in package '' which was not found
[0m12:58:42.991591 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.relationships_marts_sales_product_id__product_id__ref_products_.77e7665182' (models/marts/_marts__models.yml) depends on a node named 'marts_sales' in package '' which was not found
[0m12:58:42.991800 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_sales_quantity.ea8c580869' (models/marts/_marts__models.yml) depends on a node named 'marts_sales' in package '' which was not found
[0m12:58:42.992006 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_sales_order_date.90eaa9e7fe' (models/marts/_marts__models.yml) depends on a node named 'marts_sales' in package '' which was not found
[0m12:58:42.992218 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_sales_status.e9b4b90247' (models/marts/_marts__models.yml) depends on a node named 'marts_sales' in package '' which was not found
[0m12:58:42.992424 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_sales_category.a98218f68d' (models/marts/_marts__models.yml) depends on a node named 'marts_sales' in package '' which was not found
[0m12:58:42.992633 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_sales_unit_price.321f152a2a' (models/marts/_marts__models.yml) depends on a node named 'marts_sales' in package '' which was not found
[0m12:58:42.992841 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_sales_total_price.015724a7e6' (models/marts/_marts__models.yml) depends on a node named 'marts_sales' in package '' which was not found
[0m12:58:42.993045 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_sales_country.5f628b732c' (models/marts/_marts__models.yml) depends on a node named 'marts_sales' in package '' which was not found
[0m12:58:42.993257 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.unique_marts_customers_customer_id.9c72620f57' (models/marts/_marts__models.yml) depends on a node named 'marts_customers' in package '' which was not found
[0m12:58:42.993467 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_customers_customer_id.fc7763eff9' (models/marts/_marts__models.yml) depends on a node named 'marts_customers' in package '' which was not found
[0m12:58:42.993669 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.unique_marts_customers_email.6210d26820' (models/marts/_marts__models.yml) depends on a node named 'marts_customers' in package '' which was not found
[0m12:58:42.993876 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_customers_email.637d2131e6' (models/marts/_marts__models.yml) depends on a node named 'marts_customers' in package '' which was not found
[0m12:58:42.994082 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_customers_join_date.6378efd424' (models/marts/_marts__models.yml) depends on a node named 'marts_customers' in package '' which was not found
[0m12:58:42.994291 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_customers_total_orders.7cdc5122e5' (models/marts/_marts__models.yml) depends on a node named 'marts_customers' in package '' which was not found
[0m12:58:42.994501 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_customers_total_spent.d5343aecc7' (models/marts/_marts__models.yml) depends on a node named 'marts_customers' in package '' which was not found
[0m12:58:42.994705 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.unique_marts_products_product_id.e96f554683' (models/marts/_marts__models.yml) depends on a node named 'marts_products' in package '' which was not found
[0m12:58:42.994912 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_products_product_id.9b354ae761' (models/marts/_marts__models.yml) depends on a node named 'marts_products' in package '' which was not found
[0m12:58:42.995118 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_products_name.f0d9c8d191' (models/marts/_marts__models.yml) depends on a node named 'marts_products' in package '' which was not found
[0m12:58:42.995326 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_products_category.1212ed3683' (models/marts/_marts__models.yml) depends on a node named 'marts_products' in package '' which was not found
[0m12:58:42.995532 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_products_price.d6207a2896' (models/marts/_marts__models.yml) depends on a node named 'marts_products' in package '' which was not found
[0m12:58:42.995742 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_products_total_units_sold.6822a804df' (models/marts/_marts__models.yml) depends on a node named 'marts_products' in package '' which was not found
[0m12:58:42.995948 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_products_total_sales_value.b0a2a654b3' (models/marts/_marts__models.yml) depends on a node named 'marts_products' in package '' which was not found
[0m12:58:43.023712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cafa500d-dc40-4088-ba52-da08e5714ef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1635270d0>]}
[0m12:58:43.037154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cafa500d-dc40-4088-ba52-da08e5714ef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137906850>]}
[0m12:58:43.037489 [info ] [MainThread]: Found 11 models, 1 snapshot, 1 seed, 54 tests, 4 sources, 0 exposures, 0 metrics, 431 macros, 0 groups, 0 semantic models
[0m12:58:43.037711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cafa500d-dc40-4088-ba52-da08e5714ef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105adf400>]}
[0m12:58:43.039323 [info ] [MainThread]: 
[0m12:58:43.039814 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:58:43.040677 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE'
[0m12:58:43.048566 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE"
[0m12:58:43.048793 [debug] [ThreadPool]: On list_E_COMMERCE: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE"} */
show terse schemas in database E_COMMERCE
    limit 10000
[0m12:58:43.049226 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE'
[0m12:58:43.049440 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:58:43.049881 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE'
[0m12:58:43.051529 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE"
[0m12:58:43.054358 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE"
[0m12:58:43.054665 [debug] [ThreadPool]: On list_E_COMMERCE: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE"} */
show terse schemas in database E_COMMERCE
    limit 10000
[0m12:58:43.055180 [debug] [ThreadPool]: On list_E_COMMERCE: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE"} */
show terse schemas in database E_COMMERCE
    limit 10000
[0m12:58:43.055393 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:58:43.055582 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:58:44.434525 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m12:58:44.435782 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m12:58:44.437965 [debug] [ThreadPool]: On list_E_COMMERCE: Close
[0m12:58:44.439840 [debug] [ThreadPool]: On list_E_COMMERCE: Close
[0m12:58:44.501877 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m12:58:44.504085 [debug] [ThreadPool]: On list_E_COMMERCE: Close
[0m12:58:44.898018 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_E_COMMERCE, now list_E_COMMERCE_intermediate)
[0m12:58:44.899473 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_E_COMMERCE, now list_E_COMMERCE_marts)
[0m12:58:44.902059 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_E_COMMERCE, now list_E_COMMERCE_staging)
[0m12:58:44.909586 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_snapshots'
[0m12:58:44.920574 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_marts"
[0m12:58:44.921421 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PUBLIC'
[0m12:58:44.927302 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_intermediate"
[0m12:58:44.929481 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_staging"
[0m12:58:44.931845 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_snapshots"
[0m12:58:44.932241 [debug] [ThreadPool]: On list_E_COMMERCE_marts: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE_marts"} */
show terse objects in E_COMMERCE.marts limit 10000
[0m12:58:44.934659 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PUBLIC"
[0m12:58:44.935041 [debug] [ThreadPool]: On list_E_COMMERCE_intermediate: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE_intermediate"} */
show terse objects in E_COMMERCE.intermediate limit 10000
[0m12:58:44.935403 [debug] [ThreadPool]: On list_E_COMMERCE_staging: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE_staging"} */
show terse objects in E_COMMERCE.staging limit 10000
[0m12:58:44.935748 [debug] [ThreadPool]: On list_E_COMMERCE_snapshots: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE_snapshots"} */
show terse objects in E_COMMERCE.snapshots limit 10000
[0m12:58:44.936094 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:58:44.936426 [debug] [ThreadPool]: On list_E_COMMERCE_PUBLIC: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE_PUBLIC"} */
show terse objects in E_COMMERCE.PUBLIC limit 10000
[0m12:58:44.936735 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:58:44.937009 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:58:44.937271 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:58:44.937807 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:58:46.227072 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m12:58:46.240663 [debug] [ThreadPool]: On list_E_COMMERCE_intermediate: Close
[0m12:58:46.241973 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m12:58:46.244982 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:58:46.247026 [debug] [ThreadPool]: On list_E_COMMERCE_staging: Close
[0m12:58:46.248454 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m12:58:46.250753 [debug] [ThreadPool]: On list_E_COMMERCE_snapshots: Close
[0m12:58:46.258977 [debug] [ThreadPool]: On list_E_COMMERCE_marts: Close
[0m12:58:46.298664 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b07a0e-0001-815a-0004-d8be00018252
[0m12:58:46.298978 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m12:58:46.299308 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m12:58:46.299538 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m12:58:46.299798 [debug] [ThreadPool]: On list_E_COMMERCE_PUBLIC: Close
[0m12:58:46.655512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cafa500d-dc40-4088-ba52-da08e5714ef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x163580220>]}
[0m12:58:46.656925 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m12:58:46.657544 [info ] [MainThread]: 
[0m12:58:46.662131 [debug] [Thread-1  ]: Began running node model.billy_bulky.staging__shopify__products_history
[0m12:58:46.662970 [debug] [Thread-2  ]: Began running node model.billy_bulky.staging_shopify__customers
[0m12:58:46.663630 [debug] [Thread-3  ]: Began running node model.billy_bulky.staging_shopify__orders
[0m12:58:46.664350 [info ] [Thread-1  ]: 1 of 11 START sql view model staging.staging__shopify__products_history ........ [RUN]
[0m12:58:46.665047 [info ] [Thread-2  ]: 2 of 11 START sql view model staging.staging_shopify__customers ................ [RUN]
[0m12:58:46.666821 [debug] [Thread-4  ]: Began running node model.billy_bulky.staging_shopify__products
[0m12:58:46.665759 [info ] [Thread-3  ]: 3 of 11 START sql view model staging.staging_shopify__orders ................... [RUN]
[0m12:58:46.668704 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_E_COMMERCE_intermediate, now model.billy_bulky.staging__shopify__products_history)
[0m12:58:46.669698 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_E_COMMERCE_marts, now model.billy_bulky.staging_shopify__customers)
[0m12:58:46.670448 [info ] [Thread-4  ]: 4 of 11 START sql view model staging.staging_shopify__products ................. [RUN]
[0m12:58:46.671428 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly list_E_COMMERCE_staging, now model.billy_bulky.staging_shopify__orders)
[0m12:58:46.672010 [debug] [Thread-1  ]: Began compiling node model.billy_bulky.staging__shopify__products_history
[0m12:58:46.672527 [debug] [Thread-2  ]: Began compiling node model.billy_bulky.staging_shopify__customers
[0m12:58:46.673381 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly list_E_COMMERCE_snapshots, now model.billy_bulky.staging_shopify__products)
[0m12:58:46.673902 [debug] [Thread-3  ]: Began compiling node model.billy_bulky.staging_shopify__orders
[0m12:58:46.684223 [debug] [Thread-1  ]: Writing injected SQL for node "model.billy_bulky.staging__shopify__products_history"
[0m12:58:46.688045 [debug] [Thread-2  ]: Writing injected SQL for node "model.billy_bulky.staging_shopify__customers"
[0m12:58:46.688556 [debug] [Thread-4  ]: Began compiling node model.billy_bulky.staging_shopify__products
[0m12:58:46.691627 [debug] [Thread-3  ]: Writing injected SQL for node "model.billy_bulky.staging_shopify__orders"
[0m12:58:46.695020 [debug] [Thread-4  ]: Writing injected SQL for node "model.billy_bulky.staging_shopify__products"
[0m12:58:46.695740 [debug] [Thread-1  ]: Timing info for model.billy_bulky.staging__shopify__products_history (compile): 12:58:46.674234 => 12:58:46.695465
[0m12:58:46.696225 [debug] [Thread-2  ]: Timing info for model.billy_bulky.staging_shopify__customers (compile): 12:58:46.684570 => 12:58:46.696020
[0m12:58:46.696642 [debug] [Thread-1  ]: Began executing node model.billy_bulky.staging__shopify__products_history
[0m12:58:46.697070 [debug] [Thread-3  ]: Timing info for model.billy_bulky.staging_shopify__orders (compile): 12:58:46.688819 => 12:58:46.696882
[0m12:58:46.697421 [debug] [Thread-2  ]: Began executing node model.billy_bulky.staging_shopify__customers
[0m12:58:46.703837 [debug] [Thread-4  ]: Timing info for model.billy_bulky.staging_shopify__products (compile): 12:58:46.692099 => 12:58:46.703547
[0m12:58:46.717696 [debug] [Thread-3  ]: Began executing node model.billy_bulky.staging_shopify__orders
[0m12:58:46.722497 [debug] [Thread-1  ]: Writing runtime sql for node "model.billy_bulky.staging__shopify__products_history"
[0m12:58:46.725922 [debug] [Thread-2  ]: Writing runtime sql for node "model.billy_bulky.staging_shopify__customers"
[0m12:58:46.726210 [debug] [Thread-4  ]: Began executing node model.billy_bulky.staging_shopify__products
[0m12:58:46.728465 [debug] [Thread-3  ]: Writing runtime sql for node "model.billy_bulky.staging_shopify__orders"
[0m12:58:46.730836 [debug] [Thread-4  ]: Writing runtime sql for node "model.billy_bulky.staging_shopify__products"
[0m12:58:46.731558 [debug] [Thread-3  ]: Using snowflake connection "model.billy_bulky.staging_shopify__orders"
[0m12:58:46.731843 [debug] [Thread-3  ]: On model.billy_bulky.staging_shopify__orders: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.staging_shopify__orders"} */
create or replace   view E_COMMERCE.staging.staging_shopify__orders
  
   as (
    WITH orders AS (
    SELECT * FROM SHOPIFY.PUBLIC.orders
)

SELECT
    ORDER_ID
    , CUSTOMER_ID
    , PRODUCT_ID
    , QUANTITY
    , ORDER_DATE
    , STATUS
FROM orders
  );
[0m12:58:46.732442 [debug] [Thread-1  ]: Using snowflake connection "model.billy_bulky.staging__shopify__products_history"
[0m12:58:46.732912 [debug] [Thread-2  ]: Using snowflake connection "model.billy_bulky.staging_shopify__customers"
[0m12:58:46.733148 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m12:58:46.733582 [debug] [Thread-4  ]: Using snowflake connection "model.billy_bulky.staging_shopify__products"
[0m12:58:46.733862 [debug] [Thread-1  ]: On model.billy_bulky.staging__shopify__products_history: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.staging__shopify__products_history"} */
create or replace   view E_COMMERCE.staging.staging__shopify__products_history
  
   as (
    WITH products AS (
    SELECT * FROM E_COMMERCE.SNAPSHOTS.products_snapshot
)

SELECT
    PRODUCT_ID
    , NAME
    , CATEGORY
    , PRICE
    , STOCK_LEVEL
    , DBT_SCD_ID
    , DBT_UPDATED_AT
    , DBT_VALID_FROM
    , DBT_VALID_TO
FROM products
  );
[0m12:58:46.734148 [debug] [Thread-2  ]: On model.billy_bulky.staging_shopify__customers: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.staging_shopify__customers"} */
create or replace   view E_COMMERCE.staging.staging_shopify__customers
  
   as (
    WITH customers AS (
    SELECT * FROM SHOPIFY.PUBLIC.customers
)

SELECT
    CUSTOMER_ID
    , FIRST_NAME
    , LAST_NAME
    , EMAIL
    , JOIN_DATE
    , COUNTRY
FROM customers
  );
[0m12:58:46.734897 [debug] [Thread-4  ]: On model.billy_bulky.staging_shopify__products: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.staging_shopify__products"} */
create or replace   view E_COMMERCE.staging.staging_shopify__products
  
   as (
    WITH products AS (
    SELECT * FROM SHOPIFY.PUBLIC.products
)

SELECT
    PRODUCT_ID
    , NAME
    , CATEGORY
    , PRICE
    , STOCK_LEVEL
FROM products
  );
[0m12:58:46.735445 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:58:46.735730 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m12:58:46.735984 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m12:58:47.908777 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:58:47.941290 [debug] [Thread-4  ]: Timing info for model.billy_bulky.staging_shopify__products (execute): 12:58:46.728795 => 12:58:47.941026
[0m12:58:47.941824 [debug] [Thread-4  ]: On model.billy_bulky.staging_shopify__products: Close
[0m12:58:48.168279 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:58:48.175403 [debug] [Thread-1  ]: Timing info for model.billy_bulky.staging__shopify__products_history (execute): 12:58:46.697660 => 12:58:48.174856
[0m12:58:48.176265 [debug] [Thread-1  ]: On model.billy_bulky.staging__shopify__products_history: Close
[0m12:58:48.191843 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:58:48.195974 [debug] [Thread-2  ]: Timing info for model.billy_bulky.staging_shopify__customers (execute): 12:58:46.722728 => 12:58:48.195598
[0m12:58:48.196669 [debug] [Thread-2  ]: On model.billy_bulky.staging_shopify__customers: Close
[0m12:58:48.551952 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cafa500d-dc40-4088-ba52-da08e5714ef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1633d9a60>]}
[0m12:58:48.553635 [info ] [Thread-1  ]: 1 of 11 OK created sql view model staging.staging__shopify__products_history ... [[32mSUCCESS 1[0m in 1.88s]
[0m12:58:48.554735 [debug] [Thread-1  ]: Finished running node model.billy_bulky.staging__shopify__products_history
[0m12:58:48.611240 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cafa500d-dc40-4088-ba52-da08e5714ef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137eb4670>]}
[0m12:58:48.612465 [info ] [Thread-2  ]: 2 of 11 OK created sql view model staging.staging_shopify__customers ........... [[32mSUCCESS 1[0m in 1.94s]
[0m12:58:48.613499 [debug] [Thread-2  ]: Finished running node model.billy_bulky.staging_shopify__customers
[0m12:58:48.857292 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cafa500d-dc40-4088-ba52-da08e5714ef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x163fbc2b0>]}
[0m12:58:48.859297 [info ] [Thread-4  ]: 4 of 11 OK created sql view model staging.staging_shopify__products ............ [[32mSUCCESS 1[0m in 2.18s]
[0m12:58:48.860561 [debug] [Thread-4  ]: Finished running node model.billy_bulky.staging_shopify__products
[0m12:58:48.861584 [debug] [Thread-6  ]: Began running node model.billy_bulky.int_products_inventory
[0m12:58:48.862395 [info ] [Thread-6  ]: 5 of 11 START sql incremental model intermediate.int_products_inventory ........ [RUN]
[0m12:58:48.863833 [debug] [Thread-6  ]: Acquiring new snowflake connection 'model.billy_bulky.int_products_inventory'
[0m12:58:48.864504 [debug] [Thread-6  ]: Began compiling node model.billy_bulky.int_products_inventory
[0m12:58:48.872257 [debug] [Thread-6  ]: Writing injected SQL for node "model.billy_bulky.int_products_inventory"
[0m12:58:48.874096 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m12:58:48.877762 [debug] [Thread-3  ]: Timing info for model.billy_bulky.staging_shopify__orders (execute): 12:58:46.726390 => 12:58:48.877430
[0m12:58:48.878403 [debug] [Thread-3  ]: On model.billy_bulky.staging_shopify__orders: Close
[0m12:58:48.879067 [debug] [Thread-6  ]: Timing info for model.billy_bulky.int_products_inventory (compile): 12:58:48.864913 => 12:58:48.878740
[0m12:58:48.881116 [debug] [Thread-6  ]: Began executing node model.billy_bulky.int_products_inventory
[0m12:58:48.928087 [debug] [Thread-6  ]: Writing runtime sql for node "model.billy_bulky.int_products_inventory"
[0m12:58:48.929360 [debug] [Thread-6  ]: Using snowflake connection "model.billy_bulky.int_products_inventory"
[0m12:58:48.929693 [debug] [Thread-6  ]: On model.billy_bulky.int_products_inventory: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.int_products_inventory"} */
create or replace transient table E_COMMERCE.intermediate.int_products_inventory
         as
        (

WITH inventory_data AS (
    SELECT
        DATE_TRUNC('day', CURRENT_TIMESTAMP) AS snapshot_date
        , p.PRODUCT_ID
        , p.STOCK_LEVEL
    FROM E_COMMERCE.staging.staging_shopify__products p
    WHERE NOT EXISTS (
        SELECT 1
        FROM E_COMMERCE.intermediate.int_products_inventory
        WHERE snapshot_date = DATE_TRUNC('day', CURRENT_TIMESTAMP)
          AND PRODUCT_ID = p.PRODUCT_ID
    )
)

SELECT
    snapshot_date
    , PRODUCT_ID
    , STOCK_LEVEL
FROM inventory_data


        );
[0m12:58:48.929992 [debug] [Thread-6  ]: Opening a new connection, currently in state init
[0m12:58:49.282595 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cafa500d-dc40-4088-ba52-da08e5714ef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1622c49d0>]}
[0m12:58:49.283427 [info ] [Thread-3  ]: 3 of 11 OK created sql view model staging.staging_shopify__orders .............. [[32mSUCCESS 1[0m in 2.61s]
[0m12:58:49.284084 [debug] [Thread-3  ]: Finished running node model.billy_bulky.staging_shopify__orders
[0m12:58:49.284771 [debug] [Thread-8  ]: Began running node model.billy_bulky.int_customers_segmentation
[0m12:58:49.285256 [debug] [Thread-9  ]: Began running node model.billy_bulky.int_products_performance
[0m12:58:49.285730 [info ] [Thread-8  ]: 6 of 11 START sql table model intermediate.int_customers_segmentation .......... [RUN]
[0m12:58:49.286195 [debug] [Thread-10 ]: Began running node model.billy_bulky.int_sales_trend
[0m12:58:49.286644 [info ] [Thread-9  ]: 7 of 11 START sql table model intermediate.int_products_performance ............ [RUN]
[0m12:58:49.287439 [debug] [Thread-8  ]: Acquiring new snowflake connection 'model.billy_bulky.int_customers_segmentation'
[0m12:58:49.287859 [info ] [Thread-10 ]: 8 of 11 START sql table model intermediate.int_sales_trend ..................... [RUN]
[0m12:58:49.288609 [debug] [Thread-9  ]: Acquiring new snowflake connection 'model.billy_bulky.int_products_performance'
[0m12:58:49.289053 [debug] [Thread-8  ]: Began compiling node model.billy_bulky.int_customers_segmentation
[0m12:58:49.289734 [debug] [Thread-10 ]: Acquiring new snowflake connection 'model.billy_bulky.int_sales_trend'
[0m12:58:49.290102 [debug] [Thread-9  ]: Began compiling node model.billy_bulky.int_products_performance
[0m12:58:49.294172 [debug] [Thread-8  ]: Writing injected SQL for node "model.billy_bulky.int_customers_segmentation"
[0m12:58:49.294598 [debug] [Thread-10 ]: Began compiling node model.billy_bulky.int_sales_trend
[0m12:58:49.297526 [debug] [Thread-9  ]: Writing injected SQL for node "model.billy_bulky.int_products_performance"
[0m12:58:49.300480 [debug] [Thread-10 ]: Writing injected SQL for node "model.billy_bulky.int_sales_trend"
[0m12:58:49.301207 [debug] [Thread-9  ]: Timing info for model.billy_bulky.int_products_performance (compile): 12:58:49.294836 => 12:58:49.300996
[0m12:58:49.301617 [debug] [Thread-8  ]: Timing info for model.billy_bulky.int_customers_segmentation (compile): 12:58:49.290354 => 12:58:49.301425
[0m12:58:49.301938 [debug] [Thread-9  ]: Began executing node model.billy_bulky.int_products_performance
[0m12:58:49.302479 [debug] [Thread-8  ]: Began executing node model.billy_bulky.int_customers_segmentation
[0m12:58:49.309239 [debug] [Thread-10 ]: Timing info for model.billy_bulky.int_sales_trend (compile): 12:58:49.297813 => 12:58:49.309054
[0m12:58:49.312276 [debug] [Thread-9  ]: Writing runtime sql for node "model.billy_bulky.int_products_performance"
[0m12:58:49.314454 [debug] [Thread-8  ]: Writing runtime sql for node "model.billy_bulky.int_customers_segmentation"
[0m12:58:49.314764 [debug] [Thread-10 ]: Began executing node model.billy_bulky.int_sales_trend
[0m12:58:49.316970 [debug] [Thread-10 ]: Writing runtime sql for node "model.billy_bulky.int_sales_trend"
[0m12:58:49.319208 [debug] [Thread-8  ]: Using snowflake connection "model.billy_bulky.int_customers_segmentation"
[0m12:58:49.320713 [debug] [Thread-9  ]: Using snowflake connection "model.billy_bulky.int_products_performance"
[0m12:58:49.321084 [debug] [Thread-8  ]: On model.billy_bulky.int_customers_segmentation: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.int_customers_segmentation"} */
create or replace transient table E_COMMERCE.intermediate.int_customers_segmentation
         as
        (WITH customers AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__customers
)

, orders AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__orders
)

, products AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__products
)

, order_aggregates AS (
    SELECT
        o.CUSTOMER_ID
        , COUNT(DISTINCT o.ORDER_ID) AS frequency
        , SUM(o.QUANTITY * p.PRICE) AS monetary
        , AVG(o.QUANTITY * p.PRICE) AS average_order_value
        , MAX(o.ORDER_DATE) AS last_purchase_date
        , COUNT(CASE WHEN o.STATUS = 'cancelled' THEN 1 END) AS cancelled_orders
        , COUNT(*) AS total_orders
    FROM orders o
    JOIN products p ON o.PRODUCT_ID = p.PRODUCT_ID
    GROUP BY o.CUSTOMER_ID
)

, customer_tenure AS (
    SELECT
        CUSTOMER_ID
        , JOIN_DATE
        , CURRENT_DATE - JOIN_DATE AS tenure
    FROM customers
)

, customer_recency AS (
    SELECT
        CUSTOMER_ID
        , CURRENT_DATE - last_purchase_date AS recency
    FROM order_aggregates
)

, final AS (
    SELECT
        c.CUSTOMER_ID
        , c.FIRST_NAME
        , c.LAST_NAME
        , c.EMAIL
        , c.JOIN_DATE
        , c.COUNTRY
        , o.frequency
        , o.monetary
        , o.average_order_value
        , o.cancelled_orders
        , o.total_orders
        , CASE 
            WHEN o.total_orders > 0 THEN ROUND((o.cancelled_orders::FLOAT / o.total_orders) * 100, 2) 
            ELSE 0 
          END AS cancellation_rate
        , r.recency
        , t.tenure
    FROM customer_tenure t
    JOIN customers c ON t.CUSTOMER_ID = c.CUSTOMER_ID
    JOIN order_aggregates o ON c.CUSTOMER_ID = o.CUSTOMER_ID
    JOIN customer_recency r ON c.CUSTOMER_ID = r.CUSTOMER_ID
)

SELECT * FROM final
        );
[0m12:58:49.321539 [debug] [Thread-9  ]: On model.billy_bulky.int_products_performance: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.int_products_performance"} */
create or replace transient table E_COMMERCE.intermediate.int_products_performance
         as
        (WITH orders AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__orders
)

, products AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__products
)

, product_sales AS (
    SELECT
        o.PRODUCT_ID
        , COUNT(DISTINCT o.ORDER_ID) AS total_sales
        , SUM(o.QUANTITY) AS total_units_sold
        , SUM(o.QUANTITY * p.PRICE) AS total_sales_value
    FROM orders o
    INNER JOIN products p ON o.PRODUCT_ID = p.PRODUCT_ID
    WHERE o.STATUS NOT IN ('cancelled') 
    GROUP BY o.PRODUCT_ID
)

, product_averages AS (
    SELECT
        PRODUCT_ID
        , (total_sales_value / NULLIF(total_units_sold, 0)) AS average_sale_price
    FROM product_sales
)

, product_stock_turnover AS (
    SELECT
        p.PRODUCT_ID
        , p.STOCK_LEVEL
        , (total_units_sold / NULLIF(p.STOCK_LEVEL, 0)) AS turnover_rate
    FROM product_sales ps
    INNER JOIN products p ON ps.PRODUCT_ID = p.PRODUCT_ID
)

, final AS (
    SELECT
    p.PRODUCT_ID
    , p.NAME
    , p.CATEGORY
    , p.PRICE
    , pa.average_sale_price
    , ps.total_sales
    , ps.total_units_sold
    , ps.total_sales_value
    , pst.turnover_rate
    , p.STOCK_LEVEL
FROM products p
LEFT JOIN product_sales ps ON p.PRODUCT_ID = ps.PRODUCT_ID
LEFT JOIN product_averages pa ON p.PRODUCT_ID = pa.PRODUCT_ID
LEFT JOIN product_stock_turnover pst ON p.PRODUCT_ID = pst.PRODUCT_ID
)

SELECT * FROM final
        );
[0m12:58:49.323403 [debug] [Thread-10 ]: Using snowflake connection "model.billy_bulky.int_sales_trend"
[0m12:58:49.323669 [debug] [Thread-8  ]: Opening a new connection, currently in state init
[0m12:58:49.323911 [debug] [Thread-9  ]: Opening a new connection, currently in state init
[0m12:58:49.324269 [debug] [Thread-10 ]: On model.billy_bulky.int_sales_trend: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.int_sales_trend"} */
create or replace transient table E_COMMERCE.intermediate.int_sales_trend
         as
        (WITH orders AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__orders
)

, products AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__products
)

, daily_sales AS (
    SELECT
        DATE(ORDER_DATE) AS sale_date
        , COUNT(DISTINCT ORDER_ID) AS total_orders
        , SUM(QUANTITY) AS total_units_sold
        , SUM(QUANTITY * PRICE) AS total_sales_value
    FROM orders AS o
    JOIN products AS p ON o.PRODUCT_ID = p.PRODUCT_ID
    WHERE o.STATUS NOT IN ('cancelled') 
    GROUP BY sale_date
)

, weekly_sales AS (
    SELECT
        DATE_TRUNC('week', sale_date) AS sale_week
        , SUM(total_orders) AS weekly_orders
        , SUM(total_units_sold) AS weekly_units_sold
        , SUM(total_sales_value) AS weekly_sales_value
    FROM daily_sales
    GROUP BY sale_week
)

, monthly_sales AS (
    SELECT
        DATE_TRUNC('month', sale_date) AS sale_month
        , SUM(total_orders) AS monthly_orders
        , SUM(total_units_sold) AS monthly_units_sold
        , SUM(total_sales_value) AS monthly_sales_value
    FROM daily_sales
    GROUP BY sale_month
)

, yearly_sales AS (
    SELECT
        DATE_TRUNC('year', sale_date) AS sale_year
        , SUM(total_orders) AS yearly_orders
        , SUM(total_units_sold) AS yearly_units_sold
        , SUM(total_sales_value) AS yearly_sales_value
    FROM daily_sales
    GROUP BY sale_year
)

SELECT
    d.sale_date
    , d.total_orders AS daily_orders
    , d.total_units_sold AS daily_units_sold
    , d.total_sales_value AS daily_sales_value
    , w.weekly_orders
    , w.weekly_units_sold
    , w.weekly_sales_value
    , m.monthly_orders
    , m.monthly_units_sold
    , m.monthly_sales_value
    , y.yearly_orders
    , y.yearly_units_sold
    , y.yearly_sales_value
FROM daily_sales d
LEFT JOIN weekly_sales w ON DATE_TRUNC('week', d.sale_date) = w.sale_week
LEFT JOIN monthly_sales m ON DATE_TRUNC('month', d.sale_date) = m.sale_month
LEFT JOIN yearly_sales y ON DATE_TRUNC('year', d.sale_date) = y.sale_year
        );
[0m12:58:49.325461 [debug] [Thread-10 ]: Opening a new connection, currently in state init
[0m12:58:49.937409 [debug] [Thread-6  ]: Snowflake adapter: Snowflake query id: 01b07a0e-0001-8184-0004-d8be000105c2
[0m12:58:49.937874 [debug] [Thread-6  ]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'E_COMMERCE.INTERMEDIATE.INT_PRODUCTS_INVENTORY' does not exist or not authorized.
[0m12:58:49.938330 [debug] [Thread-6  ]: Timing info for model.billy_bulky.int_products_inventory (execute): 12:58:48.881503 => 12:58:49.938144
[0m12:58:49.938665 [debug] [Thread-6  ]: On model.billy_bulky.int_products_inventory: Close
[0m12:58:50.410723 [debug] [Thread-6  ]: Database Error in model int_products_inventory (models/intermediate/products/int_products_inventory.sql)
  002003 (42S02): SQL compilation error:
  Object 'E_COMMERCE.INTERMEDIATE.INT_PRODUCTS_INVENTORY' does not exist or not authorized.
  compiled Code at target/run/billy_bulky/models/intermediate/products/int_products_inventory.sql
[0m12:58:50.411724 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cafa500d-dc40-4088-ba52-da08e5714ef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16406f100>]}
[0m12:58:50.412601 [error] [Thread-6  ]: 5 of 11 ERROR creating sql incremental model intermediate.int_products_inventory  [[31mERROR[0m in 1.55s]
[0m12:58:50.413490 [debug] [Thread-6  ]: Finished running node model.billy_bulky.int_products_inventory
[0m12:58:51.722850 [debug] [Thread-8  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m12:58:51.729643 [debug] [Thread-8  ]: Timing info for model.billy_bulky.int_customers_segmentation (execute): 12:58:49.312472 => 12:58:51.729189
[0m12:58:51.730518 [debug] [Thread-8  ]: On model.billy_bulky.int_customers_segmentation: Close
[0m12:58:51.825685 [debug] [Thread-9  ]: SQL status: SUCCESS 1 in 3.0 seconds
[0m12:58:51.833673 [debug] [Thread-9  ]: Timing info for model.billy_bulky.int_products_performance (execute): 12:58:49.302775 => 12:58:51.833375
[0m12:58:51.834253 [debug] [Thread-9  ]: On model.billy_bulky.int_products_performance: Close
[0m12:58:51.839310 [debug] [Thread-10 ]: SQL status: SUCCESS 1 in 3.0 seconds
[0m12:58:51.842025 [debug] [Thread-10 ]: Timing info for model.billy_bulky.int_sales_trend (execute): 12:58:49.315049 => 12:58:51.841766
[0m12:58:51.842511 [debug] [Thread-10 ]: On model.billy_bulky.int_sales_trend: Close
[0m12:58:52.098875 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cafa500d-dc40-4088-ba52-da08e5714ef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16401cc40>]}
[0m12:58:52.100105 [info ] [Thread-8  ]: 6 of 11 OK created sql table model intermediate.int_customers_segmentation ..... [[32mSUCCESS 1[0m in 2.81s]
[0m12:58:52.101147 [debug] [Thread-8  ]: Finished running node model.billy_bulky.int_customers_segmentation
[0m12:58:52.102113 [debug] [Thread-1  ]: Began running node model.billy_bulky.customers
[0m12:58:52.102885 [info ] [Thread-1  ]: 9 of 11 START sql table model marts.customers .................................. [RUN]
[0m12:58:52.104127 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.billy_bulky.staging__shopify__products_history, now model.billy_bulky.customers)
[0m12:58:52.104682 [debug] [Thread-1  ]: Began compiling node model.billy_bulky.customers
[0m12:58:52.110884 [debug] [Thread-1  ]: Writing injected SQL for node "model.billy_bulky.customers"
[0m12:58:52.112584 [debug] [Thread-1  ]: Timing info for model.billy_bulky.customers (compile): 12:58:52.105005 => 12:58:52.112249
[0m12:58:52.113128 [debug] [Thread-1  ]: Began executing node model.billy_bulky.customers
[0m12:58:52.116974 [debug] [Thread-1  ]: Writing runtime sql for node "model.billy_bulky.customers"
[0m12:58:52.118873 [debug] [Thread-1  ]: Using snowflake connection "model.billy_bulky.customers"
[0m12:58:52.119413 [debug] [Thread-1  ]: On model.billy_bulky.customers: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.customers"} */
create or replace transient table E_COMMERCE.marts.customers
         as
        (WITH source AS (
    SELECT
        icp.CUSTOMER_ID
        , icp.FIRST_NAME
        , icp.LAST_NAME
        , icp.EMAIL
        , icp.JOIN_DATE
        , icp.COUNTRY
        , icp.frequency AS total_orders
        , icp.monetary AS total_spent
        , icp.recency
        , icp.tenure
    FROM E_COMMERCE.intermediate.int_customers_segmentation icp
)

, final AS (
SELECT
    s.CUSTOMER_ID
    , s.FIRST_NAME
    , s.LAST_NAME
    , s.EMAIL
    , s.JOIN_DATE
    , s.COUNTRY
    , s.total_orders
    , s.total_spent
    , s.recency
    , s.tenure
    , CASE
        WHEN total_spent > 1000 THEN 'VIP'
        ELSE 'Regular'
    END AS customer_segment
FROM source s
)

SELECT * FROM final
        );
[0m12:58:52.119910 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:58:52.176498 [debug] [Thread-9  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cafa500d-dc40-4088-ba52-da08e5714ef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x163fa0f70>]}
[0m12:58:52.177487 [info ] [Thread-9  ]: 7 of 11 OK created sql table model intermediate.int_products_performance ....... [[32mSUCCESS 1[0m in 2.89s]
[0m12:58:52.178331 [debug] [Thread-9  ]: Finished running node model.billy_bulky.int_products_performance
[0m12:58:52.179164 [debug] [Thread-4  ]: Began running node model.billy_bulky.products
[0m12:58:52.179895 [info ] [Thread-4  ]: 10 of 11 START sql table model marts.products .................................. [RUN]
[0m12:58:52.181553 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.billy_bulky.staging_shopify__products, now model.billy_bulky.products)
[0m12:58:52.182160 [debug] [Thread-4  ]: Began compiling node model.billy_bulky.products
[0m12:58:52.186888 [debug] [Thread-4  ]: Writing injected SQL for node "model.billy_bulky.products"
[0m12:58:52.188022 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cafa500d-dc40-4088-ba52-da08e5714ef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16409efd0>]}
[0m12:58:52.188874 [info ] [Thread-10 ]: 8 of 11 OK created sql table model intermediate.int_sales_trend ................ [[32mSUCCESS 1[0m in 2.90s]
[0m12:58:52.189707 [debug] [Thread-10 ]: Finished running node model.billy_bulky.int_sales_trend
[0m12:58:52.190435 [debug] [Thread-4  ]: Timing info for model.billy_bulky.products (compile): 12:58:52.182531 => 12:58:52.190152
[0m12:58:52.191033 [debug] [Thread-4  ]: Began executing node model.billy_bulky.products
[0m12:58:52.191586 [debug] [Thread-3  ]: Began running node model.billy_bulky.sales
[0m12:58:52.195502 [debug] [Thread-4  ]: Writing runtime sql for node "model.billy_bulky.products"
[0m12:58:52.196025 [info ] [Thread-3  ]: 11 of 11 START sql table model marts.sales ..................................... [RUN]
[0m12:58:52.196847 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.billy_bulky.staging_shopify__orders, now model.billy_bulky.sales)
[0m12:58:52.197278 [debug] [Thread-3  ]: Began compiling node model.billy_bulky.sales
[0m12:58:52.201355 [debug] [Thread-3  ]: Writing injected SQL for node "model.billy_bulky.sales"
[0m12:58:52.202484 [debug] [Thread-4  ]: Using snowflake connection "model.billy_bulky.products"
[0m12:58:52.203044 [debug] [Thread-4  ]: On model.billy_bulky.products: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.products"} */
create or replace transient table E_COMMERCE.marts.products
         as
        (WITH final AS (
    SELECT
        pp.PRODUCT_ID
        , pp.NAME
        , pp.CATEGORY
        , pp.PRICE
        , pp.average_sale_price
        , pp.total_sales
        , pp.total_units_sold
        , pp.total_sales_value
        , pp.turnover_rate
        , pp.STOCK_LEVEL
    FROM E_COMMERCE.intermediate.int_products_performance pp
)

SELECT * FROM final
        );
[0m12:58:52.203491 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m12:58:52.204922 [debug] [Thread-3  ]: Timing info for model.billy_bulky.sales (compile): 12:58:52.197522 => 12:58:52.204585
[0m12:58:52.205775 [debug] [Thread-3  ]: Began executing node model.billy_bulky.sales
[0m12:58:52.208860 [debug] [Thread-3  ]: Writing runtime sql for node "model.billy_bulky.sales"
[0m12:58:52.211269 [debug] [Thread-3  ]: Using snowflake connection "model.billy_bulky.sales"
[0m12:58:52.211723 [debug] [Thread-3  ]: On model.billy_bulky.sales: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.sales"} */
create or replace transient table E_COMMERCE.marts.sales
         as
        (WITH enriched_orders AS (
    SELECT
        o.ORDER_ID
        , o.CUSTOMER_ID
        , o.PRODUCT_ID
        , o.QUANTITY
        , o.ORDER_DATE
        , o.STATUS
        , p.CATEGORY
        , p.PRICE AS unit_price
        , (o.QUANTITY * p.PRICE) AS total_price
        , c.COUNTRY
    FROM E_COMMERCE.staging.staging_shopify__orders o
    JOIN E_COMMERCE.staging.staging_shopify__products p ON o.PRODUCT_ID = p.PRODUCT_ID
    JOIN E_COMMERCE.staging.staging_shopify__customers c ON o.CUSTOMER_ID = c.CUSTOMER_ID
    WHERE o.STATUS NOT IN ('cancelled') 
)

SELECT
    eo.ORDER_ID
    , eo.CUSTOMER_ID
    , eo.PRODUCT_ID
    , eo.QUANTITY
    , eo.ORDER_DATE
    , eo.STATUS
    , eo.CATEGORY
    , eo.unit_price
    , eo.total_price
    , eo.COUNTRY
    , sa.daily_orders
    , sa.daily_units_sold
    , sa.daily_sales_value
FROM enriched_orders eo
LEFT JOIN E_COMMERCE.intermediate.int_sales_trend sa ON DATE(eo.ORDER_DATE) = sa.sale_date
        );
[0m12:58:52.212145 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m12:58:53.872469 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m12:58:53.883418 [debug] [Thread-4  ]: Timing info for model.billy_bulky.products (execute): 12:58:52.191878 => 12:58:53.882784
[0m12:58:53.884601 [debug] [Thread-4  ]: On model.billy_bulky.products: Close
[0m12:58:53.985014 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m12:58:53.993170 [debug] [Thread-1  ]: Timing info for model.billy_bulky.customers (execute): 12:58:52.113445 => 12:58:53.992818
[0m12:58:53.993883 [debug] [Thread-1  ]: On model.billy_bulky.customers: Close
[0m12:58:54.059099 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m12:58:54.064052 [debug] [Thread-3  ]: Timing info for model.billy_bulky.sales (execute): 12:58:52.206077 => 12:58:54.063646
[0m12:58:54.064912 [debug] [Thread-3  ]: On model.billy_bulky.sales: Close
[0m12:58:54.248585 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cafa500d-dc40-4088-ba52-da08e5714ef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x163fa0e80>]}
[0m12:58:54.249543 [info ] [Thread-4  ]: 10 of 11 OK created sql table model marts.products ............................. [[32mSUCCESS 1[0m in 2.07s]
[0m12:58:54.250300 [debug] [Thread-4  ]: Finished running node model.billy_bulky.products
[0m12:58:57.565513 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cafa500d-dc40-4088-ba52-da08e5714ef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16401cc40>]}
[0m12:58:57.567036 [info ] [Thread-1  ]: 9 of 11 OK created sql table model marts.customers ............................. [[32mSUCCESS 1[0m in 5.46s]
[0m12:58:57.568108 [debug] [Thread-1  ]: Finished running node model.billy_bulky.customers
[0m12:58:57.768992 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cafa500d-dc40-4088-ba52-da08e5714ef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x163fa0160>]}
[0m12:58:57.770353 [info ] [Thread-3  ]: 11 of 11 OK created sql table model marts.sales ................................ [[32mSUCCESS 1[0m in 5.57s]
[0m12:58:57.771392 [debug] [Thread-3  ]: Finished running node model.billy_bulky.sales
[0m12:58:57.774601 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:58:57.775308 [debug] [MainThread]: Connection 'model.billy_bulky.customers' was properly closed.
[0m12:58:57.775856 [debug] [MainThread]: Connection 'model.billy_bulky.staging_shopify__customers' was properly closed.
[0m12:58:57.776353 [debug] [MainThread]: Connection 'model.billy_bulky.sales' was properly closed.
[0m12:58:57.776835 [debug] [MainThread]: Connection 'model.billy_bulky.products' was properly closed.
[0m12:58:57.777307 [debug] [MainThread]: Connection 'list_E_COMMERCE_PUBLIC' was properly closed.
[0m12:58:57.777779 [debug] [MainThread]: Connection 'model.billy_bulky.int_products_inventory' was properly closed.
[0m12:58:57.778251 [debug] [MainThread]: Connection 'model.billy_bulky.int_customers_segmentation' was properly closed.
[0m12:58:57.778733 [debug] [MainThread]: Connection 'model.billy_bulky.int_products_performance' was properly closed.
[0m12:58:57.779227 [debug] [MainThread]: Connection 'model.billy_bulky.int_sales_trend' was properly closed.
[0m12:58:57.779882 [info ] [MainThread]: 
[0m12:58:57.780502 [info ] [MainThread]: Finished running 4 view models, 1 incremental model, 6 table models in 0 hours 0 minutes and 14.74 seconds (14.74s).
[0m12:58:57.783285 [debug] [MainThread]: Command end result
[0m12:58:57.802402 [info ] [MainThread]: 
[0m12:58:57.803042 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:58:57.803421 [info ] [MainThread]: 
[0m12:58:57.803787 [error] [MainThread]:   Database Error in model int_products_inventory (models/intermediate/products/int_products_inventory.sql)
  002003 (42S02): SQL compilation error:
  Object 'E_COMMERCE.INTERMEDIATE.INT_PRODUCTS_INVENTORY' does not exist or not authorized.
  compiled Code at target/run/billy_bulky/models/intermediate/products/int_products_inventory.sql
[0m12:58:57.804178 [info ] [MainThread]: 
[0m12:58:57.804559 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=1 SKIP=0 TOTAL=11
[0m12:58:57.807225 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 16.677258, "process_user_time": 6.728015, "process_kernel_time": 0.441607, "process_mem_max_rss": "235077632", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:58:57.807806 [debug] [MainThread]: Command `dbt run` failed at 12:58:57.807674 after 16.68 seconds
[0m12:58:57.808212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1032716d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137906850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1633d9250>]}
[0m12:58:57.808628 [debug] [MainThread]: Flushing usage events
[0m13:23:46.696753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102b7deb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053cc7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053cca90>]}


============================== 13:23:46.699593 | 85957646-6f3f-4a66-aa83-8a9b45d5d2bd ==============================
[0m13:23:46.699593 [info ] [MainThread]: Running with dbt=1.7.1
[0m13:23:46.699969 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/bitlevi/Documents/billy_bulky_ecommerce/billy_bulky_ecommerce/logs', 'version_check': 'True', 'profiles_dir': '/Users/bitlevi/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:23:47.531506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '85957646-6f3f-4a66-aa83-8a9b45d5d2bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10266e940>]}
[0m13:23:47.579268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '85957646-6f3f-4a66-aa83-8a9b45d5d2bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123a99280>]}
[0m13:23:47.579883 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m13:23:47.592731 [debug] [MainThread]: checksum: ad428e6dc3b353dcb23d0c4ebea8b20b180e94b873271ac2a054a8e446dac0e2, vars: {}, profile: , target: , version: 1.7.1
[0m13:23:47.604394 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m13:23:47.604782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '85957646-6f3f-4a66-aa83-8a9b45d5d2bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123aaa7c0>]}
[0m13:23:48.326494 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'orders' in the 'models' section of file 'models/staging/shopify/_shopify__schema.yml'
[0m13:23:48.436242 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'marts_sales' in the 'models' section of file 'models/marts/_marts__models.yml'
[0m13:23:48.437765 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'marts_customers' in the 'models' section of file 'models/marts/_marts__models.yml'
[0m13:23:48.439019 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'marts_products' in the 'models' section of file 'models/marts/_marts__models.yml'
[0m13:23:48.487303 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'int_products_inventory' in the 'models' section of file 'models/intermediate/products/_int_products__models.yml'
[0m13:23:48.527406 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.unique_orders_order_id.fed79b3a6e' (models/staging/shopify/_shopify__schema.yml) depends on a node named 'orders' in package '' which was not found
[0m13:23:48.527757 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_orders_order_id.cf6c17daed' (models/staging/shopify/_shopify__schema.yml) depends on a node named 'orders' in package '' which was not found
[0m13:23:48.527997 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_orders_customer_id.c5f02694af' (models/staging/shopify/_shopify__schema.yml) depends on a node named 'orders' in package '' which was not found
[0m13:23:48.528217 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_orders_product_id.3523c78a66' (models/staging/shopify/_shopify__schema.yml) depends on a node named 'orders' in package '' which was not found
[0m13:23:48.528432 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_orders_quantity.0e6bb23b03' (models/staging/shopify/_shopify__schema.yml) depends on a node named 'orders' in package '' which was not found
[0m13:23:48.528653 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_orders_order_date.6910a855fe' (models/staging/shopify/_shopify__schema.yml) depends on a node named 'orders' in package '' which was not found
[0m13:23:48.528865 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_orders_status.8a27272c0a' (models/staging/shopify/_shopify__schema.yml) depends on a node named 'orders' in package '' which was not found
[0m13:23:48.529082 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.accepted_values_orders_status__cancelled__processing__delivered__shipped.fbff2d9925' (models/staging/shopify/_shopify__schema.yml) depends on a node named 'orders' in package '' which was not found
[0m13:23:48.529325 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.unique_marts_sales_order_id.825e23650b' (models/marts/_marts__models.yml) depends on a node named 'marts_sales' in package '' which was not found
[0m13:23:48.529538 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_sales_order_id.842b56ef2f' (models/marts/_marts__models.yml) depends on a node named 'marts_sales' in package '' which was not found
[0m13:23:48.529747 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_sales_customer_id.189ac71c42' (models/marts/_marts__models.yml) depends on a node named 'marts_sales' in package '' which was not found
[0m13:23:48.529958 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.relationships_marts_sales_customer_id__customer_id__ref_customers_.74e21c3398' (models/marts/_marts__models.yml) depends on a node named 'marts_sales' in package '' which was not found
[0m13:23:48.530166 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_sales_product_id.12beecf4f2' (models/marts/_marts__models.yml) depends on a node named 'marts_sales' in package '' which was not found
[0m13:23:48.530378 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.relationships_marts_sales_product_id__product_id__ref_products_.77e7665182' (models/marts/_marts__models.yml) depends on a node named 'marts_sales' in package '' which was not found
[0m13:23:48.530587 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_sales_quantity.ea8c580869' (models/marts/_marts__models.yml) depends on a node named 'marts_sales' in package '' which was not found
[0m13:23:48.530798 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_sales_order_date.90eaa9e7fe' (models/marts/_marts__models.yml) depends on a node named 'marts_sales' in package '' which was not found
[0m13:23:48.531005 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_sales_status.e9b4b90247' (models/marts/_marts__models.yml) depends on a node named 'marts_sales' in package '' which was not found
[0m13:23:48.531212 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_sales_category.a98218f68d' (models/marts/_marts__models.yml) depends on a node named 'marts_sales' in package '' which was not found
[0m13:23:48.531420 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_sales_unit_price.321f152a2a' (models/marts/_marts__models.yml) depends on a node named 'marts_sales' in package '' which was not found
[0m13:23:48.531627 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_sales_total_price.015724a7e6' (models/marts/_marts__models.yml) depends on a node named 'marts_sales' in package '' which was not found
[0m13:23:48.531833 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_sales_country.5f628b732c' (models/marts/_marts__models.yml) depends on a node named 'marts_sales' in package '' which was not found
[0m13:23:48.532039 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.unique_marts_customers_customer_id.9c72620f57' (models/marts/_marts__models.yml) depends on a node named 'marts_customers' in package '' which was not found
[0m13:23:48.532246 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_customers_customer_id.fc7763eff9' (models/marts/_marts__models.yml) depends on a node named 'marts_customers' in package '' which was not found
[0m13:23:48.532453 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.unique_marts_customers_email.6210d26820' (models/marts/_marts__models.yml) depends on a node named 'marts_customers' in package '' which was not found
[0m13:23:48.532661 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_customers_email.637d2131e6' (models/marts/_marts__models.yml) depends on a node named 'marts_customers' in package '' which was not found
[0m13:23:48.532874 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_customers_join_date.6378efd424' (models/marts/_marts__models.yml) depends on a node named 'marts_customers' in package '' which was not found
[0m13:23:48.533081 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_customers_total_orders.7cdc5122e5' (models/marts/_marts__models.yml) depends on a node named 'marts_customers' in package '' which was not found
[0m13:23:48.533289 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_customers_total_spent.d5343aecc7' (models/marts/_marts__models.yml) depends on a node named 'marts_customers' in package '' which was not found
[0m13:23:48.533495 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.unique_marts_products_product_id.e96f554683' (models/marts/_marts__models.yml) depends on a node named 'marts_products' in package '' which was not found
[0m13:23:48.533700 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_products_product_id.9b354ae761' (models/marts/_marts__models.yml) depends on a node named 'marts_products' in package '' which was not found
[0m13:23:48.533903 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_products_name.f0d9c8d191' (models/marts/_marts__models.yml) depends on a node named 'marts_products' in package '' which was not found
[0m13:23:48.534115 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_products_category.1212ed3683' (models/marts/_marts__models.yml) depends on a node named 'marts_products' in package '' which was not found
[0m13:23:48.534333 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_products_price.d6207a2896' (models/marts/_marts__models.yml) depends on a node named 'marts_products' in package '' which was not found
[0m13:23:48.534616 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_products_total_units_sold.6822a804df' (models/marts/_marts__models.yml) depends on a node named 'marts_products' in package '' which was not found
[0m13:23:48.534853 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_marts_products_total_sales_value.b0a2a654b3' (models/marts/_marts__models.yml) depends on a node named 'marts_products' in package '' which was not found
[0m13:23:48.535164 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_int_products_inventory_snapshot_date.ea839d8715' (models/intermediate/products/_int_products__models.yml) depends on a node named 'int_products_inventory' in package '' which was not found
[0m13:23:48.535387 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.unique_int_products_inventory_snapshot_date.957e4a3412' (models/intermediate/products/_int_products__models.yml) depends on a node named 'int_products_inventory' in package '' which was not found
[0m13:23:48.535603 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.date_int_products_inventory_snapshot_date.a5f6775670' (models/intermediate/products/_int_products__models.yml) depends on a node named 'int_products_inventory' in package '' which was not found
[0m13:23:48.535816 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_int_products_inventory_product_id.f6ac5935e3' (models/intermediate/products/_int_products__models.yml) depends on a node named 'int_products_inventory' in package '' which was not found
[0m13:23:48.536037 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.relationships_int_products_inventory_product_id__product_id__ref_staging_shopify__products_.74f8c28027' (models/intermediate/products/_int_products__models.yml) depends on a node named 'int_products_inventory' in package '' which was not found
[0m13:23:48.536254 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.not_null_int_products_inventory_stock_level.31d0098b4a' (models/intermediate/products/_int_products__models.yml) depends on a node named 'int_products_inventory' in package '' which was not found
[0m13:23:48.536465 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.billy_bulky.numeric_int_products_inventory_stock_level.dd2cae1df8' (models/intermediate/products/_int_products__models.yml) depends on a node named 'int_products_inventory' in package '' which was not found
[0m13:23:48.566825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '85957646-6f3f-4a66-aa83-8a9b45d5d2bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124de50d0>]}
[0m13:23:48.581142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '85957646-6f3f-4a66-aa83-8a9b45d5d2bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123f25070>]}
[0m13:23:48.581494 [info ] [MainThread]: Found 10 models, 1 snapshot, 1 seed, 47 tests, 4 sources, 0 exposures, 0 metrics, 431 macros, 0 groups, 0 semantic models
[0m13:23:48.581718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '85957646-6f3f-4a66-aa83-8a9b45d5d2bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123fb47c0>]}
[0m13:23:48.583300 [info ] [MainThread]: 
[0m13:23:48.583798 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:23:48.584570 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE'
[0m13:23:48.592819 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE"
[0m13:23:48.593338 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE'
[0m13:23:48.593548 [debug] [ThreadPool]: On list_E_COMMERCE: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE"} */
show terse schemas in database E_COMMERCE
    limit 10000
[0m13:23:48.594970 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE"
[0m13:23:48.595176 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:23:48.595377 [debug] [ThreadPool]: On list_E_COMMERCE: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE"} */
show terse schemas in database E_COMMERCE
    limit 10000
[0m13:23:48.596153 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:23:50.026301 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m13:23:50.027926 [debug] [ThreadPool]: On list_E_COMMERCE: Close
[0m13:23:50.397673 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.0 seconds
[0m13:23:50.399857 [debug] [ThreadPool]: On list_E_COMMERCE: Close
[0m13:23:50.766128 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_E_COMMERCE, now list_E_COMMERCE_staging)
[0m13:23:50.768478 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_E_COMMERCE, now list_E_COMMERCE_marts)
[0m13:23:50.770005 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PUBLIC'
[0m13:23:50.773671 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_snapshots'
[0m13:23:50.789481 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_staging"
[0m13:23:50.793054 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_marts"
[0m13:23:50.796461 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PUBLIC"
[0m13:23:50.799684 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_snapshots"
[0m13:23:50.800151 [debug] [ThreadPool]: On list_E_COMMERCE_staging: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE_staging"} */
show terse objects in E_COMMERCE.staging limit 10000
[0m13:23:50.800590 [debug] [ThreadPool]: On list_E_COMMERCE_marts: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE_marts"} */
show terse objects in E_COMMERCE.marts limit 10000
[0m13:23:50.801003 [debug] [ThreadPool]: On list_E_COMMERCE_PUBLIC: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE_PUBLIC"} */
show terse objects in E_COMMERCE.PUBLIC limit 10000
[0m13:23:50.801406 [debug] [ThreadPool]: On list_E_COMMERCE_snapshots: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "connection_name": "list_E_COMMERCE_snapshots"} */
show terse objects in E_COMMERCE.snapshots limit 10000
[0m13:23:50.801804 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:23:50.802168 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:23:50.802535 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:23:50.802892 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:23:52.085555 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m13:23:52.087941 [debug] [ThreadPool]: On list_E_COMMERCE_staging: Close
[0m13:23:52.091101 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:23:52.093085 [debug] [ThreadPool]: On list_E_COMMERCE_snapshots: Close
[0m13:23:52.120453 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m13:23:52.122171 [debug] [ThreadPool]: On list_E_COMMERCE_marts: Close
[0m13:23:52.128206 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b07a27-0001-831c-0004-d8be0001358e
[0m13:23:52.128531 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m13:23:52.128902 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m13:23:52.129170 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m13:23:52.129452 [debug] [ThreadPool]: On list_E_COMMERCE_PUBLIC: Close
[0m13:23:52.544891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '85957646-6f3f-4a66-aa83-8a9b45d5d2bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1322049d0>]}
[0m13:23:52.547641 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m13:23:52.548940 [info ] [MainThread]: 
[0m13:23:52.556499 [debug] [Thread-1  ]: Began running node model.billy_bulky.staging__shopify__products_history
[0m13:23:52.557335 [debug] [Thread-2  ]: Began running node model.billy_bulky.staging_shopify__customers
[0m13:23:52.558164 [debug] [Thread-3  ]: Began running node model.billy_bulky.staging_shopify__orders
[0m13:23:52.560810 [info ] [Thread-1  ]: 1 of 7 START sql view model staging.staging__shopify__products_history ......... [RUN]
[0m13:23:52.562453 [debug] [Thread-4  ]: Began running node model.billy_bulky.staging_shopify__products
[0m13:23:52.563516 [info ] [Thread-2  ]: 2 of 7 START sql view model staging.staging_shopify__customers ................. [RUN]
[0m13:23:52.564519 [info ] [Thread-3  ]: 3 of 7 START sql view model staging.staging_shopify__orders .................... [RUN]
[0m13:23:52.565921 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_E_COMMERCE_staging, now model.billy_bulky.staging__shopify__products_history)
[0m13:23:52.566800 [info ] [Thread-4  ]: 4 of 7 START sql view model staging.staging_shopify__products .................. [RUN]
[0m13:23:52.567986 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_E_COMMERCE_marts, now model.billy_bulky.staging_shopify__customers)
[0m13:23:52.569083 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly list_E_COMMERCE_PUBLIC, now model.billy_bulky.staging_shopify__orders)
[0m13:23:52.569771 [debug] [Thread-1  ]: Began compiling node model.billy_bulky.staging__shopify__products_history
[0m13:23:52.570830 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly list_E_COMMERCE_snapshots, now model.billy_bulky.staging_shopify__products)
[0m13:23:52.571383 [debug] [Thread-2  ]: Began compiling node model.billy_bulky.staging_shopify__customers
[0m13:23:52.571932 [debug] [Thread-3  ]: Began compiling node model.billy_bulky.staging_shopify__orders
[0m13:23:52.583710 [debug] [Thread-1  ]: Writing injected SQL for node "model.billy_bulky.staging__shopify__products_history"
[0m13:23:52.584211 [debug] [Thread-4  ]: Began compiling node model.billy_bulky.staging_shopify__products
[0m13:23:52.587662 [debug] [Thread-2  ]: Writing injected SQL for node "model.billy_bulky.staging_shopify__customers"
[0m13:23:52.590785 [debug] [Thread-3  ]: Writing injected SQL for node "model.billy_bulky.staging_shopify__orders"
[0m13:23:52.594162 [debug] [Thread-4  ]: Writing injected SQL for node "model.billy_bulky.staging_shopify__products"
[0m13:23:52.595075 [debug] [Thread-3  ]: Timing info for model.billy_bulky.staging_shopify__orders (compile): 13:23:52.587949 => 13:23:52.594854
[0m13:23:52.595485 [debug] [Thread-3  ]: Began executing node model.billy_bulky.staging_shopify__orders
[0m13:23:52.595960 [debug] [Thread-2  ]: Timing info for model.billy_bulky.staging_shopify__customers (compile): 13:23:52.584527 => 13:23:52.595750
[0m13:23:52.597307 [debug] [Thread-4  ]: Timing info for model.billy_bulky.staging_shopify__products (compile): 13:23:52.591157 => 13:23:52.597105
[0m13:23:52.597697 [debug] [Thread-2  ]: Began executing node model.billy_bulky.staging_shopify__customers
[0m13:23:52.598171 [debug] [Thread-1  ]: Timing info for model.billy_bulky.staging__shopify__products_history (compile): 13:23:52.572303 => 13:23:52.597912
[0m13:23:52.598545 [debug] [Thread-4  ]: Began executing node model.billy_bulky.staging_shopify__products
[0m13:23:52.620986 [debug] [Thread-3  ]: Writing runtime sql for node "model.billy_bulky.staging_shopify__orders"
[0m13:23:52.623240 [debug] [Thread-2  ]: Writing runtime sql for node "model.billy_bulky.staging_shopify__customers"
[0m13:23:52.623530 [debug] [Thread-1  ]: Began executing node model.billy_bulky.staging__shopify__products_history
[0m13:23:52.625635 [debug] [Thread-4  ]: Writing runtime sql for node "model.billy_bulky.staging_shopify__products"
[0m13:23:52.627805 [debug] [Thread-1  ]: Writing runtime sql for node "model.billy_bulky.staging__shopify__products_history"
[0m13:23:52.628456 [debug] [Thread-2  ]: Using snowflake connection "model.billy_bulky.staging_shopify__customers"
[0m13:23:52.628742 [debug] [Thread-2  ]: On model.billy_bulky.staging_shopify__customers: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.staging_shopify__customers"} */
create or replace   view E_COMMERCE.staging.staging_shopify__customers
  
   as (
    WITH customers AS (
    SELECT * FROM SHOPIFY.PUBLIC.customers
)

SELECT
    CUSTOMER_ID
    , FIRST_NAME
    , LAST_NAME
    , EMAIL
    , JOIN_DATE
    , COUNTRY
FROM customers
  );
[0m13:23:52.629277 [debug] [Thread-3  ]: Using snowflake connection "model.billy_bulky.staging_shopify__orders"
[0m13:23:52.629523 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m13:23:52.629966 [debug] [Thread-4  ]: Using snowflake connection "model.billy_bulky.staging_shopify__products"
[0m13:23:52.630222 [debug] [Thread-3  ]: On model.billy_bulky.staging_shopify__orders: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.staging_shopify__orders"} */
create or replace   view E_COMMERCE.staging.staging_shopify__orders
  
   as (
    WITH orders AS (
    SELECT * FROM SHOPIFY.PUBLIC.orders
)

SELECT
    ORDER_ID
    , CUSTOMER_ID
    , PRODUCT_ID
    , QUANTITY
    , ORDER_DATE
    , STATUS
FROM orders
  );
[0m13:23:52.630728 [debug] [Thread-1  ]: Using snowflake connection "model.billy_bulky.staging__shopify__products_history"
[0m13:23:52.631133 [debug] [Thread-4  ]: On model.billy_bulky.staging_shopify__products: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.staging_shopify__products"} */
create or replace   view E_COMMERCE.staging.staging_shopify__products
  
   as (
    WITH products AS (
    SELECT * FROM SHOPIFY.PUBLIC.products
)

SELECT
    PRODUCT_ID
    , NAME
    , CATEGORY
    , PRICE
    , STOCK_LEVEL
FROM products
  );
[0m13:23:52.631589 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m13:23:52.631835 [debug] [Thread-1  ]: On model.billy_bulky.staging__shopify__products_history: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.staging__shopify__products_history"} */
create or replace   view E_COMMERCE.staging.staging__shopify__products_history
  
   as (
    WITH products AS (
    SELECT * FROM E_COMMERCE.SNAPSHOTS.products_snapshot
)

SELECT
    PRODUCT_ID
    , NAME
    , CATEGORY
    , PRICE
    , STOCK_LEVEL
    , DBT_SCD_ID
    , DBT_UPDATED_AT
    , DBT_VALID_FROM
    , DBT_VALID_TO
FROM products
  );
[0m13:23:52.632328 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m13:23:52.632876 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:23:53.864524 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:23:53.887678 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:23:53.935988 [debug] [Thread-2  ]: Timing info for model.billy_bulky.staging_shopify__customers (execute): 13:23:52.621182 => 13:23:53.935750
[0m13:23:53.938045 [debug] [Thread-4  ]: Timing info for model.billy_bulky.staging_shopify__products (execute): 13:23:52.623693 => 13:23:53.937831
[0m13:23:53.938444 [debug] [Thread-2  ]: On model.billy_bulky.staging_shopify__customers: Close
[0m13:23:53.938838 [debug] [Thread-4  ]: On model.billy_bulky.staging_shopify__products: Close
[0m13:23:54.457541 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85957646-6f3f-4a66-aa83-8a9b45d5d2bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124076220>]}
[0m13:23:54.462179 [info ] [Thread-4  ]: 4 of 7 OK created sql view model staging.staging_shopify__products ............. [[32mSUCCESS 1[0m in 1.89s]
[0m13:23:54.464313 [debug] [Thread-4  ]: Finished running node model.billy_bulky.staging_shopify__products
[0m13:23:54.468721 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85957646-6f3f-4a66-aa83-8a9b45d5d2bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1322f4ca0>]}
[0m13:23:54.470360 [info ] [Thread-2  ]: 2 of 7 OK created sql view model staging.staging_shopify__customers ............ [[32mSUCCESS 1[0m in 1.90s]
[0m13:23:54.471749 [debug] [Thread-2  ]: Finished running node model.billy_bulky.staging_shopify__customers
[0m13:23:54.623387 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m13:23:54.629325 [debug] [Thread-1  ]: Timing info for model.billy_bulky.staging__shopify__products_history (execute): 13:23:52.625931 => 13:23:54.628914
[0m13:23:54.631394 [debug] [Thread-1  ]: On model.billy_bulky.staging__shopify__products_history: Close
[0m13:23:54.632937 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m13:23:54.641210 [debug] [Thread-3  ]: Timing info for model.billy_bulky.staging_shopify__orders (execute): 13:23:52.596226 => 13:23:54.640636
[0m13:23:54.642494 [debug] [Thread-3  ]: On model.billy_bulky.staging_shopify__orders: Close
[0m13:23:55.096182 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85957646-6f3f-4a66-aa83-8a9b45d5d2bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124b1edf0>]}
[0m13:23:55.097269 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85957646-6f3f-4a66-aa83-8a9b45d5d2bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1249a3dc0>]}
[0m13:23:55.098094 [info ] [Thread-1  ]: 1 of 7 OK created sql view model staging.staging__shopify__products_history .... [[32mSUCCESS 1[0m in 2.53s]
[0m13:23:55.099500 [debug] [Thread-1  ]: Finished running node model.billy_bulky.staging__shopify__products_history
[0m13:23:55.098732 [info ] [Thread-3  ]: 3 of 7 OK created sql view model staging.staging_shopify__orders ............... [[32mSUCCESS 1[0m in 2.53s]
[0m13:23:55.100428 [debug] [Thread-3  ]: Finished running node model.billy_bulky.staging_shopify__orders
[0m13:23:55.101323 [debug] [Thread-6  ]: Began running node model.billy_bulky.int_customers_segmentation
[0m13:23:55.101904 [debug] [Thread-7  ]: Began running node model.billy_bulky.int_products_performance
[0m13:23:55.102837 [debug] [Thread-6  ]: Acquiring new snowflake connection 'model.billy_bulky.int_customers_segmentation'
[0m13:23:55.103299 [debug] [Thread-8  ]: Began running node model.billy_bulky.int_sales_trend
[0m13:23:55.104193 [debug] [Thread-7  ]: Acquiring new snowflake connection 'model.billy_bulky.int_products_performance'
[0m13:23:55.104656 [debug] [Thread-6  ]: Began compiling node model.billy_bulky.int_customers_segmentation
[0m13:23:55.105397 [debug] [Thread-8  ]: Acquiring new snowflake connection 'model.billy_bulky.int_sales_trend'
[0m13:23:55.105789 [debug] [Thread-7  ]: Began compiling node model.billy_bulky.int_products_performance
[0m13:23:55.110538 [debug] [Thread-6  ]: Writing injected SQL for node "model.billy_bulky.int_customers_segmentation"
[0m13:23:55.111003 [debug] [Thread-8  ]: Began compiling node model.billy_bulky.int_sales_trend
[0m13:23:55.114209 [debug] [Thread-7  ]: Writing injected SQL for node "model.billy_bulky.int_products_performance"
[0m13:23:55.117360 [debug] [Thread-8  ]: Writing injected SQL for node "model.billy_bulky.int_sales_trend"
[0m13:23:55.118114 [debug] [Thread-6  ]: Timing info for model.billy_bulky.int_customers_segmentation (compile): 13:23:55.106029 => 13:23:55.117901
[0m13:23:55.118543 [debug] [Thread-7  ]: Timing info for model.billy_bulky.int_products_performance (compile): 13:23:55.111264 => 13:23:55.118331
[0m13:23:55.119307 [debug] [Thread-6  ]: Finished running node model.billy_bulky.int_customers_segmentation
[0m13:23:55.120227 [debug] [Thread-7  ]: Finished running node model.billy_bulky.int_products_performance
[0m13:23:55.120721 [debug] [Thread-8  ]: Timing info for model.billy_bulky.int_sales_trend (compile): 13:23:55.114525 => 13:23:55.120541
[0m13:23:55.121182 [debug] [Thread-10 ]: Began running node model.billy_bulky.customers
[0m13:23:55.121831 [debug] [Thread-8  ]: Finished running node model.billy_bulky.int_sales_trend
[0m13:23:55.122138 [debug] [Thread-5  ]: Began running node model.billy_bulky.products
[0m13:23:55.122518 [info ] [Thread-10 ]: 5 of 7 START sql table model marts.customers ................................... [RUN]
[0m13:23:55.122974 [debug] [Thread-2  ]: Began running node model.billy_bulky.sales
[0m13:23:55.123339 [info ] [Thread-5  ]: 6 of 7 START sql table model marts.products .................................... [RUN]
[0m13:23:55.124000 [debug] [Thread-10 ]: Acquiring new snowflake connection 'model.billy_bulky.customers'
[0m13:23:55.124420 [info ] [Thread-2  ]: 7 of 7 START sql table model marts.sales ....................................... [RUN]
[0m13:23:55.125040 [debug] [Thread-5  ]: Acquiring new snowflake connection 'model.billy_bulky.products'
[0m13:23:55.125351 [debug] [Thread-10 ]: Began compiling node model.billy_bulky.customers
[0m13:23:55.125841 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.billy_bulky.staging_shopify__customers, now model.billy_bulky.sales)
[0m13:23:55.126142 [debug] [Thread-5  ]: Began compiling node model.billy_bulky.products
[0m13:23:55.133433 [debug] [Thread-2  ]: Began compiling node model.billy_bulky.sales
[0m13:23:55.135351 [debug] [Thread-10 ]: Writing injected SQL for node "model.billy_bulky.customers"
[0m13:23:55.139915 [debug] [Thread-5  ]: Writing injected SQL for node "model.billy_bulky.products"
[0m13:23:55.148088 [debug] [Thread-2  ]: Writing injected SQL for node "model.billy_bulky.sales"
[0m13:23:55.148795 [debug] [Thread-2  ]: Timing info for model.billy_bulky.sales (compile): 13:23:55.140104 => 13:23:55.148654
[0m13:23:55.149080 [debug] [Thread-10 ]: Timing info for model.billy_bulky.customers (compile): 13:23:55.126336 => 13:23:55.148935
[0m13:23:55.149303 [debug] [Thread-2  ]: Began executing node model.billy_bulky.sales
[0m13:23:55.149544 [debug] [Thread-10 ]: Began executing node model.billy_bulky.customers
[0m13:23:55.162348 [debug] [Thread-5  ]: Timing info for model.billy_bulky.products (compile): 13:23:55.135546 => 13:23:55.162221
[0m13:23:55.163947 [debug] [Thread-10 ]: Writing runtime sql for node "model.billy_bulky.customers"
[0m13:23:55.164129 [debug] [Thread-2  ]: Writing runtime sql for node "model.billy_bulky.sales"
[0m13:23:55.164355 [debug] [Thread-5  ]: Began executing node model.billy_bulky.products
[0m13:23:55.166774 [debug] [Thread-2  ]: Using snowflake connection "model.billy_bulky.sales"
[0m13:23:55.168577 [debug] [Thread-10 ]: Using snowflake connection "model.billy_bulky.customers"
[0m13:23:55.170803 [debug] [Thread-5  ]: Writing runtime sql for node "model.billy_bulky.products"
[0m13:23:55.171171 [debug] [Thread-2  ]: On model.billy_bulky.sales: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.sales"} */
create or replace transient table E_COMMERCE.marts.sales
         as
        (WITH  __dbt__cte__int_sales_trend as (
WITH orders AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__orders
)

, products AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__products
)

, daily_sales AS (
    SELECT
        DATE(ORDER_DATE) AS sale_date
        , COUNT(DISTINCT ORDER_ID) AS total_orders
        , SUM(QUANTITY) AS total_units_sold
        , SUM(QUANTITY * PRICE) AS total_sales_value
    FROM orders AS o
    JOIN products AS p ON o.PRODUCT_ID = p.PRODUCT_ID
    WHERE o.STATUS NOT IN ('cancelled') 
    GROUP BY sale_date
)

, weekly_sales AS (
    SELECT
        DATE_TRUNC('week', sale_date) AS sale_week
        , SUM(total_orders) AS weekly_orders
        , SUM(total_units_sold) AS weekly_units_sold
        , SUM(total_sales_value) AS weekly_sales_value
    FROM daily_sales
    GROUP BY sale_week
)

, monthly_sales AS (
    SELECT
        DATE_TRUNC('month', sale_date) AS sale_month
        , SUM(total_orders) AS monthly_orders
        , SUM(total_units_sold) AS monthly_units_sold
        , SUM(total_sales_value) AS monthly_sales_value
    FROM daily_sales
    GROUP BY sale_month
)

, yearly_sales AS (
    SELECT
        DATE_TRUNC('year', sale_date) AS sale_year
        , SUM(total_orders) AS yearly_orders
        , SUM(total_units_sold) AS yearly_units_sold
        , SUM(total_sales_value) AS yearly_sales_value
    FROM daily_sales
    GROUP BY sale_year
)

SELECT
    d.sale_date
    , d.total_orders AS daily_orders
    , d.total_units_sold AS daily_units_sold
    , d.total_sales_value AS daily_sales_value
    , w.weekly_orders
    , w.weekly_units_sold
    , w.weekly_sales_value
    , m.monthly_orders
    , m.monthly_units_sold
    , m.monthly_sales_value
    , y.yearly_orders
    , y.yearly_units_sold
    , y.yearly_sales_value
FROM daily_sales d
LEFT JOIN weekly_sales w ON DATE_TRUNC('week', d.sale_date) = w.sale_week
LEFT JOIN monthly_sales m ON DATE_TRUNC('month', d.sale_date) = m.sale_month
LEFT JOIN yearly_sales y ON DATE_TRUNC('year', d.sale_date) = y.sale_year
), enriched_orders AS (
    SELECT
        o.ORDER_ID
        , o.CUSTOMER_ID
        , o.PRODUCT_ID
        , o.QUANTITY
        , o.ORDER_DATE
        , o.STATUS
        , p.CATEGORY
        , p.PRICE AS unit_price
        , (o.QUANTITY * p.PRICE) AS total_price
        , c.COUNTRY
    FROM E_COMMERCE.staging.staging_shopify__orders o
    JOIN E_COMMERCE.staging.staging_shopify__products p ON o.PRODUCT_ID = p.PRODUCT_ID
    JOIN E_COMMERCE.staging.staging_shopify__customers c ON o.CUSTOMER_ID = c.CUSTOMER_ID
    WHERE o.STATUS NOT IN ('cancelled') 
)

SELECT
    eo.ORDER_ID
    , eo.CUSTOMER_ID
    , eo.PRODUCT_ID
    , eo.QUANTITY
    , eo.ORDER_DATE
    , eo.STATUS
    , eo.CATEGORY
    , eo.unit_price
    , eo.total_price
    , eo.COUNTRY
    , sa.daily_orders
    , sa.daily_units_sold
    , sa.daily_sales_value
FROM enriched_orders eo
LEFT JOIN __dbt__cte__int_sales_trend sa ON DATE(eo.ORDER_DATE) = sa.sale_date
        );
[0m13:23:55.171601 [debug] [Thread-10 ]: On model.billy_bulky.customers: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.customers"} */
create or replace transient table E_COMMERCE.marts.customers
         as
        (WITH  __dbt__cte__int_customers_segmentation as (
WITH customers AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__customers
)

, orders AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__orders
)

, products AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__products
)

, order_aggregates AS (
    SELECT
        o.CUSTOMER_ID
        , COUNT(DISTINCT o.ORDER_ID) AS frequency
        , SUM(o.QUANTITY * p.PRICE) AS monetary
        , AVG(o.QUANTITY * p.PRICE) AS average_order_value
        , MAX(o.ORDER_DATE) AS last_purchase_date
        , COUNT(CASE WHEN o.STATUS = 'cancelled' THEN 1 END) AS cancelled_orders
        , COUNT(*) AS total_orders
    FROM orders o
    JOIN products p ON o.PRODUCT_ID = p.PRODUCT_ID
    GROUP BY o.CUSTOMER_ID
)

, customer_tenure AS (
    SELECT
        CUSTOMER_ID
        , JOIN_DATE
        , CURRENT_DATE - JOIN_DATE AS tenure
    FROM customers
)

, customer_recency AS (
    SELECT
        CUSTOMER_ID
        , CURRENT_DATE - last_purchase_date AS recency
    FROM order_aggregates
)

, final AS (
    SELECT
        c.CUSTOMER_ID
        , c.FIRST_NAME
        , c.LAST_NAME
        , c.EMAIL
        , c.JOIN_DATE
        , c.COUNTRY
        , o.frequency
        , o.monetary
        , o.average_order_value
        , o.cancelled_orders
        , o.total_orders
        , CASE 
            WHEN o.total_orders > 0 THEN ROUND((o.cancelled_orders::FLOAT / o.total_orders) * 100, 2) 
            ELSE 0 
          END AS cancellation_rate
        , r.recency
        , t.tenure
    FROM customer_tenure t
    JOIN customers c ON t.CUSTOMER_ID = c.CUSTOMER_ID
    JOIN order_aggregates o ON c.CUSTOMER_ID = o.CUSTOMER_ID
    JOIN customer_recency r ON c.CUSTOMER_ID = r.CUSTOMER_ID
)

SELECT * FROM final
), source AS (
    SELECT
        icp.CUSTOMER_ID
        , icp.FIRST_NAME
        , icp.LAST_NAME
        , icp.EMAIL
        , icp.JOIN_DATE
        , icp.COUNTRY
        , icp.frequency AS total_orders
        , icp.monetary AS total_spent
        , icp.recency
        , icp.tenure
    FROM __dbt__cte__int_customers_segmentation icp
)

, final AS (
SELECT
    s.CUSTOMER_ID
    , s.FIRST_NAME
    , s.LAST_NAME
    , s.EMAIL
    , s.JOIN_DATE
    , s.COUNTRY
    , s.total_orders
    , s.total_spent
    , s.recency
    , s.tenure
    , CASE
        WHEN total_spent > 1000 THEN 'VIP'
        ELSE 'Regular'
    END AS customer_segment
FROM source s
)

SELECT * FROM final
        );
[0m13:23:55.171974 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m13:23:55.172220 [debug] [Thread-10 ]: Opening a new connection, currently in state init
[0m13:23:55.173840 [debug] [Thread-5  ]: Using snowflake connection "model.billy_bulky.products"
[0m13:23:55.174471 [debug] [Thread-5  ]: On model.billy_bulky.products: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "billy_bulky", "target_name": "dev", "node_id": "model.billy_bulky.products"} */
create or replace transient table E_COMMERCE.marts.products
         as
        (WITH  __dbt__cte__int_products_performance as (
WITH orders AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__orders
)

, products AS (
    SELECT * FROM E_COMMERCE.staging.staging_shopify__products
)

, product_sales AS (
    SELECT
        o.PRODUCT_ID
        , COUNT(DISTINCT o.ORDER_ID) AS total_sales
        , SUM(o.QUANTITY) AS total_units_sold
        , SUM(o.QUANTITY * p.PRICE) AS total_sales_value
    FROM orders o
    INNER JOIN products p ON o.PRODUCT_ID = p.PRODUCT_ID
    WHERE o.STATUS NOT IN ('cancelled') 
    GROUP BY o.PRODUCT_ID
)

, product_averages AS (
    SELECT
        PRODUCT_ID
        , (total_sales_value / NULLIF(total_units_sold, 0)) AS average_sale_price
    FROM product_sales
)

, product_stock_turnover AS (
    SELECT
        p.PRODUCT_ID
        , p.STOCK_LEVEL
        , (total_units_sold / NULLIF(p.STOCK_LEVEL, 0)) AS turnover_rate
    FROM product_sales ps
    INNER JOIN products p ON ps.PRODUCT_ID = p.PRODUCT_ID
)

, final AS (
    SELECT
    p.PRODUCT_ID
    , p.NAME
    , p.CATEGORY
    , p.PRICE
    , pa.average_sale_price
    , ps.total_sales
    , ps.total_units_sold
    , ps.total_sales_value
    , pst.turnover_rate
    , p.STOCK_LEVEL
FROM products p
LEFT JOIN product_sales ps ON p.PRODUCT_ID = ps.PRODUCT_ID
LEFT JOIN product_averages pa ON p.PRODUCT_ID = pa.PRODUCT_ID
LEFT JOIN product_stock_turnover pst ON p.PRODUCT_ID = pst.PRODUCT_ID
)

SELECT * FROM final
), final AS (
    SELECT
        pp.PRODUCT_ID
        , pp.NAME
        , pp.CATEGORY
        , pp.PRICE
        , pp.average_sale_price
        , pp.total_sales
        , pp.total_units_sold
        , pp.total_sales_value
        , pp.turnover_rate
        , pp.STOCK_LEVEL
    FROM __dbt__cte__int_products_performance pp
)

SELECT * FROM final
        );
[0m13:23:55.174764 [debug] [Thread-5  ]: Opening a new connection, currently in state init
[0m13:23:58.328500 [debug] [Thread-5  ]: SQL status: SUCCESS 1 in 3.0 seconds
[0m13:23:58.339847 [debug] [Thread-5  ]: Timing info for model.billy_bulky.products (execute): 13:23:55.168714 => 13:23:58.339008
[0m13:23:58.341105 [debug] [Thread-5  ]: On model.billy_bulky.products: Close
[0m13:23:58.526176 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 3.0 seconds
[0m13:23:58.533337 [debug] [Thread-2  ]: Timing info for model.billy_bulky.sales (execute): 13:23:55.149688 => 13:23:58.532755
[0m13:23:58.534358 [debug] [Thread-2  ]: On model.billy_bulky.sales: Close
[0m13:23:58.570633 [debug] [Thread-10 ]: SQL status: SUCCESS 1 in 3.0 seconds
[0m13:23:58.577322 [debug] [Thread-10 ]: Timing info for model.billy_bulky.customers (execute): 13:23:55.162478 => 13:23:58.576933
[0m13:23:58.578465 [debug] [Thread-10 ]: On model.billy_bulky.customers: Close
[0m13:23:58.707231 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85957646-6f3f-4a66-aa83-8a9b45d5d2bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13233c220>]}
[0m13:23:58.710125 [info ] [Thread-5  ]: 6 of 7 OK created sql table model marts.products ............................... [[32mSUCCESS 1[0m in 3.58s]
[0m13:23:58.711428 [debug] [Thread-5  ]: Finished running node model.billy_bulky.products
[0m13:23:58.898222 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85957646-6f3f-4a66-aa83-8a9b45d5d2bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124b2c760>]}
[0m13:23:58.901192 [info ] [Thread-2  ]: 7 of 7 OK created sql table model marts.sales .................................. [[32mSUCCESS 1[0m in 3.77s]
[0m13:23:58.903169 [debug] [Thread-2  ]: Finished running node model.billy_bulky.sales
[0m13:23:58.928991 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85957646-6f3f-4a66-aa83-8a9b45d5d2bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124b01ca0>]}
[0m13:23:58.931175 [info ] [Thread-10 ]: 5 of 7 OK created sql table model marts.customers .............................. [[32mSUCCESS 1[0m in 3.80s]
[0m13:23:58.932789 [debug] [Thread-10 ]: Finished running node model.billy_bulky.customers
[0m13:23:58.936868 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:23:58.937713 [debug] [MainThread]: Connection 'model.billy_bulky.staging__shopify__products_history' was properly closed.
[0m13:23:58.938364 [debug] [MainThread]: Connection 'model.billy_bulky.sales' was properly closed.
[0m13:23:58.938980 [debug] [MainThread]: Connection 'model.billy_bulky.staging_shopify__orders' was properly closed.
[0m13:23:58.939573 [debug] [MainThread]: Connection 'model.billy_bulky.staging_shopify__products' was properly closed.
[0m13:23:58.940172 [debug] [MainThread]: Connection 'model.billy_bulky.int_customers_segmentation' was properly closed.
[0m13:23:58.940759 [debug] [MainThread]: Connection 'model.billy_bulky.int_products_performance' was properly closed.
[0m13:23:58.941357 [debug] [MainThread]: Connection 'model.billy_bulky.int_sales_trend' was properly closed.
[0m13:23:58.941910 [debug] [MainThread]: Connection 'model.billy_bulky.customers' was properly closed.
[0m13:23:58.942381 [debug] [MainThread]: Connection 'model.billy_bulky.products' was properly closed.
[0m13:23:58.943123 [info ] [MainThread]: 
[0m13:23:58.943811 [info ] [MainThread]: Finished running 4 view models, 3 table models in 0 hours 0 minutes and 10.36 seconds (10.36s).
[0m13:23:58.947233 [debug] [MainThread]: Command end result
[0m13:23:58.970097 [info ] [MainThread]: 
[0m13:23:58.970702 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:23:58.971154 [info ] [MainThread]: 
[0m13:23:58.971594 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m13:23:58.974906 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.313474, "process_user_time": 6.340578, "process_kernel_time": 0.416095, "process_mem_max_rss": "228245504", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:23:58.975483 [debug] [MainThread]: Command `dbt run` succeeded at 13:23:58.975350 after 12.31 seconds
[0m13:23:58.975912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102b7deb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1249881f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123f25070>]}
[0m13:23:58.976367 [debug] [MainThread]: Flushing usage events
